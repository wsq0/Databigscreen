import{a9 as ui,aa as $0,ab as sS,ac as X0,ad as Xr,ae as Mo,af as Ft,ag as Tl,ah as ao,ai as j0,aj as Yt,ak as Xc,al as xt,am as It,an as et,ao as ee,ap as lS,aq as Vt,ar as uS,as as cS,at as hS,au as R,av as Z0,aw as Y0,ax as Xd,ay as fS,az as dS,aA as jt,aB as ar,aC as pt,aD as st,aE as q0,aF as Nt,aG as Sn,aH as un,aI as io,aJ as vS,aK as jd,aL as K,aM as ra,aN as pS,aO as Ve,aP as gS,aQ as mS,aR as le,aS as K0,aT as J0,aU as Q0,aV as Mr,aW as Gt,aX as yS,aY as _S,aZ as xS,a_ as SS,a$ as bl,b0 as TS,b1 as jc,b2 as bS,b3 as vt,b4 as wS,b5 as AS,b6 as ES,b7 as CS,b8 as LS,b9 as DS,ba as MS,bb as em,bc as tf,bd as PS,be as IS,bf as RS,bg as te,bh as Hr,bi as Zd,bj as NS,bk as Ya,bl as U,bm as $e,bn as Fe,bo as Pr,bp as tm,bq as rm,br as He,bs as oe,bt as OS,bu as BS,bv as on,bw as Nn,bx as Ln,by as Te,bz as ur,bA as Wr,bB as wr,bC as zt,bD as wl,bE as Al,bF as El,bG as me,bH as Cl,bI as FS,bJ as $r,bK as fe,bL as Ot,bM as zS,bN as fa,bO as oo,bP as nm,bQ as Cr,bR as kt,bS as or,bT as Zc,bU as GS,bV as Ll,bW as sr,bX as Dl,bY as Ml,bZ as rf,b_ as nf,b$ as am,c0 as im,c1 as VS,c2 as so,c3 as US,c4 as kS,c5 as om,c6 as Fs,c7 as zs,c8 as Ge,c9 as Qr,ca as af,cb as it,cc as sm,cd as Yc,ce as ot,cf as rr,cg as lm,ch as HS,ci as rt,cj as ft,ck as Pl,cl as um,cm as Dn,cn as qa,co as WS,cp as cm,cq as Po,cr as Yd,cs as jo,ct as qd,cu as $S,cv as Io,cw as Et,cx as hm,cy as qc,cz as fm,cA as Lr,cB as Kd,cC as Ro,cD as En,cE as No,cF as XS,cG as jS,cH as Ua,cI as Jd,cJ as ZS,cK as er,cL as Kc,cM as Ye,cN as Gr,cO as Jc,cP as na,cQ as Gs,cR as Vs,cS as Il,cT as Rl,cU as YS,cV as dm,cW as qS,cX as vm,cY as pm,cZ as KS,c_ as JS,c$ as Qd,d0 as QS,d1 as ev,d2 as da,d3 as en,d4 as eT,d5 as tT,d6 as rT,d7 as nT,d8 as Nl,d9 as gm,da as of,db as lo,dc as ci,dd as sn,de as Vr,df as aT,dg as iT,dh as oT,di as mm,dj as sf,dk as sT,dl as lf,dm as Us,a2 as lT,dn as Qc,dp as eh,dq as uT,dr as pu,ds as ym,dt as ct,du as uf,dv as cf,dw as gu,dx as cT,dy as ki,dz as hT,dA as th,dB as fT,dC as _m,dD as tv,dE as Ol,dF as dT,dG as rh,dH as Bl,dI as rv,dJ as vT,dK as pT,dL as gT,dM as xm,dN as nv,dO as mT,dP as Fl,dQ as Z,dR as Sm,dS as uo,dT as yT,dU as Tm,dV as Oo,dW as av,dX as _T,dY as xT,dZ as ST,d_ as bm,d$ as wm,e0 as TT,e1 as Am,e2 as Em,e3 as iv,e4 as Cm,e5 as ov,e6 as Bo,e7 as hf,e8 as bT,e9 as wT,ea as AT,eb as ET,ec as CT,ed as LT,ee as Lm,ef as DT,eg as Dm,eh as MT,ei as sv,ej as Mm,ek as PT,el as IT,em as Pm,en as RT,eo as NT,ep as OT,eq as BT,er as FT,es as zT,et as Im,eu as GT,ev as VT,ew as UT,ex as ff,ey as kT,ez as lv,eA as Rm,eB as HT,eC as WT,eD as Ai,eE as Zo,eF as $T,eG as XT,eH as jT,eI as ZT,eJ as YT,eK as bs,eL as qT,eM as KT,eN as JT,eO as zl,eP as Nm,eQ as Om,eR as QT,eS as e3,eT as ks,eU as Hs,eV as t3,eW as Bm,eX as r3,eY as uv,eZ as n3,e_ as cv,e$ as Fm,f0 as a3,f1 as i3,f2 as o3,f3 as s3,d as Gl,a as ka,o as df,R as vf,S as zm,U as Xa,c as tr,e as pr,f as aa,t as Hi,P as l3,T as u3,g as c3,f4 as Ws,f5 as pf,f6 as h3,f7 as mu,f8 as f3,f9 as Gm,fa as d3,fb as v3,fc as p3,fd as g3,fe as m3,ff as y3,fg as _3,fh as x3,fi as S3,fj as T3,fk as b3,fl as w3,fm as A3,fn as E3,fo as Vm,fp as C3,fq as L3,fr as Um,fs as nh,ft as D3,fu as M3,fv as P3,fw as I3,fx as km,fy as Hm,fz as Wm,fA as $m,fB as R3,fC as ah,fD as Fo,fE as N3,fF as hv,fG as O3,fH as fv,fI as B3,fJ as F3,fK as Xm,fL as z3,fM as jm,i as Yo,j as Zm,r as G3,w as dv,$ as qo,a5 as yu,h as V3,Z as U3,_ as k3}from"./index-6CFUAS2Q.js";import{_ as Ym}from"./_plugin-vue_export-helper-x3n3nnut.js";function H3(e){return ui(null,e)}var gf={isDimensionStacked:$0,enableDataStack:sS,getStackedDimension:X0};function mf(e,t){var r=t;t instanceof Ft||(r=new Ft(t));var n=Tl(r);return n.setExtent(e[0],e[1]),ao(n,r),n}function W3(e){Xr(e,Mo)}function $3(e){if(e){for(var t=[],r=0;r<e.length;r++)t.push(e[r].slice());return t}}function X3(e,t){var r=e.label,n=t&&t.getTextGuideLine();return{dataIndex:e.dataIndex,dataType:e.dataType,seriesIndex:e.seriesModel.seriesIndex,text:e.label.style.text,rect:e.hostRect,labelRect:e.rect,align:r.style.align,verticalAlign:r.style.verticalAlign,labelLinePoints:$3(n&&n.shape.points)}}var vv=["align","verticalAlign","width","height","fontSize"],Ht=new j0,_u=Nt(),j3=Nt();function Ko(e,t,r){for(var n=0;n<r.length;n++){var a=r[n];t[a]!=null&&(e[a]=t[a])}}var Jo=["x","y","rotation"],Z3=function(){function e(){this._labelList=[],this._chartViewList=[]}return e.prototype.clearLabels=function(){this._labelList=[],this._chartViewList=[]},e.prototype._addLabel=function(t,r,n,a,i){var o=a.style,s=a.__hostTarget,l=s.textConfig||{},u=a.getComputedTransform(),c=a.getBoundingRect().plain();Yt.applyTransform(c,c,u),u?Ht.setLocalTransform(u):(Ht.x=Ht.y=Ht.rotation=Ht.originX=Ht.originY=0,Ht.scaleX=Ht.scaleY=1),Ht.rotation=Xc(Ht.rotation);var h=a.__hostTarget,f;if(h){f=h.getBoundingRect().plain();var d=h.getComputedTransform();Yt.applyTransform(f,f,d)}var v=f&&h.getTextGuideLine();this._labelList.push({label:a,labelLine:v,seriesModel:n,dataIndex:t,dataType:r,layoutOption:i,computedLayoutOption:null,rect:c,hostRect:f,priority:f?f.width*f.height:0,defaultAttr:{ignore:a.ignore,labelGuideIgnore:v&&v.ignore,x:Ht.x,y:Ht.y,scaleX:Ht.scaleX,scaleY:Ht.scaleY,rotation:Ht.rotation,style:{x:o.x,y:o.y,align:o.align,verticalAlign:o.verticalAlign,width:o.width,height:o.height,fontSize:o.fontSize},cursor:a.cursor,attachedPos:l.position,attachedRot:l.rotation}})},e.prototype.addLabelsOfSeries=function(t){var r=this;this._chartViewList.push(t);var n=t.__model,a=n.get("labelLayout");(xt(a)||It(a).length)&&t.group.traverse(function(i){if(i.ignore)return!0;var o=i.getTextContent(),s=et(i);o&&!o.disableLabelLayout&&r._addLabel(s.dataIndex,s.dataType,n,o,a)})},e.prototype.updateLayoutConfig=function(t){var r=t.getWidth(),n=t.getHeight();function a(y,x){return function(){Xd(y,x)}}for(var i=0;i<this._labelList.length;i++){var o=this._labelList[i],s=o.label,l=s.__hostTarget,u=o.defaultAttr,c=void 0;xt(o.layoutOption)?c=o.layoutOption(X3(o,l)):c=o.layoutOption,c=c||{},o.computedLayoutOption=c;var h=Math.PI/180;l&&l.setTextConfig({local:!1,position:c.x!=null||c.y!=null?null:u.attachedPos,rotation:c.rotate!=null?c.rotate*h:u.attachedRot,offset:[c.dx||0,c.dy||0]});var f=!1;if(c.x!=null?(s.x=ee(c.x,r),s.setStyle("x",0),f=!0):(s.x=u.x,s.setStyle("x",u.style.x)),c.y!=null?(s.y=ee(c.y,n),s.setStyle("y",0),f=!0):(s.y=u.y,s.setStyle("y",u.style.y)),c.labelLinePoints){var d=l.getTextGuideLine();d&&(d.setShape({points:c.labelLinePoints}),f=!1)}var v=_u(s);v.needsUpdateLabelLine=f,s.rotation=c.rotate!=null?c.rotate*h:u.rotation,s.scaleX=u.scaleX,s.scaleY=u.scaleY;for(var p=0;p<vv.length;p++){var g=vv[p];s.setStyle(g,c[g]!=null?c[g]:u.style[g])}if(c.draggable){if(s.draggable=!0,s.cursor="move",l){var m=o.seriesModel;if(o.dataIndex!=null){var _=o.seriesModel.getData(o.dataType);m=_.getItemModel(o.dataIndex)}s.on("drag",a(l,m.getModel("labelLine")))}}else s.off("drag"),s.cursor=u.cursor}},e.prototype.layout=function(t){var r=t.getWidth(),n=t.getHeight(),a=lS(this._labelList),i=Vt(a,function(l){return l.layoutOption.moveOverlap==="shiftX"}),o=Vt(a,function(l){return l.layoutOption.moveOverlap==="shiftY"});uS(i,0,r),cS(o,0,n);var s=Vt(a,function(l){return l.layoutOption.hideOverlap});hS(s)},e.prototype.processLabelsOverall=function(){var t=this;R(this._chartViewList,function(r){var n=r.__model,a=r.ignoreLabelLineUpdate,i=n.isAnimationEnabled();r.group.traverse(function(o){if(o.ignore&&!o.forceLabelAnimation)return!0;var s=!a,l=o.getTextContent();!s&&l&&(s=_u(l).needsUpdateLabelLine),s&&t._updateLabelLine(o,n),i&&t._animateLabels(o,n)})})},e.prototype._updateLabelLine=function(t,r){var n=t.getTextContent(),a=et(t),i=a.dataIndex;if(n&&i!=null){var o=r.getData(a.dataType),s=o.getItemModel(i),l={},u=o.getItemVisual(i,"style");if(u){var c=o.getVisual("drawType");l.stroke=u[c]}var h=s.getModel("labelLine");Z0(t,Y0(s),l),Xd(t,h)}},e.prototype._animateLabels=function(t,r){var n=t.getTextContent(),a=t.getTextGuideLine();if(n&&(t.forceLabelAnimation||!n.ignore&&!n.invisible&&!t.disableLabelAnimation&&!fS(t))){var i=_u(n),o=i.oldLayout,s=et(t),l=s.dataIndex,u={x:n.x,y:n.y,rotation:n.rotation},c=r.getData(s.dataType);if(o){n.attr(o);var f=t.prevStates;f&&(pt(f,"select")>=0&&n.attr(i.oldLayoutSelect),pt(f,"emphasis")>=0&&n.attr(i.oldLayoutEmphasis)),st(n,u,r,l)}else if(n.attr(u),!dS(n).valueAnimation){var h=jt(n.style.opacity,1);n.style.opacity=0,ar(n,{style:{opacity:h}},r,l)}if(i.oldLayout=u,n.states.select){var d=i.oldLayoutSelect={};Ko(d,u,Jo),Ko(d,n.states.select,Jo)}if(n.states.emphasis){var v=i.oldLayoutEmphasis={};Ko(v,u,Jo),Ko(v,n.states.emphasis,Jo)}q0(n,l,c,r,r)}if(a&&!a.ignore&&!a.invisible){var i=j3(a),o=i.oldLayout,p={points:a.shape.points};o?(a.attr({shape:o}),st(a,{shape:p},r)):(a.setShape(p),a.style.strokePercent=0,ar(a,{style:{strokePercent:1}},r)),i.oldLayout=p}},e}();const Y3=Z3;var xu=Nt();function qm(e){e.registerUpdateLifecycle("series:beforeupdate",function(t,r,n){var a=xu(r).labelManager;a||(a=xu(r).labelManager=new Y3),a.clearLabels()}),e.registerUpdateLifecycle("series:layoutlabels",function(t,r,n){var a=xu(r).labelManager;n.updatedSeries.forEach(function(i){a.addLabelsOfSeries(r.getViewOfSeriesModel(i))}),a.updateLayoutConfig(r),a.layout(r),a.processLabelsOverall()})}var Su=Math.sin,Tu=Math.cos,Km=Math.PI,Un=Math.PI*2,q3=180/Km,K3=function(){function e(){}return e.prototype.reset=function(t){this._start=!0,this._d=[],this._str="",this._p=Math.pow(10,t||4)},e.prototype.moveTo=function(t,r){this._add("M",t,r)},e.prototype.lineTo=function(t,r){this._add("L",t,r)},e.prototype.bezierCurveTo=function(t,r,n,a,i,o){this._add("C",t,r,n,a,i,o)},e.prototype.quadraticCurveTo=function(t,r,n,a){this._add("Q",t,r,n,a)},e.prototype.arc=function(t,r,n,a,i,o){this.ellipse(t,r,n,n,0,a,i,o)},e.prototype.ellipse=function(t,r,n,a,i,o,s,l){var u=s-o,c=!l,h=Math.abs(u),f=Sn(h-Un)||(c?u>=Un:-u>=Un),d=u>0?u%Un:u%Un+Un,v=!1;f?v=!0:Sn(h)?v=!1:v=d>=Km==!!c;var p=t+n*Tu(o),g=r+a*Su(o);this._start&&this._add("M",p,g);var m=Math.round(i*q3);if(f){var _=1/this._p,y=(c?1:-1)*(Un-_);this._add("A",n,a,m,1,+c,t+n*Tu(o+y),r+a*Su(o+y)),_>.01&&this._add("A",n,a,m,0,+c,p,g)}else{var x=t+n*Tu(s),S=r+a*Su(s);this._add("A",n,a,m,+v,+c,x,S)}},e.prototype.rect=function(t,r,n,a){this._add("M",t,r),this._add("l",n,0),this._add("l",0,a),this._add("l",-n,0),this._add("Z")},e.prototype.closePath=function(){this._d.length>0&&this._add("Z")},e.prototype._add=function(t,r,n,a,i,o,s,l,u){for(var c=[],h=this._p,f=1;f<arguments.length;f++){var d=arguments[f];if(isNaN(d)){this._invalid=!0;return}c.push(Math.round(d*h)/h)}this._d.push(t+c.join(" ")),this._start=t==="Z"},e.prototype.generateStr=function(){this._str=this._invalid?"":this._d.join(""),this._d=[]},e.prototype.getStr=function(){return this._str},e}();const Jm=K3;var Qi="none",J3=Math.round;function Q3(e){var t=e.fill;return t!=null&&t!==Qi}function e4(e){var t=e.stroke;return t!=null&&t!==Qi}var ih=["lineCap","miterLimit","lineJoin"],t4=K(ih,function(e){return"stroke-"+e.toLowerCase()});function r4(e,t,r,n){var a=t.opacity==null?1:t.opacity;if(r instanceof un){e("opacity",a);return}if(Q3(t)){var i=io(t.fill);e("fill",i.color);var o=t.fillOpacity!=null?t.fillOpacity*i.opacity*a:i.opacity*a;(n||o<1)&&e("fill-opacity",o)}else e("fill",Qi);if(e4(t)){var s=io(t.stroke);e("stroke",s.color);var l=t.strokeNoScale?r.getLineScale():1,u=l?(t.lineWidth||0)/l:0,c=t.strokeOpacity!=null?t.strokeOpacity*s.opacity*a:s.opacity*a,h=t.strokeFirst;if((n||u!==1)&&e("stroke-width",u),(n||h)&&e("paint-order",h?"stroke":"fill"),(n||c<1)&&e("stroke-opacity",c),t.lineDash){var f=vS(r),d=f[0],v=f[1];d&&(v=J3(v||0),e("stroke-dasharray",d.join(",")),(v||n)&&e("stroke-dashoffset",v))}else n&&e("stroke-dasharray",Qi);for(var p=0;p<ih.length;p++){var g=ih[p];if(n||t[g]!==jd[g]){var m=t[g]||jd[g];m&&e(t4[p],m)}}}else n&&e("stroke",Qi)}var Qm="http://www.w3.org/2000/svg",ey="http://www.w3.org/1999/xlink",n4="http://www.w3.org/2000/xmlns/",a4="http://www.w3.org/XML/1998/namespace";function ty(e){return document.createElementNS(Qm,e)}function wt(e,t,r,n,a){return{tag:e,attrs:r||{},children:n,text:a,key:t}}function i4(e,t){var r=[];if(t)for(var n in t){var a=t[n],i=n;a!==!1&&(a!==!0&&a!=null&&(i+='="'+a+'"'),r.push(i))}return"<"+e+" "+r.join(" ")+">"}function o4(e){return"</"+e+">"}function yf(e,t){t=t||{};var r=t.newline?`
`:"";function n(a){var i=a.children,o=a.tag,s=a.attrs,l=a.text;return i4(o,s)+(o!=="style"?ra(l):l||"")+(i?""+r+K(i,function(u){return n(u)}).join(r)+r:"")+o4(o)}return n(e)}function s4(e,t,r){r=r||{};var n=r.newline?`
`:"",a=" {"+n,i=n+"}",o=K(It(e),function(l){return l+a+K(It(e[l]),function(u){return u+":"+e[l][u]+";"}).join(n)+i}).join(n),s=K(It(t),function(l){return"@keyframes "+l+a+K(It(t[l]),function(u){return u+a+K(It(t[l][u]),function(c){var h=t[l][u][c];return c==="d"&&(h='path("'+h+'")'),c+":"+h+";"}).join(n)+i}).join(n)+i}).join(n);return!o&&!s?"":["<![CDATA[",o,s,"]]>"].join(n)}function oh(e){return{zrId:e,shadowCache:{},patternCache:{},gradientCache:{},clipPathCache:{},defs:{},cssNodes:{},cssAnims:{},cssClassIdx:0,cssAnimIdx:0,shadowIdx:0,gradientIdx:0,patternIdx:0,clipPathIdx:0}}function pv(e,t,r,n){return wt("svg","root",{width:e,height:t,xmlns:Qm,"xmlns:xlink":ey,version:"1.1",baseProfile:"full",viewBox:n?"0 0 "+e+" "+t:!1},r)}var gv={cubicIn:"0.32,0,0.67,0",cubicOut:"0.33,1,0.68,1",cubicInOut:"0.65,0,0.35,1",quadraticIn:"0.11,0,0.5,0",quadraticOut:"0.5,1,0.89,1",quadraticInOut:"0.45,0,0.55,1",quarticIn:"0.5,0,0.75,0",quarticOut:"0.25,1,0.5,1",quarticInOut:"0.76,0,0.24,1",quinticIn:"0.64,0,0.78,0",quinticOut:"0.22,1,0.36,1",quinticInOut:"0.83,0,0.17,1",sinusoidalIn:"0.12,0,0.39,0",sinusoidalOut:"0.61,1,0.88,1",sinusoidalInOut:"0.37,0,0.63,1",exponentialIn:"0.7,0,0.84,0",exponentialOut:"0.16,1,0.3,1",exponentialInOut:"0.87,0,0.13,1",circularIn:"0.55,0,1,0.45",circularOut:"0,0.55,0.45,1",circularInOut:"0.85,0,0.15,1"},Yn="transform-origin";function l4(e,t,r){var n=le({},e.shape);le(n,t),e.buildPath(r,n);var a=new Jm;return a.reset(Q0(e)),r.rebuildPath(a,1),a.generateStr(),a.getStr()}function u4(e,t){var r=t.originX,n=t.originY;(r||n)&&(e[Yn]=r+"px "+n+"px")}var c4={fill:"fill",opacity:"opacity",lineWidth:"stroke-width",lineDashOffset:"stroke-dashoffset"};function ry(e,t){var r=t.zrId+"-ani-"+t.cssAnimIdx++;return t.cssAnims[r]=e,r}function h4(e,t,r){var n=e.shape.paths,a={},i,o;if(R(n,function(l){var u=oh(r.zrId);u.animation=!0,Vl(l,{},u,!0);var c=u.cssAnims,h=u.cssNodes,f=It(c),d=f.length;if(d){o=f[d-1];var v=c[o];for(var p in v){var g=v[p];a[p]=a[p]||{d:""},a[p].d+=g.d||""}for(var m in h){var _=h[m].animation;_.indexOf(o)>=0&&(i=_)}}}),!!i){t.d=!1;var s=ry(a,r);return i.replace(o,s)}}function mv(e){return Ve(e)?gv[e]?"cubic-bezier("+gv[e]+")":gS(e)?e:"":""}function Vl(e,t,r,n){var a=e.animators,i=a.length,o=[];if(e instanceof pS){var s=h4(e,t,r);if(s)o.push(s);else if(!i)return}else if(!i)return;for(var l={},u=0;u<i;u++){var c=a[u],h=[c.getMaxTime()/1e3+"s"],f=mv(c.getClip().easing),d=c.getDelay();f?h.push(f):h.push("linear"),d&&h.push(d/1e3+"s"),c.getLoop()&&h.push("infinite");var v=h.join(" ");l[v]=l[v]||[v,[]],l[v][1].push(c)}function p(_){var y=_[1],x=y.length,S={},T={},b={},w="animation-timing-function";function A(j,pe,de){for(var ge=j.getTracks(),nt=j.getMaxTime(),De=0;De<ge.length;De++){var Re=ge[De];if(Re.needsAnimate()){var Be=Re.keyframes,Dt=Re.propName;if(de&&(Dt=de(Dt)),Dt)for(var Rr=0;Rr<Be.length;Rr++){var Gn=Be[Rr],Vn=Math.round(Gn.time/nt*100)+"%",Wd=mv(Gn.easing),$d=Gn.rawValue;(Ve($d)||Mr($d))&&(pe[Vn]=pe[Vn]||{},pe[Vn][Dt]=Gn.rawValue,Wd&&(pe[Vn][w]=Wd))}}}}for(var E=0;E<x;E++){var C=y[E],M=C.targetName;M?M==="shape"&&A(C,T):!n&&A(C,S)}for(var P in S){var L={};mS(L,e),le(L,S[P]);var I=K0(L),N=S[P][w];b[P]=I?{transform:I}:{},u4(b[P],L),N&&(b[P][w]=N)}var F,B=!0;for(var P in T){b[P]=b[P]||{};var k=!F,N=T[P][w];k&&(F=new J0);var z=F.len();F.reset(),b[P].d=l4(e,T[P],F);var W=F.len();if(!k&&z!==W){B=!1;break}N&&(b[P][w]=N)}if(!B)for(var P in b)delete b[P].d;if(!n)for(var E=0;E<x;E++){var C=y[E],M=C.targetName;M==="style"&&A(C,b,function(ge){return c4[ge]})}for(var J=It(b),re=!0,Q,E=1;E<J.length;E++){var q=J[E-1],Ee=J[E];if(b[q][Yn]!==b[Ee][Yn]){re=!1;break}Q=b[q][Yn]}if(re&&Q){for(var P in b)b[P][Yn]&&delete b[P][Yn];t[Yn]=Q}if(Vt(J,function(j){return It(b[j]).length>0}).length){var ae=ry(b,r);return ae+" "+_[0]+" both"}}for(var g in l){var s=p(l[g]);s&&o.push(s)}if(o.length){var m=r.zrId+"-cls-"+r.cssClassIdx++;r.cssNodes["."+m]={animation:o.join(",")},t.class=m}}var co=Math.round;function ny(e){return e&&Ve(e.src)}function ay(e){return e&&xt(e.toDataURL)}function _f(e,t,r,n){r4(function(a,i){var o=a==="fill"||a==="stroke";o&&em(i)?oy(t,e,a,n):o&&tf(i)?sy(r,e,a,n):e[a]=i},t,r,!1),y4(r,e,n)}function yv(e){return Sn(e[0]-1)&&Sn(e[1])&&Sn(e[2])&&Sn(e[3]-1)}function f4(e){return Sn(e[4])&&Sn(e[5])}function xf(e,t,r){if(t&&!(f4(t)&&yv(t))){var n=r?10:1e4;e.transform=yv(t)?"translate("+co(t[4]*n)/n+" "+co(t[5]*n)/n+")":PS(t)}}function _v(e,t,r){for(var n=e.points,a=[],i=0;i<n.length;i++)a.push(co(n[i][0]*r)/r),a.push(co(n[i][1]*r)/r);t.points=a.join(" ")}function xv(e){return!e.smooth}function d4(e){var t=K(e,function(r){return typeof r=="string"?[r,r]:r});return function(r,n,a){for(var i=0;i<t.length;i++){var o=t[i],s=r[o[0]];s!=null&&(n[o[1]]=co(s*a)/a)}}}var v4={circle:[d4(["cx","cy","r"])],polyline:[_v,xv],polygon:[_v,xv]};function p4(e){for(var t=e.animators,r=0;r<t.length;r++)if(t[r].targetName==="shape")return!0;return!1}function iy(e,t){var r=e.style,n=e.shape,a=v4[e.type],i={},o=t.animation,s="path",l=e.style.strokePercent,u=t.compress&&Q0(e)||4;if(a&&!t.willUpdate&&!(a[1]&&!a[1](n))&&!(o&&p4(e))&&!(l<1)){s=e.type;var c=Math.pow(10,u);a[0](n,i,c)}else{var h=!e.path||e.shapeChanged();e.path||e.createPathProxy();var f=e.path;h&&(f.beginPath(),e.buildPath(f,e.shape),e.pathUpdated());var d=f.getVersion(),v=e,p=v.__svgPathBuilder;(v.__svgPathVersion!==d||!p||l!==v.__svgPathStrokePercent)&&(p||(p=v.__svgPathBuilder=new Jm),p.reset(u),f.rebuildPath(p,l),p.generateStr(),v.__svgPathVersion=d,v.__svgPathStrokePercent=l),i.d=p.getStr()}return xf(i,e.transform),_f(i,r,e,t),t.animation&&Vl(e,i,t),wt(s,e.id+"",i)}function g4(e,t){var r=e.style,n=r.image;if(n&&!Ve(n)&&(ny(n)?n=n.src:ay(n)&&(n=n.toDataURL())),!!n){var a=r.x||0,i=r.y||0,o=r.width,s=r.height,l={href:n,width:o,height:s};return a&&(l.x=a),i&&(l.y=i),xf(l,e.transform),_f(l,r,e,t),t.animation&&Vl(e,l,t),wt("image",e.id+"",l)}}function m4(e,t){var r=e.style,n=r.text;if(n!=null&&(n+=""),!(!n||isNaN(r.x)||isNaN(r.y))){var a=r.font||wS,i=r.x||0,o=AS(r.y||0,ES(a),r.textBaseline),s=CS[r.textAlign]||r.textAlign,l={"dominant-baseline":"central","text-anchor":s};if(LS(r)){var u="",c=r.fontStyle,h=DS(r.fontSize);if(!parseFloat(h))return;var f=r.fontFamily||MS,d=r.fontWeight;u+="font-size:"+h+";font-family:"+f+";",c&&c!=="normal"&&(u+="font-style:"+c+";"),d&&d!=="normal"&&(u+="font-weight:"+d+";"),l.style=u}else l.style="font: "+a;return n.match(/\s/)&&(l["xml:space"]="preserve"),i&&(l.x=i),o&&(l.y=o),xf(l,e.transform),_f(l,r,e,t),t.animation&&Vl(e,l,t),wt("text",e.id+"",l,void 0,n)}}function Sv(e,t){if(e instanceof Gt)return iy(e,t);if(e instanceof un)return g4(e,t);if(e instanceof yS)return m4(e,t)}function y4(e,t,r){var n=e.style;if(IS(n)){var a=RS(e),i=r.shadowCache,o=i[a];if(!o){var s=e.getGlobalScale(),l=s[0],u=s[1];if(!l||!u)return;var c=n.shadowOffsetX||0,h=n.shadowOffsetY||0,f=n.shadowBlur,d=io(n.shadowColor),v=d.opacity,p=d.color,g=f/2/l,m=f/2/u,_=g+" "+m;o=r.zrId+"-s"+r.shadowIdx++,r.defs[o]=wt("filter",o,{id:o,x:"-100%",y:"-100%",width:"300%",height:"300%"},[wt("feDropShadow","",{dx:c/l,dy:h/u,stdDeviation:_,"flood-color":p,"flood-opacity":v})]),i[a]=o}t.filter=bl(o)}}function oy(e,t,r,n){var a=e[r],i,o={gradientUnits:a.global?"userSpaceOnUse":"objectBoundingBox"};if(_S(a))i="linearGradient",o.x1=a.x,o.y1=a.y,o.x2=a.x2,o.y2=a.y2;else if(xS(a))i="radialGradient",o.cx=jt(a.x,.5),o.cy=jt(a.y,.5),o.r=jt(a.r,.5);else return;for(var s=a.colorStops,l=[],u=0,c=s.length;u<c;++u){var h=SS(s[u].offset)*100+"%",f=s[u].color,d=io(f),v=d.color,p=d.opacity,g={offset:h};g["stop-color"]=v,p<1&&(g["stop-opacity"]=p),l.push(wt("stop",u+"",g))}var m=wt(i,"",o,l),_=yf(m),y=n.gradientCache,x=y[_];x||(x=n.zrId+"-g"+n.gradientIdx++,y[_]=x,o.id=x,n.defs[x]=wt(i,x,o,l)),t[r]=bl(x)}function sy(e,t,r,n){var a=e.style[r],i=e.getBoundingRect(),o={},s=a.repeat,l=s==="no-repeat",u=s==="repeat-x",c=s==="repeat-y",h;if(TS(a)){var f=a.imageWidth,d=a.imageHeight,v=void 0,p=a.image;if(Ve(p)?v=p:ny(p)?v=p.src:ay(p)&&(v=p.toDataURL()),typeof Image>"u"){var g="Image width/height must been given explictly in svg-ssr renderer.";jc(f,g),jc(d,g)}else if(f==null||d==null){var m=function(E,C){if(E){var M=E.elm,P=f||C.width,L=d||C.height;E.tag==="pattern"&&(u?(L=1,P/=i.width):c&&(P=1,L/=i.height)),E.attrs.width=P,E.attrs.height=L,M&&(M.setAttribute("width",P),M.setAttribute("height",L))}},_=bS(v,null,e,function(E){l||m(T,E),m(h,E)});_&&_.width&&_.height&&(f=f||_.width,d=d||_.height)}h=wt("image","img",{href:v,width:f,height:d}),o.width=f,o.height=d}else a.svgElement&&(h=vt(a.svgElement),o.width=a.svgWidth,o.height=a.svgHeight);if(h){var y,x;l?y=x=1:u?(x=1,y=o.width/i.width):c?(y=1,x=o.height/i.height):o.patternUnits="userSpaceOnUse",y!=null&&!isNaN(y)&&(o.width=y),x!=null&&!isNaN(x)&&(o.height=x);var S=K0(a);S&&(o.patternTransform=S);var T=wt("pattern","",o,[h]),b=yf(T),w=n.patternCache,A=w[b];A||(A=n.zrId+"-p"+n.patternIdx++,w[b]=A,o.id=A,T=n.defs[A]=wt("pattern",A,o,[h])),t[r]=bl(A)}}function _4(e,t,r){var n=r.clipPathCache,a=r.defs,i=n[e.id];if(!i){i=r.zrId+"-c"+r.clipPathIdx++;var o={id:i};n[e.id]=i,a[i]=wt("clipPath",i,o,[iy(e,r)])}t["clip-path"]=bl(i)}function Tv(e){return document.createTextNode(e)}function ea(e,t,r){e.insertBefore(t,r)}function bv(e,t){e.removeChild(t)}function wv(e,t){e.appendChild(t)}function ly(e){return e.parentNode}function uy(e){return e.nextSibling}function bu(e,t){e.textContent=t}var Av=58,x4=120,S4=wt("","");function sh(e){return e===void 0}function Fr(e){return e!==void 0}function T4(e,t,r){for(var n={},a=t;a<=r;++a){var i=e[a].key;i!==void 0&&(n[i]=a)}return n}function Wi(e,t){var r=e.key===t.key,n=e.tag===t.tag;return n&&r}function ho(e){var t,r=e.children,n=e.tag;if(Fr(n)){var a=e.elm=ty(n);if(Sf(S4,e),te(r))for(t=0;t<r.length;++t){var i=r[t];i!=null&&wv(a,ho(i))}else Fr(e.text)&&!Hr(e.text)&&wv(a,Tv(e.text))}else e.elm=Tv(e.text);return e.elm}function cy(e,t,r,n,a){for(;n<=a;++n){var i=r[n];i!=null&&ea(e,ho(i),t)}}function $s(e,t,r,n){for(;r<=n;++r){var a=t[r];if(a!=null)if(Fr(a.tag)){var i=ly(a.elm);bv(i,a.elm)}else bv(e,a.elm)}}function Sf(e,t){var r,n=t.elm,a=e&&e.attrs||{},i=t.attrs||{};if(a!==i){for(r in i){var o=i[r],s=a[r];s!==o&&(o===!0?n.setAttribute(r,""):o===!1?n.removeAttribute(r):r.charCodeAt(0)!==x4?n.setAttribute(r,o):r==="xmlns:xlink"||r==="xmlns"?n.setAttributeNS(n4,r,o):r.charCodeAt(3)===Av?n.setAttributeNS(a4,r,o):r.charCodeAt(5)===Av?n.setAttributeNS(ey,r,o):n.setAttribute(r,o))}for(r in a)r in i||n.removeAttribute(r)}}function b4(e,t,r){for(var n=0,a=0,i=t.length-1,o=t[0],s=t[i],l=r.length-1,u=r[0],c=r[l],h,f,d,v;n<=i&&a<=l;)o==null?o=t[++n]:s==null?s=t[--i]:u==null?u=r[++a]:c==null?c=r[--l]:Wi(o,u)?(za(o,u),o=t[++n],u=r[++a]):Wi(s,c)?(za(s,c),s=t[--i],c=r[--l]):Wi(o,c)?(za(o,c),ea(e,o.elm,uy(s.elm)),o=t[++n],c=r[--l]):Wi(s,u)?(za(s,u),ea(e,s.elm,o.elm),s=t[--i],u=r[++a]):(sh(h)&&(h=T4(t,n,i)),f=h[u.key],sh(f)?ea(e,ho(u),o.elm):(d=t[f],d.tag!==u.tag?ea(e,ho(u),o.elm):(za(d,u),t[f]=void 0,ea(e,d.elm,o.elm))),u=r[++a]);(n<=i||a<=l)&&(n>i?(v=r[l+1]==null?null:r[l+1].elm,cy(e,v,r,a,l)):$s(e,t,n,i))}function za(e,t){var r=t.elm=e.elm,n=e.children,a=t.children;e!==t&&(Sf(e,t),sh(t.text)?Fr(n)&&Fr(a)?n!==a&&b4(r,n,a):Fr(a)?(Fr(e.text)&&bu(r,""),cy(r,null,a,0,a.length-1)):Fr(n)?$s(r,n,0,n.length-1):Fr(e.text)&&bu(r,""):e.text!==t.text&&(Fr(n)&&$s(r,n,0,n.length-1),bu(r,t.text)))}function w4(e,t){if(Wi(e,t))za(e,t);else{var r=e.elm,n=ly(r);ho(t),n!==null&&(ea(n,t.elm,uy(r)),$s(n,[e],0,0))}return t}var A4=0,E4=function(){function e(t,r,n){if(this.type="svg",this.refreshHover=Ev(),this.configLayer=Ev(),this.storage=r,this._opts=n=le({},n),this.root=t,this._id="zr"+A4++,this._oldVNode=pv(n.width,n.height),t&&!n.ssr){var a=this._viewport=document.createElement("div");a.style.cssText="position:relative;overflow:hidden";var i=this._svgDom=this._oldVNode.elm=ty("svg");Sf(null,this._oldVNode),a.appendChild(i),t.appendChild(a)}this.resize(n.width,n.height)}return e.prototype.getType=function(){return this.type},e.prototype.getViewportRoot=function(){return this._viewport},e.prototype.getViewportRootOffset=function(){var t=this.getViewportRoot();if(t)return{offsetLeft:t.offsetLeft||0,offsetTop:t.offsetTop||0}},e.prototype.getSvgDom=function(){return this._svgDom},e.prototype.refresh=function(){if(this.root){var t=this.renderToVNode({willUpdate:!0});t.attrs.style="position:absolute;left:0;top:0;user-select:none",w4(this._oldVNode,t),this._oldVNode=t}},e.prototype.renderOneToVNode=function(t){return Sv(t,oh(this._id))},e.prototype.renderToVNode=function(t){t=t||{};var r=this.storage.getDisplayList(!0),n=this._width,a=this._height,i=oh(this._id);i.animation=t.animation,i.willUpdate=t.willUpdate,i.compress=t.compress;var o=[],s=this._bgVNode=C4(n,a,this._backgroundColor,i);s&&o.push(s);var l=t.compress?null:this._mainVNode=wt("g","main",{},[]);this._paintList(r,i,l?l.children:o),l&&o.push(l);var u=K(It(i.defs),function(f){return i.defs[f]});if(u.length&&o.push(wt("defs","defs",{},u)),t.animation){var c=s4(i.cssNodes,i.cssAnims,{newline:!0});if(c){var h=wt("style","stl",{},[],c);o.push(h)}}return pv(n,a,o,t.useViewBox)},e.prototype.renderToString=function(t){return t=t||{},yf(this.renderToVNode({animation:jt(t.cssAnimation,!0),willUpdate:!1,compress:!0,useViewBox:jt(t.useViewBox,!0)}),{newline:!0})},e.prototype.setBackgroundColor=function(t){this._backgroundColor=t},e.prototype.getSvgRoot=function(){return this._mainVNode&&this._mainVNode.elm},e.prototype._paintList=function(t,r,n){for(var a=t.length,i=[],o=0,s,l,u=0,c=0;c<a;c++){var h=t[c];if(!h.invisible){var f=h.__clipPaths,d=f&&f.length||0,v=l&&l.length||0,p=void 0;for(p=Math.max(d-1,v-1);p>=0&&!(f&&l&&f[p]===l[p]);p--);for(var g=v-1;g>p;g--)o--,s=i[o-1];for(var m=p+1;m<d;m++){var _={};_4(f[m],_,r);var y=wt("g","clip-g-"+u++,_,[]);(s?s.children:n).push(y),i[o++]=y,s=y}l=f;var x=Sv(h,r);x&&(s?s.children:n).push(x)}}},e.prototype.resize=function(t,r){var n=this._opts,a=this.root,i=this._viewport;if(t!=null&&(n.width=t),r!=null&&(n.height=r),a&&i&&(i.style.display="none",t=Zd(a,0,n),r=Zd(a,1,n),i.style.display=""),this._width!==t||this._height!==r){if(this._width=t,this._height=r,i){var o=i.style;o.width=t+"px",o.height=r+"px"}if(tf(this._backgroundColor))this.refresh();else{var s=this._svgDom;s&&(s.setAttribute("width",t),s.setAttribute("height",r));var l=this._bgVNode&&this._bgVNode.elm;l&&(l.setAttribute("width",t),l.setAttribute("height",r))}}},e.prototype.getWidth=function(){return this._width},e.prototype.getHeight=function(){return this._height},e.prototype.dispose=function(){this.root&&(this.root.innerHTML=""),this._svgDom=this._viewport=this.storage=this._oldVNode=this._bgVNode=this._mainVNode=null},e.prototype.clear=function(){this._svgDom&&(this._svgDom.innerHTML=null),this._oldVNode=null},e.prototype.toDataURL=function(t){var r=this.renderToString(),n="data:image/svg+xml;";return t?(r=NS(r),r&&n+"base64,"+r):n+"charset=UTF-8,"+encodeURIComponent(r)},e}();function Ev(e){return function(){}}function C4(e,t,r,n){var a;if(r&&r!=="none")if(a=wt("rect","bg",{width:e,height:t,x:"0",y:"0",id:"0"}),em(r))oy({fill:r},a.attrs,"fill",n);else if(tf(r))sy({style:{fill:r},dirty:Ya,getBoundingRect:function(){return{width:e,height:t}}},a.attrs,"fill",n);else{var i=io(r),o=i.color,s=i.opacity;a.attrs.fill=o,s<1&&(a.attrs["fill-opacity"]=s)}return a}const L4=E4;function D4(e){e.registerPainter("svg",L4)}var M4=function(e){U(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r.hasSymbolVisual=!0,r}return t.prototype.getInitialData=function(r,n){return ui(null,this,{useEncodeDefaulter:!0})},t.prototype.getProgressive=function(){var r=this.option.progressive;return r??(this.option.large?5e3:this.get("progressive"))},t.prototype.getProgressiveThreshold=function(){var r=this.option.progressiveThreshold;return r??(this.option.large?1e4:this.get("progressiveThreshold"))},t.prototype.brushSelector=function(r,n,a){return a.point(n.getItemLayout(r))},t.prototype.getZLevelKey=function(){return this.getData().count()>this.getProgressiveThreshold()?this.id:""},t.type="series.scatter",t.dependencies=["grid","polar","geo","singleAxis","calendar"],t.defaultOption={coordinateSystem:"cartesian2d",z:2,legendHoverLink:!0,symbolSize:10,large:!1,largeThreshold:2e3,itemStyle:{opacity:.8},emphasis:{scale:!0},clip:!0,select:{itemStyle:{borderColor:"#212121"}},universalTransition:{divideShape:"clone"}},t}($e);const P4=M4;var hy=4,I4=function(){function e(){}return e}(),R4=function(e){U(t,e);function t(r){var n=e.call(this,r)||this;return n._off=0,n.hoverDataIdx=-1,n}return t.prototype.getDefaultShape=function(){return new I4},t.prototype.reset=function(){this.notClear=!1,this._off=0},t.prototype.buildPath=function(r,n){var a=n.points,i=n.size,o=this.symbolProxy,s=o.shape,l=r.getContext?r.getContext():r,u=l&&i[0]<hy,c=this.softClipShape,h;if(u){this._ctx=l;return}for(this._ctx=null,h=this._off;h<a.length;){var f=a[h++],d=a[h++];isNaN(f)||isNaN(d)||c&&!c.contain(f,d)||(s.x=f-i[0]/2,s.y=d-i[1]/2,s.width=i[0],s.height=i[1],o.buildPath(r,s,!0))}this.incremental&&(this._off=h,this.notClear=!0)},t.prototype.afterBrush=function(){var r=this.shape,n=r.points,a=r.size,i=this._ctx,o=this.softClipShape,s;if(i){for(s=this._off;s<n.length;){var l=n[s++],u=n[s++];isNaN(l)||isNaN(u)||o&&!o.contain(l,u)||i.fillRect(l-a[0]/2,u-a[1]/2,a[0],a[1])}this.incremental&&(this._off=s,this.notClear=!0)}},t.prototype.findDataIndex=function(r,n){for(var a=this.shape,i=a.points,o=a.size,s=Math.max(o[0],4),l=Math.max(o[1],4),u=i.length/2-1;u>=0;u--){var c=u*2,h=i[c]-s/2,f=i[c+1]-l/2;if(r>=h&&n>=f&&r<=h+s&&n<=f+l)return u}return-1},t.prototype.contain=function(r,n){var a=this.transformCoordToLocal(r,n),i=this.getBoundingRect();if(r=a[0],n=a[1],i.contain(r,n)){var o=this.hoverDataIdx=this.findDataIndex(r,n);return o>=0}return this.hoverDataIdx=-1,!1},t.prototype.getBoundingRect=function(){var r=this._rect;if(!r){for(var n=this.shape,a=n.points,i=n.size,o=i[0],s=i[1],l=1/0,u=1/0,c=-1/0,h=-1/0,f=0;f<a.length;){var d=a[f++],v=a[f++];l=Math.min(d,l),c=Math.max(d,c),u=Math.min(v,u),h=Math.max(v,h)}r=this._rect=new Yt(l-o/2,u-s/2,c-l+o,h-u+s)}return r},t}(Gt),N4=function(){function e(){this.group=new Fe}return e.prototype.updateData=function(t,r){this._clear();var n=this._create();n.setShape({points:t.getLayout("points")}),this._setCommon(n,t,r)},e.prototype.updateLayout=function(t){var r=t.getLayout("points");this.group.eachChild(function(n){if(n.startIndex!=null){var a=(n.endIndex-n.startIndex)*2,i=n.startIndex*4*2;r=new Float32Array(r.buffer,i,a)}n.setShape("points",r),n.reset()})},e.prototype.incrementalPrepareUpdate=function(t){this._clear()},e.prototype.incrementalUpdate=function(t,r,n){var a=this._newAdded[0],i=r.getLayout("points"),o=a&&a.shape.points;if(o&&o.length<2e4){var s=o.length,l=new Float32Array(s+i.length);l.set(o),l.set(i,s),a.endIndex=t.end,a.setShape({points:l})}else{this._newAdded=[];var u=this._create();u.startIndex=t.start,u.endIndex=t.end,u.incremental=!0,u.setShape({points:i}),this._setCommon(u,r,n)}},e.prototype.eachRendered=function(t){this._newAdded[0]&&t(this._newAdded[0])},e.prototype._create=function(){var t=new R4({cursor:"default"});return t.ignoreCoarsePointer=!0,this.group.add(t),this._newAdded.push(t),t},e.prototype._setCommon=function(t,r,n){var a=r.hostModel;n=n||{};var i=r.getVisual("symbolSize");t.setShape("size",i instanceof Array?i:[i,i]),t.softClipShape=n.clipShape||null,t.symbolProxy=Pr(r.getVisual("symbol"),0,0,0,0),t.setColor=t.symbolProxy.setColor;var o=t.shape.size[0]<hy;t.useStyle(a.getModel("itemStyle").getItemStyle(o?["color","shadowBlur","shadowColor"]:["color"]));var s=r.getVisual("style"),l=s&&s.fill;l&&t.setColor(l);var u=et(t);u.seriesIndex=a.seriesIndex,t.on("mousemove",function(c){u.dataIndex=null;var h=t.hoverDataIdx;h>=0&&(u.dataIndex=h+(t.startIndex||0))})},e.prototype.remove=function(){this._clear()},e.prototype._clear=function(){this._newAdded=[],this.group.removeAll()},e}();const O4=N4;var B4=function(e){U(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.render=function(r,n,a){var i=r.getData(),o=this._updateSymbolDraw(i,r);o.updateData(i,{clipShape:this._getClipShape(r)}),this._finished=!0},t.prototype.incrementalPrepareRender=function(r,n,a){var i=r.getData(),o=this._updateSymbolDraw(i,r);o.incrementalPrepareUpdate(i),this._finished=!1},t.prototype.incrementalRender=function(r,n,a){this._symbolDraw.incrementalUpdate(r,n.getData(),{clipShape:this._getClipShape(n)}),this._finished=r.end===n.getData().count()},t.prototype.updateTransform=function(r,n,a){var i=r.getData();if(this.group.dirty(),!this._finished||i.count()>1e4)return{update:!0};var o=tm("").reset(r,n,a);o.progress&&o.progress({start:0,end:i.count(),count:i.count()},i),this._symbolDraw.updateLayout(i)},t.prototype.eachRendered=function(r){this._symbolDraw&&this._symbolDraw.eachRendered(r)},t.prototype._getClipShape=function(r){var n=r.coordinateSystem,a=n&&n.getArea&&n.getArea();return r.get("clip",!0)?a:null},t.prototype._updateSymbolDraw=function(r,n){var a=this._symbolDraw,i=n.pipelineContext,o=i.large;return(!a||o!==this._isLargeDraw)&&(a&&a.remove(),a=this._symbolDraw=o?new O4:new rm,this._isLargeDraw=o,this.group.removeAll()),this.group.add(a.group),a},t.prototype.remove=function(r,n){this._symbolDraw&&this._symbolDraw.remove(!0),this._symbolDraw=null},t.prototype.dispose=function(){},t.type="scatter",t}(He);const F4=B4;function z4(e){oe(OS),e.registerSeriesModel(P4),e.registerChartView(F4),e.registerLayout(tm("scatter"))}function G4(e){e.eachSeriesByType("radar",function(t){var r=t.getData(),n=[],a=t.coordinateSystem;if(a){var i=a.getIndicatorAxes();R(i,function(o,s){r.each(r.mapDimension(i[s].dim),function(l,u){n[u]=n[u]||[];var c=a.dataToPoint(l,s);n[u][s]=Cv(c)?c:Lv(a)})}),r.each(function(o){var s=BS(n[o],function(l){return Cv(l)})||Lv(a);n[o].push(s.slice()),r.setItemLayout(o,n[o])})}})}function Cv(e){return!isNaN(e[0])&&!isNaN(e[1])}function Lv(e){return[e.cx,e.cy]}function V4(e){var t=e.polar;if(t){te(t)||(t=[t]);var r=[];R(t,function(n,a){n.indicator?(n.type&&!n.shape&&(n.shape=n.type),e.radar=e.radar||[],te(e.radar)||(e.radar=[e.radar]),e.radar.push(n)):r.push(n)}),e.polar=r}R(e.series,function(n){n&&n.type==="radar"&&n.polarIndex&&(n.radarIndex=n.polarIndex)})}var U4=function(e){U(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.render=function(r,n,a){var i=r.coordinateSystem,o=this.group,s=r.getData(),l=this._data;function u(f,d){var v=f.getItemVisual(d,"symbol")||"circle";if(v!=="none"){var p=Al(f.getItemVisual(d,"symbolSize")),g=Pr(v,-1,-1,2,2),m=f.getItemVisual(d,"symbolRotate")||0;return g.attr({style:{strokeNoScale:!0},z2:100,scaleX:p[0]/2,scaleY:p[1]/2,rotation:m*Math.PI/180||0}),g}}function c(f,d,v,p,g,m){v.removeAll();for(var _=0;_<d.length-1;_++){var y=u(p,g);y&&(y.__dimIdx=_,f[_]?(y.setPosition(f[_]),wl[m?"initProps":"updateProps"](y,{x:d[_][0],y:d[_][1]},r,g)):y.setPosition(d[_]),v.add(y))}}function h(f){return K(f,function(d){return[i.cx,i.cy]})}s.diff(l).add(function(f){var d=s.getItemLayout(f);if(d){var v=new on,p=new Nn,g={shape:{points:d}};v.shape.points=h(d),p.shape.points=h(d),ar(v,g,r,f),ar(p,g,r,f);var m=new Fe,_=new Fe;m.add(p),m.add(v),m.add(_),c(p.shape.points,d,_,s,f,!0),s.setItemGraphicEl(f,m)}}).update(function(f,d){var v=l.getItemGraphicEl(d),p=v.childAt(0),g=v.childAt(1),m=v.childAt(2),_={shape:{points:s.getItemLayout(f)}};_.shape.points&&(c(p.shape.points,_.shape.points,m,s,f,!1),Ln(g),Ln(p),st(p,_,r),st(g,_,r),s.setItemGraphicEl(f,v))}).remove(function(f){o.remove(l.getItemGraphicEl(f))}).execute(),s.eachItemGraphicEl(function(f,d){var v=s.getItemModel(d),p=f.childAt(0),g=f.childAt(1),m=f.childAt(2),_=s.getItemVisual(d,"style"),y=_.fill;o.add(f),p.useStyle(Te(v.getModel("lineStyle").getLineStyle(),{fill:"none",stroke:y})),ur(p,v,"lineStyle"),ur(g,v,"areaStyle");var x=v.getModel("areaStyle"),S=x.isEmpty()&&x.parentModel.isEmpty();g.ignore=S,R(["emphasis","select","blur"],function(w){var A=v.getModel([w,"areaStyle"]),E=A.isEmpty()&&A.parentModel.isEmpty();g.ensureState(w).ignore=E&&S}),g.useStyle(Te(x.getAreaStyle(),{fill:y,opacity:.7,decal:_.decal}));var T=v.getModel("emphasis"),b=T.getModel("itemStyle").getItemStyle();m.eachChild(function(w){if(w instanceof un){var A=w.style;w.useStyle(le({image:A.image,x:A.x,y:A.y,width:A.width,height:A.height},_))}else w.useStyle(_),w.setColor(y),w.style.strokeNoScale=!0;var E=w.ensureState("emphasis");E.style=vt(b);var C=s.getStore().get(s.getDimensionIndex(w.__dimIdx),d);(C==null||isNaN(C))&&(C=""),Wr(w,wr(v),{labelFetcher:s.hostModel,labelDataIndex:d,labelDimIndex:w.__dimIdx,defaultText:C,inheritColor:y,defaultOpacity:_.opacity})}),zt(f,T.get("focus"),T.get("blurScope"),T.get("disabled"))}),this._data=s},t.prototype.remove=function(){this.group.removeAll(),this._data=null},t.type="radar",t}(He);const k4=U4;var H4=function(e){U(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r.hasSymbolVisual=!0,r}return t.prototype.init=function(r){e.prototype.init.apply(this,arguments),this.legendVisualProvider=new El(me(this.getData,this),me(this.getRawData,this))},t.prototype.getInitialData=function(r,n){return Cl(this,{generateCoord:"indicator_",generateCoordCount:1/0})},t.prototype.formatTooltip=function(r,n,a){var i=this.getData(),o=this.coordinateSystem,s=o.getIndicatorAxes(),l=this.getData().getName(r),u=l===""?this.name:l,c=FS(this,r);return $r("section",{header:u,sortBlocks:!0,blocks:K(s,function(h){var f=i.get(i.mapDimension(h.dim),r);return $r("nameValue",{markerType:"subItem",markerColor:c,name:h.name,value:f,sortParam:f})})})},t.prototype.getTooltipPosition=function(r){if(r!=null){for(var n=this.getData(),a=this.coordinateSystem,i=n.getValues(K(a.dimensions,function(u){return n.mapDimension(u)}),r),o=0,s=i.length;o<s;o++)if(!isNaN(i[o])){var l=a.getIndicatorAxes();return a.coordToPoint(l[o].dataToCoord(i[o]),o)}}},t.type="series.radar",t.dependencies=["radar"],t.defaultOption={z:2,colorBy:"data",coordinateSystem:"radar",legendHoverLink:!0,radarIndex:0,lineStyle:{width:2,type:"solid",join:"round"},label:{position:"top"},symbolSize:8},t}($e);const W4=H4;var Ei=zS.value;function Qo(e,t){return Te({show:t},e)}var $4=function(e){U(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.optionUpdated=function(){var r=this.get("boundaryGap"),n=this.get("splitNumber"),a=this.get("scale"),i=this.get("axisLine"),o=this.get("axisTick"),s=this.get("axisLabel"),l=this.get("axisName"),u=this.get(["axisName","show"]),c=this.get(["axisName","formatter"]),h=this.get("axisNameGap"),f=this.get("triggerEvent"),d=K(this.get("indicator")||[],function(v){v.max!=null&&v.max>0&&!v.min?v.min=0:v.min!=null&&v.min<0&&!v.max&&(v.max=0);var p=l;v.color!=null&&(p=Te({color:v.color},l));var g=fe(vt(v),{boundaryGap:r,splitNumber:n,scale:a,axisLine:i,axisTick:o,axisLabel:s,name:v.text,showName:u,nameLocation:"end",nameGap:h,nameTextStyle:p,triggerEvent:f},!1);if(Ve(c)){var m=g.name;g.name=c.replace("{value}",m??"")}else xt(c)&&(g.name=c(g.name,g));var _=new Ft(g,null,this.ecModel);return Xr(_,Mo.prototype),_.mainType="radar",_.componentIndex=this.componentIndex,_},this);this._indicatorModels=d},t.prototype.getIndicatorModels=function(){return this._indicatorModels},t.type="radar",t.defaultOption={z:0,center:["50%","50%"],radius:"75%",startAngle:90,axisName:{show:!0},boundaryGap:[0,0],splitNumber:5,axisNameGap:15,scale:!1,shape:"polygon",axisLine:fe({lineStyle:{color:"#bbb"}},Ei.axisLine),axisLabel:Qo(Ei.axisLabel,!1),axisTick:Qo(Ei.axisTick,!1),splitLine:Qo(Ei.splitLine,!0),splitArea:Qo(Ei.splitArea,!0),indicator:[]},t}(Ot);const X4=$4;var j4=["axisLine","axisTickLabel","axisName"],Z4=function(e){U(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.render=function(r,n,a){var i=this.group;i.removeAll(),this._buildAxes(r),this._buildSplitLineAndArea(r)},t.prototype._buildAxes=function(r){var n=r.coordinateSystem,a=n.getIndicatorAxes(),i=K(a,function(o){var s=o.model.get("showName")?o.name:"",l=new fa(o.model,{axisName:s,position:[n.cx,n.cy],rotation:o.angle,labelDirection:-1,tickDirection:-1,nameDirection:1});return l});R(i,function(o){R(j4,o.add,o),this.group.add(o.getGroup())},this)},t.prototype._buildSplitLineAndArea=function(r){var n=r.coordinateSystem,a=n.getIndicatorAxes();if(!a.length)return;var i=r.get("shape"),o=r.getModel("splitLine"),s=r.getModel("splitArea"),l=o.getModel("lineStyle"),u=s.getModel("areaStyle"),c=o.get("show"),h=s.get("show"),f=l.get("color"),d=u.get("color"),v=te(f)?f:[f],p=te(d)?d:[d],g=[],m=[];function _(I,N,F){var B=F%N.length;return I[B]=I[B]||[],B}if(i==="circle")for(var y=a[0].getTicksCoords(),x=n.cx,S=n.cy,T=0;T<y.length;T++){if(c){var b=_(g,v,T);g[b].push(new oo({shape:{cx:x,cy:S,r:y[T].coord}}))}if(h&&T<y.length-1){var b=_(m,p,T);m[b].push(new nm({shape:{cx:x,cy:S,r0:y[T].coord,r:y[T+1].coord}}))}}else for(var w,A=K(a,function(I,N){var F=I.getTicksCoords();return w=w==null?F.length-1:Math.min(F.length-1,w),K(F,function(B){return n.coordToPoint(B.coord,N)})}),E=[],T=0;T<=w;T++){for(var C=[],M=0;M<a.length;M++)C.push(A[M][T]);if(C[0]&&C.push(C[0].slice()),c){var b=_(g,v,T);g[b].push(new Nn({shape:{points:C}}))}if(h&&E){var b=_(m,p,T-1);m[b].push(new on({shape:{points:C.concat(E)}}))}E=C.slice().reverse()}var P=l.getLineStyle(),L=u.getAreaStyle();R(m,function(I,N){this.group.add(Cr(I,{style:Te({stroke:"none",fill:p[N%p.length]},L),silent:!0}))},this),R(g,function(I,N){this.group.add(Cr(I,{style:Te({fill:"none",stroke:v[N%v.length]},P),silent:!0}))},this)},t.type="radar",t}(kt);const Y4=Z4;var q4=function(e){U(t,e);function t(r,n,a){var i=e.call(this,r,n,a)||this;return i.type="value",i.angle=0,i.name="",i}return t}(or);const K4=q4;var J4=function(){function e(t,r,n){this.dimensions=[],this._model=t,this._indicatorAxes=K(t.getIndicatorModels(),function(a,i){var o="indicator_"+i,s=new K4(o,new Zc);return s.name=a.get("name"),s.model=a,a.axis=s,this.dimensions.push(o),s},this),this.resize(t,n)}return e.prototype.getIndicatorAxes=function(){return this._indicatorAxes},e.prototype.dataToPoint=function(t,r){var n=this._indicatorAxes[r];return this.coordToPoint(n.dataToCoord(t),r)},e.prototype.coordToPoint=function(t,r){var n=this._indicatorAxes[r],a=n.angle,i=this.cx+t*Math.cos(a),o=this.cy-t*Math.sin(a);return[i,o]},e.prototype.pointToData=function(t){var r=t[0]-this.cx,n=t[1]-this.cy,a=Math.sqrt(r*r+n*n);r/=a,n/=a;for(var i=Math.atan2(-n,r),o=1/0,s,l=-1,u=0;u<this._indicatorAxes.length;u++){var c=this._indicatorAxes[u],h=Math.abs(i-c.angle);h<o&&(s=c,l=u,o=h)}return[l,+(s&&s.coordToData(a))]},e.prototype.resize=function(t,r){var n=t.get("center"),a=r.getWidth(),i=r.getHeight(),o=Math.min(a,i)/2;this.cx=ee(n[0],a),this.cy=ee(n[1],i),this.startAngle=t.get("startAngle")*Math.PI/180;var s=t.get("radius");(Ve(s)||Mr(s))&&(s=[0,s]),this.r0=ee(s[0],o),this.r=ee(s[1],o),R(this._indicatorAxes,function(l,u){l.setExtent(this.r0,this.r);var c=this.startAngle+u*Math.PI*2/this._indicatorAxes.length;c=Math.atan2(Math.sin(c),Math.cos(c)),l.angle=c},this)},e.prototype.update=function(t,r){var n=this._indicatorAxes,a=this._model;R(n,function(s){s.scale.setExtent(1/0,-1/0)}),t.eachSeriesByType("radar",function(s,l){if(!(s.get("coordinateSystem")!=="radar"||t.getComponent("radar",s.get("radarIndex"))!==a)){var u=s.getData();R(n,function(c){c.scale.unionExtentFromData(u,u.mapDimension(c.dim))})}},this);var i=a.get("splitNumber"),o=new Zc;o.setExtent(0,i),o.setInterval(1),R(n,function(s,l){GS(s.scale,s.model,o)})},e.prototype.convertToPixel=function(t,r,n){return console.warn("Not implemented."),null},e.prototype.convertFromPixel=function(t,r,n){return console.warn("Not implemented."),null},e.prototype.containPoint=function(t){return console.warn("Not implemented."),!1},e.create=function(t,r){var n=[];return t.eachComponent("radar",function(a){var i=new e(a,t,r);n.push(i),a.coordinateSystem=i}),t.eachSeriesByType("radar",function(a){a.get("coordinateSystem")==="radar"&&(a.coordinateSystem=n[a.get("radarIndex")||0])}),n},e.dimensions=[],e}();const Q4=J4;function eb(e){e.registerCoordinateSystem("radar",Q4),e.registerComponentModel(X4),e.registerComponentView(Y4),e.registerVisual({seriesType:"radar",reset:function(t){var r=t.getData();r.each(function(n){r.setItemVisual(n,"legendIcon","roundRect")}),r.setVisual("legendIcon","roundRect")}})}function tb(e){oe(eb),e.registerChartView(k4),e.registerSeriesModel(W4),e.registerLayout(G4),e.registerProcessor(Ll("radar")),e.registerPreprocessor(V4)}function rb(e){var t=e;t.hierNode={defaultAncestor:null,ancestor:t,prelim:0,modifier:0,change:0,shift:0,i:0,thread:null};for(var r=[t],n,a;n=r.pop();)if(a=n.children,n.isExpand&&a.length)for(var i=a.length,o=i-1;o>=0;o--){var s=a[o];s.hierNode={defaultAncestor:null,ancestor:s,prelim:0,modifier:0,change:0,shift:0,i:o,thread:null},r.push(s)}}function nb(e,t){var r=e.isExpand?e.children:[],n=e.parentNode.children,a=e.hierNode.i?n[e.hierNode.i-1]:null;if(r.length){ob(e);var i=(r[0].hierNode.prelim+r[r.length-1].hierNode.prelim)/2;a?(e.hierNode.prelim=a.hierNode.prelim+t(e,a),e.hierNode.modifier=e.hierNode.prelim-i):e.hierNode.prelim=i}else a&&(e.hierNode.prelim=a.hierNode.prelim+t(e,a));e.parentNode.hierNode.defaultAncestor=sb(e,a,e.parentNode.hierNode.defaultAncestor||n[0],t)}function ab(e){var t=e.hierNode.prelim+e.parentNode.hierNode.modifier;e.setLayout({x:t},!0),e.hierNode.modifier+=e.parentNode.hierNode.modifier}function Dv(e){return arguments.length?e:cb}function $i(e,t){return e-=Math.PI/2,{x:t*Math.cos(e),y:t*Math.sin(e)}}function ib(e,t){return sr(e.getBoxLayoutParams(),{width:t.getWidth(),height:t.getHeight()})}function ob(e){for(var t=e.children,r=t.length,n=0,a=0;--r>=0;){var i=t[r];i.hierNode.prelim+=n,i.hierNode.modifier+=n,a+=i.hierNode.change,n+=i.hierNode.shift+a}}function sb(e,t,r,n){if(t){for(var a=e,i=e,o=i.parentNode.children[0],s=t,l=a.hierNode.modifier,u=i.hierNode.modifier,c=o.hierNode.modifier,h=s.hierNode.modifier;s=wu(s),i=Au(i),s&&i;){a=wu(a),o=Au(o),a.hierNode.ancestor=e;var f=s.hierNode.prelim+h-i.hierNode.prelim-u+n(s,i);f>0&&(ub(lb(s,e,r),e,f),u+=f,l+=f),h+=s.hierNode.modifier,u+=i.hierNode.modifier,l+=a.hierNode.modifier,c+=o.hierNode.modifier}s&&!wu(a)&&(a.hierNode.thread=s,a.hierNode.modifier+=h-l),i&&!Au(o)&&(o.hierNode.thread=i,o.hierNode.modifier+=u-c,r=e)}return r}function wu(e){var t=e.children;return t.length&&e.isExpand?t[t.length-1]:e.hierNode.thread}function Au(e){var t=e.children;return t.length&&e.isExpand?t[0]:e.hierNode.thread}function lb(e,t,r){return e.hierNode.ancestor.parentNode===t.parentNode?e.hierNode.ancestor:r}function ub(e,t,r){var n=r/(t.hierNode.i-e.hierNode.i);t.hierNode.change-=n,t.hierNode.shift+=r,t.hierNode.modifier+=r,t.hierNode.prelim+=r,e.hierNode.change+=n}function cb(e,t){return e.parentNode===t.parentNode?1:2}var hb=function(){function e(){this.parentPoint=[],this.childPoints=[]}return e}(),fb=function(e){U(t,e);function t(r){return e.call(this,r)||this}return t.prototype.getDefaultStyle=function(){return{stroke:"#000",fill:null}},t.prototype.getDefaultShape=function(){return new hb},t.prototype.buildPath=function(r,n){var a=n.childPoints,i=a.length,o=n.parentPoint,s=a[0],l=a[i-1];if(i===1){r.moveTo(o[0],o[1]),r.lineTo(s[0],s[1]);return}var u=n.orient,c=u==="TB"||u==="BT"?0:1,h=1-c,f=ee(n.forkPosition,1),d=[];d[c]=o[c],d[h]=o[h]+(l[h]-o[h])*f,r.moveTo(o[0],o[1]),r.lineTo(d[0],d[1]),r.moveTo(s[0],s[1]),d[c]=s[c],r.lineTo(d[0],d[1]),d[c]=l[c],r.lineTo(d[0],d[1]),r.lineTo(l[0],l[1]);for(var v=1;v<i-1;v++){var p=a[v];r.moveTo(p[0],p[1]),d[c]=p[c],r.lineTo(d[0],d[1])}},t}(Gt),db=function(e){U(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r._mainGroup=new Fe,r}return t.prototype.init=function(r,n){this._controller=new Dl(n.getZr()),this._controllerHost={target:this.group},this.group.add(this._mainGroup)},t.prototype.render=function(r,n,a){var i=r.getData(),o=r.layoutInfo,s=this._mainGroup,l=r.get("layout");l==="radial"?(s.x=o.x+o.width/2,s.y=o.y+o.height/2):(s.x=o.x,s.y=o.y),this._updateViewCoordSys(r,a),this._updateController(r,n,a);var u=this._data;i.diff(u).add(function(c){Mv(i,c)&&Pv(i,c,null,s,r)}).update(function(c,h){var f=u.getItemGraphicEl(h);if(!Mv(i,c)){f&&Rv(u,h,f,s,r);return}Pv(i,c,f,s,r)}).remove(function(c){var h=u.getItemGraphicEl(c);h&&Rv(u,c,h,s,r)}).execute(),this._nodeScaleRatio=r.get("nodeScaleRatio"),this._updateNodeAndLinkScale(r),r.get("expandAndCollapse")===!0&&i.eachItemGraphicEl(function(c,h){c.off("click").on("click",function(){a.dispatchAction({type:"treeExpandAndCollapse",seriesId:r.id,dataIndex:h})})}),this._data=i},t.prototype._updateViewCoordSys=function(r,n){var a=r.getData(),i=[];a.each(function(h){var f=a.getItemLayout(h);f&&!isNaN(f.x)&&!isNaN(f.y)&&i.push([+f.x,+f.y])});var o=[],s=[];Ml(i,o,s);var l=this._min,u=this._max;s[0]-o[0]===0&&(o[0]=l?l[0]:o[0]-1,s[0]=u?u[0]:s[0]+1),s[1]-o[1]===0&&(o[1]=l?l[1]:o[1]-1,s[1]=u?u[1]:s[1]+1);var c=r.coordinateSystem=new rf;c.zoomLimit=r.get("scaleLimit"),c.setBoundingRect(o[0],o[1],s[0]-o[0],s[1]-o[1]),c.setCenter(r.get("center"),n),c.setZoom(r.get("zoom")),this.group.attr({x:c.x,y:c.y,scaleX:c.scaleX,scaleY:c.scaleY}),this._min=o,this._max=s},t.prototype._updateController=function(r,n,a){var i=this,o=this._controller,s=this._controllerHost,l=this.group;o.setPointerChecker(function(u,c,h){var f=l.getBoundingRect();return f.applyTransform(l.transform),f.contain(c,h)&&!nf(u,a,r)}),o.enable(r.get("roam")),s.zoomLimit=r.get("scaleLimit"),s.zoom=r.coordinateSystem.getZoom(),o.off("pan").off("zoom").on("pan",function(u){am(s,u.dx,u.dy),a.dispatchAction({seriesId:r.id,type:"treeRoam",dx:u.dx,dy:u.dy})}).on("zoom",function(u){im(s,u.scale,u.originX,u.originY),a.dispatchAction({seriesId:r.id,type:"treeRoam",zoom:u.scale,originX:u.originX,originY:u.originY}),i._updateNodeAndLinkScale(r),a.updateLabelLayout()})},t.prototype._updateNodeAndLinkScale=function(r){var n=r.getData(),a=this._getNodeGlobalScale(r);n.eachItemGraphicEl(function(i,o){i.setSymbolScale(a)})},t.prototype._getNodeGlobalScale=function(r){var n=r.coordinateSystem;if(n.type!=="view")return 1;var a=this._nodeScaleRatio,i=n.scaleX||1,o=n.getZoom(),s=(o-1)*a+1;return s/i},t.prototype.dispose=function(){this._controller&&this._controller.dispose(),this._controllerHost=null},t.prototype.remove=function(){this._mainGroup.removeAll(),this._data=null},t.type="tree",t}(He);function Mv(e,t){var r=e.getItemLayout(t);return r&&!isNaN(r.x)&&!isNaN(r.y)}function Pv(e,t,r,n,a){var i=!r,o=e.tree.getNodeByDataIndex(t),s=o.getModel(),l=o.getVisual("style").fill,u=o.isExpand===!1&&o.children.length!==0?l:"#fff",c=e.tree.root,h=o.parentNode===c?o:o.parentNode||o,f=e.getItemGraphicEl(h.dataIndex),d=h.getLayout(),v=f?{x:f.__oldX,y:f.__oldY,rawX:f.__radialOldRawX,rawY:f.__radialOldRawY}:d,p=o.getLayout();i?(r=new VS(e,t,null,{symbolInnerColor:u,useNameLabel:!0}),r.x=v.x,r.y=v.y):r.updateData(e,t,null,{symbolInnerColor:u,useNameLabel:!0}),r.__radialOldRawX=r.__radialRawX,r.__radialOldRawY=r.__radialRawY,r.__radialRawX=p.rawX,r.__radialRawY=p.rawY,n.add(r),e.setItemGraphicEl(t,r),r.__oldX=r.x,r.__oldY=r.y,st(r,{x:p.x,y:p.y},a);var g=r.getSymbolPath();if(a.get("layout")==="radial"){var m=c.children[0],_=m.getLayout(),y=m.children.length,x=void 0,S=void 0;if(p.x===_.x&&o.isExpand===!0&&m.children.length){var T={x:(m.children[0].getLayout().x+m.children[y-1].getLayout().x)/2,y:(m.children[0].getLayout().y+m.children[y-1].getLayout().y)/2};x=Math.atan2(T.y-_.y,T.x-_.x),x<0&&(x=Math.PI*2+x),S=T.x<_.x,S&&(x=x-Math.PI)}else x=Math.atan2(p.y-_.y,p.x-_.x),x<0&&(x=Math.PI*2+x),o.children.length===0||o.children.length!==0&&o.isExpand===!1?(S=p.x<_.x,S&&(x=x-Math.PI)):(S=p.x>_.x,S||(x=x-Math.PI));var b=S?"left":"right",w=s.getModel("label"),A=w.get("rotate"),E=A*(Math.PI/180),C=g.getTextContent();C&&(g.setTextConfig({position:w.get("position")||b,rotation:A==null?-x:E,origin:"center"}),C.setStyle("verticalAlign","middle"))}var M=s.get(["emphasis","focus"]),P=M==="relative"?so(o.getAncestorsIndices(),o.getDescendantIndices()):M==="ancestor"?o.getAncestorsIndices():M==="descendant"?o.getDescendantIndices():null;P&&(et(r).focus=P),vb(a,o,c,r,v,d,p,n),r.__edge&&(r.onHoverStateChange=function(L){if(L!=="blur"){var I=o.parentNode&&e.getItemGraphicEl(o.parentNode.dataIndex);I&&I.hoverState===US||kS(r.__edge,L)}})}function vb(e,t,r,n,a,i,o,s){var l=t.getModel(),u=e.get("edgeShape"),c=e.get("layout"),h=e.getOrient(),f=e.get(["lineStyle","curveness"]),d=e.get("edgeForkPosition"),v=l.getModel("lineStyle").getLineStyle(),p=n.__edge;if(u==="curve")t.parentNode&&t.parentNode!==r&&(p||(p=n.__edge=new om({shape:lh(c,h,f,a,a)})),st(p,{shape:lh(c,h,f,i,o)},e));else if(u==="polyline"&&c==="orthogonal"&&t!==r&&t.children&&t.children.length!==0&&t.isExpand===!0){for(var g=t.children,m=[],_=0;_<g.length;_++){var y=g[_].getLayout();m.push([y.x,y.y])}p||(p=n.__edge=new fb({shape:{parentPoint:[o.x,o.y],childPoints:[[o.x,o.y]],orient:h,forkPosition:d}})),st(p,{shape:{parentPoint:[o.x,o.y],childPoints:m}},e)}p&&!(u==="polyline"&&!t.isExpand)&&(p.useStyle(Te({strokeNoScale:!0,fill:null},v)),ur(p,l,"lineStyle"),Fs(p),s.add(p))}function Iv(e,t,r,n,a){var i=t.tree.root,o=fy(i,e),s=o.source,l=o.sourceLayout,u=t.getItemGraphicEl(e.dataIndex);if(u){var c=t.getItemGraphicEl(s.dataIndex),h=c.__edge,f=u.__edge||(s.isExpand===!1||s.children.length===1?h:void 0),d=n.get("edgeShape"),v=n.get("layout"),p=n.get("orient"),g=n.get(["lineStyle","curveness"]);f&&(d==="curve"?zs(f,{shape:lh(v,p,g,l,l),style:{opacity:0}},n,{cb:function(){r.remove(f)},removeOpt:a}):d==="polyline"&&n.get("layout")==="orthogonal"&&zs(f,{shape:{parentPoint:[l.x,l.y],childPoints:[[l.x,l.y]]},style:{opacity:0}},n,{cb:function(){r.remove(f)},removeOpt:a}))}}function fy(e,t){for(var r=t.parentNode===e?t:t.parentNode||t,n;n=r.getLayout(),n==null;)r=r.parentNode===e?r:r.parentNode||r;return{source:r,sourceLayout:n}}function Rv(e,t,r,n,a){var i=e.tree.getNodeByDataIndex(t),o=e.tree.root,s=fy(o,i).sourceLayout,l={duration:a.get("animationDurationUpdate"),easing:a.get("animationEasingUpdate")};zs(r,{x:s.x+1,y:s.y+1},a,{cb:function(){n.remove(r),e.setItemGraphicEl(t,null)},removeOpt:l}),r.fadeOut(null,e.hostModel,{fadeLabel:!0,animation:l}),i.children.forEach(function(u){Iv(u,e,n,a,l)}),Iv(i,e,n,a,l)}function lh(e,t,r,n,a){var i,o,s,l,u,c,h,f;if(e==="radial"){u=n.rawX,h=n.rawY,c=a.rawX,f=a.rawY;var d=$i(u,h),v=$i(u,h+(f-h)*r),p=$i(c,f+(h-f)*r),g=$i(c,f);return{x1:d.x||0,y1:d.y||0,x2:g.x||0,y2:g.y||0,cpx1:v.x||0,cpy1:v.y||0,cpx2:p.x||0,cpy2:p.y||0}}else u=n.x,h=n.y,c=a.x,f=a.y,(t==="LR"||t==="RL")&&(i=u+(c-u)*r,o=h,s=c+(u-c)*r,l=f),(t==="TB"||t==="BT")&&(i=u,o=h+(f-h)*r,s=c,l=f+(h-f)*r);return{x1:u,y1:h,x2:c,y2:f,cpx1:i,cpy1:o,cpx2:s,cpy2:l}}const pb=db;var xr=Nt();function Tf(e){var t=e.mainData,r=e.datas;r||(r={main:t},e.datasAttr={main:"data"}),e.datas=e.mainData=null,dy(t,r,e),R(r,function(n){R(t.TRANSFERABLE_METHODS,function(a){n.wrapMethod(a,Ge(gb,e))})}),t.wrapMethod("cloneShallow",Ge(yb,e)),R(t.CHANGABLE_METHODS,function(n){t.wrapMethod(n,Ge(mb,e))}),jc(r[t.dataType]===t)}function gb(e,t){if(Sb(this)){var r=le({},xr(this).datas);r[this.dataType]=t,dy(t,r,e)}else bf(t,this.dataType,xr(this).mainData,e);return t}function mb(e,t){return e.struct&&e.struct.update(),t}function yb(e,t){return R(xr(t).datas,function(r,n){r!==t&&bf(r.cloneShallow(),n,t,e)}),t}function _b(e){var t=xr(this).mainData;return e==null||t==null?t:xr(t).datas[e]}function xb(){var e=xr(this).mainData;return e==null?[{data:e}]:K(It(xr(e).datas),function(t){return{type:t,data:xr(e).datas[t]}})}function Sb(e){return xr(e).mainData===e}function dy(e,t,r){xr(e).datas={},R(t,function(n,a){bf(n,a,e,r)})}function bf(e,t,r,n){xr(r).datas[t]=e,xr(e).mainData=r,e.dataType=t,n.struct&&(e[n.structAttr]=n.struct,n.struct[n.datasAttr[t]]=e),e.getLinkedData=_b,e.getLinkedDataAll=xb}var Tb=function(){function e(t,r){this.depth=0,this.height=0,this.dataIndex=-1,this.children=[],this.viewChildren=[],this.isExpand=!1,this.name=t||"",this.hostTree=r}return e.prototype.isRemoved=function(){return this.dataIndex<0},e.prototype.eachNode=function(t,r,n){xt(t)&&(n=r,r=t,t=null),t=t||{},Ve(t)&&(t={order:t});var a=t.order||"preorder",i=this[t.attr||"children"],o;a==="preorder"&&(o=r.call(n,this));for(var s=0;!o&&s<i.length;s++)i[s].eachNode(t,r,n);a==="postorder"&&r.call(n,this)},e.prototype.updateDepthAndHeight=function(t){var r=0;this.depth=t;for(var n=0;n<this.children.length;n++){var a=this.children[n];a.updateDepthAndHeight(t+1),a.height>r&&(r=a.height)}this.height=r+1},e.prototype.getNodeById=function(t){if(this.getId()===t)return this;for(var r=0,n=this.children,a=n.length;r<a;r++){var i=n[r].getNodeById(t);if(i)return i}},e.prototype.contains=function(t){if(t===this)return!0;for(var r=0,n=this.children,a=n.length;r<a;r++){var i=n[r].contains(t);if(i)return i}},e.prototype.getAncestors=function(t){for(var r=[],n=t?this:this.parentNode;n;)r.push(n),n=n.parentNode;return r.reverse(),r},e.prototype.getAncestorsIndices=function(){for(var t=[],r=this;r;)t.push(r.dataIndex),r=r.parentNode;return t.reverse(),t},e.prototype.getDescendantIndices=function(){var t=[];return this.eachNode(function(r){t.push(r.dataIndex)}),t},e.prototype.getValue=function(t){var r=this.hostTree.data;return r.getStore().get(r.getDimensionIndex(t||"value"),this.dataIndex)},e.prototype.setLayout=function(t,r){this.dataIndex>=0&&this.hostTree.data.setItemLayout(this.dataIndex,t,r)},e.prototype.getLayout=function(){return this.hostTree.data.getItemLayout(this.dataIndex)},e.prototype.getModel=function(t){if(!(this.dataIndex<0)){var r=this.hostTree,n=r.data.getItemModel(this.dataIndex);return n.getModel(t)}},e.prototype.getLevelModel=function(){return(this.hostTree.levelModels||[])[this.depth]},e.prototype.setVisual=function(t,r){this.dataIndex>=0&&this.hostTree.data.setItemVisual(this.dataIndex,t,r)},e.prototype.getVisual=function(t){return this.hostTree.data.getItemVisual(this.dataIndex,t)},e.prototype.getRawIndex=function(){return this.hostTree.data.getRawIndex(this.dataIndex)},e.prototype.getId=function(){return this.hostTree.data.getId(this.dataIndex)},e.prototype.getChildIndex=function(){if(this.parentNode){for(var t=this.parentNode.children,r=0;r<t.length;++r)if(t[r]===this)return r;return-1}return-1},e.prototype.isAncestorOf=function(t){for(var r=t.parentNode;r;){if(r===this)return!0;r=r.parentNode}return!1},e.prototype.isDescendantOf=function(t){return t!==this&&t.isAncestorOf(this)},e}(),bb=function(){function e(t){this.type="tree",this._nodes=[],this.hostModel=t}return e.prototype.eachNode=function(t,r,n){this.root.eachNode(t,r,n)},e.prototype.getNodeByDataIndex=function(t){var r=this.data.getRawIndex(t);return this._nodes[r]},e.prototype.getNodeById=function(t){return this.root.getNodeById(t)},e.prototype.update=function(){for(var t=this.data,r=this._nodes,n=0,a=r.length;n<a;n++)r[n].dataIndex=-1;for(var n=0,a=t.count();n<a;n++)r[t.getRawIndex(n)].dataIndex=n},e.prototype.clearLayouts=function(){this.data.clearItemLayouts()},e.createTree=function(t,r,n){var a=new e(r),i=[],o=1;s(t);function s(c,h){var f=c.value;o=Math.max(o,te(f)?f.length:1),i.push(c);var d=new Tb(Qr(c.name,""),a);h?wb(d,h):a.root=d,a._nodes.push(d);var v=c.children;if(v)for(var p=0;p<v.length;p++)s(v[p],d)}a.root.updateDepthAndHeight(0);var l=af(i,{coordDimensions:["value"],dimensionsCount:o}).dimensions,u=new it(l,r);return u.initData(i),n&&n(u),Tf({mainData:u,struct:a,structAttr:"tree"}),a.update(),a},e}();function wb(e,t){var r=t.children;e.parentNode!==t&&(r.push(e),e.parentNode=t)}const wf=bb;function fo(e,t,r){if(e&&pt(t,e.type)>=0){var n=r.getData().tree.root,a=e.targetNode;if(Ve(a)&&(a=n.getNodeById(a)),a&&n.contains(a))return{node:a};var i=e.targetNodeId;if(i!=null&&(a=n.getNodeById(i)))return{node:a}}}function vy(e){for(var t=[];e;)e=e.parentNode,e&&t.push(e);return t.reverse()}function Af(e,t){var r=vy(e);return pt(r,t)>=0}function Ul(e,t){for(var r=[];e;){var n=e.dataIndex;r.push({name:e.name,dataIndex:n,value:t.getRawValue(n)}),e=e.parentNode}return r.reverse(),r}var Ab=function(e){U(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.hasSymbolVisual=!0,r.ignoreStyleOnData=!0,r}return t.prototype.getInitialData=function(r){var n={name:r.name,children:r.data},a=r.leaves||{},i=new Ft(a,this,this.ecModel),o=wf.createTree(n,this,s);function s(h){h.wrapMethod("getItemModel",function(f,d){var v=o.getNodeByDataIndex(d);return v&&v.children.length&&v.isExpand||(f.parentModel=i),f})}var l=0;o.eachNode("preorder",function(h){h.depth>l&&(l=h.depth)});var u=r.expandAndCollapse,c=u&&r.initialTreeDepth>=0?r.initialTreeDepth:l;return o.root.eachNode("preorder",function(h){var f=h.hostTree.data.getRawDataItem(h.dataIndex);h.isExpand=f&&f.collapsed!=null?!f.collapsed:h.depth<=c}),o.data},t.prototype.getOrient=function(){var r=this.get("orient");return r==="horizontal"?r="LR":r==="vertical"&&(r="TB"),r},t.prototype.setZoom=function(r){this.option.zoom=r},t.prototype.setCenter=function(r){this.option.center=r},t.prototype.formatTooltip=function(r,n,a){for(var i=this.getData().tree,o=i.root.children[0],s=i.getNodeByDataIndex(r),l=s.getValue(),u=s.name;s&&s!==o;)u=s.parentNode.name+"."+u,s=s.parentNode;return $r("nameValue",{name:u,value:l,noValue:isNaN(l)||l==null})},t.prototype.getDataParams=function(r){var n=e.prototype.getDataParams.apply(this,arguments),a=this.getData().tree.getNodeByDataIndex(r);return n.treeAncestors=Ul(a,this),n.collapsed=!a.isExpand,n},t.type="series.tree",t.layoutMode="box",t.defaultOption={z:2,coordinateSystem:"view",left:"12%",top:"12%",right:"12%",bottom:"12%",layout:"orthogonal",edgeShape:"curve",edgeForkPosition:"50%",roam:!1,nodeScaleRatio:.4,center:null,zoom:1,orient:"LR",symbol:"emptyCircle",symbolSize:7,expandAndCollapse:!0,initialTreeDepth:2,lineStyle:{color:"#ccc",width:1.5,curveness:.5},itemStyle:{color:"lightsteelblue",borderWidth:1.5},label:{show:!0},animationEasing:"linear",animationDuration:700,animationDurationUpdate:500},t}($e);const Eb=Ab;function Cb(e,t,r){for(var n=[e],a=[],i;i=n.pop();)if(a.push(i),i.isExpand){var o=i.children;if(o.length)for(var s=0;s<o.length;s++)n.push(o[s])}for(;i=a.pop();)t(i,r)}function Ci(e,t){for(var r=[e],n;n=r.pop();)if(t(n),n.isExpand){var a=n.children;if(a.length)for(var i=a.length-1;i>=0;i--)r.push(a[i])}}function Lb(e,t){e.eachSeriesByType("tree",function(r){Db(r,t)})}function Db(e,t){var r=ib(e,t);e.layoutInfo=r;var n=e.get("layout"),a=0,i=0,o=null;n==="radial"?(a=2*Math.PI,i=Math.min(r.height,r.width)/2,o=Dv(function(y,x){return(y.parentNode===x.parentNode?1:2)/y.depth})):(a=r.width,i=r.height,o=Dv());var s=e.getData().tree.root,l=s.children[0];if(l){rb(s),Cb(l,nb,o),s.hierNode.modifier=-l.hierNode.prelim,Ci(l,ab);var u=l,c=l,h=l;Ci(l,function(y){var x=y.getLayout().x;x<u.getLayout().x&&(u=y),x>c.getLayout().x&&(c=y),y.depth>h.depth&&(h=y)});var f=u===c?1:o(u,c)/2,d=f-u.getLayout().x,v=0,p=0,g=0,m=0;if(n==="radial")v=a/(c.getLayout().x+f+d),p=i/(h.depth-1||1),Ci(l,function(y){g=(y.getLayout().x+d)*v,m=(y.depth-1)*p;var x=$i(g,m);y.setLayout({x:x.x,y:x.y,rawX:g,rawY:m},!0)});else{var _=e.getOrient();_==="RL"||_==="LR"?(p=i/(c.getLayout().x+f+d),v=a/(h.depth-1||1),Ci(l,function(y){m=(y.getLayout().x+d)*p,g=_==="LR"?(y.depth-1)*v:a-(y.depth-1)*v,y.setLayout({x:g,y:m},!0)})):(_==="TB"||_==="BT")&&(v=a/(c.getLayout().x+f+d),p=i/(h.depth-1||1),Ci(l,function(y){g=(y.getLayout().x+d)*v,m=_==="TB"?(y.depth-1)*p:i-(y.depth-1)*p,y.setLayout({x:g,y:m},!0)}))}}}function Mb(e){e.eachSeriesByType("tree",function(t){var r=t.getData(),n=r.tree;n.eachNode(function(a){var i=a.getModel(),o=i.getModel("itemStyle").getItemStyle(),s=r.ensureUniqueItemVisual(a.dataIndex,"style");le(s,o)})})}function Pb(e){e.registerAction({type:"treeExpandAndCollapse",event:"treeExpandAndCollapse",update:"update"},function(t,r){r.eachComponent({mainType:"series",subType:"tree",query:t},function(n){var a=t.dataIndex,i=n.getData().tree,o=i.getNodeByDataIndex(a);o.isExpand=!o.isExpand})}),e.registerAction({type:"treeRoam",event:"treeRoam",update:"none"},function(t,r,n){r.eachComponent({mainType:"series",subType:"tree",query:t},function(a){var i=a.coordinateSystem,o=sm(i,t,void 0,n);a.setCenter&&a.setCenter(o.center),a.setZoom&&a.setZoom(o.zoom)})})}function Ib(e){e.registerChartView(pb),e.registerSeriesModel(Eb),e.registerLayout(Lb),e.registerVisual(Mb),Pb(e)}var Nv=["treemapZoomToNode","treemapRender","treemapMove"];function Rb(e){for(var t=0;t<Nv.length;t++)e.registerAction({type:Nv[t],update:"updateView"},Ya);e.registerAction({type:"treemapRootToNode",update:"updateView"},function(r,n){n.eachComponent({mainType:"series",subType:"treemap",query:r},a);function a(i,o){var s=["treemapZoomToNode","treemapRootToNode"],l=fo(r,s,i);if(l){var u=i.getViewRoot();u&&(r.direction=Af(u,l.node)?"rollUp":"drillDown"),i.resetViewRoot(l.node)}}})}function py(e){var t=e.getData(),r=t.tree,n={};r.eachNode(function(a){for(var i=a;i&&i.depth>1;)i=i.parentNode;var o=Yc(e.ecModel,i.name||i.dataIndex+"",n);a.setVisual("decal",o)})}var Nb=function(e){U(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r.preventUsingHoverLayer=!0,r}return t.prototype.getInitialData=function(r,n){var a={name:r.name,children:r.data};gy(a);var i=r.levels||[],o=this.designatedVisualItemStyle={},s=new Ft({itemStyle:o},this,n);i=r.levels=Ob(i,n);var l=K(i||[],function(h){return new Ft(h,s,n)},this),u=wf.createTree(a,this,c);function c(h){h.wrapMethod("getItemModel",function(f,d){var v=u.getNodeByDataIndex(d),p=v?l[v.depth]:null;return f.parentModel=p||s,f})}return u.data},t.prototype.optionUpdated=function(){this.resetViewRoot()},t.prototype.formatTooltip=function(r,n,a){var i=this.getData(),o=this.getRawValue(r),s=i.getName(r);return $r("nameValue",{name:s,value:o})},t.prototype.getDataParams=function(r){var n=e.prototype.getDataParams.apply(this,arguments),a=this.getData().tree.getNodeByDataIndex(r);return n.treeAncestors=Ul(a,this),n.treePathInfo=n.treeAncestors,n},t.prototype.setLayoutInfo=function(r){this.layoutInfo=this.layoutInfo||{},le(this.layoutInfo,r)},t.prototype.mapIdToIndex=function(r){var n=this._idIndexMap;n||(n=this._idIndexMap=ot(),this._idIndexMapCount=0);var a=n.get(r);return a==null&&n.set(r,a=this._idIndexMapCount++),a},t.prototype.getViewRoot=function(){return this._viewRoot},t.prototype.resetViewRoot=function(r){r?this._viewRoot=r:r=this._viewRoot;var n=this.getRawData().tree.root;(!r||r!==n&&!n.contains(r))&&(this._viewRoot=n)},t.prototype.enableAriaDecal=function(){py(this)},t.type="series.treemap",t.layoutMode="box",t.defaultOption={progressive:0,left:"center",top:"middle",width:"80%",height:"80%",sort:!0,clipWindow:"origin",squareRatio:.5*(1+Math.sqrt(5)),leafDepth:null,drillDownIcon:"▶",zoomToNodeRatio:.32*.32,roam:!0,nodeClick:"zoomToNode",animation:!0,animationDurationUpdate:900,animationEasing:"quinticInOut",breadcrumb:{show:!0,height:22,left:"center",top:"bottom",emptyItemWidth:25,itemStyle:{color:"rgba(0,0,0,0.7)",textStyle:{color:"#fff"}},emphasis:{itemStyle:{color:"rgba(0,0,0,0.9)"}}},label:{show:!0,distance:0,padding:5,position:"inside",color:"#fff",overflow:"truncate"},upperLabel:{show:!1,position:[0,"50%"],height:20,overflow:"truncate",verticalAlign:"middle"},itemStyle:{color:null,colorAlpha:null,colorSaturation:null,borderWidth:0,gapWidth:0,borderColor:"#fff",borderColorSaturation:null},emphasis:{upperLabel:{show:!0,position:[0,"50%"],overflow:"truncate",verticalAlign:"middle"}},visualDimension:0,visualMin:null,visualMax:null,color:[],colorAlpha:null,colorSaturation:null,colorMappingBy:"index",visibleMin:10,childrenVisibleMin:null,levels:[]},t}($e);function gy(e){var t=0;R(e.children,function(n){gy(n);var a=n.value;te(a)&&(a=a[0]),t+=a});var r=e.value;te(r)&&(r=r[0]),(r==null||isNaN(r))&&(r=t),r<0&&(r=0),te(e.value)?e.value[0]=r:e.value=r}function Ob(e,t){var r=rr(t.get("color")),n=rr(t.get(["aria","decal","decals"]));if(r){e=e||[];var a,i;R(e,function(s){var l=new Ft(s),u=l.get("color"),c=l.get("decal");(l.get(["itemStyle","color"])||u&&u!=="none")&&(a=!0),(l.get(["itemStyle","decal"])||c&&c!=="none")&&(i=!0)});var o=e[0]||(e[0]={});return a||(o.color=r.slice()),!i&&n&&(o.decal=n.slice()),e}}const Bb=Nb;var Fb=8,Ov=8,Eu=5,zb=function(){function e(t){this.group=new Fe,t.add(this.group)}return e.prototype.render=function(t,r,n,a){var i=t.getModel("breadcrumb"),o=this.group;if(o.removeAll(),!(!i.get("show")||!n)){var s=i.getModel("itemStyle"),l=i.getModel("emphasis"),u=s.getModel("textStyle"),c=l.getModel(["itemStyle","textStyle"]),h={pos:{left:i.get("left"),right:i.get("right"),top:i.get("top"),bottom:i.get("bottom")},box:{width:r.getWidth(),height:r.getHeight()},emptyItemWidth:i.get("emptyItemWidth"),totalWidth:0,renderList:[]};this._prepare(n,h,u),this._renderContent(t,h,s,l,u,c,a),lm(o,h.pos,h.box)}},e.prototype._prepare=function(t,r,n){for(var a=t;a;a=a.parentNode){var i=Qr(a.getModel().get("name"),""),o=n.getTextRect(i),s=Math.max(o.width+Fb*2,r.emptyItemWidth);r.totalWidth+=s+Ov,r.renderList.push({node:a,text:i,width:s})}},e.prototype._renderContent=function(t,r,n,a,i,o,s){for(var l=0,u=r.emptyItemWidth,c=t.get(["breadcrumb","height"]),h=HS(r.pos,r.box),f=r.totalWidth,d=r.renderList,v=a.getModel("itemStyle").getItemStyle(),p=d.length-1;p>=0;p--){var g=d[p],m=g.node,_=g.width,y=g.text;f>h.width&&(f-=_-u,_=u,y=null);var x=new on({shape:{points:Gb(l,0,_,c,p===d.length-1,p===0)},style:Te(n.getItemStyle(),{lineJoin:"bevel"}),textContent:new rt({style:ft(i,{text:y})}),textConfig:{position:"inside"},z2:Pl*1e4,onclick:Ge(s,m)});x.disableLabelAnimation=!0,x.getTextContent().ensureState("emphasis").style=ft(o,{text:y}),x.ensureState("emphasis").style=v,zt(x,a.get("focus"),a.get("blurScope"),a.get("disabled")),this.group.add(x),Vb(x,t,m),l+=_+Ov}},e.prototype.remove=function(){this.group.removeAll()},e}();function Gb(e,t,r,n,a,i){var o=[[a?e:e-Eu,t],[e+r,t],[e+r,t+n],[a?e:e-Eu,t+n]];return!i&&o.splice(2,0,[e+r+Eu,t+n/2]),!a&&o.push([e,t+n/2]),o}function Vb(e,t,r){et(e).eventData={componentType:"series",componentSubType:"treemap",componentIndex:t.componentIndex,seriesIndex:t.seriesIndex,seriesName:t.name,seriesType:"treemap",selfType:"breadcrumb",nodeData:{dataIndex:r&&r.dataIndex,name:r&&r.name},treePathInfo:r&&Ul(r,t)}}const Ub=zb;var kb=function(){function e(){this._storage=[],this._elExistsMap={}}return e.prototype.add=function(t,r,n,a,i){return this._elExistsMap[t.id]?!1:(this._elExistsMap[t.id]=!0,this._storage.push({el:t,target:r,duration:n,delay:a,easing:i}),!0)},e.prototype.finished=function(t){return this._finishedCallback=t,this},e.prototype.start=function(){for(var t=this,r=this._storage.length,n=function(){r--,r<=0&&(t._storage.length=0,t._elExistsMap={},t._finishedCallback&&t._finishedCallback())},a=0,i=this._storage.length;a<i;a++){var o=this._storage[a];o.el.animateTo(o.target,{duration:o.duration,delay:o.delay,easing:o.easing,setToFinal:!0,done:n,aborted:n})}return this},e}();function Hb(){return new kb}var uh=Fe,Bv=Et,Fv=3,zv="label",Gv="upperLabel",Wb=Pl*10,$b=Pl*2,Xb=Pl*3,qn=um([["fill","color"],["stroke","strokeColor"],["lineWidth","strokeWidth"],["shadowBlur"],["shadowOffsetX"],["shadowOffsetY"],["shadowColor"]]),Vv=function(e){var t=qn(e);return t.stroke=t.fill=t.lineWidth=null,t},Xs=Nt(),jb=function(e){U(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r._state="ready",r._storage=Li(),r}return t.prototype.render=function(r,n,a,i){var o=n.findComponents({mainType:"series",subType:"treemap",query:i});if(!(pt(o,r)<0)){this.seriesModel=r,this.api=a,this.ecModel=n;var s=["treemapZoomToNode","treemapRootToNode"],l=fo(i,s,r),u=i&&i.type,c=r.layoutInfo,h=!this._oldTree,f=this._storage,d=u==="treemapRootToNode"&&l&&f?{rootNodeGroup:f.nodeGroup[l.node.getRawIndex()],direction:i.direction}:null,v=this._giveContainerGroup(c),p=r.get("animation"),g=this._doRender(v,r,d);p&&!h&&(!u||u==="treemapZoomToNode"||u==="treemapRootToNode")?this._doAnimation(v,g,r,d):g.renderFinally(),this._resetController(a),this._renderBreadcrumb(r,a,l)}},t.prototype._giveContainerGroup=function(r){var n=this._containerGroup;return n||(n=this._containerGroup=new uh,this._initEvents(n),this.group.add(n)),n.x=r.x,n.y=r.y,n},t.prototype._doRender=function(r,n,a){var i=n.getData().tree,o=this._oldTree,s=Li(),l=Li(),u=this._storage,c=[];function h(g,m,_,y){return Zb(n,l,u,a,s,c,g,m,_,y)}d(i.root?[i.root]:[],o&&o.root?[o.root]:[],r,i===o||!o,0);var f=v(u);return this._oldTree=i,this._storage=l,{lastsForAnimation:s,willDeleteEls:f,renderFinally:p};function d(g,m,_,y,x){y?(m=g,R(g,function(b,w){!b.isRemoved()&&T(w,w)})):new Dn(m,g,S,S).add(T).update(T).remove(Ge(T,null)).execute();function S(b){return b.getId()}function T(b,w){var A=b!=null?g[b]:null,E=w!=null?m[w]:null,C=h(A,E,_,x);C&&d(A&&A.viewChildren||[],E&&E.viewChildren||[],C,y,x+1)}}function v(g){var m=Li();return g&&R(g,function(_,y){var x=m[y];R(_,function(S){S&&(x.push(S),Xs(S).willDelete=!0)})}),m}function p(){R(f,function(g){R(g,function(m){m.parent&&m.parent.remove(m)})}),R(c,function(g){g.invisible=!0,g.dirty()})}},t.prototype._doAnimation=function(r,n,a,i){var o=a.get("animationDurationUpdate"),s=a.get("animationEasing"),l=(xt(o)?0:o)||0,u=(xt(s)?null:s)||"cubicOut",c=Hb();R(n.willDeleteEls,function(h,f){R(h,function(d,v){if(!d.invisible){var p=d.parent,g,m=Xs(p);if(i&&i.direction==="drillDown")g=p===i.rootNodeGroup?{shape:{x:0,y:0,width:m.nodeWidth,height:m.nodeHeight},style:{opacity:0}}:{style:{opacity:0}};else{var _=0,y=0;m.willDelete||(_=m.nodeWidth/2,y=m.nodeHeight/2),g=f==="nodeGroup"?{x:_,y,style:{opacity:0}}:{shape:{x:_,y,width:0,height:0},style:{opacity:0}}}g&&c.add(d,g,l,0,u)}})}),R(this._storage,function(h,f){R(h,function(d,v){var p=n.lastsForAnimation[f][v],g={};p&&(d instanceof Fe?p.oldX!=null&&(g.x=d.x,g.y=d.y,d.x=p.oldX,d.y=p.oldY):(p.oldShape&&(g.shape=le({},d.shape),d.setShape(p.oldShape)),p.fadein?(d.setStyle("opacity",0),g.style={opacity:1}):d.style.opacity!==1&&(g.style={opacity:1})),c.add(d,g,l,0,u))})},this),this._state="animating",c.finished(me(function(){this._state="ready",n.renderFinally()},this)).start()},t.prototype._resetController=function(r){var n=this._controller;n||(n=this._controller=new Dl(r.getZr()),n.enable(this.seriesModel.get("roam")),n.on("pan",me(this._onPan,this)),n.on("zoom",me(this._onZoom,this)));var a=new Yt(0,0,r.getWidth(),r.getHeight());n.setPointerChecker(function(i,o,s){return a.contain(o,s)})},t.prototype._clearController=function(){var r=this._controller;r&&(r.dispose(),r=null)},t.prototype._onPan=function(r){if(this._state!=="animating"&&(Math.abs(r.dx)>Fv||Math.abs(r.dy)>Fv)){var n=this.seriesModel.getData().tree.root;if(!n)return;var a=n.getLayout();if(!a)return;this.api.dispatchAction({type:"treemapMove",from:this.uid,seriesId:this.seriesModel.id,rootRect:{x:a.x+r.dx,y:a.y+r.dy,width:a.width,height:a.height}})}},t.prototype._onZoom=function(r){var n=r.originX,a=r.originY;if(this._state!=="animating"){var i=this.seriesModel.getData().tree.root;if(!i)return;var o=i.getLayout();if(!o)return;var s=new Yt(o.x,o.y,o.width,o.height),l=this.seriesModel.layoutInfo;n-=l.x,a-=l.y;var u=Po();qa(u,u,[-n,-a]),WS(u,u,[r.scale,r.scale]),qa(u,u,[n,a]),s.applyTransform(u),this.api.dispatchAction({type:"treemapRender",from:this.uid,seriesId:this.seriesModel.id,rootRect:{x:s.x,y:s.y,width:s.width,height:s.height}})}},t.prototype._initEvents=function(r){var n=this;r.on("click",function(a){if(n._state==="ready"){var i=n.seriesModel.get("nodeClick",!0);if(i){var o=n.findTarget(a.offsetX,a.offsetY);if(o){var s=o.node;if(s.getLayout().isLeafRoot)n._rootToNode(o);else if(i==="zoomToNode")n._zoomToNode(o);else if(i==="link"){var l=s.hostTree.data.getItemModel(s.dataIndex),u=l.get("link",!0),c=l.get("target",!0)||"blank";u&&cm(u,c)}}}}},this)},t.prototype._renderBreadcrumb=function(r,n,a){var i=this;a||(a=r.get("leafDepth",!0)!=null?{node:r.getViewRoot()}:this.findTarget(n.getWidth()/2,n.getHeight()/2),a||(a={node:r.getData().tree.root})),(this._breadcrumb||(this._breadcrumb=new Ub(this.group))).render(r,n,a.node,function(o){i._state!=="animating"&&(Af(r.getViewRoot(),o)?i._rootToNode({node:o}):i._zoomToNode({node:o}))})},t.prototype.remove=function(){this._clearController(),this._containerGroup&&this._containerGroup.removeAll(),this._storage=Li(),this._state="ready",this._breadcrumb&&this._breadcrumb.remove()},t.prototype.dispose=function(){this._clearController()},t.prototype._zoomToNode=function(r){this.api.dispatchAction({type:"treemapZoomToNode",from:this.uid,seriesId:this.seriesModel.id,targetNode:r.node})},t.prototype._rootToNode=function(r){this.api.dispatchAction({type:"treemapRootToNode",from:this.uid,seriesId:this.seriesModel.id,targetNode:r.node})},t.prototype.findTarget=function(r,n){var a,i=this.seriesModel.getViewRoot();return i.eachNode({attr:"viewChildren",order:"preorder"},function(o){var s=this._storage.background[o.getRawIndex()];if(s){var l=s.transformCoordToLocal(r,n),u=s.shape;if(u.x<=l[0]&&l[0]<=u.x+u.width&&u.y<=l[1]&&l[1]<=u.y+u.height)a={node:o,offsetX:l[0],offsetY:l[1]};else return!1}},this),a},t.type="treemap",t}(He);function Li(){return{nodeGroup:[],background:[],content:[]}}function Zb(e,t,r,n,a,i,o,s,l,u){if(!o)return;var c=o.getLayout(),h=e.getData(),f=o.getModel();if(h.setItemGraphicEl(o.dataIndex,null),!c||!c.isInView)return;var d=c.width,v=c.height,p=c.borderWidth,g=c.invisible,m=o.getRawIndex(),_=s&&s.getRawIndex(),y=o.viewChildren,x=c.upperHeight,S=y&&y.length,T=f.getModel("itemStyle"),b=f.getModel(["emphasis","itemStyle"]),w=f.getModel(["blur","itemStyle"]),A=f.getModel(["select","itemStyle"]),E=T.get("borderRadius")||0,C=Q("nodeGroup",uh);if(!C)return;if(l.add(C),C.x=c.x||0,C.y=c.y||0,C.markRedraw(),Xs(C).nodeWidth=d,Xs(C).nodeHeight=v,c.isAboveViewRoot)return C;var M=Q("background",Bv,u,$b);M&&k(C,M,S&&c.upperLabelHeight);var P=f.getModel("emphasis"),L=P.get("focus"),I=P.get("blurScope"),N=P.get("disabled"),F=L==="ancestor"?o.getAncestorsIndices():L==="descendant"?o.getDescendantIndices():L;if(S)Yd(C)&&jo(C,!1),M&&(jo(M,!N),h.setItemGraphicEl(o.dataIndex,M),qd(M,F,I));else{var B=Q("content",Bv,u,Xb);B&&z(C,B),M.disableMorphing=!0,M&&Yd(M)&&jo(M,!1),jo(C,!N),h.setItemGraphicEl(o.dataIndex,C),qd(C,F,I)}return C;function k(ae,j,pe){var de=et(j);if(de.dataIndex=o.dataIndex,de.seriesIndex=e.seriesIndex,j.setShape({x:0,y:0,width:d,height:v,r:E}),g)W(j);else{j.invisible=!1;var ge=o.getVisual("style"),nt=ge.stroke,De=Vv(T);De.fill=nt;var Re=qn(b);Re.fill=b.get("borderColor");var Be=qn(w);Be.fill=w.get("borderColor");var Dt=qn(A);if(Dt.fill=A.get("borderColor"),pe){var Rr=d-2*p;J(j,nt,ge.opacity,{x:p,y:0,width:Rr,height:x})}else j.removeTextContent();j.setStyle(De),j.ensureState("emphasis").style=Re,j.ensureState("blur").style=Be,j.ensureState("select").style=Dt,Fs(j)}ae.add(j)}function z(ae,j){var pe=et(j);pe.dataIndex=o.dataIndex,pe.seriesIndex=e.seriesIndex;var de=Math.max(d-2*p,0),ge=Math.max(v-2*p,0);if(j.culling=!0,j.setShape({x:p,y:p,width:de,height:ge,r:E}),g)W(j);else{j.invisible=!1;var nt=o.getVisual("style"),De=nt.fill,Re=Vv(T);Re.fill=De,Re.decal=nt.decal;var Be=qn(b),Dt=qn(w),Rr=qn(A);J(j,De,nt.opacity,null),j.setStyle(Re),j.ensureState("emphasis").style=Be,j.ensureState("blur").style=Dt,j.ensureState("select").style=Rr,Fs(j)}ae.add(j)}function W(ae){!ae.invisible&&i.push(ae)}function J(ae,j,pe,de){var ge=f.getModel(de?Gv:zv),nt=Qr(f.get("name"),null),De=ge.getShallow("show");Wr(ae,wr(f,de?Gv:zv),{defaultText:De?nt:null,inheritColor:j,defaultOpacity:pe,labelFetcher:e,labelDataIndex:o.dataIndex});var Re=ae.getTextContent();if(Re){var Be=Re.style,Dt=$S(Be.padding||0);de&&(ae.setTextConfig({layoutRect:de}),Re.disableLabelLayout=!0),Re.beforeUpdate=function(){var Gn=Math.max((de?de.width:ae.shape.width)-Dt[1]-Dt[3],0),Vn=Math.max((de?de.height:ae.shape.height)-Dt[0]-Dt[2],0);(Be.width!==Gn||Be.height!==Vn)&&Re.setStyle({width:Gn,height:Vn})},Be.truncateMinChar=2,Be.lineOverflow="truncate",re(Be,de,c);var Rr=Re.getState("emphasis");re(Rr?Rr.style:null,de,c)}}function re(ae,j,pe){var de=ae?ae.text:null;if(!j&&pe.isLeafRoot&&de!=null){var ge=e.get("drillDownIcon",!0);ae.text=ge?ge+" "+de:de}}function Q(ae,j,pe,de){var ge=_!=null&&r[ae][_],nt=a[ae];return ge?(r[ae][_]=null,q(nt,ge)):g||(ge=new j,ge instanceof Io&&(ge.z2=Yb(pe,de)),Ee(nt,ge)),t[ae][m]=ge}function q(ae,j){var pe=ae[m]={};j instanceof uh?(pe.oldX=j.x,pe.oldY=j.y):pe.oldShape=le({},j.shape)}function Ee(ae,j){var pe=ae[m]={},de=o.parentNode,ge=j instanceof Fe;if(de&&(!n||n.direction==="drillDown")){var nt=0,De=0,Re=a.background[de.getRawIndex()];!n&&Re&&Re.oldShape&&(nt=Re.oldShape.width,De=Re.oldShape.height),ge?(pe.oldX=0,pe.oldY=De):pe.oldShape={x:nt,y:De,width:0,height:0}}pe.fadein=!ge}}function Yb(e,t){return e*Wb+t}const qb=jb;var Kb="itemStyle",my=Nt();const Jb={seriesType:"treemap",reset:function(e){var t=e.getData().tree,r=t.root;r.isRemoved()||yy(r,{},e.getViewRoot().getAncestors(),e)}};function yy(e,t,r,n){var a=e.getModel(),i=e.getLayout(),o=e.hostTree.data;if(!(!i||i.invisible||!i.isInView)){var s=a.getModel(Kb),l=Qb(s,t,n),u=o.ensureUniqueItemVisual(e.dataIndex,"style"),c=s.get("borderColor"),h=s.get("borderColorSaturation"),f;h!=null&&(f=Uv(l),c=ew(h,f)),u.stroke=c;var d=e.viewChildren;if(!d||!d.length)f=Uv(l),u.fill=f;else{var v=tw(e,a,i,s,l,d);R(d,function(p,g){if(p.depth>=r.length||p===r[p.depth]){var m=rw(a,l,p,g,v,n);yy(p,m,r,n)}})}}}function Qb(e,t,r){var n=le({},t),a=r.designatedVisualItemStyle;return R(["color","colorAlpha","colorSaturation"],function(i){a[i]=t[i];var o=e.get(i);a[i]=null,o!=null&&(n[i]=o)}),n}function Uv(e){var t=Cu(e,"color");if(t){var r=Cu(e,"colorAlpha"),n=Cu(e,"colorSaturation");return n&&(t=hm(t,null,null,n)),r&&(t=qc(t,r)),t}}function ew(e,t){return t!=null?hm(t,null,null,e):null}function Cu(e,t){var r=e[t];if(r!=null&&r!=="none")return r}function tw(e,t,r,n,a,i){if(!(!i||!i.length)){var o=Lu(t,"color")||a.color!=null&&a.color!=="none"&&(Lu(t,"colorAlpha")||Lu(t,"colorSaturation"));if(o){var s=t.get("visualMin"),l=t.get("visualMax"),u=r.dataExtent.slice();s!=null&&s<u[0]&&(u[0]=s),l!=null&&l>u[1]&&(u[1]=l);var c=t.get("colorMappingBy"),h={type:o.name,dataExtent:u,visual:o.range};h.type==="color"&&(c==="index"||c==="id")?(h.mappingMethod="category",h.loop=!0):h.mappingMethod="linear";var f=new fm(h);return my(f).drColorMappingBy=c,f}}}function Lu(e,t){var r=e.get(t);return te(r)&&r.length?{name:t,range:r}:null}function rw(e,t,r,n,a,i){var o=le({},t);if(a){var s=a.type,l=s==="color"&&my(a).drColorMappingBy,u=l==="index"?n:l==="id"?i.mapIdToIndex(r.getId()):r.getValue(e.get("visualDimension"));o[s]=a.mapValueToVisual(u)}return o}var vo=Math.max,js=Math.min,kv=Lr,Ef=R,_y=["itemStyle","borderWidth"],nw=["itemStyle","gapWidth"],aw=["upperLabel","show"],iw=["upperLabel","height"];const ow={seriesType:"treemap",reset:function(e,t,r,n){var a=r.getWidth(),i=r.getHeight(),o=e.option,s=sr(e.getBoxLayoutParams(),{width:r.getWidth(),height:r.getHeight()}),l=o.size||[],u=ee(kv(s.width,l[0]),a),c=ee(kv(s.height,l[1]),i),h=n&&n.type,f=["treemapZoomToNode","treemapRootToNode"],d=fo(n,f,e),v=h==="treemapRender"||h==="treemapMove"?n.rootRect:null,p=e.getViewRoot(),g=vy(p);if(h!=="treemapMove"){var m=h==="treemapZoomToNode"?fw(e,d,p,u,c):v?[v.width,v.height]:[u,c],_=o.sort;_&&_!=="asc"&&_!=="desc"&&(_="desc");var y={squareRatio:o.squareRatio,sort:_,leafDepth:o.leafDepth};p.hostTree.clearLayouts();var x={x:0,y:0,width:m[0],height:m[1],area:m[0]*m[1]};p.setLayout(x),xy(p,y,!1,0),x=p.getLayout(),Ef(g,function(T,b){var w=(g[b+1]||p).getValue();T.setLayout(le({dataExtent:[w,w],borderWidth:0,upperHeight:0},x))})}var S=e.getData().tree.root;S.setLayout(dw(s,v,d),!0),e.setLayoutInfo(s),Sy(S,new Yt(-s.x,-s.y,a,i),g,p,0)}};function xy(e,t,r,n){var a,i;if(!e.isRemoved()){var o=e.getLayout();a=o.width,i=o.height;var s=e.getModel(),l=s.get(_y),u=s.get(nw)/2,c=Ty(s),h=Math.max(l,c),f=l-u,d=h-u;e.setLayout({borderWidth:l,upperHeight:h,upperLabelHeight:c},!0),a=vo(a-2*f,0),i=vo(i-f-d,0);var v=a*i,p=sw(e,s,v,t,r,n);if(p.length){var g={x:f,y:d,width:a,height:i},m=js(a,i),_=1/0,y=[];y.area=0;for(var x=0,S=p.length;x<S;){var T=p[x];y.push(T),y.area+=T.getLayout().area;var b=hw(y,m,t.squareRatio);b<=_?(x++,_=b):(y.area-=y.pop().getLayout().area,Hv(y,m,g,u,!1),m=js(g.width,g.height),y.length=y.area=0,_=1/0)}if(y.length&&Hv(y,m,g,u,!0),!r){var w=s.get("childrenVisibleMin");w!=null&&v<w&&(r=!0)}for(var x=0,S=p.length;x<S;x++)xy(p[x],t,r,n+1)}}}function sw(e,t,r,n,a,i){var o=e.children||[],s=n.sort;s!=="asc"&&s!=="desc"&&(s=null);var l=n.leafDepth!=null&&n.leafDepth<=i;if(a&&!l)return e.viewChildren=[];o=Vt(o,function(d){return!d.isRemoved()}),uw(o,s);var u=cw(t,o,s);if(u.sum===0)return e.viewChildren=[];if(u.sum=lw(t,r,u.sum,s,o),u.sum===0)return e.viewChildren=[];for(var c=0,h=o.length;c<h;c++){var f=o[c].getValue()/u.sum*r;o[c].setLayout({area:f})}return l&&(o.length&&e.setLayout({isLeafRoot:!0},!0),o.length=0),e.viewChildren=o,e.setLayout({dataExtent:u.dataExtent},!0),o}function lw(e,t,r,n,a){if(!n)return r;for(var i=e.get("visibleMin"),o=a.length,s=o,l=o-1;l>=0;l--){var u=a[n==="asc"?o-l-1:l].getValue();u/r*t<i&&(s=l,r-=u)}return n==="asc"?a.splice(0,o-s):a.splice(s,o-s),r}function uw(e,t){return t&&e.sort(function(r,n){var a=t==="asc"?r.getValue()-n.getValue():n.getValue()-r.getValue();return a===0?t==="asc"?r.dataIndex-n.dataIndex:n.dataIndex-r.dataIndex:a}),e}function cw(e,t,r){for(var n=0,a=0,i=t.length;a<i;a++)n+=t[a].getValue();var o=e.get("visualDimension"),s;return!t||!t.length?s=[NaN,NaN]:o==="value"&&r?(s=[t[t.length-1].getValue(),t[0].getValue()],r==="asc"&&s.reverse()):(s=[1/0,-1/0],Ef(t,function(l){var u=l.getValue(o);u<s[0]&&(s[0]=u),u>s[1]&&(s[1]=u)})),{sum:n,dataExtent:s}}function hw(e,t,r){for(var n=0,a=1/0,i=0,o=void 0,s=e.length;i<s;i++)o=e[i].getLayout().area,o&&(o<a&&(a=o),o>n&&(n=o));var l=e.area*e.area,u=t*t*r;return l?vo(u*n/l,l/(u*a)):1/0}function Hv(e,t,r,n,a){var i=t===r.width?0:1,o=1-i,s=["x","y"],l=["width","height"],u=r[s[i]],c=t?e.area/t:0;(a||c>r[l[o]])&&(c=r[l[o]]);for(var h=0,f=e.length;h<f;h++){var d=e[h],v={},p=c?d.getLayout().area/c:0,g=v[l[o]]=vo(c-2*n,0),m=r[s[i]]+r[l[i]]-u,_=h===f-1||m<p?m:p,y=v[l[i]]=vo(_-2*n,0);v[s[o]]=r[s[o]]+js(n,g/2),v[s[i]]=u+js(n,y/2),u+=_,d.setLayout(v,!0)}r[s[o]]+=c,r[l[o]]-=c}function fw(e,t,r,n,a){var i=(t||{}).node,o=[n,a];if(!i||i===r)return o;for(var s,l=n*a,u=l*e.option.zoomToNodeRatio;s=i.parentNode;){for(var c=0,h=s.children,f=0,d=h.length;f<d;f++)c+=h[f].getValue();var v=i.getValue();if(v===0)return o;u*=c/v;var p=s.getModel(),g=p.get(_y),m=Math.max(g,Ty(p));u+=4*g*g+(3*g+m)*Math.pow(u,.5),u>Kd&&(u=Kd),i=s}u<l&&(u=l);var _=Math.pow(u/l,.5);return[n*_,a*_]}function dw(e,t,r){if(t)return{x:t.x,y:t.y};var n={x:0,y:0};if(!r)return n;var a=r.node,i=a.getLayout();if(!i)return n;for(var o=[i.width/2,i.height/2],s=a;s;){var l=s.getLayout();o[0]+=l.x,o[1]+=l.y,s=s.parentNode}return{x:e.width/2-o[0],y:e.height/2-o[1]}}function Sy(e,t,r,n,a){var i=e.getLayout(),o=r[a],s=o&&o===e;if(!(o&&!s||a===r.length&&e!==n)){e.setLayout({isInView:!0,invisible:!s&&!t.intersect(i),isAboveViewRoot:s},!0);var l=new Yt(t.x-i.x,t.y-i.y,t.width,t.height);Ef(e.viewChildren||[],function(u){Sy(u,l,r,n,a+1)})}}function Ty(e){return e.get(aw)?e.get(iw):0}function vw(e){e.registerSeriesModel(Bb),e.registerChartView(qb),e.registerVisual(Jb),e.registerLayout(ow),Rb(e)}function pw(e){var t=e.findComponents({mainType:"legend"});!t||!t.length||e.eachSeriesByType("graph",function(r){var n=r.getCategoriesData(),a=r.getGraph(),i=a.data,o=n.mapArray(n.getName);i.filterSelf(function(s){var l=i.getItemModel(s),u=l.getShallow("category");if(u!=null){Mr(u)&&(u=o[u]);for(var c=0;c<t.length;c++)if(!t[c].isSelected(u))return!1}return!0})})}function gw(e){var t={};e.eachSeriesByType("graph",function(r){var n=r.getCategoriesData(),a=r.getData(),i={};n.each(function(o){var s=n.getName(o);i["ec-"+s]=o;var l=n.getItemModel(o),u=l.getModel("itemStyle").getItemStyle();u.fill||(u.fill=r.getColorFromPalette(s,t)),n.setItemVisual(o,"style",u);for(var c=["symbol","symbolSize","symbolKeepAspect"],h=0;h<c.length;h++){var f=l.getShallow(c[h],!0);f!=null&&n.setItemVisual(o,c[h],f)}}),n.count()&&a.each(function(o){var s=a.getItemModel(o),l=s.getShallow("category");if(l!=null){Ve(l)&&(l=i["ec-"+l]);var u=n.getItemVisual(l,"style"),c=a.ensureUniqueItemVisual(o,"style");le(c,u);for(var h=["symbol","symbolSize","symbolKeepAspect"],f=0;f<h.length;f++)a.setItemVisual(o,h[f],n.getItemVisual(l,h[f]))}})})}function es(e){return e instanceof Array||(e=[e,e]),e}function mw(e){e.eachSeriesByType("graph",function(t){var r=t.getGraph(),n=t.getEdgeData(),a=es(t.get("edgeSymbol")),i=es(t.get("edgeSymbolSize"));n.setVisual("fromSymbol",a&&a[0]),n.setVisual("toSymbol",a&&a[1]),n.setVisual("fromSymbolSize",i&&i[0]),n.setVisual("toSymbolSize",i&&i[1]),n.setVisual("style",t.getModel("lineStyle").getLineStyle()),n.each(function(o){var s=n.getItemModel(o),l=r.getEdgeByIndex(o),u=es(s.getShallow("symbol",!0)),c=es(s.getShallow("symbolSize",!0)),h=s.getModel("lineStyle").getLineStyle(),f=n.ensureUniqueItemVisual(o,"style");switch(le(f,h),f.stroke){case"source":{var d=l.node1.getVisual("style");f.stroke=d&&d.fill;break}case"target":{var d=l.node2.getVisual("style");f.stroke=d&&d.fill;break}}u[0]&&l.setVisual("fromSymbol",u[0]),u[1]&&l.setVisual("toSymbol",u[1]),c[0]&&l.setVisual("fromSymbolSize",c[0]),c[1]&&l.setVisual("toSymbolSize",c[1])})})}var ch="-->",kl=function(e){return e.get("autoCurveness")||null},by=function(e,t){var r=kl(e),n=20,a=[];if(Mr(r))n=r;else if(te(r)){e.__curvenessList=r;return}t>n&&(n=t);var i=n%2?n+2:n+3;a=[];for(var o=0;o<i;o++)a.push((o%2?o+1:o)/10*(o%2?-1:1));e.__curvenessList=a},po=function(e,t,r){var n=[e.id,e.dataIndex].join("."),a=[t.id,t.dataIndex].join(".");return[r.uid,n,a].join(ch)},wy=function(e){var t=e.split(ch);return[t[0],t[2],t[1]].join(ch)},yw=function(e,t){var r=po(e.node1,e.node2,t);return t.__edgeMap[r]},_w=function(e,t){var r=hh(po(e.node1,e.node2,t),t),n=hh(po(e.node2,e.node1,t),t);return r+n},hh=function(e,t){var r=t.__edgeMap;return r[e]?r[e].length:0};function xw(e){kl(e)&&(e.__curvenessList=[],e.__edgeMap={},by(e))}function Sw(e,t,r,n){if(kl(r)){var a=po(e,t,r),i=r.__edgeMap,o=i[wy(a)];i[a]&&!o?i[a].isForward=!0:o&&i[a]&&(o.isForward=!0,i[a].isForward=!1),i[a]=i[a]||[],i[a].push(n)}}function Cf(e,t,r,n){var a=kl(t),i=te(a);if(!a)return null;var o=yw(e,t);if(!o)return null;for(var s=-1,l=0;l<o.length;l++)if(o[l]===r){s=l;break}var u=_w(e,t);by(t,u),e.lineStyle=e.lineStyle||{};var c=po(e.node1,e.node2,t),h=t.__curvenessList,f=i||u%2?0:1;if(o.isForward)return h[f+s];var d=wy(c),v=hh(d,t),p=h[s+v+f];return n?i?a&&a[0]===0?(v+f)%2?p:-p:((v%2?0:1)+f)%2?p:-p:(v+f)%2?p:-p:h[s+v+f]}function Ay(e){var t=e.coordinateSystem;if(!(t&&t.type!=="view")){var r=e.getGraph();r.eachNode(function(n){var a=n.getModel();n.setLayout([+a.get("x"),+a.get("y")])}),Lf(r,e)}}function Lf(e,t){e.eachEdge(function(r,n){var a=Ro(r.getModel().get(["lineStyle","curveness"]),-Cf(r,t,n,!0),0),i=En(r.node1.getLayout()),o=En(r.node2.getLayout()),s=[i,o];+a&&s.push([(i[0]+o[0])/2-(i[1]-o[1])*a,(i[1]+o[1])/2-(o[0]-i[0])*a]),r.setLayout(s)})}function Tw(e,t){e.eachSeriesByType("graph",function(r){var n=r.get("layout"),a=r.coordinateSystem;if(a&&a.type!=="view"){var i=r.getData(),o=[];R(a.dimensions,function(f){o=o.concat(i.mapDimensionsAll(f))});for(var s=0;s<i.count();s++){for(var l=[],u=!1,c=0;c<o.length;c++){var h=i.get(o[c],s);isNaN(h)||(u=!0),l.push(h)}u?i.setItemLayout(s,a.dataToPoint(l)):i.setItemLayout(s,[NaN,NaN])}Lf(i.graph,r)}else(!n||n==="none")&&Ay(r)})}function Xi(e){var t=e.coordinateSystem;if(t.type!=="view")return 1;var r=e.option.nodeScaleRatio,n=t.scaleX,a=t.getZoom(),i=(a-1)*r+1;return i/n}function ji(e){var t=e.getVisual("symbolSize");return t instanceof Array&&(t=(t[0]+t[1])/2),+t}var Wv=Math.PI,Du=[];function Df(e,t,r,n){var a=e.coordinateSystem;if(!(a&&a.type!=="view")){var i=a.getBoundingRect(),o=e.getData(),s=o.graph,l=i.width/2+i.x,u=i.height/2+i.y,c=Math.min(i.width,i.height)/2,h=o.count();if(o.setLayout({cx:l,cy:u}),!!h){if(r){var f=a.pointToData(n),d=f[0],v=f[1],p=[d-l,v-u];No(p,p),XS(p,p,c),r.setLayout([l+p[0],u+p[1]],!0);var g=e.get(["circular","rotateLabel"]);Ey(r,g,l,u)}bw[t](e,s,o,c,l,u,h),s.eachEdge(function(m,_){var y=Ro(m.getModel().get(["lineStyle","curveness"]),Cf(m,e,_),0),x=En(m.node1.getLayout()),S=En(m.node2.getLayout()),T,b=(x[0]+S[0])/2,w=(x[1]+S[1])/2;+y&&(y*=3,T=[l*y+b*(1-y),u*y+w*(1-y)]),m.setLayout([x,S,T])})}}}var bw={value:function(e,t,r,n,a,i,o){var s=0,l=r.getSum("value"),u=Math.PI*2/(l||o);t.eachNode(function(c){var h=c.getValue("value"),f=u*(l?h:1)/2;s+=f,c.setLayout([n*Math.cos(s)+a,n*Math.sin(s)+i]),s+=f})},symbolSize:function(e,t,r,n,a,i,o){var s=0;Du.length=o;var l=Xi(e);t.eachNode(function(h){var f=ji(h);isNaN(f)&&(f=2),f<0&&(f=0),f*=l;var d=Math.asin(f/2/n);isNaN(d)&&(d=Wv/2),Du[h.dataIndex]=d,s+=d*2});var u=(2*Wv-s)/o/2,c=0;t.eachNode(function(h){var f=u+Du[h.dataIndex];c+=f,(!h.getLayout()||!h.getLayout().fixed)&&h.setLayout([n*Math.cos(c)+a,n*Math.sin(c)+i]),c+=f})}};function Ey(e,t,r,n){var a=e.getGraphicEl();if(a){var i=e.getModel(),o=i.get(["label","rotate"])||0,s=a.getSymbolPath();if(t){var l=e.getLayout(),u=Math.atan2(l[1]-n,l[0]-r);u<0&&(u=Math.PI*2+u);var c=l[0]<r;c&&(u=u-Math.PI);var h=c?"left":"right";s.setTextConfig({rotation:-u,position:h,origin:"center"});var f=s.ensureState("emphasis");le(f.textConfig||(f.textConfig={}),{position:h})}else s.setTextConfig({rotation:o*=Math.PI/180})}}function ww(e){e.eachSeriesByType("graph",function(t){t.get("layout")==="circular"&&Df(t,"symbolSize")})}var wa=Kc;function Aw(e,t,r){for(var n=e,a=t,i=r.rect,o=i.width,s=i.height,l=[i.x+o/2,i.y+s/2],u=r.gravity==null?.1:r.gravity,c=0;c<n.length;c++){var h=n[c];h.p||(h.p=jS(o*(Math.random()-.5)+l[0],s*(Math.random()-.5)+l[1])),h.pp=En(h.p),h.edges=null}var f=r.friction==null?.6:r.friction,d=f,v,p;return{warmUp:function(){d=f*.8},setFixed:function(g){n[g].fixed=!0},setUnfixed:function(g){n[g].fixed=!1},beforeStep:function(g){v=g},afterStep:function(g){p=g},step:function(g){v&&v(n,a);for(var m=[],_=n.length,y=0;y<a.length;y++){var x=a[y];if(!x.ignoreForceLayout){var S=x.n1,T=x.n2;Ua(m,T.p,S.p);var b=Jd(m)-x.d,w=T.w/(S.w+T.w);isNaN(w)&&(w=0),No(m,m),!S.fixed&&wa(S.p,S.p,m,w*b*d),!T.fixed&&wa(T.p,T.p,m,-(1-w)*b*d)}}for(var y=0;y<_;y++){var A=n[y];A.fixed||(Ua(m,l,A.p),wa(A.p,A.p,m,u*d))}for(var y=0;y<_;y++)for(var S=n[y],E=y+1;E<_;E++){var T=n[E];Ua(m,T.p,S.p);var b=Jd(m);b===0&&(ZS(m,Math.random()-.5,Math.random()-.5),b=1);var C=(S.rep+T.rep)/b/b;!S.fixed&&wa(S.pp,S.pp,m,C),!T.fixed&&wa(T.pp,T.pp,m,-C)}for(var M=[],y=0;y<_;y++){var A=n[y];A.fixed||(Ua(M,A.p,A.pp),wa(A.p,A.p,M,d),er(A.pp,A.p))}d=d*.992;var P=d<.01;p&&p(n,a,P),g&&g(P)}}}function Ew(e){e.eachSeriesByType("graph",function(t){var r=t.coordinateSystem;if(!(r&&r.type!=="view"))if(t.get("layout")==="force"){var n=t.preservedPoints||{},a=t.getGraph(),i=a.data,o=a.edgeData,s=t.getModel("force"),l=s.get("initLayout");t.preservedPoints?i.each(function(y){var x=i.getId(y);i.setItemLayout(y,n[x]||[NaN,NaN])}):!l||l==="none"?Ay(t):l==="circular"&&Df(t,"value");var u=i.getDataExtent("value"),c=o.getDataExtent("value"),h=s.get("repulsion"),f=s.get("edgeLength"),d=te(h)?h:[h,h],v=te(f)?f:[f,f];v=[v[1],v[0]];var p=i.mapArray("value",function(y,x){var S=i.getItemLayout(x),T=Ye(y,u,d);return isNaN(T)&&(T=(d[0]+d[1])/2),{w:T,rep:T,fixed:i.getItemModel(x).get("fixed"),p:!S||isNaN(S[0])||isNaN(S[1])?null:S}}),g=o.mapArray("value",function(y,x){var S=a.getEdgeByIndex(x),T=Ye(y,c,v);isNaN(T)&&(T=(v[0]+v[1])/2);var b=S.getModel(),w=Ro(S.getModel().get(["lineStyle","curveness"]),-Cf(S,t,x,!0),0);return{n1:p[S.node1.dataIndex],n2:p[S.node2.dataIndex],d:T,curveness:w,ignoreForceLayout:b.get("ignoreForceLayout")}}),m=r.getBoundingRect(),_=Aw(p,g,{rect:m,gravity:s.get("gravity"),friction:s.get("friction")});_.beforeStep(function(y,x){for(var S=0,T=y.length;S<T;S++)y[S].fixed&&er(y[S].p,a.getNodeByIndex(S).getLayout())}),_.afterStep(function(y,x,S){for(var T=0,b=y.length;T<b;T++)y[T].fixed||a.getNodeByIndex(T).setLayout(y[T].p),n[i.getId(T)]=y[T].p;for(var T=0,b=x.length;T<b;T++){var w=x[T],A=a.getEdgeByIndex(T),E=w.n1.p,C=w.n2.p,M=A.getLayout();M=M?M.slice():[],M[0]=M[0]||[],M[1]=M[1]||[],er(M[0],E),er(M[1],C),+w.curveness&&(M[2]=[(E[0]+C[0])/2-(E[1]-C[1])*w.curveness,(E[1]+C[1])/2-(C[0]-E[0])*w.curveness]),A.setLayout(M)}}),t.forceLayout=_,t.preservedPoints=n,_.step()}else t.forceLayout=null})}function Cw(e,t,r){var n=le(e.getBoxLayoutParams(),{aspect:r});return sr(n,{width:t.getWidth(),height:t.getHeight()})}function Lw(e,t){var r=[];return e.eachSeriesByType("graph",function(n){var a=n.get("coordinateSystem");if(!a||a==="view"){var i=n.getData(),o=i.mapArray(function(g){var m=i.getItemModel(g);return[+m.get("x"),+m.get("y")]}),s=[],l=[];Ml(o,s,l),l[0]-s[0]===0&&(l[0]+=1,s[0]-=1),l[1]-s[1]===0&&(l[1]+=1,s[1]-=1);var u=(l[0]-s[0])/(l[1]-s[1]),c=Cw(n,t,u);isNaN(u)&&(s=[c.x,c.y],l=[c.x+c.width,c.y+c.height]);var h=l[0]-s[0],f=l[1]-s[1],d=c.width,v=c.height,p=n.coordinateSystem=new rf;p.zoomLimit=n.get("scaleLimit"),p.setBoundingRect(s[0],s[1],h,f),p.setViewRect(c.x,c.y,d,v),p.setCenter(n.get("center"),t),p.setZoom(n.get("zoom")),r.push(p)}}),r}var $v=Gr.prototype,Mu=om.prototype,Cy=function(){function e(){this.x1=0,this.y1=0,this.x2=0,this.y2=0,this.percent=1}return e}();(function(e){U(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t})(Cy);function Pu(e){return isNaN(+e.cpx1)||isNaN(+e.cpy1)}var Dw=function(e){U(t,e);function t(r){var n=e.call(this,r)||this;return n.type="ec-line",n}return t.prototype.getDefaultStyle=function(){return{stroke:"#000",fill:null}},t.prototype.getDefaultShape=function(){return new Cy},t.prototype.buildPath=function(r,n){Pu(n)?$v.buildPath.call(this,r,n):Mu.buildPath.call(this,r,n)},t.prototype.pointAt=function(r){return Pu(this.shape)?$v.pointAt.call(this,r):Mu.pointAt.call(this,r)},t.prototype.tangentAt=function(r){var n=this.shape,a=Pu(n)?[n.x2-n.x1,n.y2-n.y1]:Mu.tangentAt.call(this,r);return No(a,a)},t}(Gt);const Mw=Dw;var Iu=["fromSymbol","toSymbol"];function Xv(e){return"_"+e+"Type"}function jv(e,t,r){var n=t.getItemVisual(r,e);if(!n||n==="none")return n;var a=t.getItemVisual(r,e+"Size"),i=t.getItemVisual(r,e+"Rotate"),o=t.getItemVisual(r,e+"Offset"),s=t.getItemVisual(r,e+"KeepAspect"),l=Al(a),u=Il(o||0,l);return n+l+u+(i||"")+(s||"")}function Zv(e,t,r){var n=t.getItemVisual(r,e);if(!(!n||n==="none")){var a=t.getItemVisual(r,e+"Size"),i=t.getItemVisual(r,e+"Rotate"),o=t.getItemVisual(r,e+"Offset"),s=t.getItemVisual(r,e+"KeepAspect"),l=Al(a),u=Il(o||0,l),c=Pr(n,-l[0]/2+u[0],-l[1]/2+u[1],l[0],l[1],null,s);return c.__specifiedRotation=i==null||isNaN(i)?void 0:+i*Math.PI/180||0,c.name=e,c}}function Pw(e){var t=new Mw({name:"line",subPixelOptimize:!0});return fh(t.shape,e),t}function fh(e,t){e.x1=t[0][0],e.y1=t[0][1],e.x2=t[1][0],e.y2=t[1][1],e.percent=1;var r=t[2];r?(e.cpx1=r[0],e.cpy1=r[1]):(e.cpx1=NaN,e.cpy1=NaN)}var Iw=function(e){U(t,e);function t(r,n,a){var i=e.call(this)||this;return i._createLine(r,n,a),i}return t.prototype._createLine=function(r,n,a){var i=r.hostModel,o=r.getItemLayout(n),s=Pw(o);s.shape.percent=0,ar(s,{shape:{percent:1}},i,n),this.add(s),R(Iu,function(l){var u=Zv(l,r,n);this.add(u),this[Xv(l)]=jv(l,r,n)},this),this._updateCommonStl(r,n,a)},t.prototype.updateData=function(r,n,a){var i=r.hostModel,o=this.childOfName("line"),s=r.getItemLayout(n),l={shape:{}};fh(l.shape,s),st(o,l,i,n),R(Iu,function(u){var c=jv(u,r,n),h=Xv(u);if(this[h]!==c){this.remove(this.childOfName(u));var f=Zv(u,r,n);this.add(f)}this[h]=c},this),this._updateCommonStl(r,n,a)},t.prototype.getLinePath=function(){return this.childAt(0)},t.prototype._updateCommonStl=function(r,n,a){var i=r.hostModel,o=this.childOfName("line"),s=a&&a.emphasisLineStyle,l=a&&a.blurLineStyle,u=a&&a.selectLineStyle,c=a&&a.labelStatesModels,h=a&&a.emphasisDisabled,f=a&&a.focus,d=a&&a.blurScope;if(!a||r.hasItemOption){var v=r.getItemModel(n),p=v.getModel("emphasis");s=p.getModel("lineStyle").getLineStyle(),l=v.getModel(["blur","lineStyle"]).getLineStyle(),u=v.getModel(["select","lineStyle"]).getLineStyle(),h=p.get("disabled"),f=p.get("focus"),d=p.get("blurScope"),c=wr(v)}var g=r.getItemVisual(n,"style"),m=g.stroke;o.useStyle(g),o.style.fill=null,o.style.strokeNoScale=!0,o.ensureState("emphasis").style=s,o.ensureState("blur").style=l,o.ensureState("select").style=u,R(Iu,function(T){var b=this.childOfName(T);if(b){b.setColor(m),b.style.opacity=g.opacity;for(var w=0;w<Jc.length;w++){var A=Jc[w],E=o.getState(A);if(E){var C=E.style||{},M=b.ensureState(A),P=M.style||(M.style={});C.stroke!=null&&(P[b.__isEmptyBrush?"stroke":"fill"]=C.stroke),C.opacity!=null&&(P.opacity=C.opacity)}}b.markRedraw()}},this);var _=i.getRawValue(n);Wr(this,c,{labelDataIndex:n,labelFetcher:{getFormattedLabel:function(T,b){return i.getFormattedLabel(T,b,r.dataType)}},inheritColor:m||"#000",defaultOpacity:g.opacity,defaultText:(_==null?r.getName(n):isFinite(_)?na(_):_)+""});var y=this.getTextContent();if(y){var x=c.normal;y.__align=y.style.align,y.__verticalAlign=y.style.verticalAlign,y.__position=x.get("position")||"middle";var S=x.get("distance");te(S)||(S=[S,S]),y.__labelDistance=S}this.setTextConfig({position:null,local:!0,inside:!1}),zt(this,f,d,h)},t.prototype.highlight=function(){Gs(this)},t.prototype.downplay=function(){Vs(this)},t.prototype.updateLayout=function(r,n){this.setLinePoints(r.getItemLayout(n))},t.prototype.setLinePoints=function(r){var n=this.childOfName("line");fh(n.shape,r),n.dirty()},t.prototype.beforeUpdate=function(){var r=this,n=r.childOfName("fromSymbol"),a=r.childOfName("toSymbol"),i=r.getTextContent();if(!n&&!a&&(!i||i.ignore))return;for(var o=1,s=this.parent;s;)s.scaleX&&(o/=s.scaleX),s=s.parent;var l=r.childOfName("line");if(!this.__dirty&&!l.__dirty)return;var u=l.shape.percent,c=l.pointAt(0),h=l.pointAt(u),f=Ua([],h,c);No(f,f);function d(E,C){var M=E.__specifiedRotation;if(M==null){var P=l.tangentAt(C);E.attr("rotation",(C===1?-1:1)*Math.PI/2-Math.atan2(P[1],P[0]))}else E.attr("rotation",M)}if(n&&(n.setPosition(c),d(n,0),n.scaleX=n.scaleY=o*u,n.markRedraw()),a&&(a.setPosition(h),d(a,1),a.scaleX=a.scaleY=o*u,a.markRedraw()),i&&!i.ignore){i.x=i.y=0,i.originX=i.originY=0;var v=void 0,p=void 0,g=i.__labelDistance,m=g[0]*o,_=g[1]*o,y=u/2,x=l.tangentAt(y),S=[x[1],-x[0]],T=l.pointAt(y);S[1]>0&&(S[0]=-S[0],S[1]=-S[1]);var b=x[0]<0?-1:1;if(i.__position!=="start"&&i.__position!=="end"){var w=-Math.atan2(x[1],x[0]);h[0]<c[0]&&(w=Math.PI+w),i.rotation=w}var A=void 0;switch(i.__position){case"insideStartTop":case"insideMiddleTop":case"insideEndTop":case"middle":A=-_,p="bottom";break;case"insideStartBottom":case"insideMiddleBottom":case"insideEndBottom":A=_,p="top";break;default:A=0,p="middle"}switch(i.__position){case"end":i.x=f[0]*m+h[0],i.y=f[1]*_+h[1],v=f[0]>.8?"left":f[0]<-.8?"right":"center",p=f[1]>.8?"top":f[1]<-.8?"bottom":"middle";break;case"start":i.x=-f[0]*m+c[0],i.y=-f[1]*_+c[1],v=f[0]>.8?"right":f[0]<-.8?"left":"center",p=f[1]>.8?"bottom":f[1]<-.8?"top":"middle";break;case"insideStartTop":case"insideStart":case"insideStartBottom":i.x=m*b+c[0],i.y=c[1]+A,v=x[0]<0?"right":"left",i.originX=-m*b,i.originY=-A;break;case"insideMiddleTop":case"insideMiddle":case"insideMiddleBottom":case"middle":i.x=T[0],i.y=T[1]+A,v="center",i.originY=-A;break;case"insideEndTop":case"insideEnd":case"insideEndBottom":i.x=-m*b+h[0],i.y=h[1]+A,v=x[0]>=0?"right":"left",i.originX=m*b,i.originY=-A;break}i.scaleX=i.scaleY=o,i.setStyle({verticalAlign:i.__verticalAlign||p,align:i.__align||v})}},t}(Fe);const Mf=Iw;var Rw=function(){function e(t){this.group=new Fe,this._LineCtor=t||Mf}return e.prototype.updateData=function(t){var r=this;this._progressiveEls=null;var n=this,a=n.group,i=n._lineData;n._lineData=t,i||a.removeAll();var o=Yv(t);t.diff(i).add(function(s){r._doAdd(t,s,o)}).update(function(s,l){r._doUpdate(i,t,l,s,o)}).remove(function(s){a.remove(i.getItemGraphicEl(s))}).execute()},e.prototype.updateLayout=function(){var t=this._lineData;t&&t.eachItemGraphicEl(function(r,n){r.updateLayout(t,n)},this)},e.prototype.incrementalPrepareUpdate=function(t){this._seriesScope=Yv(t),this._lineData=null,this.group.removeAll()},e.prototype.incrementalUpdate=function(t,r){this._progressiveEls=[];function n(s){!s.isGroup&&!Nw(s)&&(s.incremental=!0,s.ensureState("emphasis").hoverLayer=!0)}for(var a=t.start;a<t.end;a++){var i=r.getItemLayout(a);if(Ru(i)){var o=new this._LineCtor(r,a,this._seriesScope);o.traverse(n),this.group.add(o),r.setItemGraphicEl(a,o),this._progressiveEls.push(o)}}},e.prototype.remove=function(){this.group.removeAll()},e.prototype.eachRendered=function(t){Rl(this._progressiveEls||this.group,t)},e.prototype._doAdd=function(t,r,n){var a=t.getItemLayout(r);if(Ru(a)){var i=new this._LineCtor(t,r,n);t.setItemGraphicEl(r,i),this.group.add(i)}},e.prototype._doUpdate=function(t,r,n,a,i){var o=t.getItemGraphicEl(n);if(!Ru(r.getItemLayout(a))){this.group.remove(o);return}o?o.updateData(r,a,i):o=new this._LineCtor(r,a,i),r.setItemGraphicEl(a,o),this.group.add(o)},e}();function Nw(e){return e.animators&&e.animators.length>0}function Yv(e){var t=e.hostModel,r=t.getModel("emphasis");return{lineStyle:t.getModel("lineStyle").getLineStyle(),emphasisLineStyle:r.getModel(["lineStyle"]).getLineStyle(),blurLineStyle:t.getModel(["blur","lineStyle"]).getLineStyle(),selectLineStyle:t.getModel(["select","lineStyle"]).getLineStyle(),emphasisDisabled:r.get("disabled"),blurScope:r.get("blurScope"),focus:r.get("focus"),labelStatesModels:wr(t)}}function qv(e){return isNaN(e[0])||isNaN(e[1])}function Ru(e){return e&&!qv(e[0])&&!qv(e[1])}const Pf=Rw;var Nu=[],Ou=[],Bu=[],Aa=dm,Fu=qS,Kv=Math.abs;function Jv(e,t,r){for(var n=e[0],a=e[1],i=e[2],o=1/0,s,l=r*r,u=.1,c=.1;c<=.9;c+=.1){Nu[0]=Aa(n[0],a[0],i[0],c),Nu[1]=Aa(n[1],a[1],i[1],c);var h=Kv(Fu(Nu,t)-l);h<o&&(o=h,s=c)}for(var f=0;f<32;f++){var d=s+u;Ou[0]=Aa(n[0],a[0],i[0],s),Ou[1]=Aa(n[1],a[1],i[1],s),Bu[0]=Aa(n[0],a[0],i[0],d),Bu[1]=Aa(n[1],a[1],i[1],d);var h=Fu(Ou,t)-l;if(Kv(h)<.01)break;var v=Fu(Bu,t)-l;u/=2,h<0?v>=0?s=s+u:s=s-u:v>=0?s=s-u:s=s+u}return s}function zu(e,t){var r=[],n=YS,a=[[],[],[]],i=[[],[]],o=[];t/=2,e.eachEdge(function(s,l){var u=s.getLayout(),c=s.getVisual("fromSymbol"),h=s.getVisual("toSymbol");u.__original||(u.__original=[En(u[0]),En(u[1])],u[2]&&u.__original.push(En(u[2])));var f=u.__original;if(u[2]!=null){if(er(a[0],f[0]),er(a[1],f[2]),er(a[2],f[1]),c&&c!=="none"){var d=ji(s.node1),v=Jv(a,f[0],d*t);n(a[0][0],a[1][0],a[2][0],v,r),a[0][0]=r[3],a[1][0]=r[4],n(a[0][1],a[1][1],a[2][1],v,r),a[0][1]=r[3],a[1][1]=r[4]}if(h&&h!=="none"){var d=ji(s.node2),v=Jv(a,f[1],d*t);n(a[0][0],a[1][0],a[2][0],v,r),a[1][0]=r[1],a[2][0]=r[2],n(a[0][1],a[1][1],a[2][1],v,r),a[1][1]=r[1],a[2][1]=r[2]}er(u[0],a[0]),er(u[1],a[2]),er(u[2],a[1])}else{if(er(i[0],f[0]),er(i[1],f[1]),Ua(o,i[1],i[0]),No(o,o),c&&c!=="none"){var d=ji(s.node1);Kc(i[0],i[0],o,d*t)}if(h&&h!=="none"){var d=ji(s.node2);Kc(i[1],i[1],o,-d*t)}er(u[0],i[0]),er(u[1],i[1])}})}function Qv(e){return e.type==="view"}var Ow=function(e){U(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.init=function(r,n){var a=new rm,i=new Pf,o=this.group;this._controller=new Dl(n.getZr()),this._controllerHost={target:o},o.add(a.group),o.add(i.group),this._symbolDraw=a,this._lineDraw=i,this._firstRender=!0},t.prototype.render=function(r,n,a){var i=this,o=r.coordinateSystem;this._model=r;var s=this._symbolDraw,l=this._lineDraw,u=this.group;if(Qv(o)){var c={x:o.x,y:o.y,scaleX:o.scaleX,scaleY:o.scaleY};this._firstRender?u.attr(c):st(u,c,r)}zu(r.getGraph(),Xi(r));var h=r.getData();s.updateData(h);var f=r.getEdgeData();l.updateData(f),this._updateNodeAndLinkScale(),this._updateController(r,n,a),clearTimeout(this._layoutTimeout);var d=r.forceLayout,v=r.get(["force","layoutAnimation"]);d&&this._startForceLayoutIteration(d,v);var p=r.get("layout");h.graph.eachNode(function(y){var x=y.dataIndex,S=y.getGraphicEl(),T=y.getModel();if(S){S.off("drag").off("dragend");var b=T.get("draggable");b&&S.on("drag",function(A){switch(p){case"force":d.warmUp(),!i._layouting&&i._startForceLayoutIteration(d,v),d.setFixed(x),h.setItemLayout(x,[S.x,S.y]);break;case"circular":h.setItemLayout(x,[S.x,S.y]),y.setLayout({fixed:!0},!0),Df(r,"symbolSize",y,[A.offsetX,A.offsetY]),i.updateLayout(r);break;case"none":default:h.setItemLayout(x,[S.x,S.y]),Lf(r.getGraph(),r),i.updateLayout(r);break}}).on("dragend",function(){d&&d.setUnfixed(x)}),S.setDraggable(b,!!T.get("cursor"));var w=T.get(["emphasis","focus"]);w==="adjacency"&&(et(S).focus=y.getAdjacentDataIndices())}}),h.graph.eachEdge(function(y){var x=y.getGraphicEl(),S=y.getModel().get(["emphasis","focus"]);x&&S==="adjacency"&&(et(x).focus={edge:[y.dataIndex],node:[y.node1.dataIndex,y.node2.dataIndex]})});var g=r.get("layout")==="circular"&&r.get(["circular","rotateLabel"]),m=h.getLayout("cx"),_=h.getLayout("cy");h.graph.eachNode(function(y){Ey(y,g,m,_)}),this._firstRender=!1},t.prototype.dispose=function(){this._controller&&this._controller.dispose(),this._controllerHost=null},t.prototype._startForceLayoutIteration=function(r,n){var a=this;(function i(){r.step(function(o){a.updateLayout(a._model),(a._layouting=!o)&&(n?a._layoutTimeout=setTimeout(i,16):i())})})()},t.prototype._updateController=function(r,n,a){var i=this,o=this._controller,s=this._controllerHost,l=this.group;if(o.setPointerChecker(function(u,c,h){var f=l.getBoundingRect();return f.applyTransform(l.transform),f.contain(c,h)&&!nf(u,a,r)}),!Qv(r.coordinateSystem)){o.disable();return}o.enable(r.get("roam")),s.zoomLimit=r.get("scaleLimit"),s.zoom=r.coordinateSystem.getZoom(),o.off("pan").off("zoom").on("pan",function(u){am(s,u.dx,u.dy),a.dispatchAction({seriesId:r.id,type:"graphRoam",dx:u.dx,dy:u.dy})}).on("zoom",function(u){im(s,u.scale,u.originX,u.originY),a.dispatchAction({seriesId:r.id,type:"graphRoam",zoom:u.scale,originX:u.originX,originY:u.originY}),i._updateNodeAndLinkScale(),zu(r.getGraph(),Xi(r)),i._lineDraw.updateLayout(),a.updateLabelLayout()})},t.prototype._updateNodeAndLinkScale=function(){var r=this._model,n=r.getData(),a=Xi(r);n.eachItemGraphicEl(function(i,o){i&&i.setSymbolScale(a)})},t.prototype.updateLayout=function(r){zu(r.getGraph(),Xi(r)),this._symbolDraw.updateLayout(),this._lineDraw.updateLayout()},t.prototype.remove=function(r,n){this._symbolDraw&&this._symbolDraw.remove(),this._lineDraw&&this._lineDraw.remove()},t.type="graph",t}(He);const Bw=Ow;function Ea(e){return"_EC_"+e}var Fw=function(){function e(t){this.type="graph",this.nodes=[],this.edges=[],this._nodesMap={},this._edgesMap={},this._directed=t||!1}return e.prototype.isDirected=function(){return this._directed},e.prototype.addNode=function(t,r){t=t==null?""+r:""+t;var n=this._nodesMap;if(!n[Ea(t)]){var a=new Kn(t,r);return a.hostGraph=this,this.nodes.push(a),n[Ea(t)]=a,a}},e.prototype.getNodeByIndex=function(t){var r=this.data.getRawIndex(t);return this.nodes[r]},e.prototype.getNodeById=function(t){return this._nodesMap[Ea(t)]},e.prototype.addEdge=function(t,r,n){var a=this._nodesMap,i=this._edgesMap;if(Mr(t)&&(t=this.nodes[t]),Mr(r)&&(r=this.nodes[r]),t instanceof Kn||(t=a[Ea(t)]),r instanceof Kn||(r=a[Ea(r)]),!(!t||!r)){var o=t.id+"-"+r.id,s=new Ly(t,r,n);return s.hostGraph=this,this._directed&&(t.outEdges.push(s),r.inEdges.push(s)),t.edges.push(s),t!==r&&r.edges.push(s),this.edges.push(s),i[o]=s,s}},e.prototype.getEdgeByIndex=function(t){var r=this.edgeData.getRawIndex(t);return this.edges[r]},e.prototype.getEdge=function(t,r){t instanceof Kn&&(t=t.id),r instanceof Kn&&(r=r.id);var n=this._edgesMap;return this._directed?n[t+"-"+r]:n[t+"-"+r]||n[r+"-"+t]},e.prototype.eachNode=function(t,r){for(var n=this.nodes,a=n.length,i=0;i<a;i++)n[i].dataIndex>=0&&t.call(r,n[i],i)},e.prototype.eachEdge=function(t,r){for(var n=this.edges,a=n.length,i=0;i<a;i++)n[i].dataIndex>=0&&n[i].node1.dataIndex>=0&&n[i].node2.dataIndex>=0&&t.call(r,n[i],i)},e.prototype.breadthFirstTraverse=function(t,r,n,a){if(r instanceof Kn||(r=this._nodesMap[Ea(r)]),!!r){for(var i=n==="out"?"outEdges":n==="in"?"inEdges":"edges",o=0;o<this.nodes.length;o++)this.nodes[o].__visited=!1;if(!t.call(a,r,null))for(var s=[r];s.length;)for(var l=s.shift(),u=l[i],o=0;o<u.length;o++){var c=u[o],h=c.node1===l?c.node2:c.node1;if(!h.__visited){if(t.call(a,h,l))return;s.push(h),h.__visited=!0}}}},e.prototype.update=function(){for(var t=this.data,r=this.edgeData,n=this.nodes,a=this.edges,i=0,o=n.length;i<o;i++)n[i].dataIndex=-1;for(var i=0,o=t.count();i<o;i++)n[t.getRawIndex(i)].dataIndex=i;r.filterSelf(function(s){var l=a[r.getRawIndex(s)];return l.node1.dataIndex>=0&&l.node2.dataIndex>=0});for(var i=0,o=a.length;i<o;i++)a[i].dataIndex=-1;for(var i=0,o=r.count();i<o;i++)a[r.getRawIndex(i)].dataIndex=i},e.prototype.clone=function(){for(var t=new e(this._directed),r=this.nodes,n=this.edges,a=0;a<r.length;a++)t.addNode(r[a].id,r[a].dataIndex);for(var a=0;a<n.length;a++){var i=n[a];t.addEdge(i.node1.id,i.node2.id,i.dataIndex)}return t},e}(),Kn=function(){function e(t,r){this.inEdges=[],this.outEdges=[],this.edges=[],this.dataIndex=-1,this.id=t??"",this.dataIndex=r??-1}return e.prototype.degree=function(){return this.edges.length},e.prototype.inDegree=function(){return this.inEdges.length},e.prototype.outDegree=function(){return this.outEdges.length},e.prototype.getModel=function(t){if(!(this.dataIndex<0)){var r=this.hostGraph,n=r.data.getItemModel(this.dataIndex);return n.getModel(t)}},e.prototype.getAdjacentDataIndices=function(){for(var t={edge:[],node:[]},r=0;r<this.edges.length;r++){var n=this.edges[r];n.dataIndex<0||(t.edge.push(n.dataIndex),t.node.push(n.node1.dataIndex,n.node2.dataIndex))}return t},e.prototype.getTrajectoryDataIndices=function(){for(var t=ot(),r=ot(),n=0;n<this.edges.length;n++){var a=this.edges[n];if(!(a.dataIndex<0)){t.set(a.dataIndex,!0);for(var i=[a.node1],o=[a.node2],s=0;s<i.length;){var l=i[s];s++,r.set(l.dataIndex,!0);for(var u=0;u<l.inEdges.length;u++)t.set(l.inEdges[u].dataIndex,!0),i.push(l.inEdges[u].node1)}for(s=0;s<o.length;){var c=o[s];s++,r.set(c.dataIndex,!0);for(var u=0;u<c.outEdges.length;u++)t.set(c.outEdges[u].dataIndex,!0),o.push(c.outEdges[u].node2)}}}return{edge:t.keys(),node:r.keys()}},e}(),Ly=function(){function e(t,r,n){this.dataIndex=-1,this.node1=t,this.node2=r,this.dataIndex=n??-1}return e.prototype.getModel=function(t){if(!(this.dataIndex<0)){var r=this.hostGraph,n=r.edgeData.getItemModel(this.dataIndex);return n.getModel(t)}},e.prototype.getAdjacentDataIndices=function(){return{edge:[this.dataIndex],node:[this.node1.dataIndex,this.node2.dataIndex]}},e.prototype.getTrajectoryDataIndices=function(){var t=ot(),r=ot();t.set(this.dataIndex,!0);for(var n=[this.node1],a=[this.node2],i=0;i<n.length;){var o=n[i];i++,r.set(o.dataIndex,!0);for(var s=0;s<o.inEdges.length;s++)t.set(o.inEdges[s].dataIndex,!0),n.push(o.inEdges[s].node1)}for(i=0;i<a.length;){var l=a[i];i++,r.set(l.dataIndex,!0);for(var s=0;s<l.outEdges.length;s++)t.set(l.outEdges[s].dataIndex,!0),a.push(l.outEdges[s].node2)}return{edge:t.keys(),node:r.keys()}},e}();function Dy(e,t){return{getValue:function(r){var n=this[e][t];return n.getStore().get(n.getDimensionIndex(r||"value"),this.dataIndex)},setVisual:function(r,n){this.dataIndex>=0&&this[e][t].setItemVisual(this.dataIndex,r,n)},getVisual:function(r){return this[e][t].getItemVisual(this.dataIndex,r)},setLayout:function(r,n){this.dataIndex>=0&&this[e][t].setItemLayout(this.dataIndex,r,n)},getLayout:function(){return this[e][t].getItemLayout(this.dataIndex)},getGraphicEl:function(){return this[e][t].getItemGraphicEl(this.dataIndex)},getRawIndex:function(){return this[e][t].getRawIndex(this.dataIndex)}}}Xr(Kn,Dy("hostGraph","data"));Xr(Ly,Dy("hostGraph","edgeData"));const My=Fw;function Py(e,t,r,n,a){for(var i=new My(n),o=0;o<e.length;o++)i.addNode(Lr(e[o].id,e[o].name,o),o);for(var s=[],l=[],u=0,o=0;o<t.length;o++){var c=t[o],h=c.source,f=c.target;i.addEdge(h,f,u)&&(l.push(c),s.push(Lr(Qr(c.id,null),h+" > "+f)),u++)}var d=r.get("coordinateSystem"),v;if(d==="cartesian2d"||d==="polar")v=ui(e,r);else{var p=vm.get(d),g=p?p.dimensions||[]:[];pt(g,"value")<0&&g.concat(["value"]);var m=af(e,{coordDimensions:g,encodeDefine:r.getEncode()}).dimensions;v=new it(m,r),v.initData(e)}var _=new it(["value"],r);return _.initData(l,s),a&&a(v,_),Tf({mainData:v,struct:i,structAttr:"graph",datas:{node:v,edge:_},datasAttr:{node:"data",edge:"edgeData"}}),i.update(),i}var zw=function(e){U(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r.hasSymbolVisual=!0,r}return t.prototype.init=function(r){e.prototype.init.apply(this,arguments);var n=this;function a(){return n._categoriesData}this.legendVisualProvider=new El(a,a),this.fillDataTextStyle(r.edges||r.links),this._updateCategoriesData()},t.prototype.mergeOption=function(r){e.prototype.mergeOption.apply(this,arguments),this.fillDataTextStyle(r.edges||r.links),this._updateCategoriesData()},t.prototype.mergeDefaultAndTheme=function(r){e.prototype.mergeDefaultAndTheme.apply(this,arguments),pm(r,"edgeLabel",["show"])},t.prototype.getInitialData=function(r,n){var a=r.edges||r.links||[],i=r.data||r.nodes||[],o=this;if(i&&a){xw(this);var s=Py(i,a,this,!0,l);return R(s.edges,function(u){Sw(u.node1,u.node2,this,u.dataIndex)},this),s.data}function l(u,c){u.wrapMethod("getItemModel",function(v){var p=o._categoriesModels,g=v.getShallow("category"),m=p[g];return m&&(m.parentModel=v.parentModel,v.parentModel=m),v});var h=Ft.prototype.getModel;function f(v,p){var g=h.call(this,v,p);return g.resolveParentPath=d,g}c.wrapMethod("getItemModel",function(v){return v.resolveParentPath=d,v.getModel=f,v});function d(v){if(v&&(v[0]==="label"||v[1]==="label")){var p=v.slice();return v[0]==="label"?p[0]="edgeLabel":v[1]==="label"&&(p[1]="edgeLabel"),p}return v}}},t.prototype.getGraph=function(){return this.getData().graph},t.prototype.getEdgeData=function(){return this.getGraph().edgeData},t.prototype.getCategoriesData=function(){return this._categoriesData},t.prototype.formatTooltip=function(r,n,a){if(a==="edge"){var i=this.getData(),o=this.getDataParams(r,a),s=i.graph.getEdgeByIndex(r),l=i.getName(s.node1.dataIndex),u=i.getName(s.node2.dataIndex),c=[];return l!=null&&c.push(l),u!=null&&c.push(u),$r("nameValue",{name:c.join(" > "),value:o.value,noValue:o.value==null})}var h=KS({series:this,dataIndex:r,multipleSeries:n});return h},t.prototype._updateCategoriesData=function(){var r=K(this.option.categories||[],function(a){return a.value!=null?a:le({value:0},a)}),n=new it(["value"],this);n.initData(r),this._categoriesData=n,this._categoriesModels=n.mapArray(function(a){return n.getItemModel(a)})},t.prototype.setZoom=function(r){this.option.zoom=r},t.prototype.setCenter=function(r){this.option.center=r},t.prototype.isAnimationEnabled=function(){return e.prototype.isAnimationEnabled.call(this)&&!(this.get("layout")==="force"&&this.get(["force","layoutAnimation"]))},t.type="series.graph",t.dependencies=["grid","polar","geo","singleAxis","calendar"],t.defaultOption={z:2,coordinateSystem:"view",legendHoverLink:!0,layout:null,circular:{rotateLabel:!1},force:{initLayout:null,repulsion:[0,50],gravity:.1,friction:.6,edgeLength:30,layoutAnimation:!0},left:"center",top:"center",symbol:"circle",symbolSize:10,edgeSymbol:["none","none"],edgeSymbolSize:10,edgeLabel:{position:"middle",distance:5},draggable:!1,roam:!1,center:null,zoom:1,nodeScaleRatio:.6,label:{show:!1,formatter:"{b}"},itemStyle:{},lineStyle:{color:"#aaa",width:1,opacity:.5},emphasis:{scale:!0,label:{show:!0}},select:{itemStyle:{borderColor:"#212121"}}},t}($e);const Gw=zw;var Vw={type:"graphRoam",event:"graphRoam",update:"none"};function Uw(e){e.registerChartView(Bw),e.registerSeriesModel(Gw),e.registerProcessor(pw),e.registerVisual(gw),e.registerVisual(mw),e.registerLayout(Tw),e.registerLayout(e.PRIORITY.VISUAL.POST_CHART_LAYOUT,ww),e.registerLayout(Ew),e.registerCoordinateSystem("graphView",{dimensions:rf.dimensions,create:Lw}),e.registerAction({type:"focusNodeAdjacency",event:"focusNodeAdjacency",update:"series:focusNodeAdjacency"},Ya),e.registerAction({type:"unfocusNodeAdjacency",event:"unfocusNodeAdjacency",update:"series:unfocusNodeAdjacency"},Ya),e.registerAction(Vw,function(t,r,n){r.eachComponent({mainType:"series",query:t},function(a){var i=a.coordinateSystem,o=sm(i,t,void 0,n);a.setCenter&&a.setCenter(o.center),a.setZoom&&a.setZoom(o.zoom)})})}var kw=function(){function e(){this.angle=0,this.width=10,this.r=10,this.x=0,this.y=0}return e}(),Hw=function(e){U(t,e);function t(r){var n=e.call(this,r)||this;return n.type="pointer",n}return t.prototype.getDefaultShape=function(){return new kw},t.prototype.buildPath=function(r,n){var a=Math.cos,i=Math.sin,o=n.r,s=n.width,l=n.angle,u=n.x-a(l)*s*(s>=o/3?1:2),c=n.y-i(l)*s*(s>=o/3?1:2);l=n.angle-Math.PI/2,r.moveTo(u,c),r.lineTo(n.x+a(l)*s,n.y+i(l)*s),r.lineTo(n.x+a(n.angle)*o,n.y+i(n.angle)*o),r.lineTo(n.x-a(l)*s,n.y-i(l)*s),r.lineTo(u,c)},t}(Gt);const Ww=Hw;function $w(e,t){var r=e.get("center"),n=t.getWidth(),a=t.getHeight(),i=Math.min(n,a),o=ee(r[0],t.getWidth()),s=ee(r[1],t.getHeight()),l=ee(e.get("radius"),i/2);return{cx:o,cy:s,r:l}}function ts(e,t){var r=e==null?"":e+"";return t&&(Ve(t)?r=t.replace("{value}",r):xt(t)&&(r=t(e))),r}var Xw=function(e){U(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.render=function(r,n,a){this.group.removeAll();var i=r.get(["axisLine","lineStyle","color"]),o=$w(r,a);this._renderMain(r,n,a,i,o),this._data=r.getData()},t.prototype.dispose=function(){},t.prototype._renderMain=function(r,n,a,i,o){var s=this.group,l=r.get("clockwise"),u=-r.get("startAngle")/180*Math.PI,c=-r.get("endAngle")/180*Math.PI,h=r.getModel("axisLine"),f=h.get("roundCap"),d=f?ev:da,v=h.get("show"),p=h.getModel("lineStyle"),g=p.get("width"),m=[u,c];JS(m,!l),u=m[0],c=m[1];for(var _=c-u,y=u,x=[],S=0;v&&S<i.length;S++){var T=Math.min(Math.max(i[S][0],0),1);c=u+_*T;var b=new d({shape:{startAngle:y,endAngle:c,cx:o.cx,cy:o.cy,clockwise:l,r0:o.r-g,r:o.r},silent:!0});b.setStyle({fill:i[S][1]}),b.setStyle(p.getLineStyle(["color","width"])),x.push(b),y=c}x.reverse(),R(x,function(A){return s.add(A)});var w=function(A){if(A<=0)return i[0][1];var E;for(E=0;E<i.length;E++)if(i[E][0]>=A&&(E===0?0:i[E-1][0])<A)return i[E][1];return i[E-1][1]};this._renderTicks(r,n,a,w,o,u,c,l,g),this._renderTitleAndDetail(r,n,a,w,o),this._renderAnchor(r,o),this._renderPointer(r,n,a,w,o,u,c,l,g)},t.prototype._renderTicks=function(r,n,a,i,o,s,l,u,c){for(var h=this.group,f=o.cx,d=o.cy,v=o.r,p=+r.get("min"),g=+r.get("max"),m=r.getModel("splitLine"),_=r.getModel("axisTick"),y=r.getModel("axisLabel"),x=r.get("splitNumber"),S=_.get("splitNumber"),T=ee(m.get("length"),v),b=ee(_.get("length"),v),w=s,A=(l-s)/x,E=A/S,C=m.getModel("lineStyle").getLineStyle(),M=_.getModel("lineStyle").getLineStyle(),P=m.get("distance"),L,I,N=0;N<=x;N++){if(L=Math.cos(w),I=Math.sin(w),m.get("show")){var F=P?P+c:c,B=new Gr({shape:{x1:L*(v-F)+f,y1:I*(v-F)+d,x2:L*(v-T-F)+f,y2:I*(v-T-F)+d},style:C,silent:!0});C.stroke==="auto"&&B.setStyle({stroke:i(N/x)}),h.add(B)}if(y.get("show")){var F=y.get("distance")+P,k=ts(na(N/x*(g-p)+p),y.get("formatter")),z=i(N/x),W=L*(v-T-F)+f,J=I*(v-T-F)+d,re=y.get("rotate"),Q=0;re==="radial"?(Q=-w+2*Math.PI,Q>Math.PI/2&&(Q+=Math.PI)):re==="tangential"?Q=-w-Math.PI/2:Mr(re)&&(Q=re*Math.PI/180),Q===0?h.add(new rt({style:ft(y,{text:k,x:W,y:J,verticalAlign:I<-.8?"top":I>.8?"bottom":"middle",align:L<-.4?"left":L>.4?"right":"center"},{inheritColor:z}),silent:!0})):h.add(new rt({style:ft(y,{text:k,x:W,y:J,verticalAlign:"middle",align:"center"},{inheritColor:z}),silent:!0,originX:W,originY:J,rotation:Q}))}if(_.get("show")&&N!==x){var F=_.get("distance");F=F?F+c:c;for(var q=0;q<=S;q++){L=Math.cos(w),I=Math.sin(w);var Ee=new Gr({shape:{x1:L*(v-F)+f,y1:I*(v-F)+d,x2:L*(v-b-F)+f,y2:I*(v-b-F)+d},silent:!0,style:M});M.stroke==="auto"&&Ee.setStyle({stroke:i((N+q/S)/x)}),h.add(Ee),w+=E}w-=E}else w+=A}},t.prototype._renderPointer=function(r,n,a,i,o,s,l,u,c){var h=this.group,f=this._data,d=this._progressEls,v=[],p=r.get(["pointer","show"]),g=r.getModel("progress"),m=g.get("show"),_=r.getData(),y=_.mapDimension("value"),x=+r.get("min"),S=+r.get("max"),T=[x,S],b=[s,l];function w(E,C){var M=_.getItemModel(E),P=M.getModel("pointer"),L=ee(P.get("width"),o.r),I=ee(P.get("length"),o.r),N=r.get(["pointer","icon"]),F=P.get("offsetCenter"),B=ee(F[0],o.r),k=ee(F[1],o.r),z=P.get("keepAspect"),W;return N?W=Pr(N,B-L/2,k-I,L,I,null,z):W=new Ww({shape:{angle:-Math.PI/2,width:L,r:I,x:B,y:k}}),W.rotation=-(C+Math.PI/2),W.x=o.cx,W.y=o.cy,W}function A(E,C){var M=g.get("roundCap"),P=M?ev:da,L=g.get("overlap"),I=L?g.get("width"):c/_.count(),N=L?o.r-I:o.r-(E+1)*I,F=L?o.r:o.r-E*I,B=new P({shape:{startAngle:s,endAngle:C,cx:o.cx,cy:o.cy,clockwise:u,r0:N,r:F}});return L&&(B.z2=S-_.get(y,E)%S),B}(m||p)&&(_.diff(f).add(function(E){var C=_.get(y,E);if(p){var M=w(E,s);ar(M,{rotation:-((isNaN(+C)?b[0]:Ye(C,T,b,!0))+Math.PI/2)},r),h.add(M),_.setItemGraphicEl(E,M)}if(m){var P=A(E,s),L=g.get("clip");ar(P,{shape:{endAngle:Ye(C,T,b,L)}},r),h.add(P),Qd(r.seriesIndex,_.dataType,E,P),v[E]=P}}).update(function(E,C){var M=_.get(y,E);if(p){var P=f.getItemGraphicEl(C),L=P?P.rotation:s,I=w(E,L);I.rotation=L,st(I,{rotation:-((isNaN(+M)?b[0]:Ye(M,T,b,!0))+Math.PI/2)},r),h.add(I),_.setItemGraphicEl(E,I)}if(m){var N=d[C],F=N?N.shape.endAngle:s,B=A(E,F),k=g.get("clip");st(B,{shape:{endAngle:Ye(M,T,b,k)}},r),h.add(B),Qd(r.seriesIndex,_.dataType,E,B),v[E]=B}}).execute(),_.each(function(E){var C=_.getItemModel(E),M=C.getModel("emphasis"),P=M.get("focus"),L=M.get("blurScope"),I=M.get("disabled");if(p){var N=_.getItemGraphicEl(E),F=_.getItemVisual(E,"style"),B=F.fill;if(N instanceof un){var k=N.style;N.useStyle(le({image:k.image,x:k.x,y:k.y,width:k.width,height:k.height},F))}else N.useStyle(F),N.type!=="pointer"&&N.setColor(B);N.setStyle(C.getModel(["pointer","itemStyle"]).getItemStyle()),N.style.fill==="auto"&&N.setStyle("fill",i(Ye(_.get(y,E),T,[0,1],!0))),N.z2EmphasisLift=0,ur(N,C),zt(N,P,L,I)}if(m){var z=v[E];z.useStyle(_.getItemVisual(E,"style")),z.setStyle(C.getModel(["progress","itemStyle"]).getItemStyle()),z.z2EmphasisLift=0,ur(z,C),zt(z,P,L,I)}}),this._progressEls=v)},t.prototype._renderAnchor=function(r,n){var a=r.getModel("anchor"),i=a.get("show");if(i){var o=a.get("size"),s=a.get("icon"),l=a.get("offsetCenter"),u=a.get("keepAspect"),c=Pr(s,n.cx-o/2+ee(l[0],n.r),n.cy-o/2+ee(l[1],n.r),o,o,null,u);c.z2=a.get("showAbove")?1:0,c.setStyle(a.getModel("itemStyle").getItemStyle()),this.group.add(c)}},t.prototype._renderTitleAndDetail=function(r,n,a,i,o){var s=this,l=r.getData(),u=l.mapDimension("value"),c=+r.get("min"),h=+r.get("max"),f=new Fe,d=[],v=[],p=r.isAnimationEnabled(),g=r.get(["pointer","showAbove"]);l.diff(this._data).add(function(m){d[m]=new rt({silent:!0}),v[m]=new rt({silent:!0})}).update(function(m,_){d[m]=s._titleEls[_],v[m]=s._detailEls[_]}).execute(),l.each(function(m){var _=l.getItemModel(m),y=l.get(u,m),x=new Fe,S=i(Ye(y,[c,h],[0,1],!0)),T=_.getModel("title");if(T.get("show")){var b=T.get("offsetCenter"),w=o.cx+ee(b[0],o.r),A=o.cy+ee(b[1],o.r),E=d[m];E.attr({z2:g?0:2,style:ft(T,{x:w,y:A,text:l.getName(m),align:"center",verticalAlign:"middle"},{inheritColor:S})}),x.add(E)}var C=_.getModel("detail");if(C.get("show")){var M=C.get("offsetCenter"),P=o.cx+ee(M[0],o.r),L=o.cy+ee(M[1],o.r),I=ee(C.get("width"),o.r),N=ee(C.get("height"),o.r),F=r.get(["progress","show"])?l.getItemVisual(m,"style").fill:S,E=v[m],B=C.get("formatter");E.attr({z2:g?0:2,style:ft(C,{x:P,y:L,text:ts(y,B),width:isNaN(I)?null:I,height:isNaN(N)?null:N,align:"center",verticalAlign:"middle"},{inheritColor:F})}),QS(E,{normal:C},y,function(z){return ts(z,B)}),p&&q0(E,m,l,r,{getFormattedLabel:function(z,W,J,re,Q,q){return ts(q?q.interpolatedValue:y,B)}}),x.add(E)}f.add(x)}),this.group.add(f),this._titleEls=d,this._detailEls=v},t.type="gauge",t}(He);const jw=Xw;var Zw=function(e){U(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r.visualStyleAccessPath="itemStyle",r}return t.prototype.getInitialData=function(r,n){return Cl(this,["value"])},t.type="series.gauge",t.defaultOption={z:2,colorBy:"data",center:["50%","50%"],legendHoverLink:!0,radius:"75%",startAngle:225,endAngle:-45,clockwise:!0,min:0,max:100,splitNumber:10,axisLine:{show:!0,roundCap:!1,lineStyle:{color:[[1,"#E6EBF8"]],width:10}},progress:{show:!1,overlap:!0,width:10,roundCap:!1,clip:!0},splitLine:{show:!0,length:10,distance:10,lineStyle:{color:"#63677A",width:3,type:"solid"}},axisTick:{show:!0,splitNumber:5,length:6,distance:10,lineStyle:{color:"#63677A",width:1,type:"solid"}},axisLabel:{show:!0,distance:15,color:"#464646",fontSize:12,rotate:0},pointer:{icon:null,offsetCenter:[0,0],show:!0,showAbove:!0,length:"60%",width:6,keepAspect:!1},anchor:{show:!1,showAbove:!1,size:6,icon:"circle",offsetCenter:[0,0],keepAspect:!1,itemStyle:{color:"#fff",borderWidth:0,borderColor:"#5470c6"}},title:{show:!0,offsetCenter:[0,"20%"],color:"#464646",fontSize:16,valueAnimation:!1},detail:{show:!0,backgroundColor:"rgba(0,0,0,0)",borderWidth:0,borderColor:"#ccc",width:100,height:null,padding:[5,10],offsetCenter:[0,"40%"],color:"#464646",fontSize:30,fontWeight:"bold",lineHeight:30,valueAnimation:!1}},t}($e);const Yw=Zw;function qw(e){e.registerChartView(jw),e.registerSeriesModel(Yw)}var Kw=["itemStyle","opacity"],Jw=function(e){U(t,e);function t(r,n){var a=e.call(this)||this,i=a,o=new Nn,s=new rt;return i.setTextContent(s),a.setTextGuideLine(o),a.updateData(r,n,!0),a}return t.prototype.updateData=function(r,n,a){var i=this,o=r.hostModel,s=r.getItemModel(n),l=r.getItemLayout(n),u=s.getModel("emphasis"),c=s.get(Kw);c=c??1,a||Ln(i),i.useStyle(r.getItemVisual(n,"style")),i.style.lineJoin="round",a?(i.setShape({points:l.points}),i.style.opacity=0,ar(i,{style:{opacity:c}},o,n)):st(i,{style:{opacity:c},shape:{points:l.points}},o,n),ur(i,s),this._updateLabel(r,n),zt(this,u.get("focus"),u.get("blurScope"),u.get("disabled"))},t.prototype._updateLabel=function(r,n){var a=this,i=this.getTextGuideLine(),o=a.getTextContent(),s=r.hostModel,l=r.getItemModel(n),u=r.getItemLayout(n),c=u.label,h=r.getItemVisual(n,"style"),f=h.fill;Wr(o,wr(l),{labelFetcher:r.hostModel,labelDataIndex:n,defaultOpacity:h.opacity,defaultText:r.getName(n)},{normal:{align:c.textAlign,verticalAlign:c.verticalAlign}}),a.setTextConfig({local:!0,inside:!!c.inside,insideStroke:f,outsideFill:f});var d=c.linePoints;i.setShape({points:d}),a.textGuideLineConfig={anchor:d?new en(d[0][0],d[0][1]):null},st(o,{style:{x:c.x,y:c.y}},s,n),o.attr({rotation:c.rotation,originX:c.x,originY:c.y,z2:10}),Z0(a,Y0(l),{stroke:f})},t}(on),Qw=function(e){U(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r.ignoreLabelLineUpdate=!0,r}return t.prototype.render=function(r,n,a){var i=r.getData(),o=this._data,s=this.group;i.diff(o).add(function(l){var u=new Jw(i,l);i.setItemGraphicEl(l,u),s.add(u)}).update(function(l,u){var c=o.getItemGraphicEl(u);c.updateData(i,l),s.add(c),i.setItemGraphicEl(l,c)}).remove(function(l){var u=o.getItemGraphicEl(l);eT(u,r,l)}).execute(),this._data=i},t.prototype.remove=function(){this.group.removeAll(),this._data=null},t.prototype.dispose=function(){},t.type="funnel",t}(He);const eA=Qw;var tA=function(e){U(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.init=function(r){e.prototype.init.apply(this,arguments),this.legendVisualProvider=new El(me(this.getData,this),me(this.getRawData,this)),this._defaultLabelLine(r)},t.prototype.getInitialData=function(r,n){return Cl(this,{coordDimensions:["value"],encodeDefaulter:Ge(tT,this)})},t.prototype._defaultLabelLine=function(r){pm(r,"labelLine",["show"]);var n=r.labelLine,a=r.emphasis.labelLine;n.show=n.show&&r.label.show,a.show=a.show&&r.emphasis.label.show},t.prototype.getDataParams=function(r){var n=this.getData(),a=e.prototype.getDataParams.call(this,r),i=n.mapDimension("value"),o=n.getSum(i);return a.percent=o?+(n.get(i,r)/o*100).toFixed(2):0,a.$vars.push("percent"),a},t.type="series.funnel",t.defaultOption={z:2,legendHoverLink:!0,colorBy:"data",left:80,top:60,right:80,bottom:60,minSize:"0%",maxSize:"100%",sort:"descending",orient:"vertical",gap:0,funnelAlign:"center",label:{show:!0,position:"outer"},labelLine:{show:!0,length:20,lineStyle:{width:1}},itemStyle:{borderColor:"#fff",borderWidth:1},emphasis:{label:{show:!0}},select:{itemStyle:{borderColor:"#212121"}}},t}($e);const rA=tA;function nA(e,t){return sr(e.getBoxLayoutParams(),{width:t.getWidth(),height:t.getHeight()})}function aA(e,t){for(var r=e.mapDimension("value"),n=e.mapArray(r,function(l){return l}),a=[],i=t==="ascending",o=0,s=e.count();o<s;o++)a[o]=o;return xt(t)?a.sort(t):t!=="none"&&a.sort(function(l,u){return i?n[l]-n[u]:n[u]-n[l]}),a}function iA(e){var t=e.hostModel,r=t.get("orient");e.each(function(n){var a=e.getItemModel(n),i=a.getModel("label"),o=i.get("position"),s=a.getModel("labelLine"),l=e.getItemLayout(n),u=l.points,c=o==="inner"||o==="inside"||o==="center"||o==="insideLeft"||o==="insideRight",h,f,d,v;if(c)o==="insideLeft"?(f=(u[0][0]+u[3][0])/2+5,d=(u[0][1]+u[3][1])/2,h="left"):o==="insideRight"?(f=(u[1][0]+u[2][0])/2-5,d=(u[1][1]+u[2][1])/2,h="right"):(f=(u[0][0]+u[1][0]+u[2][0]+u[3][0])/4,d=(u[0][1]+u[1][1]+u[2][1]+u[3][1])/4,h="center"),v=[[f,d],[f,d]];else{var p=void 0,g=void 0,m=void 0,_=void 0,y=s.get("length");o==="left"?(p=(u[3][0]+u[0][0])/2,g=(u[3][1]+u[0][1])/2,m=p-y,f=m-5,h="right"):o==="right"?(p=(u[1][0]+u[2][0])/2,g=(u[1][1]+u[2][1])/2,m=p+y,f=m+5,h="left"):o==="top"?(p=(u[3][0]+u[0][0])/2,g=(u[3][1]+u[0][1])/2,_=g-y,d=_-5,h="center"):o==="bottom"?(p=(u[1][0]+u[2][0])/2,g=(u[1][1]+u[2][1])/2,_=g+y,d=_+5,h="center"):o==="rightTop"?(p=r==="horizontal"?u[3][0]:u[1][0],g=r==="horizontal"?u[3][1]:u[1][1],r==="horizontal"?(_=g-y,d=_-5,h="center"):(m=p+y,f=m+5,h="top")):o==="rightBottom"?(p=u[2][0],g=u[2][1],r==="horizontal"?(_=g+y,d=_+5,h="center"):(m=p+y,f=m+5,h="bottom")):o==="leftTop"?(p=u[0][0],g=r==="horizontal"?u[0][1]:u[1][1],r==="horizontal"?(_=g-y,d=_-5,h="center"):(m=p-y,f=m-5,h="right")):o==="leftBottom"?(p=r==="horizontal"?u[1][0]:u[3][0],g=r==="horizontal"?u[1][1]:u[2][1],r==="horizontal"?(_=g+y,d=_+5,h="center"):(m=p-y,f=m-5,h="right")):(p=(u[1][0]+u[2][0])/2,g=(u[1][1]+u[2][1])/2,r==="horizontal"?(_=g+y,d=_+5,h="center"):(m=p+y,f=m+5,h="left")),r==="horizontal"?(m=p,f=m):(_=g,d=_),v=[[p,g],[m,_]]}l.label={linePoints:v,x:f,y:d,verticalAlign:"middle",textAlign:h,inside:c}})}function oA(e,t){e.eachSeriesByType("funnel",function(r){var n=r.getData(),a=n.mapDimension("value"),i=r.get("sort"),o=nA(r,t),s=r.get("orient"),l=o.width,u=o.height,c=aA(n,i),h=o.x,f=o.y,d=s==="horizontal"?[ee(r.get("minSize"),u),ee(r.get("maxSize"),u)]:[ee(r.get("minSize"),l),ee(r.get("maxSize"),l)],v=n.getDataExtent(a),p=r.get("min"),g=r.get("max");p==null&&(p=Math.min(v[0],0)),g==null&&(g=v[1]);var m=r.get("funnelAlign"),_=r.get("gap"),y=s==="horizontal"?l:u,x=(y-_*(n.count()-1))/n.count(),S=function(L,I){if(s==="horizontal"){var N=n.get(a,L)||0,F=Ye(N,[p,g],d,!0),B=void 0;switch(m){case"top":B=f;break;case"center":B=f+(u-F)/2;break;case"bottom":B=f+(u-F);break}return[[I,B],[I,B+F]]}var k=n.get(a,L)||0,z=Ye(k,[p,g],d,!0),W;switch(m){case"left":W=h;break;case"center":W=h+(l-z)/2;break;case"right":W=h+l-z;break}return[[W,I],[W+z,I]]};i==="ascending"&&(x=-x,_=-_,s==="horizontal"?h+=l:f+=u,c=c.reverse());for(var T=0;T<c.length;T++){var b=c[T],w=c[T+1],A=n.getItemModel(b);if(s==="horizontal"){var E=A.get(["itemStyle","width"]);E==null?E=x:(E=ee(E,l),i==="ascending"&&(E=-E));var C=S(b,h),M=S(w,h+E);h+=E+_,n.setItemLayout(b,{points:C.concat(M.slice().reverse())})}else{var P=A.get(["itemStyle","height"]);P==null?P=x:(P=ee(P,u),i==="ascending"&&(P=-P));var C=S(b,f),M=S(w,f+P);f+=P+_,n.setItemLayout(b,{points:C.concat(M.slice().reverse())})}}iA(n)})}function sA(e){e.registerChartView(eA),e.registerSeriesModel(rA),e.registerLayout(oA),e.registerProcessor(Ll("funnel"))}var lA=.3,uA=function(e){U(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r._dataGroup=new Fe,r._initialized=!1,r}return t.prototype.init=function(){this.group.add(this._dataGroup)},t.prototype.render=function(r,n,a,i){this._progressiveEls=null;var o=this._dataGroup,s=r.getData(),l=this._data,u=r.coordinateSystem,c=u.dimensions,h=tp(r);s.diff(l).add(f).update(d).remove(v).execute();function f(g){var m=ep(s,o,g,c,u);Gu(m,s,g,h)}function d(g,m){var _=l.getItemGraphicEl(m),y=Iy(s,g,c,u);s.setItemGraphicEl(g,_),st(_,{shape:{points:y}},r,g),Ln(_),Gu(_,s,g,h)}function v(g){var m=l.getItemGraphicEl(g);o.remove(m)}if(!this._initialized){this._initialized=!0;var p=cA(u,r,function(){setTimeout(function(){o.removeClipPath()})});o.setClipPath(p)}this._data=s},t.prototype.incrementalPrepareRender=function(r,n,a){this._initialized=!0,this._data=null,this._dataGroup.removeAll()},t.prototype.incrementalRender=function(r,n,a){for(var i=n.getData(),o=n.coordinateSystem,s=o.dimensions,l=tp(n),u=this._progressiveEls=[],c=r.start;c<r.end;c++){var h=ep(i,this._dataGroup,c,s,o);h.incremental=!0,Gu(h,i,c,l),u.push(h)}},t.prototype.remove=function(){this._dataGroup&&this._dataGroup.removeAll(),this._data=null},t.type="parallel",t}(He);function cA(e,t,r){var n=e.model,a=e.getRect(),i=new Et({shape:{x:a.x,y:a.y,width:a.width,height:a.height}}),o=n.get("layout")==="horizontal"?"width":"height";return i.setShape(o,0),ar(i,{shape:{width:a.width,height:a.height}},t,r),i}function Iy(e,t,r,n){for(var a=[],i=0;i<r.length;i++){var o=r[i],s=e.get(e.mapDimension(o),t);hA(s,n.getAxis(o).type)||a.push(n.dataToPoint(s,o))}return a}function ep(e,t,r,n,a){var i=Iy(e,r,n,a),o=new Nn({shape:{points:i},z2:10});return t.add(o),e.setItemGraphicEl(r,o),o}function tp(e){var t=e.get("smooth",!0);return t===!0&&(t=lA),t=rT(t),nT(t)&&(t=0),{smooth:t}}function Gu(e,t,r,n){e.useStyle(t.getItemVisual(r,"style")),e.style.fill=null,e.setShape("smooth",n.smooth);var a=t.getItemModel(r),i=a.getModel("emphasis");ur(e,a,"lineStyle"),zt(e,i.get("focus"),i.get("blurScope"),i.get("disabled"))}function hA(e,t){return t==="category"?e==null:e==null||isNaN(e)}const fA=uA;var dA=function(e){U(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r.visualStyleAccessPath="lineStyle",r.visualDrawType="stroke",r}return t.prototype.getInitialData=function(r,n){return ui(null,this,{useEncodeDefaulter:me(vA,null,this)})},t.prototype.getRawIndicesByActiveState=function(r){var n=this.coordinateSystem,a=this.getData(),i=[];return n.eachActiveState(a,function(o,s){r===o&&i.push(a.getRawIndex(s))}),i},t.type="series.parallel",t.dependencies=["parallel"],t.defaultOption={z:2,coordinateSystem:"parallel",parallelIndex:0,label:{show:!1},inactiveOpacity:.05,activeOpacity:1,lineStyle:{width:1,opacity:.45,type:"solid"},emphasis:{label:{show:!1}},progressive:500,smooth:!1,animationEasing:"linear"},t}($e);function vA(e){var t=e.ecModel.getComponent("parallel",e.get("parallelIndex"));if(t){var r={};return R(t.dimensions,function(n){var a=pA(n);r[n]=a}),r}}function pA(e){return+e.replace("dim","")}const gA=dA;var mA=["lineStyle","opacity"],yA={seriesType:"parallel",reset:function(e,t){var r=e.coordinateSystem,n={normal:e.get(["lineStyle","opacity"]),active:e.get("activeOpacity"),inactive:e.get("inactiveOpacity")};return{progress:function(a,i){r.eachActiveState(i,function(o,s){var l=n[o];if(o==="normal"&&i.hasItemOption){var u=i.getItemModel(s).get(mA,!0);u!=null&&(l=u)}var c=i.ensureUniqueItemVisual(s,"style");c.opacity=l},a.start,a.end)}}}};const _A=yA;function xA(e){SA(e),TA(e)}function SA(e){if(!e.parallel){var t=!1;R(e.series,function(r){r&&r.type==="parallel"&&(t=!0)}),t&&(e.parallel=[{}])}}function TA(e){var t=rr(e.parallelAxis);R(t,function(r){if(Hr(r)){var n=r.parallelIndex||0,a=rr(e.parallel)[n];a&&a.parallelAxisDefault&&fe(r,a.parallelAxisDefault,!1)}})}var bA=5,wA=function(e){U(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.render=function(r,n,a){this._model=r,this._api=a,this._handlers||(this._handlers={},R(AA,function(i,o){a.getZr().on(o,this._handlers[o]=me(i,this))},this)),Nl(this,"_throttledDispatchExpand",r.get("axisExpandRate"),"fixRate")},t.prototype.dispose=function(r,n){gm(this,"_throttledDispatchExpand"),R(this._handlers,function(a,i){n.getZr().off(i,a)}),this._handlers=null},t.prototype._throttledDispatchExpand=function(r){this._dispatchExpand(r)},t.prototype._dispatchExpand=function(r){r&&this._api.dispatchAction(le({type:"parallelAxisExpand"},r))},t.type="parallel",t}(kt),AA={mousedown:function(e){Vu(this,"click")&&(this._mouseDownPoint=[e.offsetX,e.offsetY])},mouseup:function(e){var t=this._mouseDownPoint;if(Vu(this,"click")&&t){var r=[e.offsetX,e.offsetY],n=Math.pow(t[0]-r[0],2)+Math.pow(t[1]-r[1],2);if(n>bA)return;var a=this._model.coordinateSystem.getSlidedAxisExpandWindow([e.offsetX,e.offsetY]);a.behavior!=="none"&&this._dispatchExpand({axisExpandWindow:a.axisExpandWindow})}this._mouseDownPoint=null},mousemove:function(e){if(!(this._mouseDownPoint||!Vu(this,"mousemove"))){var t=this._model,r=t.coordinateSystem.getSlidedAxisExpandWindow([e.offsetX,e.offsetY]),n=r.behavior;n==="jump"&&this._throttledDispatchExpand.debounceNextCall(t.get("axisExpandDebounce")),this._throttledDispatchExpand(n==="none"?null:{axisExpandWindow:r.axisExpandWindow,animation:n==="jump"?null:{duration:0}})}}};function Vu(e,t){var r=e._model;return r.get("axisExpandable")&&r.get("axisExpandTriggerOn")===t}const EA=wA;var CA=function(e){U(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.init=function(){e.prototype.init.apply(this,arguments),this.mergeOption({})},t.prototype.mergeOption=function(r){var n=this.option;r&&fe(n,r,!0),this._initDimensions()},t.prototype.contains=function(r,n){var a=r.get("parallelIndex");return a!=null&&n.getComponent("parallel",a)===this},t.prototype.setAxisExpand=function(r){R(["axisExpandable","axisExpandCenter","axisExpandCount","axisExpandWidth","axisExpandWindow"],function(n){r.hasOwnProperty(n)&&(this.option[n]=r[n])},this)},t.prototype._initDimensions=function(){var r=this.dimensions=[],n=this.parallelAxisIndex=[],a=Vt(this.ecModel.queryComponents({mainType:"parallelAxis"}),function(i){return(i.get("parallelIndex")||0)===this.componentIndex},this);R(a,function(i){r.push("dim"+i.get("dim")),n.push(i.componentIndex)})},t.type="parallel",t.dependencies=["parallelAxis"],t.layoutMode="box",t.defaultOption={z:0,left:80,top:60,right:80,bottom:60,layout:"horizontal",axisExpandable:!1,axisExpandCenter:null,axisExpandCount:0,axisExpandWidth:50,axisExpandRate:17,axisExpandDebounce:50,axisExpandSlideTriggerArea:[-.15,.05,.4],axisExpandTriggerOn:"click",parallelAxisDefault:null},t}(Ot);const LA=CA;var DA=function(e){U(t,e);function t(r,n,a,i,o){var s=e.call(this,r,n,a)||this;return s.type=i||"value",s.axisIndex=o,s}return t.prototype.isHorizontal=function(){return this.coordinateSystem.getModel().get("layout")!=="horizontal"},t}(or);const MA=DA;var Uu=R,Ry=Math.min,Ny=Math.max,rp=Math.floor,PA=Math.ceil,np=na,IA=Math.PI,RA=function(){function e(t,r,n){this.type="parallel",this._axesMap=ot(),this._axesLayout={},this.dimensions=t.dimensions,this._model=t,this._init(t,r,n)}return e.prototype._init=function(t,r,n){var a=t.dimensions,i=t.parallelAxisIndex;Uu(a,function(o,s){var l=i[s],u=r.getComponent("parallelAxis",l),c=this._axesMap.set(o,new MA(o,Tl(u),[0,0],u.get("type"),l)),h=c.type==="category";c.onBand=h&&u.get("boundaryGap"),c.inverse=u.get("inverse"),u.axis=c,c.model=u,c.coordinateSystem=u.coordinateSystem=this},this)},e.prototype.update=function(t,r){this._updateAxesFromSeries(this._model,t)},e.prototype.containPoint=function(t){var r=this._makeLayoutInfo(),n=r.axisBase,a=r.layoutBase,i=r.pixelDimIndex,o=t[1-i],s=t[i];return o>=n&&o<=n+r.axisLength&&s>=a&&s<=a+r.layoutLength},e.prototype.getModel=function(){return this._model},e.prototype._updateAxesFromSeries=function(t,r){r.eachSeries(function(n){if(t.contains(n,r)){var a=n.getData();Uu(this.dimensions,function(i){var o=this._axesMap.get(i);o.scale.unionExtentFromData(a,a.mapDimension(i)),ao(o.scale,o.model)},this)}},this)},e.prototype.resize=function(t,r){this._rect=sr(t.getBoxLayoutParams(),{width:r.getWidth(),height:r.getHeight()}),this._layoutAxes()},e.prototype.getRect=function(){return this._rect},e.prototype._makeLayoutInfo=function(){var t=this._model,r=this._rect,n=["x","y"],a=["width","height"],i=t.get("layout"),o=i==="horizontal"?0:1,s=r[a[o]],l=[0,s],u=this.dimensions.length,c=rs(t.get("axisExpandWidth"),l),h=rs(t.get("axisExpandCount")||0,[0,u]),f=t.get("axisExpandable")&&u>3&&u>h&&h>1&&c>0&&s>0,d=t.get("axisExpandWindow"),v;if(d)v=rs(d[1]-d[0],l),d[1]=d[0]+v;else{v=rs(c*(h-1),l);var p=t.get("axisExpandCenter")||rp(u/2);d=[c*p-v/2],d[1]=d[0]+v}var g=(s-v)/(u-h);g<3&&(g=0);var m=[rp(np(d[0]/c,1))+1,PA(np(d[1]/c,1))-1],_=g/c*d[0];return{layout:i,pixelDimIndex:o,layoutBase:r[n[o]],layoutLength:s,axisBase:r[n[1-o]],axisLength:r[a[1-o]],axisExpandable:f,axisExpandWidth:c,axisCollapseWidth:g,axisExpandWindow:d,axisCount:u,winInnerIndices:m,axisExpandWindow0Pos:_}},e.prototype._layoutAxes=function(){var t=this._rect,r=this._axesMap,n=this.dimensions,a=this._makeLayoutInfo(),i=a.layout;r.each(function(o){var s=[0,a.axisLength],l=o.inverse?1:0;o.setExtent(s[l],s[1-l])}),Uu(n,function(o,s){var l=(a.axisExpandable?OA:NA)(s,a),u={horizontal:{x:l.position,y:a.axisLength},vertical:{x:0,y:l.position}},c={horizontal:IA/2,vertical:0},h=[u[i].x+t.x,u[i].y+t.y],f=c[i],d=Po();of(d,d,f),qa(d,d,h),this._axesLayout[o]={position:h,rotation:f,transform:d,axisNameAvailableWidth:l.axisNameAvailableWidth,axisLabelShow:l.axisLabelShow,nameTruncateMaxWidth:l.nameTruncateMaxWidth,tickDirection:1,labelDirection:1}},this)},e.prototype.getAxis=function(t){return this._axesMap.get(t)},e.prototype.dataToPoint=function(t,r){return this.axisCoordToPoint(this._axesMap.get(r).dataToCoord(t),r)},e.prototype.eachActiveState=function(t,r,n,a){n==null&&(n=0),a==null&&(a=t.count());var i=this._axesMap,o=this.dimensions,s=[],l=[];R(o,function(g){s.push(t.mapDimension(g)),l.push(i.get(g).model)});for(var u=this.hasAxisBrushed(),c=n;c<a;c++){var h=void 0;if(!u)h="normal";else{h="active";for(var f=t.getValues(s,c),d=0,v=o.length;d<v;d++){var p=l[d].getActiveState(f[d]);if(p==="inactive"){h="inactive";break}}}r(h,c)}},e.prototype.hasAxisBrushed=function(){for(var t=this.dimensions,r=this._axesMap,n=!1,a=0,i=t.length;a<i;a++)r.get(t[a]).model.getActiveState()!=="normal"&&(n=!0);return n},e.prototype.axisCoordToPoint=function(t,r){var n=this._axesLayout[r];return lo([t,0],n.transform)},e.prototype.getAxisLayout=function(t){return vt(this._axesLayout[t])},e.prototype.getSlidedAxisExpandWindow=function(t){var r=this._makeLayoutInfo(),n=r.pixelDimIndex,a=r.axisExpandWindow.slice(),i=a[1]-a[0],o=[0,r.axisExpandWidth*(r.axisCount-1)];if(!this.containPoint(t))return{behavior:"none",axisExpandWindow:a};var s=t[n]-r.layoutBase-r.axisExpandWindow0Pos,l,u="slide",c=r.axisCollapseWidth,h=this._model.get("axisExpandSlideTriggerArea"),f=h[0]!=null;if(c)f&&c&&s<i*h[0]?(u="jump",l=s-i*h[2]):f&&c&&s>i*(1-h[0])?(u="jump",l=s-i*(1-h[2])):(l=s-i*h[1])>=0&&(l=s-i*(1-h[1]))<=0&&(l=0),l*=r.axisExpandWidth/c,l?ci(l,a,o,"all"):u="none";else{var d=a[1]-a[0],v=o[1]*s/d;a=[Ny(0,v-d/2)],a[1]=Ry(o[1],a[0]+d),a[0]=a[1]-d}return{axisExpandWindow:a,behavior:u}},e}();function rs(e,t){return Ry(Ny(e,t[0]),t[1])}function NA(e,t){var r=t.layoutLength/(t.axisCount-1);return{position:r*e,axisNameAvailableWidth:r,axisLabelShow:!0}}function OA(e,t){var r=t.layoutLength,n=t.axisExpandWidth,a=t.axisCount,i=t.axisCollapseWidth,o=t.winInnerIndices,s,l=i,u=!1,c;return e<o[0]?(s=e*i,c=i):e<=o[1]?(s=t.axisExpandWindow0Pos+e*n-t.axisExpandWindow[0],l=n,u=!0):(s=r-(a-1-e)*i,c=i),{position:s,axisNameAvailableWidth:l,axisLabelShow:u,nameTruncateMaxWidth:c}}const BA=RA;function FA(e,t){var r=[];return e.eachComponent("parallel",function(n,a){var i=new BA(n,e,t);i.name="parallel_"+a,i.resize(n,t),n.coordinateSystem=i,i.model=n,r.push(i)}),e.eachSeries(function(n){if(n.get("coordinateSystem")==="parallel"){var a=n.getReferringComponents("parallel",sn).models[0];n.coordinateSystem=a.coordinateSystem}}),r}var zA={create:FA};const GA=zA;var Oy=function(e){U(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r.activeIntervals=[],r}return t.prototype.getAreaSelectStyle=function(){return um([["fill","color"],["lineWidth","borderWidth"],["stroke","borderColor"],["width","width"],["opacity","opacity"]])(this.getModel("areaSelectStyle"))},t.prototype.setActiveIntervals=function(r){var n=this.activeIntervals=vt(r);if(n)for(var a=n.length-1;a>=0;a--)Vr(n[a])},t.prototype.getActiveState=function(r){var n=this.activeIntervals;if(!n.length)return"normal";if(r==null||isNaN(+r))return"inactive";if(n.length===1){var a=n[0];if(a[0]<=r&&r<=a[1])return"active"}else for(var i=0,o=n.length;i<o;i++)if(n[i][0]<=r&&r<=n[i][1])return"active";return"inactive"},t}(Ot);Xr(Oy,Mo);const ap=Oy;var va=!0,go=Math.min,Ka=Math.max,VA=Math.pow,UA=1e4,kA=6,HA=6,ip="globalPan",WA={w:[0,0],e:[0,1],n:[1,0],s:[1,1]},$A={w:"ew",e:"ew",n:"ns",s:"ns",ne:"nesw",sw:"nesw",nw:"nwse",se:"nwse"},op={brushStyle:{lineWidth:2,stroke:"rgba(210,219,238,0.3)",fill:"#D2DBEE"},transformable:!0,brushMode:"single",removeOnClick:!1},XA=0,jA=function(e){U(t,e);function t(r){var n=e.call(this)||this;return n._track=[],n._covers=[],n._handlers={},n._zr=r,n.group=new Fe,n._uid="brushController_"+XA++,R(eE,function(a,i){this._handlers[i]=me(a,this)},n),n}return t.prototype.enableBrush=function(r){return this._brushType&&this._doDisableBrush(),r.brushType&&this._doEnableBrush(r),this},t.prototype._doEnableBrush=function(r){var n=this._zr;this._enableGlobalPan||aT(n,ip,this._uid),R(this._handlers,function(a,i){n.on(i,a)}),this._brushType=r.brushType,this._brushOption=fe(vt(op),r,!0)},t.prototype._doDisableBrush=function(){var r=this._zr;iT(r,ip,this._uid),R(this._handlers,function(n,a){r.off(a,n)}),this._brushType=this._brushOption=null},t.prototype.setPanels=function(r){if(r&&r.length){var n=this._panels={};R(r,function(a){n[a.panelId]=vt(a)})}else this._panels=null;return this},t.prototype.mount=function(r){r=r||{},this._enableGlobalPan=r.enableGlobalPan;var n=this.group;return this._zr.add(n),n.attr({x:r.x||0,y:r.y||0,rotation:r.rotation||0,scaleX:r.scaleX||1,scaleY:r.scaleY||1}),this._transform=n.getLocalTransform(),this},t.prototype.updateCovers=function(r){r=K(r,function(f){return fe(vt(op),f,!0)});var n="\0-brush-index-",a=this._covers,i=this._covers=[],o=this,s=this._creatingCover;return new Dn(a,r,u,l).add(c).update(c).remove(h).execute(),this;function l(f,d){return(f.id!=null?f.id:n+d)+"-"+f.brushType}function u(f,d){return l(f.__brushOption,d)}function c(f,d){var v=r[f];if(d!=null&&a[d]===s)i[f]=a[d];else{var p=i[f]=d!=null?(a[d].__brushOption=v,a[d]):Fy(o,By(o,v));If(o,p)}}function h(f){a[f]!==s&&o.group.remove(a[f])}},t.prototype.unmount=function(){return this.enableBrush(!1),dh(this),this._zr.remove(this.group),this},t.prototype.dispose=function(){this.unmount(),this.off()},t}(oT);function By(e,t){var r=Hl[t.brushType].createCover(e,t);return r.__brushOption=t,Gy(r,t),e.group.add(r),r}function Fy(e,t){var r=Rf(t);return r.endCreating&&(r.endCreating(e,t),Gy(t,t.__brushOption)),t}function zy(e,t){var r=t.__brushOption;Rf(t).updateCoverShape(e,t,r.range,r)}function Gy(e,t){var r=t.z;r==null&&(r=UA),e.traverse(function(n){n.z=r,n.z2=r})}function If(e,t){Rf(t).updateCommon(e,t),zy(e,t)}function Rf(e){return Hl[e.__brushOption.brushType]}function Nf(e,t,r){var n=e._panels;if(!n)return va;var a,i=e._transform;return R(n,function(o){o.isTargetByCursor(t,r,i)&&(a=o)}),a}function Vy(e,t){var r=e._panels;if(!r)return va;var n=t.__brushOption.panelId;return n!=null?r[n]:va}function dh(e){var t=e._covers,r=t.length;return R(t,function(n){e.group.remove(n)},e),t.length=0,!!r}function pa(e,t){var r=K(e._covers,function(n){var a=n.__brushOption,i=vt(a.range);return{brushType:a.brushType,panelId:a.panelId,range:i}});e.trigger("brush",{areas:r,isEnd:!!t.isEnd,removeOnClick:!!t.removeOnClick})}function ZA(e){var t=e._track;if(!t.length)return!1;var r=t[t.length-1],n=t[0],a=r[0]-n[0],i=r[1]-n[1],o=VA(a*a+i*i,.5);return o>kA}function Uy(e){var t=e.length-1;return t<0&&(t=0),[e[0],e[t]]}function ky(e,t,r,n){var a=new Fe;return a.add(new Et({name:"main",style:Of(r),silent:!0,draggable:!0,cursor:"move",drift:Ge(sp,e,t,a,["n","s","w","e"]),ondragend:Ge(pa,t,{isEnd:!0})})),R(n,function(i){a.add(new Et({name:i.join(""),style:{opacity:0},draggable:!0,silent:!0,invisible:!0,drift:Ge(sp,e,t,a,i),ondragend:Ge(pa,t,{isEnd:!0})}))}),a}function Hy(e,t,r,n){var a=n.brushStyle.lineWidth||0,i=Ka(a,HA),o=r[0][0],s=r[1][0],l=o-a/2,u=s-a/2,c=r[0][1],h=r[1][1],f=c-i+a/2,d=h-i+a/2,v=c-o,p=h-s,g=v+a,m=p+a;Yr(e,t,"main",o,s,v,p),n.transformable&&(Yr(e,t,"w",l,u,i,m),Yr(e,t,"e",f,u,i,m),Yr(e,t,"n",l,u,g,i),Yr(e,t,"s",l,d,g,i),Yr(e,t,"nw",l,u,i,i),Yr(e,t,"ne",f,u,i,i),Yr(e,t,"sw",l,d,i,i),Yr(e,t,"se",f,d,i,i))}function vh(e,t){var r=t.__brushOption,n=r.transformable,a=t.childAt(0);a.useStyle(Of(r)),a.attr({silent:!n,cursor:n?"move":"default"}),R([["w"],["e"],["n"],["s"],["s","e"],["s","w"],["n","e"],["n","w"]],function(i){var o=t.childOfName(i.join("")),s=i.length===1?ph(e,i[0]):qA(e,i);o&&o.attr({silent:!n,invisible:!n,cursor:n?$A[s]+"-resize":null})})}function Yr(e,t,r,n,a,i,o){var s=t.childOfName(r);s&&s.setShape(JA(Bf(e,t,[[n,a],[n+i,a+o]])))}function Of(e){return Te({strokeNoScale:!0},e.brushStyle)}function Wy(e,t,r,n){var a=[go(e,r),go(t,n)],i=[Ka(e,r),Ka(t,n)];return[[a[0],i[0]],[a[1],i[1]]]}function YA(e){return sf(e.group)}function ph(e,t){var r={w:"left",e:"right",n:"top",s:"bottom"},n={left:"w",right:"e",top:"n",bottom:"s"},a=mm(r[t],YA(e));return n[a]}function qA(e,t){var r=[ph(e,t[0]),ph(e,t[1])];return(r[0]==="e"||r[0]==="w")&&r.reverse(),r.join("")}function sp(e,t,r,n,a,i){var o=r.__brushOption,s=e.toRectRange(o.range),l=$y(t,a,i);R(n,function(u){var c=WA[u];s[c[0]][c[1]]+=l[c[0]]}),o.range=e.fromRectRange(Wy(s[0][0],s[1][0],s[0][1],s[1][1])),If(t,r),pa(t,{isEnd:!1})}function KA(e,t,r,n){var a=t.__brushOption.range,i=$y(e,r,n);R(a,function(o){o[0]+=i[0],o[1]+=i[1]}),If(e,t),pa(e,{isEnd:!1})}function $y(e,t,r){var n=e.group,a=n.transformCoordToLocal(t,r),i=n.transformCoordToLocal(0,0);return[a[0]-i[0],a[1]-i[1]]}function Bf(e,t,r){var n=Vy(e,t);return n&&n!==va?n.clipPath(r,e._transform):vt(r)}function JA(e){var t=go(e[0][0],e[1][0]),r=go(e[0][1],e[1][1]),n=Ka(e[0][0],e[1][0]),a=Ka(e[0][1],e[1][1]);return{x:t,y:r,width:n-t,height:a-r}}function QA(e,t,r){if(!(!e._brushType||tE(e,t.offsetX,t.offsetY))){var n=e._zr,a=e._covers,i=Nf(e,t,r);if(!e._dragging)for(var o=0;o<a.length;o++){var s=a[o].__brushOption;if(i&&(i===va||s.panelId===i.panelId)&&Hl[s.brushType].contain(a[o],r[0],r[1]))return}i&&n.setCursorStyle("crosshair")}}function gh(e){var t=e.event;t.preventDefault&&t.preventDefault()}function mh(e,t,r){return e.childOfName("main").contain(t,r)}function Xy(e,t,r,n){var a=e._creatingCover,i=e._creatingPanel,o=e._brushOption,s;if(e._track.push(r.slice()),ZA(e)||a){if(i&&!a){o.brushMode==="single"&&dh(e);var l=vt(o);l.brushType=lp(l.brushType,i),l.panelId=i===va?null:i.panelId,a=e._creatingCover=By(e,l),e._covers.push(a)}if(a){var u=Hl[lp(e._brushType,i)],c=a.__brushOption;c.range=u.getCreatingRange(Bf(e,a,e._track)),n&&(Fy(e,a),u.updateCommon(e,a)),zy(e,a),s={isEnd:n}}}else n&&o.brushMode==="single"&&o.removeOnClick&&Nf(e,t,r)&&dh(e)&&(s={isEnd:n,removeOnClick:!0});return s}function lp(e,t){return e==="auto"?t.defaultBrushType:e}var eE={mousedown:function(e){if(this._dragging)up(this,e);else if(!e.target||!e.target.draggable){gh(e);var t=this.group.transformCoordToLocal(e.offsetX,e.offsetY);this._creatingCover=null;var r=this._creatingPanel=Nf(this,e,t);r&&(this._dragging=!0,this._track=[t.slice()])}},mousemove:function(e){var t=e.offsetX,r=e.offsetY,n=this.group.transformCoordToLocal(t,r);if(QA(this,e,n),this._dragging){gh(e);var a=Xy(this,e,n,!1);a&&pa(this,a)}},mouseup:function(e){up(this,e)}};function up(e,t){if(e._dragging){gh(t);var r=t.offsetX,n=t.offsetY,a=e.group.transformCoordToLocal(r,n),i=Xy(e,t,a,!0);e._dragging=!1,e._track=[],e._creatingCover=null,i&&pa(e,i)}}function tE(e,t,r){var n=e._zr;return t<0||t>n.getWidth()||r<0||r>n.getHeight()}var Hl={lineX:cp(0),lineY:cp(1),rect:{createCover:function(e,t){function r(n){return n}return ky({toRectRange:r,fromRectRange:r},e,t,[["w"],["e"],["n"],["s"],["s","e"],["s","w"],["n","e"],["n","w"]])},getCreatingRange:function(e){var t=Uy(e);return Wy(t[1][0],t[1][1],t[0][0],t[0][1])},updateCoverShape:function(e,t,r,n){Hy(e,t,r,n)},updateCommon:vh,contain:mh},polygon:{createCover:function(e,t){var r=new Fe;return r.add(new Nn({name:"main",style:Of(t),silent:!0})),r},getCreatingRange:function(e){return e},endCreating:function(e,t){t.remove(t.childAt(0)),t.add(new on({name:"main",draggable:!0,drift:Ge(KA,e,t),ondragend:Ge(pa,e,{isEnd:!0})}))},updateCoverShape:function(e,t,r,n){t.childAt(0).setShape({points:Bf(e,t,r)})},updateCommon:vh,contain:mh}};function cp(e){return{createCover:function(t,r){return ky({toRectRange:function(n){var a=[n,[0,100]];return e&&a.reverse(),a},fromRectRange:function(n){return n[e]}},t,r,[[["w"],["e"]],[["n"],["s"]]][e])},getCreatingRange:function(t){var r=Uy(t),n=go(r[0][e],r[1][e]),a=Ka(r[0][e],r[1][e]);return[n,a]},updateCoverShape:function(t,r,n,a){var i,o=Vy(t,r);if(o!==va&&o.getLinearBrushOtherExtent)i=o.getLinearBrushOtherExtent(e);else{var s=t._zr;i=[0,[s.getWidth(),s.getHeight()][1-e]]}var l=[n,i];e&&l.reverse(),Hy(t,r,l,a)},updateCommon:vh,contain:mh}}const Ff=jA;function jy(e){return e=zf(e),function(t){return sT(t,e)}}function Zy(e,t){return e=zf(e),function(r){var n=t??r,a=n?e.width:e.height,i=n?e.x:e.y;return[i,i+(a||0)]}}function Yy(e,t,r){var n=zf(e);return function(a,i){return n.contain(i[0],i[1])&&!nf(a,t,r)}}function zf(e){return Yt.create(e)}var rE=["axisLine","axisTickLabel","axisName"],nE=function(e){U(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.init=function(r,n){e.prototype.init.apply(this,arguments),(this._brushController=new Ff(n.getZr())).on("brush",me(this._onBrush,this))},t.prototype.render=function(r,n,a,i){if(!aE(r,n,i)){this.axisModel=r,this.api=a,this.group.removeAll();var o=this._axisGroup;if(this._axisGroup=new Fe,this.group.add(this._axisGroup),!!r.get("show")){var s=oE(r,n),l=s.coordinateSystem,u=r.getAreaSelectStyle(),c=u.width,h=r.axis.dim,f=l.getAxisLayout(h),d=le({strokeContainThreshold:c},f),v=new fa(r,d);R(rE,v.add,v),this._axisGroup.add(v.getGroup()),this._refreshBrushController(d,u,r,s,c,a),lf(o,this._axisGroup,r)}}},t.prototype._refreshBrushController=function(r,n,a,i,o,s){var l=a.axis.getExtent(),u=l[1]-l[0],c=Math.min(30,Math.abs(u)*.1),h=Yt.create({x:l[0],y:-o/2,width:u,height:o});h.x-=c,h.width+=2*c,this._brushController.mount({enableGlobalPan:!0,rotation:r.rotation,x:r.position[0],y:r.position[1]}).setPanels([{panelId:"pl",clipPath:jy(h),isTargetByCursor:Yy(h,s,i),getLinearBrushOtherExtent:Zy(h,0)}]).enableBrush({brushType:"lineX",brushStyle:n,removeOnClick:!0}).updateCovers(iE(a))},t.prototype._onBrush=function(r){var n=r.areas,a=this.axisModel,i=a.axis,o=K(n,function(s){return[i.coordToData(s.range[0],!0),i.coordToData(s.range[1],!0)]});(!a.option.realtime===r.isEnd||r.removeOnClick)&&this.api.dispatchAction({type:"axisAreaSelect",parallelAxisId:a.id,intervals:o})},t.prototype.dispose=function(){this._brushController.dispose()},t.type="parallelAxis",t}(kt);function aE(e,t,r){return r&&r.type==="axisAreaSelect"&&t.findComponents({mainType:"parallelAxis",query:r})[0]===e}function iE(e){var t=e.axis;return K(e.activeIntervals,function(r){return{brushType:"lineX",panelId:"pl",range:[t.dataToCoord(r[0],!0),t.dataToCoord(r[1],!0)]}})}function oE(e,t){return t.getComponent("parallel",e.get("parallelIndex"))}const sE=nE;var lE={type:"axisAreaSelect",event:"axisAreaSelected"};function uE(e){e.registerAction(lE,function(t,r){r.eachComponent({mainType:"parallelAxis",query:t},function(n){n.axis.model.setActiveIntervals(t.intervals)})}),e.registerAction("parallelAxisExpand",function(t,r){r.eachComponent({mainType:"parallel",query:t},function(n){n.setAxisExpand(t)})})}var cE={type:"value",areaSelectStyle:{width:20,borderWidth:1,borderColor:"rgba(160,197,232)",color:"rgba(160,197,232)",opacity:.3},realtime:!0,z:10};function qy(e){e.registerComponentView(EA),e.registerComponentModel(LA),e.registerCoordinateSystem("parallel",GA),e.registerPreprocessor(xA),e.registerComponentModel(ap),e.registerComponentView(sE),Us(e,"parallel",ap,cE),uE(e)}function hE(e){oe(qy),e.registerChartView(fA),e.registerSeriesModel(gA),e.registerVisual(e.PRIORITY.VISUAL.BRUSH,_A)}var fE=function(){function e(){this.x1=0,this.y1=0,this.x2=0,this.y2=0,this.cpx1=0,this.cpy1=0,this.cpx2=0,this.cpy2=0,this.extent=0}return e}(),dE=function(e){U(t,e);function t(r){return e.call(this,r)||this}return t.prototype.getDefaultShape=function(){return new fE},t.prototype.buildPath=function(r,n){var a=n.extent;r.moveTo(n.x1,n.y1),r.bezierCurveTo(n.cpx1,n.cpy1,n.cpx2,n.cpy2,n.x2,n.y2),n.orient==="vertical"?(r.lineTo(n.x2+a,n.y2),r.bezierCurveTo(n.cpx2+a,n.cpy2,n.cpx1+a,n.cpy1,n.x1+a,n.y1)):(r.lineTo(n.x2,n.y2+a),r.bezierCurveTo(n.cpx2,n.cpy2+a,n.cpx1,n.cpy1+a,n.x1,n.y1+a)),r.closePath()},t.prototype.highlight=function(){Gs(this)},t.prototype.downplay=function(){Vs(this)},t}(Gt),vE=function(e){U(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r._focusAdjacencyDisabled=!1,r}return t.prototype.render=function(r,n,a){var i=this,o=r.getGraph(),s=this.group,l=r.layoutInfo,u=l.width,c=l.height,h=r.getData(),f=r.getData("edge"),d=r.get("orient");this._model=r,s.removeAll(),s.x=l.x,s.y=l.y,o.eachEdge(function(v){var p=new dE,g=et(p);g.dataIndex=v.dataIndex,g.seriesIndex=r.seriesIndex,g.dataType="edge";var m=v.getModel(),_=m.getModel("lineStyle"),y=_.get("curveness"),x=v.node1.getLayout(),S=v.node1.getModel(),T=S.get("localX"),b=S.get("localY"),w=v.node2.getLayout(),A=v.node2.getModel(),E=A.get("localX"),C=A.get("localY"),M=v.getLayout(),P,L,I,N,F,B,k,z;p.shape.extent=Math.max(1,M.dy),p.shape.orient=d,d==="vertical"?(P=(T!=null?T*u:x.x)+M.sy,L=(b!=null?b*c:x.y)+x.dy,I=(E!=null?E*u:w.x)+M.ty,N=C!=null?C*c:w.y,F=P,B=L*(1-y)+N*y,k=I,z=L*y+N*(1-y)):(P=(T!=null?T*u:x.x)+x.dx,L=(b!=null?b*c:x.y)+M.sy,I=E!=null?E*u:w.x,N=(C!=null?C*c:w.y)+M.ty,F=P*(1-y)+I*y,B=L,k=P*y+I*(1-y),z=N),p.setShape({x1:P,y1:L,x2:I,y2:N,cpx1:F,cpy1:B,cpx2:k,cpy2:z}),p.useStyle(_.getItemStyle()),hp(p.style,d,v);var W=""+m.get("value"),J=wr(m,"edgeLabel");Wr(p,J,{labelFetcher:{getFormattedLabel:function(q,Ee,ae,j,pe,de){return r.getFormattedLabel(q,Ee,"edge",j,Ro(pe,J.normal&&J.normal.get("formatter"),W),de)}},labelDataIndex:v.dataIndex,defaultText:W}),p.setTextConfig({position:"inside"});var re=m.getModel("emphasis");ur(p,m,"lineStyle",function(q){var Ee=q.getItemStyle();return hp(Ee,d,v),Ee}),s.add(p),f.setItemGraphicEl(v.dataIndex,p);var Q=re.get("focus");zt(p,Q==="adjacency"?v.getAdjacentDataIndices():Q==="trajectory"?v.getTrajectoryDataIndices():Q,re.get("blurScope"),re.get("disabled"))}),o.eachNode(function(v){var p=v.getLayout(),g=v.getModel(),m=g.get("localX"),_=g.get("localY"),y=g.getModel("emphasis"),x=new Et({shape:{x:m!=null?m*u:p.x,y:_!=null?_*c:p.y,width:p.dx,height:p.dy},style:g.getModel("itemStyle").getItemStyle(),z2:10});Wr(x,wr(g),{labelFetcher:{getFormattedLabel:function(T,b){return r.getFormattedLabel(T,b,"node")}},labelDataIndex:v.dataIndex,defaultText:v.id}),x.disableLabelAnimation=!0,x.setStyle("fill",v.getVisual("color")),x.setStyle("decal",v.getVisual("style").decal),ur(x,g),s.add(x),h.setItemGraphicEl(v.dataIndex,x),et(x).dataType="node";var S=y.get("focus");zt(x,S==="adjacency"?v.getAdjacentDataIndices():S==="trajectory"?v.getTrajectoryDataIndices():S,y.get("blurScope"),y.get("disabled"))}),h.eachItemGraphicEl(function(v,p){var g=h.getItemModel(p);g.get("draggable")&&(v.drift=function(m,_){i._focusAdjacencyDisabled=!0,this.shape.x+=m,this.shape.y+=_,this.dirty(),a.dispatchAction({type:"dragNode",seriesId:r.id,dataIndex:h.getRawIndex(p),localX:this.shape.x/u,localY:this.shape.y/c})},v.ondragend=function(){i._focusAdjacencyDisabled=!1},v.draggable=!0,v.cursor="move")}),!this._data&&r.isAnimationEnabled()&&s.setClipPath(pE(s.getBoundingRect(),r,function(){s.removeClipPath()})),this._data=r.getData()},t.prototype.dispose=function(){},t.type="sankey",t}(He);function hp(e,t,r){switch(e.fill){case"source":e.fill=r.node1.getVisual("color"),e.decal=r.node1.getVisual("style").decal;break;case"target":e.fill=r.node2.getVisual("color"),e.decal=r.node2.getVisual("style").decal;break;case"gradient":var n=r.node1.getVisual("color"),a=r.node2.getVisual("color");Ve(n)&&Ve(a)&&(e.fill=new lT(0,0,+(t==="horizontal"),+(t==="vertical"),[{color:n,offset:0},{color:a,offset:1}]))}}function pE(e,t,r){var n=new Et({shape:{x:e.x-10,y:e.y-10,width:0,height:e.height+20}});return ar(n,{shape:{width:e.width+20}},t,r),n}const gE=vE;var mE=function(e){U(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.getInitialData=function(r,n){var a=r.edges||r.links,i=r.data||r.nodes,o=r.levels;this.levelModels=[];for(var s=this.levelModels,l=0;l<o.length;l++)o[l].depth!=null&&o[l].depth>=0&&(s[o[l].depth]=new Ft(o[l],this,n));if(i&&a){var u=Py(i,a,this,!0,c);return u.data}function c(h,f){h.wrapMethod("getItemModel",function(d,v){var p=d.parentModel,g=p.getData().getItemLayout(v);if(g){var m=g.depth,_=p.levelModels[m];_&&(d.parentModel=_)}return d}),f.wrapMethod("getItemModel",function(d,v){var p=d.parentModel,g=p.getGraph().getEdgeByIndex(v),m=g.node1.getLayout();if(m){var _=m.depth,y=p.levelModels[_];y&&(d.parentModel=y)}return d})}},t.prototype.setNodePosition=function(r,n){var a=this.option.data||this.option.nodes,i=a[r];i.localX=n[0],i.localY=n[1]},t.prototype.getGraph=function(){return this.getData().graph},t.prototype.getEdgeData=function(){return this.getGraph().edgeData},t.prototype.formatTooltip=function(r,n,a){function i(d){return isNaN(d)||d==null}if(a==="edge"){var o=this.getDataParams(r,a),s=o.data,l=o.value,u=s.source+" -- "+s.target;return $r("nameValue",{name:u,value:l,noValue:i(l)})}else{var c=this.getGraph().getNodeByIndex(r),h=c.getLayout().value,f=this.getDataParams(r,a).data.name;return $r("nameValue",{name:f!=null?f+"":null,value:h,noValue:i(h)})}},t.prototype.optionUpdated=function(){},t.prototype.getDataParams=function(r,n){var a=e.prototype.getDataParams.call(this,r,n);if(a.value==null&&n==="node"){var i=this.getGraph().getNodeByIndex(r),o=i.getLayout().value;a.value=o}return a},t.type="series.sankey",t.defaultOption={z:2,coordinateSystem:"view",left:"5%",top:"5%",right:"20%",bottom:"5%",orient:"horizontal",nodeWidth:20,nodeGap:8,draggable:!0,layoutIterations:32,label:{show:!0,position:"right",fontSize:12},edgeLabel:{show:!1,fontSize:12},levels:[],nodeAlign:"justify",lineStyle:{color:"#314656",opacity:.2,curveness:.5},emphasis:{label:{show:!0},lineStyle:{opacity:.5}},select:{itemStyle:{borderColor:"#212121"}},animationEasing:"linear",animationDuration:1e3},t}($e);const yE=mE;function _E(e,t){e.eachSeriesByType("sankey",function(r){var n=r.get("nodeWidth"),a=r.get("nodeGap"),i=xE(r,t);r.layoutInfo=i;var o=i.width,s=i.height,l=r.getGraph(),u=l.nodes,c=l.edges;TE(u);var h=Vt(u,function(p){return p.getLayout().value===0}),f=h.length!==0?0:r.get("layoutIterations"),d=r.get("orient"),v=r.get("nodeAlign");SE(u,c,n,a,o,s,f,d,v)})}function xE(e,t){return sr(e.getBoxLayoutParams(),{width:t.getWidth(),height:t.getHeight()})}function SE(e,t,r,n,a,i,o,s,l){bE(e,t,r,a,i,s,l),CE(e,t,i,a,n,o,s),BE(e,s)}function TE(e){R(e,function(t){var r=Cn(t.outEdges,Zs),n=Cn(t.inEdges,Zs),a=t.getValue()||0,i=Math.max(r,n,a);t.setLayout({value:i},!0)})}function bE(e,t,r,n,a,i,o){for(var s=[],l=[],u=[],c=[],h=0,f=0;f<t.length;f++)s[f]=1;for(var f=0;f<e.length;f++)l[f]=e[f].inEdges.length,l[f]===0&&u.push(e[f]);for(var d=-1;u.length;){for(var v=0;v<u.length;v++){var p=u[v],g=p.hostGraph.data.getRawDataItem(p.dataIndex),m=g.depth!=null&&g.depth>=0;m&&g.depth>d&&(d=g.depth),p.setLayout({depth:m?g.depth:h},!0),i==="vertical"?p.setLayout({dy:r},!0):p.setLayout({dx:r},!0);for(var _=0;_<p.outEdges.length;_++){var y=p.outEdges[_],x=t.indexOf(y);s[x]=0;var S=y.node2,T=e.indexOf(S);--l[T]===0&&c.indexOf(S)<0&&c.push(S)}}++h,u=c,c=[]}for(var f=0;f<s.length;f++)if(s[f]===1)throw new Error("Sankey is a DAG, the original data has cycle!");var b=d>h-1?d:h-1;o&&o!=="left"&&wE(e,o,i,b);var w=i==="vertical"?(a-r)/b:(n-r)/b;EE(e,w,i)}function Ky(e){var t=e.hostGraph.data.getRawDataItem(e.dataIndex);return t.depth!=null&&t.depth>=0}function wE(e,t,r,n){if(t==="right"){for(var a=[],i=e,o=0;i.length;){for(var s=0;s<i.length;s++){var l=i[s];l.setLayout({skNodeHeight:o},!0);for(var u=0;u<l.inEdges.length;u++){var c=l.inEdges[u];a.indexOf(c.node1)<0&&a.push(c.node1)}}i=a,a=[],++o}R(e,function(h){Ky(h)||h.setLayout({depth:Math.max(0,n-h.getLayout().skNodeHeight)},!0)})}else t==="justify"&&AE(e,n)}function AE(e,t){R(e,function(r){!Ky(r)&&!r.outEdges.length&&r.setLayout({depth:t},!0)})}function EE(e,t,r){R(e,function(n){var a=n.getLayout().depth*t;r==="vertical"?n.setLayout({y:a},!0):n.setLayout({x:a},!0)})}function CE(e,t,r,n,a,i,o){var s=LE(e,o);DE(s,t,r,n,a,o),ku(s,a,r,n,o);for(var l=1;i>0;i--)l*=.99,ME(s,l,o),ku(s,a,r,n,o),OE(s,l,o),ku(s,a,r,n,o)}function LE(e,t){var r=[],n=t==="vertical"?"y":"x",a=Qc(e,function(i){return i.getLayout()[n]});return a.keys.sort(function(i,o){return i-o}),R(a.keys,function(i){r.push(a.buckets.get(i))}),r}function DE(e,t,r,n,a,i){var o=1/0;R(e,function(s){var l=s.length,u=0;R(s,function(h){u+=h.getLayout().value});var c=i==="vertical"?(n-(l-1)*a)/u:(r-(l-1)*a)/u;c<o&&(o=c)}),R(e,function(s){R(s,function(l,u){var c=l.getLayout().value*o;i==="vertical"?(l.setLayout({x:u},!0),l.setLayout({dx:c},!0)):(l.setLayout({y:u},!0),l.setLayout({dy:c},!0))})}),R(t,function(s){var l=+s.getValue()*o;s.setLayout({dy:l},!0)})}function ku(e,t,r,n,a){var i=a==="vertical"?"x":"y";R(e,function(o){o.sort(function(p,g){return p.getLayout()[i]-g.getLayout()[i]});for(var s,l,u,c=0,h=o.length,f=a==="vertical"?"dx":"dy",d=0;d<h;d++)l=o[d],u=c-l.getLayout()[i],u>0&&(s=l.getLayout()[i]+u,a==="vertical"?l.setLayout({x:s},!0):l.setLayout({y:s},!0)),c=l.getLayout()[i]+l.getLayout()[f]+t;var v=a==="vertical"?n:r;if(u=c-t-v,u>0){s=l.getLayout()[i]-u,a==="vertical"?l.setLayout({x:s},!0):l.setLayout({y:s},!0),c=s;for(var d=h-2;d>=0;--d)l=o[d],u=l.getLayout()[i]+l.getLayout()[f]+t-c,u>0&&(s=l.getLayout()[i]-u,a==="vertical"?l.setLayout({x:s},!0):l.setLayout({y:s},!0)),c=l.getLayout()[i]}})}function ME(e,t,r){R(e.slice().reverse(),function(n){R(n,function(a){if(a.outEdges.length){var i=Cn(a.outEdges,PE,r)/Cn(a.outEdges,Zs);if(isNaN(i)){var o=a.outEdges.length;i=o?Cn(a.outEdges,IE,r)/o:0}if(r==="vertical"){var s=a.getLayout().x+(i-Mn(a,r))*t;a.setLayout({x:s},!0)}else{var l=a.getLayout().y+(i-Mn(a,r))*t;a.setLayout({y:l},!0)}}})})}function PE(e,t){return Mn(e.node2,t)*e.getValue()}function IE(e,t){return Mn(e.node2,t)}function RE(e,t){return Mn(e.node1,t)*e.getValue()}function NE(e,t){return Mn(e.node1,t)}function Mn(e,t){return t==="vertical"?e.getLayout().x+e.getLayout().dx/2:e.getLayout().y+e.getLayout().dy/2}function Zs(e){return e.getValue()}function Cn(e,t,r){for(var n=0,a=e.length,i=-1;++i<a;){var o=+t(e[i],r);isNaN(o)||(n+=o)}return n}function OE(e,t,r){R(e,function(n){R(n,function(a){if(a.inEdges.length){var i=Cn(a.inEdges,RE,r)/Cn(a.inEdges,Zs);if(isNaN(i)){var o=a.inEdges.length;i=o?Cn(a.inEdges,NE,r)/o:0}if(r==="vertical"){var s=a.getLayout().x+(i-Mn(a,r))*t;a.setLayout({x:s},!0)}else{var l=a.getLayout().y+(i-Mn(a,r))*t;a.setLayout({y:l},!0)}}})})}function BE(e,t){var r=t==="vertical"?"x":"y";R(e,function(n){n.outEdges.sort(function(a,i){return a.node2.getLayout()[r]-i.node2.getLayout()[r]}),n.inEdges.sort(function(a,i){return a.node1.getLayout()[r]-i.node1.getLayout()[r]})}),R(e,function(n){var a=0,i=0;R(n.outEdges,function(o){o.setLayout({sy:a},!0),a+=o.getLayout().dy}),R(n.inEdges,function(o){o.setLayout({ty:i},!0),i+=o.getLayout().dy})})}function FE(e){e.eachSeriesByType("sankey",function(t){var r=t.getGraph(),n=r.nodes,a=r.edges;if(n.length){var i=1/0,o=-1/0;R(n,function(s){var l=s.getLayout().value;l<i&&(i=l),l>o&&(o=l)}),R(n,function(s){var l=new fm({type:"color",mappingMethod:"linear",dataExtent:[i,o],visual:t.get("color")}),u=l.mapValueToVisual(s.getLayout().value),c=s.getModel().get(["itemStyle","color"]);c!=null?(s.setVisual("color",c),s.setVisual("style",{fill:c})):(s.setVisual("color",u),s.setVisual("style",{fill:u}))})}a.length&&R(a,function(s){var l=s.getModel().get("lineStyle");s.setVisual("style",l)})})}function zE(e){e.registerChartView(gE),e.registerSeriesModel(yE),e.registerLayout(_E),e.registerVisual(FE),e.registerAction({type:"dragNode",event:"dragnode",update:"update"},function(t,r){r.eachComponent({mainType:"series",subType:"sankey",query:t},function(n){n.setNodePosition(t.dataIndex,[t.localX,t.localY])})})}var Jy=function(){function e(){}return e.prototype.getInitialData=function(t,r){var n,a=r.getComponent("xAxis",this.get("xAxisIndex")),i=r.getComponent("yAxis",this.get("yAxisIndex")),o=a.get("type"),s=i.get("type"),l;o==="category"?(t.layout="horizontal",n=a.getOrdinalMeta(),l=!0):s==="category"?(t.layout="vertical",n=i.getOrdinalMeta(),l=!0):t.layout=t.layout||"horizontal";var u=["x","y"],c=t.layout==="horizontal"?0:1,h=this._baseAxisDim=u[c],f=u[1-c],d=[a,i],v=d[c].get("type"),p=d[1-c].get("type"),g=t.data;if(g&&l){var m=[];R(g,function(x,S){var T;te(x)?(T=x.slice(),x.unshift(S)):te(x.value)?(T=le({},x),T.value=T.value.slice(),x.value.unshift(S)):T=x,m.push(T)}),t.data=m}var _=this.defaultValueDimensions,y=[{name:h,type:eh(v),ordinalMeta:n,otherDims:{tooltip:!1,itemName:0},dimsDef:["base"]},{name:f,type:eh(p),dimsDef:_.slice()}];return Cl(this,{coordDimensions:y,dimensionsCount:_.length+1,encodeDefaulter:Ge(uT,y,this)})},e.prototype.getBaseAxis=function(){var t=this._baseAxisDim;return this.ecModel.getComponent(t+"Axis",this.get(t+"AxisIndex")).axis},e}(),Qy=function(e){U(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r.defaultValueDimensions=[{name:"min",defaultTooltip:!0},{name:"Q1",defaultTooltip:!0},{name:"median",defaultTooltip:!0},{name:"Q3",defaultTooltip:!0},{name:"max",defaultTooltip:!0}],r.visualDrawType="stroke",r}return t.type="series.boxplot",t.dependencies=["xAxis","yAxis","grid"],t.defaultOption={z:2,coordinateSystem:"cartesian2d",legendHoverLink:!0,layout:null,boxWidth:[7,50],itemStyle:{color:"#fff",borderWidth:1},emphasis:{scale:!0,itemStyle:{borderWidth:2,shadowBlur:5,shadowOffsetX:1,shadowOffsetY:1,shadowColor:"rgba(0,0,0,0.2)"}},animationDuration:800},t}($e);Xr(Qy,Jy,!0);const GE=Qy;var VE=function(e){U(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.render=function(r,n,a){var i=r.getData(),o=this.group,s=this._data;this._data||o.removeAll();var l=r.get("layout")==="horizontal"?1:0;i.diff(s).add(function(u){if(i.hasValue(u)){var c=i.getItemLayout(u),h=fp(c,i,u,l,!0);i.setItemGraphicEl(u,h),o.add(h)}}).update(function(u,c){var h=s.getItemGraphicEl(c);if(!i.hasValue(u)){o.remove(h);return}var f=i.getItemLayout(u);h?(Ln(h),e_(f,h,i,u)):h=fp(f,i,u,l),o.add(h),i.setItemGraphicEl(u,h)}).remove(function(u){var c=s.getItemGraphicEl(u);c&&o.remove(c)}).execute(),this._data=i},t.prototype.remove=function(r){var n=this.group,a=this._data;this._data=null,a&&a.eachItemGraphicEl(function(i){i&&n.remove(i)})},t.type="boxplot",t}(He),UE=function(){function e(){}return e}(),kE=function(e){U(t,e);function t(r){var n=e.call(this,r)||this;return n.type="boxplotBoxPath",n}return t.prototype.getDefaultShape=function(){return new UE},t.prototype.buildPath=function(r,n){var a=n.points,i=0;for(r.moveTo(a[i][0],a[i][1]),i++;i<4;i++)r.lineTo(a[i][0],a[i][1]);for(r.closePath();i<a.length;i++)r.moveTo(a[i][0],a[i][1]),i++,r.lineTo(a[i][0],a[i][1])},t}(Gt);function fp(e,t,r,n,a){var i=e.ends,o=new kE({shape:{points:a?HE(i,n,e):i}});return e_(e,o,t,r,a),o}function e_(e,t,r,n,a){var i=r.hostModel,o=wl[a?"initProps":"updateProps"];o(t,{shape:{points:e.ends}},i,n),t.useStyle(r.getItemVisual(n,"style")),t.style.strokeNoScale=!0,t.z2=100;var s=r.getItemModel(n),l=s.getModel("emphasis");ur(t,s),zt(t,l.get("focus"),l.get("blurScope"),l.get("disabled"))}function HE(e,t,r){return K(e,function(n){return n=n.slice(),n[t]=r.initBaseline,n})}const WE=VE;var eo=R;function $E(e){var t=XE(e);eo(t,function(r){var n=r.seriesModels;n.length&&(jE(r),eo(n,function(a,i){ZE(a,r.boxOffsetList[i],r.boxWidthList[i])}))})}function XE(e){var t=[],r=[];return e.eachSeriesByType("boxplot",function(n){var a=n.getBaseAxis(),i=pt(r,a);i<0&&(i=r.length,r[i]=a,t[i]={axis:a,seriesModels:[]}),t[i].seriesModels.push(n)}),t}function jE(e){var t=e.axis,r=e.seriesModels,n=r.length,a=e.boxWidthList=[],i=e.boxOffsetList=[],o=[],s;if(t.type==="category")s=t.getBandWidth();else{var l=0;eo(r,function(v){l=Math.max(l,v.getData().count())});var u=t.getExtent();s=Math.abs(u[1]-u[0])/l}eo(r,function(v){var p=v.get("boxWidth");te(p)||(p=[p,p]),o.push([ee(p[0],s)||0,ee(p[1],s)||0])});var c=s*.8-2,h=c/n*.3,f=(c-h*(n-1))/n,d=f/2-c/2;eo(r,function(v,p){i.push(d),d+=h+f,a.push(Math.min(Math.max(f,o[p][0]),o[p][1]))})}function ZE(e,t,r){var n=e.coordinateSystem,a=e.getData(),i=r/2,o=e.get("layout")==="horizontal"?0:1,s=1-o,l=["x","y"],u=a.mapDimension(l[o]),c=a.mapDimensionsAll(l[s]);if(u==null||c.length<5)return;for(var h=0;h<a.count();h++){var f=a.get(u,h),d=y(f,c[2],h),v=y(f,c[0],h),p=y(f,c[1],h),g=y(f,c[3],h),m=y(f,c[4],h),_=[];x(_,p,!1),x(_,g,!0),_.push(v,p,m,g),S(_,v),S(_,m),S(_,d),a.setItemLayout(h,{initBaseline:d[s],ends:_})}function y(T,b,w){var A=a.get(b,w),E=[];E[o]=T,E[s]=A;var C;return isNaN(T)||isNaN(A)?C=[NaN,NaN]:(C=n.dataToPoint(E),C[o]+=t),C}function x(T,b,w){var A=b.slice(),E=b.slice();A[o]+=i,E[o]-=i,w?T.push(A,E):T.push(E,A)}function S(T,b){var w=b.slice(),A=b.slice();w[o]-=i,A[o]+=i,T.push(w,A)}}function YE(e,t){t=t||{};for(var r=[],n=[],a=t.boundIQR,i=a==="none"||a===0,o=0;o<e.length;o++){var s=Vr(e[o].slice()),l=pu(s,.25),u=pu(s,.5),c=pu(s,.75),h=s[0],f=s[s.length-1],d=(a??1.5)*(c-l),v=i?h:Math.max(h,l-d),p=i?f:Math.min(f,c+d),g=t.itemNameFormatter,m=xt(g)?g({value:o}):Ve(g)?g.replace("{value}",o+""):o+"";r.push([m,v,l,u,c,p]);for(var _=0;_<s.length;_++){var y=s[_];if(y<v||y>p){var x=[m,y];n.push(x)}}}return{boxData:r,outliers:n}}var qE={type:"echarts:boxplot",transform:function(t){var r=t.upstream;if(r.sourceFormat!==ym){var n="";ct(n)}var a=YE(r.getRawData(),t.config);return[{dimensions:["ItemName","Low","Q1","Q2","Q3","High"],data:a.boxData},{data:a.outliers}]}};function KE(e){e.registerSeriesModel(GE),e.registerChartView(WE),e.registerLayout($E),e.registerTransform(qE)}var JE=["color","borderColor"],QE=function(e){U(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.render=function(r,n,a){this.group.removeClipPath(),this._progressiveEls=null,this._updateDrawMode(r),this._isLargeDraw?this._renderLarge(r):this._renderNormal(r)},t.prototype.incrementalPrepareRender=function(r,n,a){this._clear(),this._updateDrawMode(r)},t.prototype.incrementalRender=function(r,n,a,i){this._progressiveEls=[],this._isLargeDraw?this._incrementalRenderLarge(r,n):this._incrementalRenderNormal(r,n)},t.prototype.eachRendered=function(r){Rl(this._progressiveEls||this.group,r)},t.prototype._updateDrawMode=function(r){var n=r.pipelineContext.large;(this._isLargeDraw==null||n!==this._isLargeDraw)&&(this._isLargeDraw=n,this._clear())},t.prototype._renderNormal=function(r){var n=r.getData(),a=this._data,i=this.group,o=n.getLayout("isSimpleBox"),s=r.get("clip",!0),l=r.coordinateSystem,u=l.getArea&&l.getArea();this._data||i.removeAll(),n.diff(a).add(function(c){if(n.hasValue(c)){var h=n.getItemLayout(c);if(s&&dp(u,h))return;var f=Hu(h,c,!0);ar(f,{shape:{points:h.ends}},r,c),Wu(f,n,c,o),i.add(f),n.setItemGraphicEl(c,f)}}).update(function(c,h){var f=a.getItemGraphicEl(h);if(!n.hasValue(c)){i.remove(f);return}var d=n.getItemLayout(c);if(s&&dp(u,d)){i.remove(f);return}f?(st(f,{shape:{points:d.ends}},r,c),Ln(f)):f=Hu(d),Wu(f,n,c,o),i.add(f),n.setItemGraphicEl(c,f)}).remove(function(c){var h=a.getItemGraphicEl(c);h&&i.remove(h)}).execute(),this._data=n},t.prototype._renderLarge=function(r){this._clear(),vp(r,this.group);var n=r.get("clip",!0)?uf(r.coordinateSystem,!1,r):null;n?this.group.setClipPath(n):this.group.removeClipPath()},t.prototype._incrementalRenderNormal=function(r,n){for(var a=n.getData(),i=a.getLayout("isSimpleBox"),o;(o=r.next())!=null;){var s=a.getItemLayout(o),l=Hu(s);Wu(l,a,o,i),l.incremental=!0,this.group.add(l),this._progressiveEls.push(l)}},t.prototype._incrementalRenderLarge=function(r,n){vp(n,this.group,this._progressiveEls,!0)},t.prototype.remove=function(r){this._clear()},t.prototype._clear=function(){this.group.removeAll(),this._data=null},t.type="candlestick",t}(He),eC=function(){function e(){}return e}(),tC=function(e){U(t,e);function t(r){var n=e.call(this,r)||this;return n.type="normalCandlestickBox",n}return t.prototype.getDefaultShape=function(){return new eC},t.prototype.buildPath=function(r,n){var a=n.points;this.__simpleBox?(r.moveTo(a[4][0],a[4][1]),r.lineTo(a[6][0],a[6][1])):(r.moveTo(a[0][0],a[0][1]),r.lineTo(a[1][0],a[1][1]),r.lineTo(a[2][0],a[2][1]),r.lineTo(a[3][0],a[3][1]),r.closePath(),r.moveTo(a[4][0],a[4][1]),r.lineTo(a[5][0],a[5][1]),r.moveTo(a[6][0],a[6][1]),r.lineTo(a[7][0],a[7][1]))},t}(Gt);function Hu(e,t,r){var n=e.ends;return new tC({shape:{points:r?rC(n,e):n},z2:100})}function dp(e,t){for(var r=!0,n=0;n<t.ends.length;n++)if(e.contain(t.ends[n][0],t.ends[n][1])){r=!1;break}return r}function Wu(e,t,r,n){var a=t.getItemModel(r);e.useStyle(t.getItemVisual(r,"style")),e.style.strokeNoScale=!0,e.__simpleBox=n,ur(e,a)}function rC(e,t){return K(e,function(r){return r=r.slice(),r[1]=t.initBaseline,r})}var nC=function(){function e(){}return e}(),$u=function(e){U(t,e);function t(r){var n=e.call(this,r)||this;return n.type="largeCandlestickBox",n}return t.prototype.getDefaultShape=function(){return new nC},t.prototype.buildPath=function(r,n){for(var a=n.points,i=0;i<a.length;)if(this.__sign===a[i++]){var o=a[i++];r.moveTo(o,a[i++]),r.lineTo(o,a[i++])}else i+=3},t}(Gt);function vp(e,t,r,n){var a=e.getData(),i=a.getLayout("largePoints"),o=new $u({shape:{points:i},__sign:1,ignoreCoarsePointer:!0});t.add(o);var s=new $u({shape:{points:i},__sign:-1,ignoreCoarsePointer:!0});t.add(s);var l=new $u({shape:{points:i},__sign:0,ignoreCoarsePointer:!0});t.add(l),Xu(1,o,e),Xu(-1,s,e),Xu(0,l,e),n&&(o.incremental=!0,s.incremental=!0),r&&r.push(o,s)}function Xu(e,t,r,n){var a=r.get(["itemStyle",e>0?"borderColor":"borderColor0"])||r.get(["itemStyle",e>0?"color":"color0"]);e===0&&(a=r.get(["itemStyle","borderColorDoji"]));var i=r.getModel("itemStyle").getItemStyle(JE);t.useStyle(i),t.style.fill=null,t.style.stroke=a}const aC=QE;var t_=function(e){U(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r.defaultValueDimensions=[{name:"open",defaultTooltip:!0},{name:"close",defaultTooltip:!0},{name:"lowest",defaultTooltip:!0},{name:"highest",defaultTooltip:!0}],r}return t.prototype.getShadowDim=function(){return"open"},t.prototype.brushSelector=function(r,n,a){var i=n.getItemLayout(r);return i&&a.rect(i.brushRect)},t.type="series.candlestick",t.dependencies=["xAxis","yAxis","grid"],t.defaultOption={z:2,coordinateSystem:"cartesian2d",legendHoverLink:!0,layout:null,clip:!0,itemStyle:{color:"#eb5454",color0:"#47b262",borderColor:"#eb5454",borderColor0:"#47b262",borderColorDoji:null,borderWidth:1},emphasis:{scale:!0,itemStyle:{borderWidth:2}},barMaxWidth:null,barMinWidth:null,barWidth:null,large:!0,largeThreshold:600,progressive:3e3,progressiveThreshold:1e4,progressiveChunkMode:"mod",animationEasing:"linear",animationDuration:300},t}($e);Xr(t_,Jy,!0);const iC=t_;function oC(e){!e||!te(e.series)||R(e.series,function(t){Hr(t)&&t.type==="k"&&(t.type="candlestick")})}var sC=["itemStyle","borderColor"],lC=["itemStyle","borderColor0"],uC=["itemStyle","borderColorDoji"],cC=["itemStyle","color"],hC=["itemStyle","color0"],fC={seriesType:"candlestick",plan:cf(),performRawSeries:!0,reset:function(e,t){function r(i,o){return o.get(i>0?cC:hC)}function n(i,o){return o.get(i===0?uC:i>0?sC:lC)}if(!t.isSeriesFiltered(e)){var a=e.pipelineContext.large;return!a&&{progress:function(i,o){for(var s;(s=i.next())!=null;){var l=o.getItemModel(s),u=o.getItemLayout(s).sign,c=l.getItemStyle();c.fill=r(u,l),c.stroke=n(u,l)||c.fill;var h=o.ensureUniqueItemVisual(s,"style");le(h,c)}}}}}};const dC=fC;var vC={seriesType:"candlestick",plan:cf(),reset:function(e){var t=e.coordinateSystem,r=e.getData(),n=pC(e,r),a=0,i=1,o=["x","y"],s=r.getDimensionIndex(r.mapDimension(o[a])),l=K(r.mapDimensionsAll(o[i]),r.getDimensionIndex,r),u=l[0],c=l[1],h=l[2],f=l[3];if(r.setLayout({candleWidth:n,isSimpleBox:n<=1.3}),s<0||l.length<4)return;return{progress:e.pipelineContext.large?v:d};function d(p,g){for(var m,_=g.getStore();(m=p.next())!=null;){var y=_.get(s,m),x=_.get(u,m),S=_.get(c,m),T=_.get(h,m),b=_.get(f,m),w=Math.min(x,S),A=Math.max(x,S),E=F(w,y),C=F(A,y),M=F(T,y),P=F(b,y),L=[];B(L,C,0),B(L,E,1),L.push(z(P),z(C),z(M),z(E));var I=g.getItemModel(m),N=!!I.get(["itemStyle","borderColorDoji"]);g.setItemLayout(m,{sign:pp(_,m,x,S,c,N),initBaseline:x>S?C[i]:E[i],ends:L,brushRect:k(T,b,y)})}function F(W,J){var re=[];return re[a]=J,re[i]=W,isNaN(J)||isNaN(W)?[NaN,NaN]:t.dataToPoint(re)}function B(W,J,re){var Q=J.slice(),q=J.slice();Q[a]=gu(Q[a]+n/2,1,!1),q[a]=gu(q[a]-n/2,1,!0),re?W.push(Q,q):W.push(q,Q)}function k(W,J,re){var Q=F(W,re),q=F(J,re);return Q[a]-=n/2,q[a]-=n/2,{x:Q[0],y:Q[1],width:n,height:q[1]-Q[1]}}function z(W){return W[a]=gu(W[a],1),W}}function v(p,g){for(var m=cT(p.count*4),_=0,y,x=[],S=[],T,b=g.getStore(),w=!!e.get(["itemStyle","borderColorDoji"]);(T=p.next())!=null;){var A=b.get(s,T),E=b.get(u,T),C=b.get(c,T),M=b.get(h,T),P=b.get(f,T);if(isNaN(A)||isNaN(M)||isNaN(P)){m[_++]=NaN,_+=3;continue}m[_++]=pp(b,T,E,C,c,w),x[a]=A,x[i]=M,y=t.dataToPoint(x,null,S),m[_++]=y?y[0]:NaN,m[_++]=y?y[1]:NaN,x[i]=P,y=t.dataToPoint(x,null,S),m[_++]=y?y[1]:NaN}g.setLayout("largePoints",m)}}};function pp(e,t,r,n,a,i){var o;return r>n?o=-1:r<n?o=1:o=i?0:t>0?e.get(a,t-1)<=n?1:-1:1,o}function pC(e,t){var r=e.getBaseAxis(),n,a=r.type==="category"?r.getBandWidth():(n=r.getExtent(),Math.abs(n[1]-n[0])/t.count()),i=ee(jt(e.get("barMaxWidth"),a),a),o=ee(jt(e.get("barMinWidth"),1),a),s=e.get("barWidth");return s!=null?ee(s,a):Math.max(Math.min(a/2,i),o)}const gC=vC;function mC(e){e.registerChartView(aC),e.registerSeriesModel(iC),e.registerPreprocessor(oC),e.registerVisual(dC),e.registerLayout(gC)}var yC=function(e){U(t,e);function t(r,n,a){var i=e.call(this)||this;return i.add(i.createLine(r,n,a)),i._updateEffectSymbol(r,n),i}return t.prototype.createLine=function(r,n,a){return new Mf(r,n,a)},t.prototype._updateEffectSymbol=function(r,n){var a=r.getItemModel(n),i=a.getModel("effect"),o=i.get("symbolSize"),s=i.get("symbol");te(o)||(o=[o,o]);var l=r.getItemVisual(n,"style"),u=i.get("color")||l&&l.stroke,c=this.childAt(1);this._symbolType!==s&&(this.remove(c),c=Pr(s,-.5,-.5,1,1,u),c.z2=100,c.culling=!0,this.add(c)),c&&(c.setStyle("shadowColor",u),c.setStyle(i.getItemStyle(["color"])),c.scaleX=o[0],c.scaleY=o[1],c.setColor(u),this._symbolType=s,this._symbolScale=o,this._updateEffectAnimation(r,i,n))},t.prototype._updateEffectAnimation=function(r,n,a){var i=this.childAt(1);if(i){var o=r.getItemLayout(a),s=n.get("period")*1e3,l=n.get("loop"),u=n.get("roundTrip"),c=n.get("constantSpeed"),h=Lr(n.get("delay"),function(d){return d/r.count()*s/3});if(i.ignore=!0,this._updateAnimationPoints(i,o),c>0&&(s=this._getLineLength(i)/c*1e3),s!==this._period||l!==this._loop||u!==this._roundTrip){i.stopAnimation();var f=void 0;xt(h)?f=h(a):f=h,i.__t>0&&(f=-s*i.__t),this._animateSymbol(i,s,f,l,u)}this._period=s,this._loop=l,this._roundTrip=u}},t.prototype._animateSymbol=function(r,n,a,i,o){if(n>0){r.__t=0;var s=this,l=r.animate("",i).when(o?n*2:n,{__t:o?2:1}).delay(a).during(function(){s._updateSymbolPosition(r)});i||l.done(function(){s.remove(r)}),l.start()}},t.prototype._getLineLength=function(r){return ki(r.__p1,r.__cp1)+ki(r.__cp1,r.__p2)},t.prototype._updateAnimationPoints=function(r,n){r.__p1=n[0],r.__p2=n[1],r.__cp1=n[2]||[(n[0][0]+n[1][0])/2,(n[0][1]+n[1][1])/2]},t.prototype.updateData=function(r,n,a){this.childAt(0).updateData(r,n,a),this._updateEffectSymbol(r,n)},t.prototype._updateSymbolPosition=function(r){var n=r.__p1,a=r.__p2,i=r.__cp1,o=r.__t<1?r.__t:2-r.__t,s=[r.x,r.y],l=s.slice(),u=dm,c=hT;s[0]=u(n[0],i[0],a[0],o),s[1]=u(n[1],i[1],a[1],o);var h=r.__t<1?c(n[0],i[0],a[0],o):c(a[0],i[0],n[0],1-o),f=r.__t<1?c(n[1],i[1],a[1],o):c(a[1],i[1],n[1],1-o);r.rotation=-Math.atan2(f,h)-Math.PI/2,(this._symbolType==="line"||this._symbolType==="rect"||this._symbolType==="roundRect")&&(r.__lastT!==void 0&&r.__lastT<r.__t?(r.scaleY=ki(l,s)*1.05,o===1&&(s[0]=l[0]+(s[0]-l[0])/2,s[1]=l[1]+(s[1]-l[1])/2)):r.__lastT===1?r.scaleY=2*ki(n,s):r.scaleY=this._symbolScale[1]),r.__lastT=r.__t,r.ignore=!1,r.x=s[0],r.y=s[1]},t.prototype.updateLayout=function(r,n){this.childAt(0).updateLayout(r,n);var a=r.getItemModel(n).getModel("effect");this._updateEffectAnimation(r,a,n)},t}(Fe);const r_=yC;var _C=function(e){U(t,e);function t(r,n,a){var i=e.call(this)||this;return i._createPolyline(r,n,a),i}return t.prototype._createPolyline=function(r,n,a){var i=r.getItemLayout(n),o=new Nn({shape:{points:i}});this.add(o),this._updateCommonStl(r,n,a)},t.prototype.updateData=function(r,n,a){var i=r.hostModel,o=this.childAt(0),s={shape:{points:r.getItemLayout(n)}};st(o,s,i,n),this._updateCommonStl(r,n,a)},t.prototype._updateCommonStl=function(r,n,a){var i=this.childAt(0),o=r.getItemModel(n),s=a&&a.emphasisLineStyle,l=a&&a.focus,u=a&&a.blurScope,c=a&&a.emphasisDisabled;if(!a||r.hasItemOption){var h=o.getModel("emphasis");s=h.getModel("lineStyle").getLineStyle(),c=h.get("disabled"),l=h.get("focus"),u=h.get("blurScope")}i.useStyle(r.getItemVisual(n,"style")),i.style.fill=null,i.style.strokeNoScale=!0;var f=i.ensureState("emphasis");f.style=s,zt(this,l,u,c)},t.prototype.updateLayout=function(r,n){var a=this.childAt(0);a.setShape("points",r.getItemLayout(n))},t}(Fe);const n_=_C;var xC=function(e){U(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r._lastFrame=0,r._lastFramePercent=0,r}return t.prototype.createLine=function(r,n,a){return new n_(r,n,a)},t.prototype._updateAnimationPoints=function(r,n){this._points=n;for(var a=[0],i=0,o=1;o<n.length;o++){var s=n[o-1],l=n[o];i+=ki(s,l),a.push(i)}if(i===0){this._length=0;return}for(var o=0;o<a.length;o++)a[o]/=i;this._offsets=a,this._length=i},t.prototype._getLineLength=function(){return this._length},t.prototype._updateSymbolPosition=function(r){var n=r.__t<1?r.__t:2-r.__t,a=this._points,i=this._offsets,o=a.length;if(i){var s=this._lastFrame,l;if(n<this._lastFramePercent){var u=Math.min(s+1,o-1);for(l=u;l>=0&&!(i[l]<=n);l--);l=Math.min(l,o-2)}else{for(l=s;l<o&&!(i[l]>n);l++);l=Math.min(l-1,o-2)}var c=(n-i[l])/(i[l+1]-i[l]),h=a[l],f=a[l+1];r.x=h[0]*(1-c)+c*f[0],r.y=h[1]*(1-c)+c*f[1];var d=r.__t<1?f[0]-h[0]:h[0]-f[0],v=r.__t<1?f[1]-h[1]:h[1]-f[1];r.rotation=-Math.atan2(v,d)-Math.PI/2,this._lastFrame=l,this._lastFramePercent=n,r.ignore=!1}},t}(r_);const SC=xC;var TC=function(){function e(){this.polyline=!1,this.curveness=0,this.segs=[]}return e}(),bC=function(e){U(t,e);function t(r){var n=e.call(this,r)||this;return n._off=0,n.hoverDataIdx=-1,n}return t.prototype.reset=function(){this.notClear=!1,this._off=0},t.prototype.getDefaultStyle=function(){return{stroke:"#000",fill:null}},t.prototype.getDefaultShape=function(){return new TC},t.prototype.buildPath=function(r,n){var a=n.segs,i=n.curveness,o;if(n.polyline)for(o=this._off;o<a.length;){var s=a[o++];if(s>0){r.moveTo(a[o++],a[o++]);for(var l=1;l<s;l++)r.lineTo(a[o++],a[o++])}}else for(o=this._off;o<a.length;){var u=a[o++],c=a[o++],h=a[o++],f=a[o++];if(r.moveTo(u,c),i>0){var d=(u+h)/2-(c-f)*i,v=(c+f)/2-(h-u)*i;r.quadraticCurveTo(d,v,h,f)}else r.lineTo(h,f)}this.incremental&&(this._off=o,this.notClear=!0)},t.prototype.findDataIndex=function(r,n){var a=this.shape,i=a.segs,o=a.curveness,s=this.style.lineWidth;if(a.polyline)for(var l=0,u=0;u<i.length;){var c=i[u++];if(c>0)for(var h=i[u++],f=i[u++],d=1;d<c;d++){var v=i[u++],p=i[u++];if(th(h,f,v,p,s,r,n))return l}l++}else for(var l=0,u=0;u<i.length;){var h=i[u++],f=i[u++],v=i[u++],p=i[u++];if(o>0){var g=(h+v)/2-(f-p)*o,m=(f+p)/2-(v-h)*o;if(fT(h,f,g,m,v,p,s,r,n))return l}else if(th(h,f,v,p,s,r,n))return l;l++}return-1},t.prototype.contain=function(r,n){var a=this.transformCoordToLocal(r,n),i=this.getBoundingRect();if(r=a[0],n=a[1],i.contain(r,n)){var o=this.hoverDataIdx=this.findDataIndex(r,n);return o>=0}return this.hoverDataIdx=-1,!1},t.prototype.getBoundingRect=function(){var r=this._rect;if(!r){for(var n=this.shape,a=n.segs,i=1/0,o=1/0,s=-1/0,l=-1/0,u=0;u<a.length;){var c=a[u++],h=a[u++];i=Math.min(c,i),s=Math.max(c,s),o=Math.min(h,o),l=Math.max(h,l)}r=this._rect=new Yt(i,o,s,l)}return r},t}(Gt),wC=function(){function e(){this.group=new Fe}return e.prototype.updateData=function(t){this._clear();var r=this._create();r.setShape({segs:t.getLayout("linesPoints")}),this._setCommon(r,t)},e.prototype.incrementalPrepareUpdate=function(t){this.group.removeAll(),this._clear()},e.prototype.incrementalUpdate=function(t,r){var n=this._newAdded[0],a=r.getLayout("linesPoints"),i=n&&n.shape.segs;if(i&&i.length<2e4){var o=i.length,s=new Float32Array(o+a.length);s.set(i),s.set(a,o),n.setShape({segs:s})}else{this._newAdded=[];var l=this._create();l.incremental=!0,l.setShape({segs:a}),this._setCommon(l,r),l.__startIndex=t.start}},e.prototype.remove=function(){this._clear()},e.prototype.eachRendered=function(t){this._newAdded[0]&&t(this._newAdded[0])},e.prototype._create=function(){var t=new bC({cursor:"default",ignoreCoarsePointer:!0});return this._newAdded.push(t),this.group.add(t),t},e.prototype._setCommon=function(t,r,n){var a=r.hostModel;t.setShape({polyline:a.get("polyline"),curveness:a.get(["lineStyle","curveness"])}),t.useStyle(a.getModel("lineStyle").getLineStyle()),t.style.strokeNoScale=!0;var i=r.getVisual("style");i&&i.stroke&&t.setStyle("stroke",i.stroke),t.setStyle("fill",null);var o=et(t);o.seriesIndex=a.seriesIndex,t.on("mousemove",function(s){o.dataIndex=null;var l=t.hoverDataIdx;l>0&&(o.dataIndex=l+t.__startIndex)})},e.prototype._clear=function(){this._newAdded=[],this.group.removeAll()},e}();const AC=wC;var EC={seriesType:"lines",plan:cf(),reset:function(e){var t=e.coordinateSystem;if(t){var r=e.get("polyline"),n=e.pipelineContext.large;return{progress:function(a,i){var o=[];if(n){var s=void 0,l=a.end-a.start;if(r){for(var u=0,c=a.start;c<a.end;c++)u+=e.getLineCoordsCount(c);s=new Float32Array(l+u*2)}else s=new Float32Array(l*4);for(var h=0,f=[],c=a.start;c<a.end;c++){var d=e.getLineCoords(c,o);r&&(s[h++]=d);for(var v=0;v<d;v++)f=t.dataToPoint(o[v],!1,f),s[h++]=f[0],s[h++]=f[1]}i.setLayout("linesPoints",s)}else for(var c=a.start;c<a.end;c++){var p=i.getItemModel(c),d=e.getLineCoords(c,o),g=[];if(r)for(var m=0;m<d;m++)g.push(t.dataToPoint(o[m]));else{g[0]=t.dataToPoint(o[0]),g[1]=t.dataToPoint(o[1]);var _=p.get(["lineStyle","curveness"]);+_&&(g[2]=[(g[0][0]+g[1][0])/2-(g[0][1]-g[1][1])*_,(g[0][1]+g[1][1])/2-(g[1][0]-g[0][0])*_])}i.setItemLayout(c,g)}}}}}};const a_=EC;var CC=function(e){U(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.render=function(r,n,a){var i=r.getData(),o=this._updateLineDraw(i,r),s=r.get("zlevel"),l=r.get(["effect","trailLength"]),u=a.getZr(),c=u.painter.getType()==="svg";c||u.painter.getLayer(s).clear(!0),this._lastZlevel!=null&&!c&&u.configLayer(this._lastZlevel,{motionBlur:!1}),this._showEffect(r)&&l>0&&(c||u.configLayer(s,{motionBlur:!0,lastFrameAlpha:Math.max(Math.min(l/10+.9,1),0)})),o.updateData(i);var h=r.get("clip",!0)&&uf(r.coordinateSystem,!1,r);h?this.group.setClipPath(h):this.group.removeClipPath(),this._lastZlevel=s,this._finished=!0},t.prototype.incrementalPrepareRender=function(r,n,a){var i=r.getData(),o=this._updateLineDraw(i,r);o.incrementalPrepareUpdate(i),this._clearLayer(a),this._finished=!1},t.prototype.incrementalRender=function(r,n,a){this._lineDraw.incrementalUpdate(r,n.getData()),this._finished=r.end===n.getData().count()},t.prototype.eachRendered=function(r){this._lineDraw&&this._lineDraw.eachRendered(r)},t.prototype.updateTransform=function(r,n,a){var i=r.getData(),o=r.pipelineContext;if(!this._finished||o.large||o.progressiveRender)return{update:!0};var s=a_.reset(r,n,a);s.progress&&s.progress({start:0,end:i.count(),count:i.count()},i),this._lineDraw.updateLayout(),this._clearLayer(a)},t.prototype._updateLineDraw=function(r,n){var a=this._lineDraw,i=this._showEffect(n),o=!!n.get("polyline"),s=n.pipelineContext,l=s.large;return(!a||i!==this._hasEffet||o!==this._isPolyline||l!==this._isLargeDraw)&&(a&&a.remove(),a=this._lineDraw=l?new AC:new Pf(o?i?SC:n_:i?r_:Mf),this._hasEffet=i,this._isPolyline=o,this._isLargeDraw=l),this.group.add(a.group),a},t.prototype._showEffect=function(r){return!!r.get(["effect","show"])},t.prototype._clearLayer=function(r){var n=r.getZr(),a=n.painter.getType()==="svg";!a&&this._lastZlevel!=null&&n.painter.getLayer(this._lastZlevel).clear(!0)},t.prototype.remove=function(r,n){this._lineDraw&&this._lineDraw.remove(),this._lineDraw=null,this._clearLayer(n)},t.prototype.dispose=function(r,n){this.remove(r,n)},t.type="lines",t}(He);const LC=CC;var DC=typeof Uint32Array>"u"?Array:Uint32Array,MC=typeof Float64Array>"u"?Array:Float64Array;function gp(e){var t=e.data;t&&t[0]&&t[0][0]&&t[0][0].coord&&(e.data=K(t,function(r){var n=[r[0].coord,r[1].coord],a={coords:n};return r[0].name&&(a.fromName=r[0].name),r[1].name&&(a.toName=r[1].name),_m([a,r[0],r[1]])}))}var PC=function(e){U(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r.visualStyleAccessPath="lineStyle",r.visualDrawType="stroke",r}return t.prototype.init=function(r){r.data=r.data||[],gp(r);var n=this._processFlatCoordsArray(r.data);this._flatCoords=n.flatCoords,this._flatCoordsOffset=n.flatCoordsOffset,n.flatCoords&&(r.data=new Float32Array(n.count)),e.prototype.init.apply(this,arguments)},t.prototype.mergeOption=function(r){if(gp(r),r.data){var n=this._processFlatCoordsArray(r.data);this._flatCoords=n.flatCoords,this._flatCoordsOffset=n.flatCoordsOffset,n.flatCoords&&(r.data=new Float32Array(n.count))}e.prototype.mergeOption.apply(this,arguments)},t.prototype.appendData=function(r){var n=this._processFlatCoordsArray(r.data);n.flatCoords&&(this._flatCoords?(this._flatCoords=so(this._flatCoords,n.flatCoords),this._flatCoordsOffset=so(this._flatCoordsOffset,n.flatCoordsOffset)):(this._flatCoords=n.flatCoords,this._flatCoordsOffset=n.flatCoordsOffset),r.data=new Float32Array(n.count)),this.getRawData().appendData(r.data)},t.prototype._getCoordsFromItemModel=function(r){var n=this.getData().getItemModel(r),a=n.option instanceof Array?n.option:n.getShallow("coords");return a},t.prototype.getLineCoordsCount=function(r){return this._flatCoordsOffset?this._flatCoordsOffset[r*2+1]:this._getCoordsFromItemModel(r).length},t.prototype.getLineCoords=function(r,n){if(this._flatCoordsOffset){for(var a=this._flatCoordsOffset[r*2],i=this._flatCoordsOffset[r*2+1],o=0;o<i;o++)n[o]=n[o]||[],n[o][0]=this._flatCoords[a+o*2],n[o][1]=this._flatCoords[a+o*2+1];return i}else{for(var s=this._getCoordsFromItemModel(r),o=0;o<s.length;o++)n[o]=n[o]||[],n[o][0]=s[o][0],n[o][1]=s[o][1];return s.length}},t.prototype._processFlatCoordsArray=function(r){var n=0;if(this._flatCoords&&(n=this._flatCoords.length),Mr(r[0])){for(var a=r.length,i=new DC(a),o=new MC(a),s=0,l=0,u=0,c=0;c<a;){u++;var h=r[c++];i[l++]=s+n,i[l++]=h;for(var f=0;f<h;f++){var d=r[c++],v=r[c++];o[s++]=d,o[s++]=v}}return{flatCoordsOffset:new Uint32Array(i.buffer,0,l),flatCoords:o,count:u}}return{flatCoordsOffset:null,flatCoords:null,count:r.length}},t.prototype.getInitialData=function(r,n){var a=new it(["value"],this);return a.hasItemOption=!1,a.initData(r.data,[],function(i,o,s,l){if(i instanceof Array)return NaN;a.hasItemOption=!0;var u=i.value;if(u!=null)return u instanceof Array?u[l]:u}),a},t.prototype.formatTooltip=function(r,n,a){var i=this.getData(),o=i.getItemModel(r),s=o.get("name");if(s)return s;var l=o.get("fromName"),u=o.get("toName"),c=[];return l!=null&&c.push(l),u!=null&&c.push(u),$r("nameValue",{name:c.join(" > ")})},t.prototype.preventIncremental=function(){return!!this.get(["effect","show"])},t.prototype.getProgressive=function(){var r=this.option.progressive;return r??(this.option.large?1e4:this.get("progressive"))},t.prototype.getProgressiveThreshold=function(){var r=this.option.progressiveThreshold;return r??(this.option.large?2e4:this.get("progressiveThreshold"))},t.prototype.getZLevelKey=function(){var r=this.getModel("effect"),n=r.get("trailLength");return this.getData().count()>this.getProgressiveThreshold()?this.id:r.get("show")&&n>0?n+"":""},t.type="series.lines",t.dependencies=["grid","polar","geo","calendar"],t.defaultOption={coordinateSystem:"geo",z:2,legendHoverLink:!0,xAxisIndex:0,yAxisIndex:0,symbol:["none","none"],symbolSize:[10,10],geoIndex:0,effect:{show:!1,period:4,constantSpeed:0,symbol:"circle",symbolSize:3,loop:!0,trailLength:.2},large:!1,largeThreshold:2e3,polyline:!1,clip:!0,label:{show:!1,position:"end"},lineStyle:{opacity:.5}},t}($e);const IC=PC;function ns(e){return e instanceof Array||(e=[e,e]),e}var RC={seriesType:"lines",reset:function(e){var t=ns(e.get("symbol")),r=ns(e.get("symbolSize")),n=e.getData();n.setVisual("fromSymbol",t&&t[0]),n.setVisual("toSymbol",t&&t[1]),n.setVisual("fromSymbolSize",r&&r[0]),n.setVisual("toSymbolSize",r&&r[1]);function a(i,o){var s=i.getItemModel(o),l=ns(s.getShallow("symbol",!0)),u=ns(s.getShallow("symbolSize",!0));l[0]&&i.setItemVisual(o,"fromSymbol",l[0]),l[1]&&i.setItemVisual(o,"toSymbol",l[1]),u[0]&&i.setItemVisual(o,"fromSymbolSize",u[0]),u[1]&&i.setItemVisual(o,"toSymbolSize",u[1])}return{dataEach:n.hasItemOption?a:null}}};const NC=RC;function OC(e){e.registerChartView(LC),e.registerSeriesModel(IC),e.registerLayout(a_),e.registerVisual(NC)}var BC=256,FC=function(){function e(){this.blurSize=30,this.pointSize=20,this.maxOpacity=1,this.minOpacity=0,this._gradientPixels={inRange:null,outOfRange:null};var t=tv.createCanvas();this.canvas=t}return e.prototype.update=function(t,r,n,a,i,o){var s=this._getBrush(),l=this._getGradient(i,"inRange"),u=this._getGradient(i,"outOfRange"),c=this.pointSize+this.blurSize,h=this.canvas,f=h.getContext("2d"),d=t.length;h.width=r,h.height=n;for(var v=0;v<d;++v){var p=t[v],g=p[0],m=p[1],_=p[2],y=a(_);f.globalAlpha=y,f.drawImage(s,g-c,m-c)}if(!h.width||!h.height)return h;for(var x=f.getImageData(0,0,h.width,h.height),S=x.data,T=0,b=S.length,w=this.minOpacity,A=this.maxOpacity,E=A-w;T<b;){var y=S[T+3]/256,C=Math.floor(y*(BC-1))*4;if(y>0){var M=o(y)?l:u;y>0&&(y=y*E+w),S[T++]=M[C],S[T++]=M[C+1],S[T++]=M[C+2],S[T++]=M[C+3]*y*256}else T+=4}return f.putImageData(x,0,0),h},e.prototype._getBrush=function(){var t=this._brushCanvas||(this._brushCanvas=tv.createCanvas()),r=this.pointSize+this.blurSize,n=r*2;t.width=n,t.height=n;var a=t.getContext("2d");return a.clearRect(0,0,n,n),a.shadowOffsetX=n,a.shadowBlur=this.blurSize,a.shadowColor="#000",a.beginPath(),a.arc(-r,r,this.pointSize,0,Math.PI*2,!0),a.closePath(),a.fill(),t},e.prototype._getGradient=function(t,r){for(var n=this._gradientPixels,a=n[r]||(n[r]=new Uint8ClampedArray(256*4)),i=[0,0,0,0],o=0,s=0;s<256;s++)t[r](s/255,!0,i),a[o++]=i[0],a[o++]=i[1],a[o++]=i[2],a[o++]=i[3];return a},e}();const zC=FC;function GC(e,t,r){var n=e[1]-e[0];t=K(t,function(o){return{interval:[(o.interval[0]-e[0])/n,(o.interval[1]-e[0])/n]}});var a=t.length,i=0;return function(o){var s;for(s=i;s<a;s++){var l=t[s].interval;if(l[0]<=o&&o<=l[1]){i=s;break}}if(s===a)for(s=i-1;s>=0;s--){var l=t[s].interval;if(l[0]<=o&&o<=l[1]){i=s;break}}return s>=0&&s<a&&r[s]}}function VC(e,t){var r=e[1]-e[0];return t=[(t[0]-e[0])/r,(t[1]-e[0])/r],function(n){return n>=t[0]&&n<=t[1]}}function mp(e){var t=e.dimensions;return t[0]==="lng"&&t[1]==="lat"}var UC=function(e){U(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.render=function(r,n,a){var i;n.eachComponent("visualMap",function(s){s.eachTargetSeries(function(l){l===r&&(i=s)})}),this._progressiveEls=null,this.group.removeAll();var o=r.coordinateSystem;o.type==="cartesian2d"||o.type==="calendar"?this._renderOnCartesianAndCalendar(r,a,0,r.getData().count()):mp(o)&&this._renderOnGeo(o,r,i,a)},t.prototype.incrementalPrepareRender=function(r,n,a){this.group.removeAll()},t.prototype.incrementalRender=function(r,n,a,i){var o=n.coordinateSystem;o&&(mp(o)?this.render(n,a,i):(this._progressiveEls=[],this._renderOnCartesianAndCalendar(n,i,r.start,r.end,!0)))},t.prototype.eachRendered=function(r){Rl(this._progressiveEls||this.group,r)},t.prototype._renderOnCartesianAndCalendar=function(r,n,a,i,o){var s=r.coordinateSystem,l=Ol(s,"cartesian2d"),u,c,h,f;if(l){var d=s.getAxis("x"),v=s.getAxis("y");u=d.getBandWidth()+.5,c=v.getBandWidth()+.5,h=d.scale.getExtent(),f=v.scale.getExtent()}for(var p=this.group,g=r.getData(),m=r.getModel(["emphasis","itemStyle"]).getItemStyle(),_=r.getModel(["blur","itemStyle"]).getItemStyle(),y=r.getModel(["select","itemStyle"]).getItemStyle(),x=r.get(["itemStyle","borderRadius"]),S=wr(r),T=r.getModel("emphasis"),b=T.get("focus"),w=T.get("blurScope"),A=T.get("disabled"),E=l?[g.mapDimension("x"),g.mapDimension("y"),g.mapDimension("value")]:[g.mapDimension("time"),g.mapDimension("value")],C=a;C<i;C++){var M=void 0,P=g.getItemVisual(C,"style");if(l){var L=g.get(E[0],C),I=g.get(E[1],C);if(isNaN(g.get(E[2],C))||isNaN(L)||isNaN(I)||L<h[0]||L>h[1]||I<f[0]||I>f[1])continue;var N=s.dataToPoint([L,I]);M=new Et({shape:{x:N[0]-u/2,y:N[1]-c/2,width:u,height:c},style:P})}else{if(isNaN(g.get(E[1],C)))continue;M=new Et({z2:1,shape:s.dataToRect([g.get(E[0],C)]).contentShape,style:P})}if(g.hasItemOption){var F=g.getItemModel(C),B=F.getModel("emphasis");m=B.getModel("itemStyle").getItemStyle(),_=F.getModel(["blur","itemStyle"]).getItemStyle(),y=F.getModel(["select","itemStyle"]).getItemStyle(),x=F.get(["itemStyle","borderRadius"]),b=B.get("focus"),w=B.get("blurScope"),A=B.get("disabled"),S=wr(F)}M.shape.r=x;var k=r.getRawValue(C),z="-";k&&k[2]!=null&&(z=k[2]+""),Wr(M,S,{labelFetcher:r,labelDataIndex:C,defaultOpacity:P.opacity,defaultText:z}),M.ensureState("emphasis").style=m,M.ensureState("blur").style=_,M.ensureState("select").style=y,zt(M,b,w,A),M.incremental=o,o&&(M.states.emphasis.hoverLayer=!0),p.add(M),g.setItemGraphicEl(C,M),this._progressiveEls&&this._progressiveEls.push(M)}},t.prototype._renderOnGeo=function(r,n,a,i){var o=a.targetVisuals.inRange,s=a.targetVisuals.outOfRange,l=n.getData(),u=this._hmLayer||this._hmLayer||new zC;u.blurSize=n.get("blurSize"),u.pointSize=n.get("pointSize"),u.minOpacity=n.get("minOpacity"),u.maxOpacity=n.get("maxOpacity");var c=r.getViewRect().clone(),h=r.getRoamTransform();c.applyTransform(h);var f=Math.max(c.x,0),d=Math.max(c.y,0),v=Math.min(c.width+c.x,i.getWidth()),p=Math.min(c.height+c.y,i.getHeight()),g=v-f,m=p-d,_=[l.mapDimension("lng"),l.mapDimension("lat"),l.mapDimension("value")],y=l.mapArray(_,function(b,w,A){var E=r.dataToPoint([b,w]);return E[0]-=f,E[1]-=d,E.push(A),E}),x=a.getExtent(),S=a.type==="visualMap.continuous"?VC(x,a.option.range):GC(x,a.getPieceList(),a.option.selected);u.update(y,g,m,o.color.getNormalizer(),{inRange:o.color.getColorMapper(),outOfRange:s.color.getColorMapper()},S);var T=new un({style:{width:g,height:m,x:f,y:d,image:u.canvas},silent:!0});this.group.add(T)},t.type="heatmap",t}(He);const kC=UC;var HC=function(e){U(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.getInitialData=function(r,n){return ui(null,this,{generateCoord:"value"})},t.prototype.preventIncremental=function(){var r=vm.get(this.get("coordinateSystem"));if(r&&r.dimensions)return r.dimensions[0]==="lng"&&r.dimensions[1]==="lat"},t.type="series.heatmap",t.dependencies=["grid","geo","calendar"],t.defaultOption={coordinateSystem:"cartesian2d",z:2,geoIndex:0,blurSize:30,pointSize:20,maxOpacity:1,minOpacity:0,select:{itemStyle:{borderColor:"#212121"}}},t}($e);const WC=HC;function $C(e){e.registerChartView(kC),e.registerSeriesModel(WC)}var XC=["itemStyle","borderWidth"],yp=[{xy:"x",wh:"width",index:0,posDesc:["left","right"]},{xy:"y",wh:"height",index:1,posDesc:["top","bottom"]}],ju=new oo,jC=function(e){U(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.render=function(r,n,a){var i=this.group,o=r.getData(),s=this._data,l=r.coordinateSystem,u=l.getBaseAxis(),c=u.isHorizontal(),h=l.master.getRect(),f={ecSize:{width:a.getWidth(),height:a.getHeight()},seriesModel:r,coordSys:l,coordSysExtent:[[h.x,h.x+h.width],[h.y,h.y+h.height]],isHorizontal:c,valueDim:yp[+c],categoryDim:yp[1-+c]};return o.diff(s).add(function(d){if(o.hasValue(d)){var v=xp(o,d),p=_p(o,d,v,f),g=Sp(o,f,p);o.setItemGraphicEl(d,g),i.add(g),bp(g,f,p)}}).update(function(d,v){var p=s.getItemGraphicEl(v);if(!o.hasValue(d)){i.remove(p);return}var g=xp(o,d),m=_p(o,d,g,f),_=c_(o,m);p&&_!==p.__pictorialShapeStr&&(i.remove(p),o.setItemGraphicEl(d,null),p=null),p?e5(p,f,m):p=Sp(o,f,m,!0),o.setItemGraphicEl(d,p),p.__pictorialSymbolMeta=m,i.add(p),bp(p,f,m)}).remove(function(d){var v=s.getItemGraphicEl(d);v&&Tp(s,d,v.__pictorialSymbolMeta.animationModel,v)}).execute(),this._data=o,this.group},t.prototype.remove=function(r,n){var a=this.group,i=this._data;r.get("animation")?i&&i.eachItemGraphicEl(function(o){Tp(i,et(o).dataIndex,r,o)}):a.removeAll()},t.type="pictorialBar",t}(He);function _p(e,t,r,n){var a=e.getItemLayout(t),i=r.get("symbolRepeat"),o=r.get("symbolClip"),s=r.get("symbolPosition")||"start",l=r.get("symbolRotate"),u=(l||0)*Math.PI/180||0,c=r.get("symbolPatternSize")||2,h=r.isAnimationEnabled(),f={dataIndex:t,layout:a,itemModel:r,symbolType:e.getItemVisual(t,"symbol")||"circle",style:e.getItemVisual(t,"style"),symbolClip:o,symbolRepeat:i,symbolRepeatDirection:r.get("symbolRepeatDirection"),symbolPatternSize:c,rotation:u,animationModel:h?r:null,hoverScale:h&&r.get(["emphasis","scale"]),z2:r.getShallow("z",!0)||0};ZC(r,i,a,n,f),YC(e,t,a,i,o,f.boundingLength,f.pxSign,c,n,f),qC(r,f.symbolScale,u,n,f);var d=f.symbolSize,v=Il(r.get("symbolOffset"),d);return KC(r,d,a,i,o,v,s,f.valueLineWidth,f.boundingLength,f.repeatCutLength,n,f),f}function ZC(e,t,r,n,a){var i=n.valueDim,o=e.get("symbolBoundingData"),s=n.coordSys.getOtherAxis(n.coordSys.getBaseAxis()),l=s.toGlobalCoord(s.dataToCoord(0)),u=1-+(r[i.wh]<=0),c;if(te(o)){var h=[Zu(s,o[0])-l,Zu(s,o[1])-l];h[1]<h[0]&&h.reverse(),c=h[u]}else o!=null?c=Zu(s,o)-l:t?c=n.coordSysExtent[i.index][u]-l:c=r[i.wh];a.boundingLength=c,t&&(a.repeatCutLength=r[i.wh]),a.pxSign=c>0?1:-1}function Zu(e,t){return e.toGlobalCoord(e.dataToCoord(e.scale.parse(t)))}function YC(e,t,r,n,a,i,o,s,l,u){var c=l.valueDim,h=l.categoryDim,f=Math.abs(r[h.wh]),d=e.getItemVisual(t,"symbolSize"),v;te(d)?v=d.slice():d==null?v=["100%","100%"]:v=[d,d],v[h.index]=ee(v[h.index],f),v[c.index]=ee(v[c.index],n?f:Math.abs(i)),u.symbolSize=v;var p=u.symbolScale=[v[0]/s,v[1]/s];p[c.index]*=(l.isHorizontal?-1:1)*o}function qC(e,t,r,n,a){var i=e.get(XC)||0;i&&(ju.attr({scaleX:t[0],scaleY:t[1],rotation:r}),ju.updateTransform(),i/=ju.getLineScale(),i*=t[n.valueDim.index]),a.valueLineWidth=i||0}function KC(e,t,r,n,a,i,o,s,l,u,c,h){var f=c.categoryDim,d=c.valueDim,v=h.pxSign,p=Math.max(t[d.index]+s,0),g=p;if(n){var m=Math.abs(l),_=Lr(e.get("symbolMargin"),"15%")+"",y=!1;_.lastIndexOf("!")===_.length-1&&(y=!0,_=_.slice(0,_.length-1));var x=ee(_,t[d.index]),S=Math.max(p+x*2,0),T=y?0:x*2,b=dT(n),w=b?n:wp((m+T)/S),A=m-w*p;x=A/2/(y?w:Math.max(w-1,1)),S=p+x*2,T=y?0:x*2,!b&&n!=="fixed"&&(w=u?wp((Math.abs(u)+T)/S):0),g=w*S-T,h.repeatTimes=w,h.symbolMargin=x}var E=v*(g/2),C=h.pathPosition=[];C[f.index]=r[f.wh]/2,C[d.index]=o==="start"?E:o==="end"?l-E:l/2,i&&(C[0]+=i[0],C[1]+=i[1]);var M=h.bundlePosition=[];M[f.index]=r[f.xy],M[d.index]=r[d.xy];var P=h.barRectShape=le({},r);P[d.wh]=v*Math.max(Math.abs(r[d.wh]),Math.abs(C[d.index]+E)),P[f.wh]=r[f.wh];var L=h.clipShape={};L[f.xy]=-r[f.xy],L[f.wh]=c.ecSize[f.wh],L[d.xy]=0,L[d.wh]=r[d.wh]}function i_(e){var t=e.symbolPatternSize,r=Pr(e.symbolType,-t/2,-t/2,t,t);return r.attr({culling:!0}),r.type!=="image"&&r.setStyle({strokeNoScale:!0}),r}function o_(e,t,r,n){var a=e.__pictorialBundle,i=r.symbolSize,o=r.valueLineWidth,s=r.pathPosition,l=t.valueDim,u=r.repeatTimes||0,c=0,h=i[t.valueDim.index]+o+r.symbolMargin*2;for(Gf(e,function(p){p.__pictorialAnimationIndex=c,p.__pictorialRepeatTimes=u,c<u?ja(p,null,v(c),r,n):ja(p,null,{scaleX:0,scaleY:0},r,n,function(){a.remove(p)}),c++});c<u;c++){var f=i_(r);f.__pictorialAnimationIndex=c,f.__pictorialRepeatTimes=u,a.add(f);var d=v(c);ja(f,{x:d.x,y:d.y,scaleX:0,scaleY:0},{scaleX:d.scaleX,scaleY:d.scaleY,rotation:d.rotation},r,n)}function v(p){var g=s.slice(),m=r.pxSign,_=p;return(r.symbolRepeatDirection==="start"?m>0:m<0)&&(_=u-1-p),g[l.index]=h*(_-u/2+.5)+s[l.index],{x:g[0],y:g[1],scaleX:r.symbolScale[0],scaleY:r.symbolScale[1],rotation:r.rotation}}}function s_(e,t,r,n){var a=e.__pictorialBundle,i=e.__pictorialMainPath;i?ja(i,null,{x:r.pathPosition[0],y:r.pathPosition[1],scaleX:r.symbolScale[0],scaleY:r.symbolScale[1],rotation:r.rotation},r,n):(i=e.__pictorialMainPath=i_(r),a.add(i),ja(i,{x:r.pathPosition[0],y:r.pathPosition[1],scaleX:0,scaleY:0,rotation:r.rotation},{scaleX:r.symbolScale[0],scaleY:r.symbolScale[1]},r,n))}function l_(e,t,r){var n=le({},t.barRectShape),a=e.__pictorialBarRect;a?ja(a,null,{shape:n},t,r):(a=e.__pictorialBarRect=new Et({z2:2,shape:n,silent:!0,style:{stroke:"transparent",fill:"transparent",lineWidth:0}}),a.disableMorphing=!0,e.add(a))}function u_(e,t,r,n){if(r.symbolClip){var a=e.__pictorialClipPath,i=le({},r.clipShape),o=t.valueDim,s=r.animationModel,l=r.dataIndex;if(a)st(a,{shape:i},s,l);else{i[o.wh]=0,a=new Et({shape:i}),e.__pictorialBundle.setClipPath(a),e.__pictorialClipPath=a;var u={};u[o.wh]=r.clipShape[o.wh],wl[n?"updateProps":"initProps"](a,{shape:u},s,l)}}}function xp(e,t){var r=e.getItemModel(t);return r.getAnimationDelayParams=JC,r.isAnimationEnabled=QC,r}function JC(e){return{index:e.__pictorialAnimationIndex,count:e.__pictorialRepeatTimes}}function QC(){return this.parentModel.isAnimationEnabled()&&!!this.getShallow("animation")}function Sp(e,t,r,n){var a=new Fe,i=new Fe;return a.add(i),a.__pictorialBundle=i,i.x=r.bundlePosition[0],i.y=r.bundlePosition[1],r.symbolRepeat?o_(a,t,r):s_(a,t,r),l_(a,r,n),u_(a,t,r,n),a.__pictorialShapeStr=c_(e,r),a.__pictorialSymbolMeta=r,a}function e5(e,t,r){var n=r.animationModel,a=r.dataIndex,i=e.__pictorialBundle;st(i,{x:r.bundlePosition[0],y:r.bundlePosition[1]},n,a),r.symbolRepeat?o_(e,t,r,!0):s_(e,t,r,!0),l_(e,r,!0),u_(e,t,r,!0)}function Tp(e,t,r,n){var a=n.__pictorialBarRect;a&&a.removeTextContent();var i=[];Gf(n,function(o){i.push(o)}),n.__pictorialMainPath&&i.push(n.__pictorialMainPath),n.__pictorialClipPath&&(r=null),R(i,function(o){zs(o,{scaleX:0,scaleY:0},r,t,function(){n.parent&&n.parent.remove(n)})}),e.setItemGraphicEl(t,null)}function c_(e,t){return[e.getItemVisual(t.dataIndex,"symbol")||"none",!!t.symbolRepeat,!!t.symbolClip].join(":")}function Gf(e,t,r){R(e.__pictorialBundle.children(),function(n){n!==e.__pictorialBarRect&&t.call(r,n)})}function ja(e,t,r,n,a,i){t&&e.attr(t),n.symbolClip&&!a?r&&e.attr(r):r&&wl[a?"updateProps":"initProps"](e,r,n.animationModel,n.dataIndex,i)}function bp(e,t,r){var n=r.dataIndex,a=r.itemModel,i=a.getModel("emphasis"),o=i.getModel("itemStyle").getItemStyle(),s=a.getModel(["blur","itemStyle"]).getItemStyle(),l=a.getModel(["select","itemStyle"]).getItemStyle(),u=a.getShallow("cursor"),c=i.get("focus"),h=i.get("blurScope"),f=i.get("scale");Gf(e,function(p){if(p instanceof un){var g=p.style;p.useStyle(le({image:g.image,x:g.x,y:g.y,width:g.width,height:g.height},r.style))}else p.useStyle(r.style);var m=p.ensureState("emphasis");m.style=o,f&&(m.scaleX=p.scaleX*1.1,m.scaleY=p.scaleY*1.1),p.ensureState("blur").style=s,p.ensureState("select").style=l,u&&(p.cursor=u),p.z2=r.z2});var d=t.valueDim.posDesc[+(r.boundingLength>0)],v=e.__pictorialBarRect;Wr(v,wr(a),{labelFetcher:t.seriesModel,labelDataIndex:n,defaultText:rh(t.seriesModel.getData(),n),inheritColor:r.style.fill,defaultOpacity:r.style.opacity,defaultOutsidePosition:d}),zt(e,c,h,i.get("disabled"))}function wp(e){var t=Math.round(e);return Math.abs(e-t)<1e-4?t:Math.ceil(e)}const t5=jC;var r5=function(e){U(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r.hasSymbolVisual=!0,r.defaultSymbol="roundRect",r}return t.prototype.getInitialData=function(r){return r.stack=null,e.prototype.getInitialData.apply(this,arguments)},t.type="series.pictorialBar",t.dependencies=["grid"],t.defaultOption=Bl(rv.defaultOption,{symbol:"circle",symbolSize:null,symbolRotate:null,symbolPosition:null,symbolOffset:null,symbolMargin:null,symbolRepeat:!1,symbolRepeatDirection:"end",symbolClip:!1,symbolBoundingData:null,symbolPatternSize:400,barGap:"-100%",progressive:0,emphasis:{scale:!1},select:{itemStyle:{borderColor:"#212121"}}}),t}(rv);const n5=r5;function a5(e){e.registerChartView(t5),e.registerSeriesModel(n5),e.registerLayout(e.PRIORITY.VISUAL.LAYOUT,Ge(pT,"pictorialBar")),e.registerLayout(e.PRIORITY.VISUAL.PROGRESSIVE_LAYOUT,vT("pictorialBar"))}var i5=function(e){U(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r._layers=[],r}return t.prototype.render=function(r,n,a){var i=r.getData(),o=this,s=this.group,l=r.getLayerSeries(),u=i.getLayout("layoutInfo"),c=u.rect,h=u.boundaryGap;s.x=0,s.y=c.y+h[0];function f(g){return g.name}var d=new Dn(this._layersSeries||[],l,f,f),v=[];d.add(me(p,this,"add")).update(me(p,this,"update")).remove(me(p,this,"remove")).execute();function p(g,m,_){var y=o._layers;if(g==="remove"){s.remove(y[m]);return}for(var x=[],S=[],T,b=l[m].indices,w=0;w<b.length;w++){var A=i.getItemLayout(b[w]),E=A.x,C=A.y0,M=A.y;x.push(E,C),S.push(E,C+M),T=i.getItemVisual(b[w],"style")}var P,L=i.getItemLayout(b[0]),I=r.getModel("label"),N=I.get("margin"),F=r.getModel("emphasis");if(g==="add"){var B=v[m]=new Fe;P=new gT({shape:{points:x,stackedOnPoints:S,smooth:.4,stackedOnSmooth:.4,smoothConstraint:!1},z2:0}),B.add(P),s.add(B),r.isAnimationEnabled()&&P.setClipPath(o5(P.getBoundingRect(),r,function(){P.removeClipPath()}))}else{var B=y[_];P=B.childAt(0),s.add(B),v[m]=B,st(P,{shape:{points:x,stackedOnPoints:S}},r),Ln(P)}Wr(P,wr(r),{labelDataIndex:b[w-1],defaultText:i.getName(b[w-1]),inheritColor:T.fill},{normal:{verticalAlign:"middle"}}),P.setTextConfig({position:null,local:!0});var k=P.getTextContent();k&&(k.x=L.x-N,k.y=L.y0+L.y/2),P.useStyle(T),i.setItemGraphicEl(m,P),ur(P,r),zt(P,F.get("focus"),F.get("blurScope"),F.get("disabled"))}this._layersSeries=l,this._layers=v},t.type="themeRiver",t}(He);function o5(e,t,r){var n=new Et({shape:{x:e.x-10,y:e.y-10,width:0,height:e.height+20}});return ar(n,{shape:{x:e.x-50,width:e.width+100,height:e.height+20}},t,r),n}const s5=i5;var Yu=2,l5=function(e){U(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.init=function(r){e.prototype.init.apply(this,arguments),this.legendVisualProvider=new El(me(this.getData,this),me(this.getRawData,this))},t.prototype.fixData=function(r){var n=r.length,a={},i=Qc(r,function(f){return a.hasOwnProperty(f[0]+"")||(a[f[0]+""]=-1),f[2]}),o=[];i.buckets.each(function(f,d){o.push({name:d,dataList:f})});for(var s=o.length,l=0;l<s;++l){for(var u=o[l].name,c=0;c<o[l].dataList.length;++c){var h=o[l].dataList[c][0]+"";a[h]=l}for(var h in a)a.hasOwnProperty(h)&&a[h]!==l&&(a[h]=l,r[n]=[h,0,u],n++)}return r},t.prototype.getInitialData=function(r,n){for(var a=this.getReferringComponents("singleAxis",sn).models[0],i=a.get("type"),o=Vt(r.data,function(v){return v[2]!==void 0}),s=this.fixData(o||[]),l=[],u=this.nameMap=ot(),c=0,h=0;h<s.length;++h)l.push(s[h][Yu]),u.get(s[h][Yu])||(u.set(s[h][Yu],c),c++);var f=af(s,{coordDimensions:["single"],dimensionsDefine:[{name:"time",type:eh(i)},{name:"value",type:"float"},{name:"name",type:"ordinal"}],encodeDefine:{single:0,value:1,itemName:2}}).dimensions,d=new it(f,this);return d.initData(s),d},t.prototype.getLayerSeries=function(){for(var r=this.getData(),n=r.count(),a=[],i=0;i<n;++i)a[i]=i;var o=r.mapDimension("single"),s=Qc(a,function(u){return r.get("name",u)}),l=[];return s.buckets.each(function(u,c){u.sort(function(h,f){return r.get(o,h)-r.get(o,f)}),l.push({name:c,indices:u})}),l},t.prototype.getAxisTooltipData=function(r,n,a){te(r)||(r=r?[r]:[]);for(var i=this.getData(),o=this.getLayerSeries(),s=[],l=o.length,u,c=0;c<l;++c){for(var h=Number.MAX_VALUE,f=-1,d=o[c].indices.length,v=0;v<d;++v){var p=i.get(r[0],o[c].indices[v]),g=Math.abs(p-n);g<=h&&(u=p,h=g,f=o[c].indices[v])}s.push(f)}return{dataIndices:s,nestestValue:u}},t.prototype.formatTooltip=function(r,n,a){var i=this.getData(),o=i.getName(r),s=i.get(i.mapDimension("value"),r);return $r("nameValue",{name:o,value:s})},t.type="series.themeRiver",t.dependencies=["singleAxis"],t.defaultOption={z:2,colorBy:"data",coordinateSystem:"singleAxis",boundaryGap:["10%","10%"],singleAxisIndex:0,animationEasing:"linear",label:{margin:4,show:!0,position:"left",fontSize:11},emphasis:{label:{show:!0}}},t}($e);const u5=l5;function c5(e,t){e.eachSeriesByType("themeRiver",function(r){var n=r.getData(),a=r.coordinateSystem,i={},o=a.getRect();i.rect=o;var s=r.get("boundaryGap"),l=a.getAxis();if(i.boundaryGap=s,l.orient==="horizontal"){s[0]=ee(s[0],o.height),s[1]=ee(s[1],o.height);var u=o.height-s[0]-s[1];Ap(n,r,u)}else{s[0]=ee(s[0],o.width),s[1]=ee(s[1],o.width);var c=o.width-s[0]-s[1];Ap(n,r,c)}n.setLayout("layoutInfo",i)})}function Ap(e,t,r){if(e.count())for(var n=t.coordinateSystem,a=t.getLayerSeries(),i=e.mapDimension("single"),o=e.mapDimension("value"),s=K(a,function(g){return K(g.indices,function(m){var _=n.dataToPoint(e.get(i,m));return _[1]=e.get(o,m),_})}),l=h5(s),u=l.y0,c=r/l.max,h=a.length,f=a[0].indices.length,d,v=0;v<f;++v){d=u[v]*c,e.setItemLayout(a[0].indices[v],{layerIndex:0,x:s[0][v][0],y0:d,y:s[0][v][1]*c});for(var p=1;p<h;++p)d+=s[p-1][v][1]*c,e.setItemLayout(a[p].indices[v],{layerIndex:p,x:s[p][v][0],y0:d,y:s[p][v][1]*c})}}function h5(e){for(var t=e.length,r=e[0].length,n=[],a=[],i=0,o=0;o<r;++o){for(var s=0,l=0;l<t;++l)s+=e[l][o][1];s>i&&(i=s),n.push(s)}for(var u=0;u<r;++u)a[u]=(i-n[u])/2;i=0;for(var c=0;c<r;++c){var h=n[c]+a[c];h>i&&(i=h)}return{y0:a,max:i}}function f5(e){e.registerChartView(s5),e.registerSeriesModel(u5),e.registerLayout(c5),e.registerProcessor(Ll("themeRiver"))}var d5=2,v5=4,p5=function(e){U(t,e);function t(r,n,a,i){var o=e.call(this)||this;o.z2=d5,o.textConfig={inside:!0},et(o).seriesIndex=n.seriesIndex;var s=new rt({z2:v5,silent:r.getModel().get(["label","silent"])});return o.setTextContent(s),o.updateData(!0,r,n,a,i),o}return t.prototype.updateData=function(r,n,a,i,o){this.node=n,n.piece=this,a=a||this._seriesModel,i=i||this._ecModel;var s=this;et(s).dataIndex=n.dataIndex;var l=n.getModel(),u=l.getModel("emphasis"),c=n.getLayout(),h=le({},c);h.label=null;var f=n.getVisual("style");f.lineJoin="bevel";var d=n.getVisual("decal");d&&(f.decal=xm(d,o));var v=nv(l.getModel("itemStyle"),h,!0);le(h,v),R(Jc,function(_){var y=s.ensureState(_),x=l.getModel([_,"itemStyle"]);y.style=x.getItemStyle();var S=nv(x,h);S&&(y.shape=S)}),r?(s.setShape(h),s.shape.r=c.r0,ar(s,{shape:{r:c.r}},a,n.dataIndex)):(st(s,{shape:h},a),Ln(s)),s.useStyle(f),this._updateLabel(a);var p=l.getShallow("cursor");p&&s.attr("cursor",p),this._seriesModel=a||this._seriesModel,this._ecModel=i||this._ecModel;var g=u.get("focus"),m=g==="ancestor"?n.getAncestorsIndices():g==="descendant"?n.getDescendantIndices():g;zt(this,m,u.get("blurScope"),u.get("disabled"))},t.prototype._updateLabel=function(r){var n=this,a=this.node.getModel(),i=a.getModel("label"),o=this.node.getLayout(),s=o.endAngle-o.startAngle,l=(o.startAngle+o.endAngle)/2,u=Math.cos(l),c=Math.sin(l),h=this,f=h.getTextContent(),d=this.node.dataIndex,v=i.get("minAngle")/180*Math.PI,p=i.get("show")&&!(v!=null&&Math.abs(s)<v);f.ignore=!p,R(mT,function(m){var _=m==="normal"?a.getModel("label"):a.getModel([m,"label"]),y=m==="normal",x=y?f:f.ensureState(m),S=r.getFormattedLabel(d,m);y&&(S=S||n.node.name),x.style=ft(_,{},null,m!=="normal",!0),S&&(x.style.text=S);var T=_.get("show");T!=null&&!y&&(x.ignore=!T);var b=g(_,"position"),w=y?h:h.states[m],A=w.style.fill;w.textConfig={outsideFill:_.get("color")==="inherit"?A:null,inside:b!=="outside"};var E,C=g(_,"distance")||0,M=g(_,"align");b==="outside"?(E=o.r+C,M=l>Math.PI/2?"right":"left"):!M||M==="center"?(s===2*Math.PI&&o.r0===0?E=0:E=(o.r+o.r0)/2,M="center"):M==="left"?(E=o.r0+C,l>Math.PI/2&&(M="right")):M==="right"&&(E=o.r-C,l>Math.PI/2&&(M="left")),x.style.align=M,x.style.verticalAlign=g(_,"verticalAlign")||"middle",x.x=E*u+o.cx,x.y=E*c+o.cy;var P=g(_,"rotate"),L=0;P==="radial"?(L=Xc(-l),L>Math.PI/2&&L<Math.PI*1.5&&(L+=Math.PI)):P==="tangential"?(L=Math.PI/2-l,L>Math.PI/2?L-=Math.PI:L<-Math.PI/2&&(L+=Math.PI)):Mr(P)&&(L=P*Math.PI/180),x.rotation=Xc(L)});function g(m,_){var y=m.get(_);return y??i.get(_)}f.dirtyStyle()},t}(da);const Ep=p5;var yh="sunburstRootToNode",Cp="sunburstHighlight",g5="sunburstUnhighlight";function m5(e){e.registerAction({type:yh,update:"updateView"},function(t,r){r.eachComponent({mainType:"series",subType:"sunburst",query:t},n);function n(a,i){var o=fo(t,[yh],a);if(o){var s=a.getViewRoot();s&&(t.direction=Af(s,o.node)?"rollUp":"drillDown"),a.resetViewRoot(o.node)}}}),e.registerAction({type:Cp,update:"none"},function(t,r,n){t=le({},t),r.eachComponent({mainType:"series",subType:"sunburst",query:t},a);function a(i){var o=fo(t,[Cp],i);o&&(t.dataIndex=o.node.dataIndex)}n.dispatchAction(le(t,{type:"highlight"}))}),e.registerAction({type:g5,update:"updateView"},function(t,r,n){t=le({},t),n.dispatchAction(le(t,{type:"downplay"}))})}var y5=function(e){U(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.render=function(r,n,a,i){var o=this;this.seriesModel=r,this.api=a,this.ecModel=n;var s=r.getData(),l=s.tree.root,u=r.getViewRoot(),c=this.group,h=r.get("renderLabelForZeroData"),f=[];u.eachNode(function(_){f.push(_)});var d=this._oldChildren||[];v(f,d),m(l,u),this._initEvents(),this._oldChildren=f;function v(_,y){if(_.length===0&&y.length===0)return;new Dn(y,_,x,x).add(S).update(S).remove(Ge(S,null)).execute();function x(T){return T.getId()}function S(T,b){var w=T==null?null:_[T],A=b==null?null:y[b];p(w,A)}}function p(_,y){if(!h&&_&&!_.getValue()&&(_=null),_!==l&&y!==l){if(y&&y.piece)_?(y.piece.updateData(!1,_,r,n,a),s.setItemGraphicEl(_.dataIndex,y.piece)):g(y);else if(_){var x=new Ep(_,r,n,a);c.add(x),s.setItemGraphicEl(_.dataIndex,x)}}}function g(_){_&&_.piece&&(c.remove(_.piece),_.piece=null)}function m(_,y){y.depth>0?(o.virtualPiece?o.virtualPiece.updateData(!1,_,r,n,a):(o.virtualPiece=new Ep(_,r,n,a),c.add(o.virtualPiece)),y.piece.off("click"),o.virtualPiece.on("click",function(x){o._rootToNode(y.parentNode)})):o.virtualPiece&&(c.remove(o.virtualPiece),o.virtualPiece=null)}},t.prototype._initEvents=function(){var r=this;this.group.off("click"),this.group.on("click",function(n){var a=!1,i=r.seriesModel.getViewRoot();i.eachNode(function(o){if(!a&&o.piece&&o.piece===n.target){var s=o.getModel().get("nodeClick");if(s==="rootToNode")r._rootToNode(o);else if(s==="link"){var l=o.getModel(),u=l.get("link");if(u){var c=l.get("target",!0)||"_blank";cm(u,c)}}a=!0}})})},t.prototype._rootToNode=function(r){r!==this.seriesModel.getViewRoot()&&this.api.dispatchAction({type:yh,from:this.uid,seriesId:this.seriesModel.id,targetNode:r})},t.prototype.containPoint=function(r,n){var a=n.getData(),i=a.getItemLayout(0);if(i){var o=r[0]-i.cx,s=r[1]-i.cy,l=Math.sqrt(o*o+s*s);return l<=i.r&&l>=i.r0}},t.type="sunburst",t}(He);const _5=y5;var x5=function(e){U(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r.ignoreStyleOnData=!0,r}return t.prototype.getInitialData=function(r,n){var a={name:r.name,children:r.data};h_(a);var i=this._levelModels=K(r.levels||[],function(l){return new Ft(l,this,n)},this),o=wf.createTree(a,this,s);function s(l){l.wrapMethod("getItemModel",function(u,c){var h=o.getNodeByDataIndex(c),f=i[h.depth];return f&&(u.parentModel=f),u})}return o.data},t.prototype.optionUpdated=function(){this.resetViewRoot()},t.prototype.getDataParams=function(r){var n=e.prototype.getDataParams.apply(this,arguments),a=this.getData().tree.getNodeByDataIndex(r);return n.treePathInfo=Ul(a,this),n},t.prototype.getLevelModel=function(r){return this._levelModels&&this._levelModels[r.depth]},t.prototype.getViewRoot=function(){return this._viewRoot},t.prototype.resetViewRoot=function(r){r?this._viewRoot=r:r=this._viewRoot;var n=this.getRawData().tree.root;(!r||r!==n&&!n.contains(r))&&(this._viewRoot=n)},t.prototype.enableAriaDecal=function(){py(this)},t.type="series.sunburst",t.defaultOption={z:2,center:["50%","50%"],radius:[0,"75%"],clockwise:!0,startAngle:90,minAngle:0,stillShowZeroSum:!0,nodeClick:"rootToNode",renderLabelForZeroData:!1,label:{rotate:"radial",show:!0,opacity:1,align:"center",position:"inside",distance:5,silent:!0},itemStyle:{borderWidth:1,borderColor:"white",borderType:"solid",shadowBlur:0,shadowColor:"rgba(0, 0, 0, 0.2)",shadowOffsetX:0,shadowOffsetY:0,opacity:1},emphasis:{focus:"descendant"},blur:{itemStyle:{opacity:.2},label:{opacity:.1}},animationType:"expansion",animationDuration:1e3,animationDurationUpdate:500,data:[],sort:"desc"},t}($e);function h_(e){var t=0;R(e.children,function(n){h_(n);var a=n.value;te(a)&&(a=a[0]),t+=a});var r=e.value;te(r)&&(r=r[0]),(r==null||isNaN(r))&&(r=t),r<0&&(r=0),te(e.value)?e.value[0]=r:e.value=r}const S5=x5;var Lp=Math.PI/180;function T5(e,t,r){t.eachSeriesByType(e,function(n){var a=n.get("center"),i=n.get("radius");te(i)||(i=[0,i]),te(a)||(a=[a,a]);var o=r.getWidth(),s=r.getHeight(),l=Math.min(o,s),u=ee(a[0],o),c=ee(a[1],s),h=ee(i[0],l/2),f=ee(i[1],l/2),d=-n.get("startAngle")*Lp,v=n.get("minAngle")*Lp,p=n.getData().tree.root,g=n.getViewRoot(),m=g.depth,_=n.get("sort");_!=null&&f_(g,_);var y=0;R(g.children,function(N){!isNaN(N.getValue())&&y++});var x=g.getValue(),S=Math.PI/(x||y)*2,T=g.depth>0,b=g.height-(T?-1:1),w=(f-h)/(b||1),A=n.get("clockwise"),E=n.get("stillShowZeroSum"),C=A?1:-1,M=function(N,F){if(N){var B=F;if(N!==p){var k=N.getValue(),z=x===0&&E?S:k*S;z<v&&(z=v),B=F+C*z;var W=N.depth-m-(T?-1:1),J=h+w*W,re=h+w*(W+1),Q=n.getLevelModel(N);if(Q){var q=Q.get("r0",!0),Ee=Q.get("r",!0),ae=Q.get("radius",!0);ae!=null&&(q=ae[0],Ee=ae[1]),q!=null&&(J=ee(q,l/2)),Ee!=null&&(re=ee(Ee,l/2))}N.setLayout({angle:z,startAngle:F,endAngle:B,clockwise:A,cx:u,cy:c,r0:J,r:re})}if(N.children&&N.children.length){var j=0;R(N.children,function(pe){j+=M(pe,F+j)})}return B-F}};if(T){var P=h,L=h+w,I=Math.PI*2;p.setLayout({angle:I,startAngle:d,endAngle:d+I,clockwise:A,cx:u,cy:c,r0:P,r:L})}M(g,d)})}function f_(e,t){var r=e.children||[];e.children=b5(r,t),r.length&&R(e.children,function(n){f_(n,t)})}function b5(e,t){if(xt(t)){var r=K(e,function(a,i){var o=a.getValue();return{params:{depth:a.depth,height:a.height,dataIndex:a.dataIndex,getValue:function(){return o}},index:i}});return r.sort(function(a,i){return t(a.params,i.params)}),K(r,function(a){return e[a.index]})}else{var n=t==="asc";return e.sort(function(a,i){var o=(a.getValue()-i.getValue())*(n?1:-1);return o===0?(a.dataIndex-i.dataIndex)*(n?-1:1):o})}}function w5(e){var t={};function r(n,a,i){for(var o=n;o&&o.depth>1;)o=o.parentNode;var s=a.getColorFromPalette(o.name||o.dataIndex+"",t);return n.depth>1&&Ve(s)&&(s=Fl(s,(n.depth-1)/(i-1)*.5)),s}e.eachSeriesByType("sunburst",function(n){var a=n.getData(),i=a.tree;i.eachNode(function(o){var s=o.getModel(),l=s.getModel("itemStyle").getItemStyle();l.fill||(l.fill=r(o,n,i.root.height));var u=a.ensureUniqueItemVisual(o.dataIndex,"style");le(u,l)})})}function A5(e){e.registerChartView(_5),e.registerSeriesModel(S5),e.registerLayout(Ge(T5,"sunburst")),e.registerProcessor(Ge(Ll,"sunburst")),e.registerVisual(w5),m5(e)}var Dp={color:"fill",borderColor:"stroke"},E5={symbol:1,symbolSize:1,symbolKeepAspect:1,legendIcon:1,visualMeta:1,liftZ:1,decal:1},tn=Nt(),C5=function(e){U(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.optionUpdated=function(){this.currentZLevel=this.get("zlevel",!0),this.currentZ=this.get("z",!0)},t.prototype.getInitialData=function(r,n){return ui(null,this)},t.prototype.getDataParams=function(r,n,a){var i=e.prototype.getDataParams.call(this,r,n);return a&&(i.info=tn(a).info),i},t.type="series.custom",t.dependencies=["grid","polar","geo","singleAxis","calendar"],t.defaultOption={coordinateSystem:"cartesian2d",z:2,legendHoverLink:!0,clip:!1},t}($e);const L5=C5;function D5(e,t){return t=t||[0,0],K(["x","y"],function(r,n){var a=this.getAxis(r),i=t[n],o=e[n]/2;return a.type==="category"?a.getBandWidth():Math.abs(a.dataToCoord(i-o)-a.dataToCoord(i+o))},this)}function M5(e){var t=e.master.getRect();return{coordSys:{type:"cartesian2d",x:t.x,y:t.y,width:t.width,height:t.height},api:{coord:function(r){return e.dataToPoint(r)},size:me(D5,e)}}}function P5(e,t){return t=t||[0,0],K([0,1],function(r){var n=t[r],a=e[r]/2,i=[],o=[];return i[r]=n-a,o[r]=n+a,i[1-r]=o[1-r]=t[1-r],Math.abs(this.dataToPoint(i)[r]-this.dataToPoint(o)[r])},this)}function I5(e){var t=e.getBoundingRect();return{coordSys:{type:"geo",x:t.x,y:t.y,width:t.width,height:t.height,zoom:e.getZoom()},api:{coord:function(r){return e.dataToPoint(r)},size:me(P5,e)}}}function R5(e,t){var r=this.getAxis(),n=t instanceof Array?t[0]:t,a=(e instanceof Array?e[0]:e)/2;return r.type==="category"?r.getBandWidth():Math.abs(r.dataToCoord(n-a)-r.dataToCoord(n+a))}function N5(e){var t=e.getRect();return{coordSys:{type:"singleAxis",x:t.x,y:t.y,width:t.width,height:t.height},api:{coord:function(r){return e.dataToPoint(r)},size:me(R5,e)}}}function O5(e,t){return t=t||[0,0],K(["Radius","Angle"],function(r,n){var a="get"+r+"Axis",i=this[a](),o=t[n],s=e[n]/2,l=i.type==="category"?i.getBandWidth():Math.abs(i.dataToCoord(o-s)-i.dataToCoord(o+s));return r==="Angle"&&(l=l*Math.PI/180),l},this)}function B5(e){var t=e.getRadiusAxis(),r=e.getAngleAxis(),n=t.getExtent();return n[0]>n[1]&&n.reverse(),{coordSys:{type:"polar",cx:e.cx,cy:e.cy,r:n[1],r0:n[0]},api:{coord:function(a){var i=t.dataToRadius(a[0]),o=r.dataToAngle(a[1]),s=e.coordToPoint([i,o]);return s.push(i,o*Math.PI/180),s},size:me(O5,e)}}}function F5(e){var t=e.getRect(),r=e.getRangeInfo();return{coordSys:{type:"calendar",x:t.x,y:t.y,width:t.width,height:t.height,cellWidth:e.getCellWidth(),cellHeight:e.getCellHeight(),rangeInfo:{start:r.start,end:r.end,weeks:r.weeks,dayCount:r.allDay}},api:{coord:function(n,a){return e.dataToPoint(n,a)}}}}function d_(e,t,r,n){return e&&(e.legacy||e.legacy!==!1&&!r&&!n&&t!=="tspan"&&(t==="text"||Z(e,"text")))}function v_(e,t,r){var n=e,a,i,o;if(t==="text")o=n;else{o={},Z(n,"text")&&(o.text=n.text),Z(n,"rich")&&(o.rich=n.rich),Z(n,"textFill")&&(o.fill=n.textFill),Z(n,"textStroke")&&(o.stroke=n.textStroke),Z(n,"fontFamily")&&(o.fontFamily=n.fontFamily),Z(n,"fontSize")&&(o.fontSize=n.fontSize),Z(n,"fontStyle")&&(o.fontStyle=n.fontStyle),Z(n,"fontWeight")&&(o.fontWeight=n.fontWeight),i={type:"text",style:o,silent:!0},a={};var s=Z(n,"textPosition");r?a.position=s?n.textPosition:"inside":s&&(a.position=n.textPosition),Z(n,"textPosition")&&(a.position=n.textPosition),Z(n,"textOffset")&&(a.offset=n.textOffset),Z(n,"textRotation")&&(a.rotation=n.textRotation),Z(n,"textDistance")&&(a.distance=n.textDistance)}return Mp(o,e),R(o.rich,function(l){Mp(l,l)}),{textConfig:a,textContent:i}}function Mp(e,t){t&&(t.font=t.textFont||t.font,Z(t,"textStrokeWidth")&&(e.lineWidth=t.textStrokeWidth),Z(t,"textAlign")&&(e.align=t.textAlign),Z(t,"textVerticalAlign")&&(e.verticalAlign=t.textVerticalAlign),Z(t,"textLineHeight")&&(e.lineHeight=t.textLineHeight),Z(t,"textWidth")&&(e.width=t.textWidth),Z(t,"textHeight")&&(e.height=t.textHeight),Z(t,"textBackgroundColor")&&(e.backgroundColor=t.textBackgroundColor),Z(t,"textPadding")&&(e.padding=t.textPadding),Z(t,"textBorderColor")&&(e.borderColor=t.textBorderColor),Z(t,"textBorderWidth")&&(e.borderWidth=t.textBorderWidth),Z(t,"textBorderRadius")&&(e.borderRadius=t.textBorderRadius),Z(t,"textBoxShadowColor")&&(e.shadowColor=t.textBoxShadowColor),Z(t,"textBoxShadowBlur")&&(e.shadowBlur=t.textBoxShadowBlur),Z(t,"textBoxShadowOffsetX")&&(e.shadowOffsetX=t.textBoxShadowOffsetX),Z(t,"textBoxShadowOffsetY")&&(e.shadowOffsetY=t.textBoxShadowOffsetY))}function Pp(e,t,r){var n=e;n.textPosition=n.textPosition||r.position||"inside",r.offset!=null&&(n.textOffset=r.offset),r.rotation!=null&&(n.textRotation=r.rotation),r.distance!=null&&(n.textDistance=r.distance);var a=n.textPosition.indexOf("inside")>=0,i=e.fill||"#000";Ip(n,t);var o=n.textFill==null;return a?o&&(n.textFill=r.insideFill||"#fff",!n.textStroke&&r.insideStroke&&(n.textStroke=r.insideStroke),!n.textStroke&&(n.textStroke=i),n.textStrokeWidth==null&&(n.textStrokeWidth=2)):(o&&(n.textFill=e.fill||r.outsideFill||"#000"),!n.textStroke&&r.outsideStroke&&(n.textStroke=r.outsideStroke)),n.text=t.text,n.rich=t.rich,R(t.rich,function(s){Ip(s,s)}),n}function Ip(e,t){t&&(Z(t,"fill")&&(e.textFill=t.fill),Z(t,"stroke")&&(e.textStroke=t.fill),Z(t,"lineWidth")&&(e.textStrokeWidth=t.lineWidth),Z(t,"font")&&(e.font=t.font),Z(t,"fontStyle")&&(e.fontStyle=t.fontStyle),Z(t,"fontWeight")&&(e.fontWeight=t.fontWeight),Z(t,"fontSize")&&(e.fontSize=t.fontSize),Z(t,"fontFamily")&&(e.fontFamily=t.fontFamily),Z(t,"align")&&(e.textAlign=t.align),Z(t,"verticalAlign")&&(e.textVerticalAlign=t.verticalAlign),Z(t,"lineHeight")&&(e.textLineHeight=t.lineHeight),Z(t,"width")&&(e.textWidth=t.width),Z(t,"height")&&(e.textHeight=t.height),Z(t,"backgroundColor")&&(e.textBackgroundColor=t.backgroundColor),Z(t,"padding")&&(e.textPadding=t.padding),Z(t,"borderColor")&&(e.textBorderColor=t.borderColor),Z(t,"borderWidth")&&(e.textBorderWidth=t.borderWidth),Z(t,"borderRadius")&&(e.textBorderRadius=t.borderRadius),Z(t,"shadowColor")&&(e.textBoxShadowColor=t.shadowColor),Z(t,"shadowBlur")&&(e.textBoxShadowBlur=t.shadowBlur),Z(t,"shadowOffsetX")&&(e.textBoxShadowOffsetX=t.shadowOffsetX),Z(t,"shadowOffsetY")&&(e.textBoxShadowOffsetY=t.shadowOffsetY),Z(t,"textShadowColor")&&(e.textShadowColor=t.textShadowColor),Z(t,"textShadowBlur")&&(e.textShadowBlur=t.textShadowBlur),Z(t,"textShadowOffsetX")&&(e.textShadowOffsetX=t.textShadowOffsetX),Z(t,"textShadowOffsetY")&&(e.textShadowOffsetY=t.textShadowOffsetY))}var p_={position:["x","y"],scale:["scaleX","scaleY"],origin:["originX","originY"]},Rp=It(p_);Sm(uo,function(e,t){return e[t]=1,e},{});uo.join(", ");var Ys=["","style","shape","extra"],Ja=Nt();function Vf(e,t,r,n,a){var i=e+"Animation",o=Oo(e,n,a)||{},s=Ja(t).userDuring;return o.duration>0&&(o.during=s?me(k5,{el:t,userDuring:s}):null,o.setToFinal=!0,o.scope=e),le(o,r[i]),o}function ws(e,t,r,n){n=n||{};var a=n.dataIndex,i=n.isInit,o=n.clearStyle,s=r.isAnimationEnabled(),l=Ja(e),u=t.style;l.userDuring=t.during;var c={},h={};if(W5(e,t,h),Op("shape",t,h),Op("extra",t,h),!i&&s&&(H5(e,t,c),Np("shape",e,t,c),Np("extra",e,t,c),$5(e,t,u,c)),h.style=u,z5(e,h,o),V5(e,t),s)if(i){var f={};R(Ys,function(v){var p=v?t[v]:t;p&&p.enterFrom&&(v&&(f[v]=f[v]||{}),le(v?f[v]:f,p.enterFrom))});var d=Vf("enter",e,t,r,a);d.duration>0&&e.animateFrom(f,d)}else G5(e,t,a||0,r,c);g_(e,t),u?e.dirty():e.markRedraw()}function g_(e,t){for(var r=Ja(e).leaveToProps,n=0;n<Ys.length;n++){var a=Ys[n],i=a?t[a]:t;i&&i.leaveTo&&(r||(r=Ja(e).leaveToProps={}),a&&(r[a]=r[a]||{}),le(a?r[a]:r,i.leaveTo))}}function Wl(e,t,r,n){if(e){var a=e.parent,i=Ja(e).leaveToProps;if(i){var o=Vf("update",e,t,r,0);o.done=function(){a.remove(e),n&&n()},e.animateTo(i,o)}else a.remove(e),n&&n()}}function ua(e){return e==="all"}function z5(e,t,r){var n=t.style;if(!e.isGroup&&n){if(r){e.useStyle({});for(var a=e.animators,i=0;i<a.length;i++){var o=a[i];o.targetName==="style"&&o.changeTarget(e.style)}}e.setStyle(n)}t&&(t.style=null,t&&e.attr(t),t.style=n)}function G5(e,t,r,n,a){if(a){var i=Vf("update",e,t,n,r);i.duration>0&&e.animateFrom(a,i)}}function V5(e,t){Z(t,"silent")&&(e.silent=t.silent),Z(t,"ignore")&&(e.ignore=t.ignore),e instanceof Io&&Z(t,"invisible")&&(e.invisible=t.invisible),e instanceof Gt&&Z(t,"autoBatch")&&(e.autoBatch=t.autoBatch)}var Or={},U5={setTransform:function(e,t){return Or.el[e]=t,this},getTransform:function(e){return Or.el[e]},setShape:function(e,t){var r=Or.el,n=r.shape||(r.shape={});return n[e]=t,r.dirtyShape&&r.dirtyShape(),this},getShape:function(e){var t=Or.el.shape;if(t)return t[e]},setStyle:function(e,t){var r=Or.el,n=r.style;return n&&(n[e]=t,r.dirtyStyle&&r.dirtyStyle()),this},getStyle:function(e){var t=Or.el.style;if(t)return t[e]},setExtra:function(e,t){var r=Or.el.extra||(Or.el.extra={});return r[e]=t,this},getExtra:function(e){var t=Or.el.extra;if(t)return t[e]}};function k5(){var e=this,t=e.el;if(t){var r=Ja(t).userDuring,n=e.userDuring;if(r!==n){e.el=e.userDuring=null;return}Or.el=t,n(U5)}}function Np(e,t,r,n){var a=r[e];if(a){var i=t[e],o;if(i){var s=r.transition,l=a.transition;if(l)if(!o&&(o=n[e]={}),ua(l))le(o,i);else for(var u=rr(l),c=0;c<u.length;c++){var h=u[c],f=i[h];o[h]=f}else if(ua(s)||pt(s,e)>=0){!o&&(o=n[e]={});for(var d=It(i),c=0;c<d.length;c++){var h=d[c],f=i[h];X5(a[h],f)&&(o[h]=f)}}}}}function Op(e,t,r){var n=t[e];if(n)for(var a=r[e]={},i=It(n),o=0;o<i.length;o++){var s=i[o];a[s]=yT(n[s])}}function H5(e,t,r){for(var n=t.transition,a=ua(n)?uo:rr(n||[]),i=0;i<a.length;i++){var o=a[i];if(!(o==="style"||o==="shape"||o==="extra")){var s=e[o];r[o]=s}}}function W5(e,t,r){for(var n=0;n<Rp.length;n++){var a=Rp[n],i=p_[a],o=t[a];o&&(r[i[0]]=o[0],r[i[1]]=o[1])}for(var n=0;n<uo.length;n++){var s=uo[n];t[s]!=null&&(r[s]=t[s])}}function $5(e,t,r,n){if(r){var a=e.style,i;if(a){var o=r.transition,s=t.transition;if(o&&!ua(o)){var l=rr(o);!i&&(i=n.style={});for(var u=0;u<l.length;u++){var c=l[u],h=a[c];i[c]=h}}else if(e.getAnimationStyleProps&&(ua(s)||ua(o)||pt(s,"style")>=0)){var f=e.getAnimationStyleProps(),d=f?f.style:null;if(d){!i&&(i=n.style={});for(var v=It(r),u=0;u<v.length;u++){var c=v[u];if(d[c]){var h=a[c];i[c]=h}}}}}}}function X5(e,t){return Tm(e)?e!==t:e!=null&&isFinite(e)}var m_=Nt(),j5=["percent","easing","shape","style","extra"];function y_(e){e.stopAnimation("keyframe"),e.attr(m_(e))}function qs(e,t,r){if(!(!r.isAnimationEnabled()||!t)){if(te(t)){R(t,function(s){qs(e,s,r)});return}var n=t.keyframes,a=t.duration;if(r&&a==null){var i=Oo("enter",r,0);a=i&&i.duration}if(!(!n||!a)){var o=m_(e);R(Ys,function(s){if(!(s&&!e[s])){var l;n.sort(function(u,c){return u.percent-c.percent}),R(n,function(u){var c=e.animators,h=s?u[s]:u;if(h){var f=It(h);if(s||(f=Vt(f,function(p){return pt(j5,p)<0})),!!f.length){l||(l=e.animate(s,t.loop,!0),l.scope="keyframe");for(var d=0;d<c.length;d++)c[d]!==l&&c[d].targetName===l.targetName&&c[d].stopTracks(f);s&&(o[s]=o[s]||{});var v=s?o[s]:o;R(f,function(p){v[p]=((s?e[s]:e)||{})[p]}),l.whenWithKeys(a*u.percent,h,f,u.easing)}}}),l&&l.delay(t.delay||0).duration(a).start(t.easing)}})}}}var rn="emphasis",Tn="normal",Uf="blur",kf="select",Pn=[Tn,rn,Uf,kf],qu={normal:["itemStyle"],emphasis:[rn,"itemStyle"],blur:[Uf,"itemStyle"],select:[kf,"itemStyle"]},Ku={normal:["label"],emphasis:[rn,"label"],blur:[Uf,"label"],select:[kf,"label"]},Z5=["x","y"],Y5="e\0\0",dr={normal:{},emphasis:{},blur:{},select:{}},q5={cartesian2d:M5,geo:I5,single:N5,polar:B5,calendar:F5};function _h(e){return e instanceof Gt}function xh(e){return e instanceof Io}function K5(e,t){t.copyTransform(e),xh(t)&&xh(e)&&(t.setStyle(e.style),t.z=e.z,t.z2=e.z2,t.zlevel=e.zlevel,t.invisible=e.invisible,t.ignore=e.ignore,_h(t)&&_h(e)&&t.setShape(e.shape))}var J5=function(e){U(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.render=function(r,n,a,i){this._progressiveEls=null;var o=this._data,s=r.getData(),l=this.group,u=Bp(r,s,n,a);o||l.removeAll(),s.diff(o).add(function(h){Ju(a,null,h,u(h,i),r,l,s)}).remove(function(h){var f=o.getItemGraphicEl(h);f&&Wl(f,tn(f).option,r)}).update(function(h,f){var d=o.getItemGraphicEl(f);Ju(a,d,h,u(h,i),r,l,s)}).execute();var c=r.get("clip",!0)?uf(r.coordinateSystem,!1,r):null;c?l.setClipPath(c):l.removeClipPath(),this._data=s},t.prototype.incrementalPrepareRender=function(r,n,a){this.group.removeAll(),this._data=null},t.prototype.incrementalRender=function(r,n,a,i,o){var s=n.getData(),l=Bp(n,s,a,i),u=this._progressiveEls=[];function c(d){d.isGroup||(d.incremental=!0,d.ensureState("emphasis").hoverLayer=!0)}for(var h=r.start;h<r.end;h++){var f=Ju(null,null,h,l(h,o),n,this.group,s);f&&(f.traverse(c),u.push(f))}},t.prototype.eachRendered=function(r){Rl(this._progressiveEls||this.group,r)},t.prototype.filterForExposedEvent=function(r,n,a,i){var o=n.element;if(o==null||a.name===o)return!0;for(;(a=a.__hostTarget||a.parent)&&a!==this.group;)if(a.name===o)return!0;return!1},t.type="custom",t}(He);const Q5=J5;function Hf(e){var t=e.type,r;if(t==="path"){var n=e.shape,a=n.width!=null&&n.height!=null?{x:n.x||0,y:n.y||0,width:n.width,height:n.height}:null,i=S_(n);r=ST(i,null,a,n.layout||"center"),tn(r).customPathData=i}else if(t==="image")r=new un({}),tn(r).customImagePath=e.style.image;else if(t==="text")r=new rt({});else if(t==="group")r=new Fe;else{if(t==="compoundPath")throw new Error('"compoundPath" is not supported yet.');var o=bm(t);if(!o){var s="";ct(s)}r=new o}return tn(r).customGraphicType=t,r.name=e.name,r.z2EmphasisLift=1,r.z2SelectLift=1,r}function Wf(e,t,r,n,a,i,o){y_(t);var s=a&&a.normal.cfg;s&&t.setTextConfig(s),n&&n.transition==null&&(n.transition=Z5);var l=n&&n.style;if(l){if(t.type==="text"){var u=l;Z(u,"textFill")&&(u.fill=u.textFill),Z(u,"textStroke")&&(u.stroke=u.textStroke)}var c=void 0,h=_h(t)?l.decal:null;e&&h&&(h.dirty=!0,c=xm(h,e)),l.__decalPattern=c}if(xh(t)&&l){var c=l.__decalPattern;c&&(l.decal=c)}ws(t,n,i,{dataIndex:r,isInit:o,clearStyle:!0}),qs(t,n.keyframeAnimation,i)}function __(e,t,r,n,a){var i=t.isGroup?null:t,o=a&&a[e].cfg;if(i){var s=i.ensureState(e);if(n===!1){var l=i.getState(e);l&&(l.style=null)}else s.style=n||null;o&&(s.textConfig=o),Fs(i)}}function eL(e,t,r){if(!e.isGroup){var n=e,a=r.currentZ,i=r.currentZLevel;n.z=a,n.zlevel=i;var o=t.z2;o!=null&&(n.z2=o||0);for(var s=0;s<Pn.length;s++)tL(n,t,Pn[s])}}function tL(e,t,r){var n=r===Tn,a=n?t:Ks(t,r),i=a?a.z2:null,o;i!=null&&(o=n?e:e.ensureState(r),o.z2=i||0)}function Bp(e,t,r,n){var a=e.get("renderItem"),i=e.coordinateSystem,o={};i&&(o=i.prepareCustoms?i.prepareCustoms(i):q5[i.type](i));for(var s=Te({getWidth:n.getWidth,getHeight:n.getHeight,getZr:n.getZr,getDevicePixelRatio:n.getDevicePixelRatio,value:x,style:T,ordinalRawValue:S,styleEmphasis:b,visual:E,barLayout:C,currentSeriesIndices:M,font:P},o.api||{}),l={context:{},seriesId:e.id,seriesName:e.name,seriesIndex:e.seriesIndex,coordSys:o.coordSys,dataInsideLength:t.count(),encode:rL(e.getData())},u,c,h={},f={},d={},v={},p=0;p<Pn.length;p++){var g=Pn[p];d[g]=e.getModel(qu[g]),v[g]=e.getModel(Ku[g])}function m(L){return L===u?c||(c=t.getItemModel(L)):t.getItemModel(L)}function _(L,I){return t.hasItemOption?L===u?h[I]||(h[I]=m(L).getModel(qu[I])):m(L).getModel(qu[I]):d[I]}function y(L,I){return t.hasItemOption?L===u?f[I]||(f[I]=m(L).getModel(Ku[I])):m(L).getModel(Ku[I]):v[I]}return function(L,I){return u=L,c=null,h={},f={},a&&a(Te({dataIndexInside:L,dataIndex:t.getRawIndex(L),actionType:I?I.type:null},l),s)};function x(L,I){return I==null&&(I=u),t.getStore().get(t.getDimensionIndex(L||0),I)}function S(L,I){I==null&&(I=u),L=L||0;var N=t.getDimensionInfo(L);if(!N){var F=t.getDimensionIndex(L);return F>=0?t.getStore().get(F,I):void 0}var B=t.get(N.name,I),k=N&&N.ordinalMeta;return k?k.categories[B]:B}function T(L,I){I==null&&(I=u);var N=t.getItemVisual(I,"style"),F=N&&N.fill,B=N&&N.opacity,k=_(I,Tn).getItemStyle();F!=null&&(k.fill=F),B!=null&&(k.opacity=B);var z={inheritColor:Ve(F)?F:"#000"},W=y(I,Tn),J=ft(W,null,z,!1,!0);J.text=W.getShallow("show")?jt(e.getFormattedLabel(I,Tn),rh(t,I)):null;var re=av(W,z,!1);return A(L,k),k=Pp(k,J,re),L&&w(k,L),k.legacy=!0,k}function b(L,I){I==null&&(I=u);var N=_(I,rn).getItemStyle(),F=y(I,rn),B=ft(F,null,null,!0,!0);B.text=F.getShallow("show")?Ro(e.getFormattedLabel(I,rn),e.getFormattedLabel(I,Tn),rh(t,I)):null;var k=av(F,null,!0);return A(L,N),N=Pp(N,B,k),L&&w(N,L),N.legacy=!0,N}function w(L,I){for(var N in I)Z(I,N)&&(L[N]=I[N])}function A(L,I){L&&(L.textFill&&(I.textFill=L.textFill),L.textPosition&&(I.textPosition=L.textPosition))}function E(L,I){if(I==null&&(I=u),Z(Dp,L)){var N=t.getItemVisual(I,"style");return N?N[Dp[L]]:null}if(Z(E5,L))return t.getItemVisual(I,L)}function C(L){if(i.type==="cartesian2d"){var I=i.getBaseAxis();return _T(Te({axis:I},L))}}function M(){return r.getCurrentSeriesIndices()}function P(L){return xT(L,r)}}function rL(e){var t={};return R(e.dimensions,function(r){var n=e.getDimensionInfo(r);if(!n.isExtraCoord){var a=n.coordDim,i=t[a]=t[a]||[];i[n.coordDimIndex]=e.getDimensionIndex(r)}}),t}function Ju(e,t,r,n,a,i,o){if(!n){i.remove(t);return}var s=$f(e,t,r,n,a,i);return s&&o.setItemGraphicEl(r,s),s&&zt(s,n.focus,n.blurScope,n.emphasisDisabled),s}function $f(e,t,r,n,a,i){var o=-1,s=t;t&&x_(t,n,a)&&(o=pt(i.childrenRef(),t),t=null);var l=!t,u=t;u?u.clearStates():(u=Hf(n),s&&K5(s,u)),n.morph===!1?u.disableMorphing=!0:u.disableMorphing&&(u.disableMorphing=!1),dr.normal.cfg=dr.normal.conOpt=dr.emphasis.cfg=dr.emphasis.conOpt=dr.blur.cfg=dr.blur.conOpt=dr.select.cfg=dr.select.conOpt=null,dr.isLegacy=!1,aL(u,r,n,a,l,dr),nL(u,r,n,a,l),Wf(e,u,r,n,dr,a,l),Z(n,"info")&&(tn(u).info=n.info);for(var c=0;c<Pn.length;c++){var h=Pn[c];if(h!==Tn){var f=Ks(n,h),d=Xf(n,f,h);__(h,u,f,d,dr)}}return eL(u,n,a),n.type==="group"&&iL(e,u,r,n,a),o>=0?i.replaceAt(u,o):i.add(u),u}function x_(e,t,r){var n=tn(e),a=t.type,i=t.shape,o=t.style;return r.isUniversalTransitionEnabled()||a!=null&&a!==n.customGraphicType||a==="path"&&uL(i)&&S_(i)!==n.customPathData||a==="image"&&Z(o,"image")&&o.image!==n.customImagePath}function nL(e,t,r,n,a){var i=r.clipPath;if(i===!1)e&&e.getClipPath()&&e.removeClipPath();else if(i){var o=e.getClipPath();o&&x_(o,i,n)&&(o=null),o||(o=Hf(i),e.setClipPath(o)),Wf(null,o,t,i,null,n,a)}}function aL(e,t,r,n,a,i){if(!e.isGroup){Fp(r,null,i),Fp(r,rn,i);var o=i.normal.conOpt,s=i.emphasis.conOpt,l=i.blur.conOpt,u=i.select.conOpt;if(o!=null||s!=null||u!=null||l!=null){var c=e.getTextContent();if(o===!1)c&&e.removeTextContent();else{o=i.normal.conOpt=o||{type:"text"},c?c.clearStates():(c=Hf(o),e.setTextContent(c)),Wf(null,c,t,o,null,n,a);for(var h=o&&o.style,f=0;f<Pn.length;f++){var d=Pn[f];if(d!==Tn){var v=i[d].conOpt;__(d,c,v,Xf(o,v,d),null)}}h?c.dirty():c.markRedraw()}}}}function Fp(e,t,r){var n=t?Ks(e,t):e,a=t?Xf(e,n,rn):e.style,i=e.type,o=n?n.textConfig:null,s=e.textContent,l=s?t?Ks(s,t):s:null;if(a&&(r.isLegacy||d_(a,i,!!o,!!l))){r.isLegacy=!0;var u=v_(a,i,!t);!o&&u.textConfig&&(o=u.textConfig),!l&&u.textContent&&(l=u.textContent)}if(!t&&l){var c=l;!c.type&&(c.type="text")}var h=t?r[t]:r.normal;h.cfg=o,h.conOpt=l}function Ks(e,t){return t?e?e[t]:null:e}function Xf(e,t,r){var n=t&&t.style;return n==null&&r===rn&&e&&(n=e.styleEmphasis),n}function iL(e,t,r,n,a){var i=n.children,o=i?i.length:0,s=n.$mergeChildren,l=s==="byName"||n.diffChildrenByName,u=s===!1;if(!(!o&&!l&&!u)){if(l){sL({api:e,oldChildren:t.children()||[],newChildren:i||[],dataIndex:r,seriesModel:a,group:t});return}u&&t.removeAll();for(var c=0;c<o;c++){var h=i[c],f=t.childAt(c);h?(h.ignore==null&&(h.ignore=!1),$f(e,f,r,h,a,t)):f.ignore=!0}for(var d=t.childCount()-1;d>=c;d--){var v=t.childAt(d);oL(t,v,a)}}}function oL(e,t,r){t&&Wl(t,tn(e).option,r)}function sL(e){new Dn(e.oldChildren,e.newChildren,zp,zp,e).add(Gp).update(Gp).remove(lL).execute()}function zp(e,t){var r=e&&e.name;return r??Y5+t}function Gp(e,t){var r=this.context,n=e!=null?r.newChildren[e]:null,a=t!=null?r.oldChildren[t]:null;$f(r.api,a,r.dataIndex,n,r.seriesModel,r.group)}function lL(e){var t=this.context,r=t.oldChildren[e];r&&Wl(r,tn(r).option,t.seriesModel)}function S_(e){return e&&(e.pathData||e.d)}function uL(e){return e&&(Z(e,"pathData")||Z(e,"d"))}function cL(e){e.registerChartView(Q5),e.registerSeriesModel(L5)}var hL=function(e){U(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.makeElOption=function(r,n,a,i,o){var s=a.axis;s.dim==="angle"&&(this.animationThreshold=Math.PI/18);var l=s.polar,u=l.getOtherAxis(s),c=u.getExtent(),h=s.dataToCoord(n),f=i.get("type");if(f&&f!=="none"){var d=wm(i),v=dL[f](s,l,h,c);v.style=d,r.graphicKey=v.type,r.pointer=v}var p=i.get(["label","margin"]),g=fL(n,a,i,l,p);TT(r,a,i,o,g)},t}(Am);function fL(e,t,r,n,a){var i=t.axis,o=i.dataToCoord(e),s=n.getAngleAxis().getExtent()[0];s=s/180*Math.PI;var l=n.getRadiusAxis().getExtent(),u,c,h;if(i.dim==="radius"){var f=Po();of(f,f,s),qa(f,f,[n.cx,n.cy]),u=lo([o,-a],f);var d=t.getModel("axisLabel").get("rotate")||0,v=fa.innerTextLayout(s,d*Math.PI/180,-1);c=v.textAlign,h=v.textVerticalAlign}else{var p=l[1];u=n.coordToPoint([p+a,o]);var g=n.cx,m=n.cy;c=Math.abs(u[0]-g)/p<.3?"center":u[0]>g?"left":"right",h=Math.abs(u[1]-m)/p<.3?"middle":u[1]>m?"top":"bottom"}return{position:u,align:c,verticalAlign:h}}var dL={line:function(e,t,r,n){return e.dim==="angle"?{type:"Line",shape:Em(t.coordToPoint([n[0],r]),t.coordToPoint([n[1],r]))}:{type:"Circle",shape:{cx:t.cx,cy:t.cy,r}}},shadow:function(e,t,r,n){var a=Math.max(1,e.getBandWidth()),i=Math.PI/180;return e.dim==="angle"?{type:"Sector",shape:iv(t.cx,t.cy,n[0],n[1],(-r-a/2)*i,(-r+a/2)*i)}:{type:"Sector",shape:iv(t.cx,t.cy,r-a/2,r+a/2,0,Math.PI*2)}}};const vL=hL;var pL=function(e){U(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.findAxisModel=function(r){var n,a=this.ecModel;return a.eachComponent(r,function(i){i.getCoordSysModel()===this&&(n=i)},this),n},t.type="polar",t.dependencies=["radiusAxis","angleAxis"],t.defaultOption={z:0,center:["50%","50%"],radius:"80%"},t}(Ot);const gL=pL;var jf=function(e){U(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.getCoordSysModel=function(){return this.getReferringComponents("polar",sn).models[0]},t.type="polarAxis",t}(Ot);Xr(jf,Mo);var mL=function(e){U(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.type="angleAxis",t}(jf),yL=function(e){U(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.type="radiusAxis",t}(jf),Zf=function(e){U(t,e);function t(r,n){return e.call(this,"radius",r,n)||this}return t.prototype.pointToData=function(r,n){return this.polar.pointToData(r,n)[this.dim==="radius"?0:1]},t}(or);Zf.prototype.dataToRadius=or.prototype.dataToCoord;Zf.prototype.radiusToData=or.prototype.coordToData;const _L=Zf;var xL=Nt(),Yf=function(e){U(t,e);function t(r,n){return e.call(this,"angle",r,n||[0,360])||this}return t.prototype.pointToData=function(r,n){return this.polar.pointToData(r,n)[this.dim==="radius"?0:1]},t.prototype.calculateCategoryInterval=function(){var r=this,n=r.getLabelModel(),a=r.scale,i=a.getExtent(),o=a.count();if(i[1]-i[0]<1)return 0;var s=i[0],l=r.dataToCoord(s+1)-r.dataToCoord(s),u=Math.abs(l),c=Cm(s==null?"":s+"",n.getFont(),"center","top"),h=Math.max(c.height,7),f=h/u;isNaN(f)&&(f=1/0);var d=Math.max(0,Math.floor(f)),v=xL(r.model),p=v.lastAutoInterval,g=v.lastTickCount;return p!=null&&g!=null&&Math.abs(p-d)<=1&&Math.abs(g-o)<=1&&p>d?d=p:(v.lastTickCount=o,v.lastAutoInterval=d),d},t}(or);Yf.prototype.dataToAngle=or.prototype.dataToCoord;Yf.prototype.angleToData=or.prototype.coordToData;const SL=Yf;var T_=["radius","angle"],TL=function(){function e(t){this.dimensions=T_,this.type="polar",this.cx=0,this.cy=0,this._radiusAxis=new _L,this._angleAxis=new SL,this.axisPointerEnabled=!0,this.name=t||"",this._radiusAxis.polar=this._angleAxis.polar=this}return e.prototype.containPoint=function(t){var r=this.pointToCoord(t);return this._radiusAxis.contain(r[0])&&this._angleAxis.contain(r[1])},e.prototype.containData=function(t){return this._radiusAxis.containData(t[0])&&this._angleAxis.containData(t[1])},e.prototype.getAxis=function(t){var r="_"+t+"Axis";return this[r]},e.prototype.getAxes=function(){return[this._radiusAxis,this._angleAxis]},e.prototype.getAxesByScale=function(t){var r=[],n=this._angleAxis,a=this._radiusAxis;return n.scale.type===t&&r.push(n),a.scale.type===t&&r.push(a),r},e.prototype.getAngleAxis=function(){return this._angleAxis},e.prototype.getRadiusAxis=function(){return this._radiusAxis},e.prototype.getOtherAxis=function(t){var r=this._angleAxis;return t===r?this._radiusAxis:r},e.prototype.getBaseAxis=function(){return this.getAxesByScale("ordinal")[0]||this.getAxesByScale("time")[0]||this.getAngleAxis()},e.prototype.getTooltipAxes=function(t){var r=t!=null&&t!=="auto"?this.getAxis(t):this.getBaseAxis();return{baseAxes:[r],otherAxes:[this.getOtherAxis(r)]}},e.prototype.dataToPoint=function(t,r){return this.coordToPoint([this._radiusAxis.dataToRadius(t[0],r),this._angleAxis.dataToAngle(t[1],r)])},e.prototype.pointToData=function(t,r){var n=this.pointToCoord(t);return[this._radiusAxis.radiusToData(n[0],r),this._angleAxis.angleToData(n[1],r)]},e.prototype.pointToCoord=function(t){var r=t[0]-this.cx,n=t[1]-this.cy,a=this.getAngleAxis(),i=a.getExtent(),o=Math.min(i[0],i[1]),s=Math.max(i[0],i[1]);a.inverse?o=s-360:s=o+360;var l=Math.sqrt(r*r+n*n);r/=l,n/=l;for(var u=Math.atan2(-n,r)/Math.PI*180,c=u<o?1:-1;u<o||u>s;)u+=c*360;return[l,u]},e.prototype.coordToPoint=function(t){var r=t[0],n=t[1]/180*Math.PI,a=Math.cos(n)*r+this.cx,i=-Math.sin(n)*r+this.cy;return[a,i]},e.prototype.getArea=function(){var t=this.getAngleAxis(),r=this.getRadiusAxis(),n=r.getExtent().slice();n[0]>n[1]&&n.reverse();var a=t.getExtent(),i=Math.PI/180;return{cx:this.cx,cy:this.cy,r0:n[0],r:n[1],startAngle:-a[0]*i,endAngle:-a[1]*i,clockwise:t.inverse,contain:function(o,s){var l=o-this.cx,u=s-this.cy,c=l*l+u*u-1e-4,h=this.r,f=this.r0;return c<=h*h&&c>=f*f}}},e.prototype.convertToPixel=function(t,r,n){var a=Vp(r);return a===this?this.dataToPoint(n):null},e.prototype.convertFromPixel=function(t,r,n){var a=Vp(r);return a===this?this.pointToData(n):null},e}();function Vp(e){var t=e.seriesModel,r=e.polarModel;return r&&r.coordinateSystem||t&&t.coordinateSystem}const bL=TL;function wL(e,t,r){var n=t.get("center"),a=r.getWidth(),i=r.getHeight();e.cx=ee(n[0],a),e.cy=ee(n[1],i);var o=e.getRadiusAxis(),s=Math.min(a,i)/2,l=t.get("radius");l==null?l=[0,"100%"]:te(l)||(l=[0,l]);var u=[ee(l[0],s),ee(l[1],s)];o.inverse?o.setExtent(u[1],u[0]):o.setExtent(u[0],u[1])}function AL(e,t){var r=this,n=r.getAngleAxis(),a=r.getRadiusAxis();if(n.scale.setExtent(1/0,-1/0),a.scale.setExtent(1/0,-1/0),e.eachSeries(function(s){if(s.coordinateSystem===r){var l=s.getData();R(ov(l,"radius"),function(u){a.scale.unionExtentFromData(l,u)}),R(ov(l,"angle"),function(u){n.scale.unionExtentFromData(l,u)})}}),ao(n.scale,n.model),ao(a.scale,a.model),n.type==="category"&&!n.onBand){var i=n.getExtent(),o=360/n.scale.count();n.inverse?i[1]+=o:i[1]-=o,n.setExtent(i[0],i[1])}}function EL(e){return e.mainType==="angleAxis"}function Up(e,t){if(e.type=t.get("type"),e.scale=Tl(t),e.onBand=t.get("boundaryGap")&&e.type==="category",e.inverse=t.get("inverse"),EL(t)){e.inverse=e.inverse!==t.get("clockwise");var r=t.get("startAngle");e.setExtent(r,r+(e.inverse?-360:360))}t.axis=e,e.model=t}var CL={dimensions:T_,create:function(e,t){var r=[];return e.eachComponent("polar",function(n,a){var i=new bL(a+"");i.update=AL;var o=i.getRadiusAxis(),s=i.getAngleAxis(),l=n.findAxisModel("radiusAxis"),u=n.findAxisModel("angleAxis");Up(o,l),Up(s,u),wL(i,n,t),r.push(i),n.coordinateSystem=i,i.model=n}),e.eachSeries(function(n){if(n.get("coordinateSystem")==="polar"){var a=n.getReferringComponents("polar",sn).models[0];n.coordinateSystem=a.coordinateSystem}}),r}};const LL=CL;var DL=["axisLine","axisLabel","axisTick","minorTick","splitLine","minorSplitLine","splitArea"];function as(e,t,r){t[1]>t[0]&&(t=t.slice().reverse());var n=e.coordToPoint([t[0],r]),a=e.coordToPoint([t[1],r]);return{x1:n[0],y1:n[1],x2:a[0],y2:a[1]}}function is(e){var t=e.getRadiusAxis();return t.inverse?0:1}function kp(e){var t=e[0],r=e[e.length-1];t&&r&&Math.abs(Math.abs(t.coord-r.coord)-360)<1e-4&&e.pop()}var ML=function(e){U(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r.axisPointerClass="PolarAxisPointer",r}return t.prototype.render=function(r,n){if(this.group.removeAll(),!!r.get("show")){var a=r.axis,i=a.polar,o=i.getRadiusAxis().getExtent(),s=a.getTicksCoords(),l=a.getMinorTicksCoords(),u=K(a.getViewLabels(),function(c){c=vt(c);var h=a.scale,f=h.type==="ordinal"?h.getRawOrdinalNumber(c.tickValue):c.tickValue;return c.coord=a.dataToCoord(f),c});kp(u),kp(s),R(DL,function(c){r.get([c,"show"])&&(!a.scale.isBlank()||c==="axisLine")&&PL[c](this.group,r,i,s,l,o,u)},this)}},t.type="angleAxis",t}(Bo),PL={axisLine:function(e,t,r,n,a,i){var o=t.getModel(["axisLine","lineStyle"]),s=is(r),l=s?0:1,u;i[l]===0?u=new oo({shape:{cx:r.cx,cy:r.cy,r:i[s]},style:o.getLineStyle(),z2:1,silent:!0}):u=new nm({shape:{cx:r.cx,cy:r.cy,r:i[s],r0:i[l]},style:o.getLineStyle(),z2:1,silent:!0}),u.style.fill=null,e.add(u)},axisTick:function(e,t,r,n,a,i){var o=t.getModel("axisTick"),s=(o.get("inside")?-1:1)*o.get("length"),l=i[is(r)],u=K(n,function(c){return new Gr({shape:as(r,[l,l+s],c.coord)})});e.add(Cr(u,{style:Te(o.getModel("lineStyle").getLineStyle(),{stroke:t.get(["axisLine","lineStyle","color"])})}))},minorTick:function(e,t,r,n,a,i){if(a.length){for(var o=t.getModel("axisTick"),s=t.getModel("minorTick"),l=(o.get("inside")?-1:1)*s.get("length"),u=i[is(r)],c=[],h=0;h<a.length;h++)for(var f=0;f<a[h].length;f++)c.push(new Gr({shape:as(r,[u,u+l],a[h][f].coord)}));e.add(Cr(c,{style:Te(s.getModel("lineStyle").getLineStyle(),Te(o.getLineStyle(),{stroke:t.get(["axisLine","lineStyle","color"])}))}))}},axisLabel:function(e,t,r,n,a,i,o){var s=t.getCategories(!0),l=t.getModel("axisLabel"),u=l.get("margin"),c=t.get("triggerEvent");R(o,function(h,f){var d=l,v=h.tickValue,p=i[is(r)],g=r.coordToPoint([p+u,h.coord]),m=r.cx,_=r.cy,y=Math.abs(g[0]-m)/p<.3?"center":g[0]>m?"left":"right",x=Math.abs(g[1]-_)/p<.3?"middle":g[1]>_?"top":"bottom";if(s&&s[v]){var S=s[v];Hr(S)&&S.textStyle&&(d=new Ft(S.textStyle,l,l.ecModel))}var T=new rt({silent:fa.isLabelSilent(t),style:ft(d,{x:g[0],y:g[1],fill:d.getTextColor()||t.get(["axisLine","lineStyle","color"]),text:h.formattedLabel,align:y,verticalAlign:x})});if(e.add(T),c){var b=fa.makeAxisEventDataBase(t);b.targetType="axisLabel",b.value=h.rawLabel,et(T).eventData=b}},this)},splitLine:function(e,t,r,n,a,i){var o=t.getModel("splitLine"),s=o.getModel("lineStyle"),l=s.get("color"),u=0;l=l instanceof Array?l:[l];for(var c=[],h=0;h<n.length;h++){var f=u++%l.length;c[f]=c[f]||[],c[f].push(new Gr({shape:as(r,i,n[h].coord)}))}for(var h=0;h<c.length;h++)e.add(Cr(c[h],{style:Te({stroke:l[h%l.length]},s.getLineStyle()),silent:!0,z:t.get("z")}))},minorSplitLine:function(e,t,r,n,a,i){if(a.length){for(var o=t.getModel("minorSplitLine"),s=o.getModel("lineStyle"),l=[],u=0;u<a.length;u++)for(var c=0;c<a[u].length;c++)l.push(new Gr({shape:as(r,i,a[u][c].coord)}));e.add(Cr(l,{style:s.getLineStyle(),silent:!0,z:t.get("z")}))}},splitArea:function(e,t,r,n,a,i){if(n.length){var o=t.getModel("splitArea"),s=o.getModel("areaStyle"),l=s.get("color"),u=0;l=l instanceof Array?l:[l];for(var c=[],h=Math.PI/180,f=-n[0].coord*h,d=Math.min(i[0],i[1]),v=Math.max(i[0],i[1]),p=t.get("clockwise"),g=1,m=n.length;g<=m;g++){var _=g===m?n[0].coord:n[g].coord,y=u++%l.length;c[y]=c[y]||[],c[y].push(new da({shape:{cx:r.cx,cy:r.cy,r0:d,r:v,startAngle:f,endAngle:-_*h,clockwise:p},silent:!0})),f=-_*h}for(var g=0;g<c.length;g++)e.add(Cr(c[g],{style:Te({fill:l[g%l.length]},s.getAreaStyle()),silent:!0}))}}};const IL=ML;var RL=["axisLine","axisTickLabel","axisName"],NL=["splitLine","splitArea","minorSplitLine"],OL=function(e){U(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r.axisPointerClass="PolarAxisPointer",r}return t.prototype.render=function(r,n){if(this.group.removeAll(),!!r.get("show")){var a=this._axisGroup,i=this._axisGroup=new Fe;this.group.add(i);var o=r.axis,s=o.polar,l=s.getAngleAxis(),u=o.getTicksCoords(),c=o.getMinorTicksCoords(),h=l.getExtent()[0],f=o.getExtent(),d=FL(s,r,h),v=new fa(r,d);R(RL,v.add,v),i.add(v.getGroup()),lf(a,i,r),R(NL,function(p){r.get([p,"show"])&&!o.scale.isBlank()&&BL[p](this.group,r,s,h,f,u,c)},this)}},t.type="radiusAxis",t}(Bo),BL={splitLine:function(e,t,r,n,a,i){var o=t.getModel("splitLine"),s=o.getModel("lineStyle"),l=s.get("color"),u=0;l=l instanceof Array?l:[l];for(var c=[],h=0;h<i.length;h++){var f=u++%l.length;c[f]=c[f]||[],c[f].push(new oo({shape:{cx:r.cx,cy:r.cy,r:Math.max(i[h].coord,0)}}))}for(var h=0;h<c.length;h++)e.add(Cr(c[h],{style:Te({stroke:l[h%l.length],fill:null},s.getLineStyle()),silent:!0}))},minorSplitLine:function(e,t,r,n,a,i,o){if(o.length){for(var s=t.getModel("minorSplitLine"),l=s.getModel("lineStyle"),u=[],c=0;c<o.length;c++)for(var h=0;h<o[c].length;h++)u.push(new oo({shape:{cx:r.cx,cy:r.cy,r:o[c][h].coord}}));e.add(Cr(u,{style:Te({fill:null},l.getLineStyle()),silent:!0}))}},splitArea:function(e,t,r,n,a,i){if(i.length){var o=t.getModel("splitArea"),s=o.getModel("areaStyle"),l=s.get("color"),u=0;l=l instanceof Array?l:[l];for(var c=[],h=i[0].coord,f=1;f<i.length;f++){var d=u++%l.length;c[d]=c[d]||[],c[d].push(new da({shape:{cx:r.cx,cy:r.cy,r0:h,r:i[f].coord,startAngle:0,endAngle:Math.PI*2},silent:!0})),h=i[f].coord}for(var f=0;f<c.length;f++)e.add(Cr(c[f],{style:Te({fill:l[f%l.length]},s.getAreaStyle()),silent:!0}))}}};function FL(e,t,r){return{position:[e.cx,e.cy],rotation:r/180*Math.PI,labelDirection:-1,tickDirection:-1,nameDirection:1,labelRotate:t.getModel("axisLabel").get("rotate"),z2:1}}const zL=OL;function b_(e){return e.get("stack")||"__ec_stack_"+e.seriesIndex}function w_(e,t){return t.dim+e.model.componentIndex}function GL(e,t,r){var n={},a=VL(Vt(t.getSeriesByType(e),function(i){return!t.isSeriesFiltered(i)&&i.coordinateSystem&&i.coordinateSystem.type==="polar"}));t.eachSeriesByType(e,function(i){if(i.coordinateSystem.type==="polar"){var o=i.getData(),s=i.coordinateSystem,l=s.getBaseAxis(),u=w_(s,l),c=b_(i),h=a[u][c],f=h.offset,d=h.width,v=s.getOtherAxis(l),p=i.coordinateSystem.cx,g=i.coordinateSystem.cy,m=i.get("barMinHeight")||0,_=i.get("barMinAngle")||0;n[c]=n[c]||[];for(var y=o.mapDimension(v.dim),x=o.mapDimension(l.dim),S=$0(o,y),T=l.dim!=="radius"||!i.get("roundCap",!0),b=v.dataToCoord(0),w=0,A=o.count();w<A;w++){var E=o.get(y,w),C=o.get(x,w),M=E>=0?"p":"n",P=b;S&&(n[c][C]||(n[c][C]={p:b,n:b}),P=n[c][C][M]);var L=void 0,I=void 0,N=void 0,F=void 0;if(v.dim==="radius"){var B=v.dataToCoord(E)-b,k=l.dataToCoord(C);Math.abs(B)<m&&(B=(B<0?-1:1)*m),L=P,I=P+B,N=k-f,F=N-d,S&&(n[c][C][M]=I)}else{var z=v.dataToCoord(E,T)-b,W=l.dataToCoord(C);Math.abs(z)<_&&(z=(z<0?-1:1)*_),L=W+f,I=L+d,N=P,F=P+z,S&&(n[c][C][M]=F)}o.setItemLayout(w,{cx:p,cy:g,r0:L,r:I,startAngle:-N*Math.PI/180,endAngle:-F*Math.PI/180,clockwise:N>=F})}}})}function VL(e){var t={};R(e,function(n,a){var i=n.getData(),o=n.coordinateSystem,s=o.getBaseAxis(),l=w_(o,s),u=s.getExtent(),c=s.type==="category"?s.getBandWidth():Math.abs(u[1]-u[0])/i.count(),h=t[l]||{bandWidth:c,remainedWidth:c,autoWidthCount:0,categoryGap:"20%",gap:"30%",stacks:{}},f=h.stacks;t[l]=h;var d=b_(n);f[d]||h.autoWidthCount++,f[d]=f[d]||{width:0,maxWidth:0};var v=ee(n.get("barWidth"),c),p=ee(n.get("barMaxWidth"),c),g=n.get("barGap"),m=n.get("barCategoryGap");v&&!f[d].width&&(v=Math.min(h.remainedWidth,v),f[d].width=v,h.remainedWidth-=v),p&&(f[d].maxWidth=p),g!=null&&(h.gap=g),m!=null&&(h.categoryGap=m)});var r={};return R(t,function(n,a){r[a]={};var i=n.stacks,o=n.bandWidth,s=ee(n.categoryGap,o),l=ee(n.gap,1),u=n.remainedWidth,c=n.autoWidthCount,h=(u-s)/(c+(c-1)*l);h=Math.max(h,0),R(i,function(p,g){var m=p.maxWidth;m&&m<h&&(m=Math.min(m,u),p.width&&(m=Math.min(m,p.width)),u-=m,p.width=m,c--)}),h=(u-s)/(c+(c-1)*l),h=Math.max(h,0);var f=0,d;R(i,function(p,g){p.width||(p.width=h),d=p,f+=p.width*(1+l)}),d&&(f-=d.width*l);var v=-f/2;R(i,function(p,g){r[a][g]=r[a][g]||{offset:v,width:p.width},v+=p.width*(1+l)})}),r}var UL={startAngle:90,clockwise:!0,splitNumber:12,axisLabel:{rotate:0}},kL={splitNumber:5},HL=function(e){U(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.type="polar",t}(kt);function WL(e){oe(hf),Bo.registerAxisPointerClass("PolarAxisPointer",vL),e.registerCoordinateSystem("polar",LL),e.registerComponentModel(gL),e.registerComponentView(HL),Us(e,"angle",mL,UL),Us(e,"radius",yL,kL),e.registerComponentView(IL),e.registerComponentView(zL),e.registerLayout(Ge(GL,"bar"))}function Sh(e,t){t=t||{};var r=e.coordinateSystem,n=e.axis,a={},i=n.position,o=n.orient,s=r.getRect(),l=[s.x,s.x+s.width,s.y,s.y+s.height],u={horizontal:{top:l[2],bottom:l[3]},vertical:{left:l[0],right:l[1]}};a.position=[o==="vertical"?u.vertical[i]:l[0],o==="horizontal"?u.horizontal[i]:l[3]];var c={horizontal:0,vertical:1};a.rotation=Math.PI/2*c[o];var h={top:-1,bottom:1,right:1,left:-1};a.labelDirection=a.tickDirection=a.nameDirection=h[i],e.get(["axisTick","inside"])&&(a.tickDirection=-a.tickDirection),Lr(t.labelInside,e.get(["axisLabel","inside"]))&&(a.labelDirection=-a.labelDirection);var f=t.rotate;return f==null&&(f=e.get(["axisLabel","rotate"])),a.labelRotation=i==="top"?-f:f,a.z2=1,a}var $L=["axisLine","axisTickLabel","axisName"],XL=["splitArea","splitLine"],jL=function(e){U(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r.axisPointerClass="SingleAxisPointer",r}return t.prototype.render=function(r,n,a,i){var o=this.group;o.removeAll();var s=this._axisGroup;this._axisGroup=new Fe;var l=Sh(r),u=new fa(r,l);R($L,u.add,u),o.add(this._axisGroup),o.add(u.getGroup()),R(XL,function(c){r.get([c,"show"])&&ZL[c](this,this.group,this._axisGroup,r)},this),lf(s,this._axisGroup,r),e.prototype.render.call(this,r,n,a,i)},t.prototype.remove=function(){bT(this)},t.type="singleAxis",t}(Bo),ZL={splitLine:function(e,t,r,n){var a=n.axis;if(!a.scale.isBlank()){var i=n.getModel("splitLine"),o=i.getModel("lineStyle"),s=o.get("color");s=s instanceof Array?s:[s];for(var l=o.get("width"),u=n.coordinateSystem.getRect(),c=a.isHorizontal(),h=[],f=0,d=a.getTicksCoords({tickModel:i}),v=[],p=[],g=0;g<d.length;++g){var m=a.toGlobalCoord(d[g].coord);c?(v[0]=m,v[1]=u.y,p[0]=m,p[1]=u.y+u.height):(v[0]=u.x,v[1]=m,p[0]=u.x+u.width,p[1]=m);var _=new Gr({shape:{x1:v[0],y1:v[1],x2:p[0],y2:p[1]},silent:!0});wT(_.shape,l);var y=f++%s.length;h[y]=h[y]||[],h[y].push(_)}for(var x=o.getLineStyle(["color"]),g=0;g<h.length;++g)t.add(Cr(h[g],{style:Te({stroke:s[g%s.length]},x),silent:!0}))}},splitArea:function(e,t,r,n){AT(e,r,n,n)}};const YL=jL;var A_=function(e){U(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.getCoordSysModel=function(){return this},t.type="singleAxis",t.layoutMode="box",t.defaultOption={left:"5%",top:"5%",right:"5%",bottom:"5%",type:"value",position:"bottom",orient:"horizontal",axisLine:{show:!0,lineStyle:{width:1,type:"solid"}},tooltip:{show:!0},axisTick:{show:!0,length:6,lineStyle:{width:1}},axisLabel:{show:!0,interval:"auto"},splitLine:{show:!0,lineStyle:{type:"dashed",opacity:.2}}},t}(Ot);Xr(A_,Mo.prototype);const Qu=A_;var qL=function(e){U(t,e);function t(r,n,a,i,o){var s=e.call(this,r,n,a)||this;return s.type=i||"value",s.position=o||"bottom",s}return t.prototype.isHorizontal=function(){var r=this.position;return r==="top"||r==="bottom"},t.prototype.pointToData=function(r,n){return this.coordinateSystem.pointToData(r)[0]},t}(or);const KL=qL;var E_=["single"],JL=function(){function e(t,r,n){this.type="single",this.dimension="single",this.dimensions=E_,this.axisPointerEnabled=!0,this.model=t,this._init(t,r,n)}return e.prototype._init=function(t,r,n){var a=this.dimension,i=new KL(a,Tl(t),[0,0],t.get("type"),t.get("position")),o=i.type==="category";i.onBand=o&&t.get("boundaryGap"),i.inverse=t.get("inverse"),i.orient=t.get("orient"),t.axis=i,i.model=t,i.coordinateSystem=this,this._axis=i},e.prototype.update=function(t,r){t.eachSeries(function(n){if(n.coordinateSystem===this){var a=n.getData();R(a.mapDimensionsAll(this.dimension),function(i){this._axis.scale.unionExtentFromData(a,i)},this),ao(this._axis.scale,this._axis.model)}},this)},e.prototype.resize=function(t,r){this._rect=sr({left:t.get("left"),top:t.get("top"),right:t.get("right"),bottom:t.get("bottom"),width:t.get("width"),height:t.get("height")},{width:r.getWidth(),height:r.getHeight()}),this._adjustAxis()},e.prototype.getRect=function(){return this._rect},e.prototype._adjustAxis=function(){var t=this._rect,r=this._axis,n=r.isHorizontal(),a=n?[0,t.width]:[0,t.height],i=r.inverse?1:0;r.setExtent(a[i],a[1-i]),this._updateAxisTransform(r,n?t.x:t.y)},e.prototype._updateAxisTransform=function(t,r){var n=t.getExtent(),a=n[0]+n[1],i=t.isHorizontal();t.toGlobalCoord=i?function(o){return o+r}:function(o){return a-o+r},t.toLocalCoord=i?function(o){return o-r}:function(o){return a-o+r}},e.prototype.getAxis=function(){return this._axis},e.prototype.getBaseAxis=function(){return this._axis},e.prototype.getAxes=function(){return[this._axis]},e.prototype.getTooltipAxes=function(){return{baseAxes:[this.getAxis()],otherAxes:[]}},e.prototype.containPoint=function(t){var r=this.getRect(),n=this.getAxis(),a=n.orient;return a==="horizontal"?n.contain(n.toLocalCoord(t[0]))&&t[1]>=r.y&&t[1]<=r.y+r.height:n.contain(n.toLocalCoord(t[1]))&&t[0]>=r.y&&t[0]<=r.y+r.height},e.prototype.pointToData=function(t){var r=this.getAxis();return[r.coordToData(r.toLocalCoord(t[r.orient==="horizontal"?0:1]))]},e.prototype.dataToPoint=function(t){var r=this.getAxis(),n=this.getRect(),a=[],i=r.orient==="horizontal"?0:1;return t instanceof Array&&(t=t[0]),a[i]=r.toGlobalCoord(r.dataToCoord(+t)),a[1-i]=i===0?n.y+n.height/2:n.x+n.width/2,a},e.prototype.convertToPixel=function(t,r,n){var a=Hp(r);return a===this?this.dataToPoint(n):null},e.prototype.convertFromPixel=function(t,r,n){var a=Hp(r);return a===this?this.pointToData(n):null},e}();function Hp(e){var t=e.seriesModel,r=e.singleAxisModel;return r&&r.coordinateSystem||t&&t.coordinateSystem}function QL(e,t){var r=[];return e.eachComponent("singleAxis",function(n,a){var i=new JL(n,e,t);i.name="single_"+a,i.resize(n,t),n.coordinateSystem=i,r.push(i)}),e.eachSeries(function(n){if(n.get("coordinateSystem")==="singleAxis"){var a=n.getReferringComponents("singleAxis",sn).models[0];n.coordinateSystem=a&&a.coordinateSystem}}),r}var eD={create:QL,dimensions:E_};const tD=eD;var Wp=["x","y"],rD=["width","height"],nD=function(e){U(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.makeElOption=function(r,n,a,i,o){var s=a.axis,l=s.coordinateSystem,u=ec(l,1-Js(s)),c=l.dataToPoint(n)[0],h=i.get("type");if(h&&h!=="none"){var f=wm(i),d=aD[h](s,c,u);d.style=f,r.graphicKey=d.type,r.pointer=d}var v=Sh(a);ET(n,r,v,a,i,o)},t.prototype.getHandleTransform=function(r,n,a){var i=Sh(n,{labelInside:!1});i.labelMargin=a.get(["handle","margin"]);var o=CT(n.axis,r,i);return{x:o[0],y:o[1],rotation:i.rotation+(i.labelDirection<0?Math.PI:0)}},t.prototype.updateHandleTransform=function(r,n,a,i){var o=a.axis,s=o.coordinateSystem,l=Js(o),u=ec(s,l),c=[r.x,r.y];c[l]+=n[l],c[l]=Math.min(u[1],c[l]),c[l]=Math.max(u[0],c[l]);var h=ec(s,1-l),f=(h[1]+h[0])/2,d=[f,f];return d[l]=c[l],{x:c[0],y:c[1],rotation:r.rotation,cursorPoint:d,tooltipOption:{verticalAlign:"middle"}}},t}(Am),aD={line:function(e,t,r){var n=Em([t,r[0]],[t,r[1]],Js(e));return{type:"Line",subPixelOptimize:!0,shape:n}},shadow:function(e,t,r){var n=e.getBandWidth(),a=r[1]-r[0];return{type:"Rect",shape:LT([t-n/2,r[0]],[n,a],Js(e))}}};function Js(e){return e.isHorizontal()?0:1}function ec(e,t){var r=e.getRect();return[r[Wp[t]],r[Wp[t]]+r[rD[t]]]}const iD=nD;var oD=function(e){U(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.type="single",t}(kt);function sD(e){oe(hf),Bo.registerAxisPointerClass("SingleAxisPointer",iD),e.registerComponentView(oD),e.registerComponentView(YL),e.registerComponentModel(Qu),Us(e,"single",Qu,Qu.defaultOption),e.registerCoordinateSystem("single",tD)}var lD=function(e){U(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.init=function(r,n,a){var i=Lm(r);e.prototype.init.apply(this,arguments),$p(r,i)},t.prototype.mergeOption=function(r){e.prototype.mergeOption.apply(this,arguments),$p(this.option,r)},t.prototype.getCellSize=function(){return this.option.cellSize},t.type="calendar",t.defaultOption={z:2,left:80,top:60,cellSize:20,orient:"horizontal",splitLine:{show:!0,lineStyle:{color:"#000",width:1,type:"solid"}},itemStyle:{color:"#fff",borderWidth:1,borderColor:"#ccc"},dayLabel:{show:!0,firstDay:0,position:"start",margin:"50%",color:"#000"},monthLabel:{show:!0,position:"start",margin:5,align:"center",formatter:null,color:"#000"},yearLabel:{show:!0,position:null,margin:30,formatter:null,color:"#ccc",fontFamily:"sans-serif",fontWeight:"bolder",fontSize:20}},t}(Ot);function $p(e,t){var r=e.cellSize,n;te(r)?n=r:n=e.cellSize=[r,r],n.length===1&&(n[1]=n[0]);var a=K([0,1],function(i){return DT(t,i)&&(n[i]="auto"),n[i]!=null&&n[i]!=="auto"});Dm(e,t,{type:"box",ignoreSize:a})}const uD=lD;var cD=function(e){U(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.render=function(r,n,a){var i=this.group;i.removeAll();var o=r.coordinateSystem,s=o.getRangeInfo(),l=o.getOrient(),u=n.getLocaleModel();this._renderDayRect(r,s,i),this._renderLines(r,s,l,i),this._renderYearText(r,s,l,i),this._renderMonthText(r,u,l,i),this._renderWeekText(r,u,s,l,i)},t.prototype._renderDayRect=function(r,n,a){for(var i=r.coordinateSystem,o=r.getModel("itemStyle").getItemStyle(),s=i.getCellWidth(),l=i.getCellHeight(),u=n.start.time;u<=n.end.time;u=i.getNextNDay(u,1).time){var c=i.dataToRect([u],!1).tl,h=new Et({shape:{x:c[0],y:c[1],width:s,height:l},cursor:"default",style:o});a.add(h)}},t.prototype._renderLines=function(r,n,a,i){var o=this,s=r.coordinateSystem,l=r.getModel(["splitLine","lineStyle"]).getLineStyle(),u=r.get(["splitLine","show"]),c=l.lineWidth;this._tlpoints=[],this._blpoints=[],this._firstDayOfMonth=[],this._firstDayPoints=[];for(var h=n.start,f=0;h.time<=n.end.time;f++){v(h.formatedDate),f===0&&(h=s.getDateInfo(n.start.y+"-"+n.start.m));var d=h.date;d.setMonth(d.getMonth()+1),h=s.getDateInfo(d)}v(s.getNextNDay(n.end.time,1).formatedDate);function v(p){o._firstDayOfMonth.push(s.getDateInfo(p)),o._firstDayPoints.push(s.dataToRect([p],!1).tl);var g=o._getLinePointsOfOneWeek(r,p,a);o._tlpoints.push(g[0]),o._blpoints.push(g[g.length-1]),u&&o._drawSplitline(g,l,i)}u&&this._drawSplitline(o._getEdgesPoints(o._tlpoints,c,a),l,i),u&&this._drawSplitline(o._getEdgesPoints(o._blpoints,c,a),l,i)},t.prototype._getEdgesPoints=function(r,n,a){var i=[r[0].slice(),r[r.length-1].slice()],o=a==="horizontal"?0:1;return i[0][o]=i[0][o]-n/2,i[1][o]=i[1][o]+n/2,i},t.prototype._drawSplitline=function(r,n,a){var i=new Nn({z2:20,shape:{points:r},style:n});a.add(i)},t.prototype._getLinePointsOfOneWeek=function(r,n,a){for(var i=r.coordinateSystem,o=i.getDateInfo(n),s=[],l=0;l<7;l++){var u=i.getNextNDay(o.time,l),c=i.dataToRect([u.time],!1);s[2*u.day]=c.tl,s[2*u.day+1]=c[a==="horizontal"?"bl":"tr"]}return s},t.prototype._formatterLabel=function(r,n){return Ve(r)&&r?MT(r,n):xt(r)?r(n):n.nameMap},t.prototype._yearTextPositionControl=function(r,n,a,i,o){var s=n[0],l=n[1],u=["center","bottom"];i==="bottom"?(l+=o,u=["center","top"]):i==="left"?s-=o:i==="right"?(s+=o,u=["center","top"]):l-=o;var c=0;return(i==="left"||i==="right")&&(c=Math.PI/2),{rotation:c,x:s,y:l,style:{align:u[0],verticalAlign:u[1]}}},t.prototype._renderYearText=function(r,n,a,i){var o=r.getModel("yearLabel");if(o.get("show")){var s=o.get("margin"),l=o.get("position");l||(l=a!=="horizontal"?"top":"left");var u=[this._tlpoints[this._tlpoints.length-1],this._blpoints[0]],c=(u[0][0]+u[1][0])/2,h=(u[0][1]+u[1][1])/2,f=a==="horizontal"?0:1,d={top:[c,u[f][1]],bottom:[c,u[1-f][1]],left:[u[1-f][0],h],right:[u[f][0],h]},v=n.start.y;+n.end.y>+n.start.y&&(v=v+"-"+n.end.y);var p=o.get("formatter"),g={start:n.start.y,end:n.end.y,nameMap:v},m=this._formatterLabel(p,g),_=new rt({z2:30,style:ft(o,{text:m})});_.attr(this._yearTextPositionControl(_,d[l],a,l,s)),i.add(_)}},t.prototype._monthTextPositionControl=function(r,n,a,i,o){var s="left",l="top",u=r[0],c=r[1];return a==="horizontal"?(c=c+o,n&&(s="center"),i==="start"&&(l="bottom")):(u=u+o,n&&(l="middle"),i==="start"&&(s="right")),{x:u,y:c,align:s,verticalAlign:l}},t.prototype._renderMonthText=function(r,n,a,i){var o=r.getModel("monthLabel");if(o.get("show")){var s=o.get("nameMap"),l=o.get("margin"),u=o.get("position"),c=o.get("align"),h=[this._tlpoints,this._blpoints];(!s||Ve(s))&&(s&&(n=sv(s)||n),s=n.get(["time","monthAbbr"])||[]);var f=u==="start"?0:1,d=a==="horizontal"?0:1;l=u==="start"?-l:l;for(var v=c==="center",p=0;p<h[f].length-1;p++){var g=h[f][p].slice(),m=this._firstDayOfMonth[p];if(v){var _=this._firstDayPoints[p];g[d]=(_[d]+h[0][p+1][d])/2}var y=o.get("formatter"),x=s[+m.m-1],S={yyyy:m.y,yy:(m.y+"").slice(2),MM:m.m,M:+m.m,nameMap:x},T=this._formatterLabel(y,S),b=new rt({z2:30,style:le(ft(o,{text:T}),this._monthTextPositionControl(g,v,a,u,l))});i.add(b)}}},t.prototype._weekTextPositionControl=function(r,n,a,i,o){var s="center",l="middle",u=r[0],c=r[1],h=a==="start";return n==="horizontal"?(u=u+i+(h?1:-1)*o[0]/2,s=h?"right":"left"):(c=c+i+(h?1:-1)*o[1]/2,l=h?"bottom":"top"),{x:u,y:c,align:s,verticalAlign:l}},t.prototype._renderWeekText=function(r,n,a,i,o){var s=r.getModel("dayLabel");if(s.get("show")){var l=r.coordinateSystem,u=s.get("position"),c=s.get("nameMap"),h=s.get("margin"),f=l.getFirstDayOfWeek();if(!c||Ve(c)){c&&(n=sv(c)||n);var d=n.get(["time","dayOfWeekShort"]);c=d||K(n.get(["time","dayOfWeekAbbr"]),function(S){return S[0]})}var v=l.getNextNDay(a.end.time,7-a.lweek).time,p=[l.getCellWidth(),l.getCellHeight()];h=ee(h,Math.min(p[1],p[0])),u==="start"&&(v=l.getNextNDay(a.start.time,-(7+a.fweek)).time,h=-h);for(var g=0;g<7;g++){var m=l.getNextNDay(v,g),_=l.dataToRect([m.time],!1).center,y=g;y=Math.abs((g+f)%7);var x=new rt({z2:30,style:le(ft(s,{text:c[y]}),this._weekTextPositionControl(_,i,u,h,p))});o.add(x)}}},t.type="calendar",t}(kt);const hD=cD;var tc=864e5,fD=function(){function e(t,r,n){this.type="calendar",this.dimensions=e.dimensions,this.getDimensionsInfo=e.getDimensionsInfo,this._model=t}return e.getDimensionsInfo=function(){return[{name:"time",type:"time"},"value"]},e.prototype.getRangeInfo=function(){return this._rangeInfo},e.prototype.getModel=function(){return this._model},e.prototype.getRect=function(){return this._rect},e.prototype.getCellWidth=function(){return this._sw},e.prototype.getCellHeight=function(){return this._sh},e.prototype.getOrient=function(){return this._orient},e.prototype.getFirstDayOfWeek=function(){return this._firstDayOfWeek},e.prototype.getDateInfo=function(t){t=Mm(t);var r=t.getFullYear(),n=t.getMonth()+1,a=n<10?"0"+n:""+n,i=t.getDate(),o=i<10?"0"+i:""+i,s=t.getDay();return s=Math.abs((s+7-this.getFirstDayOfWeek())%7),{y:r+"",m:a,d:o,day:s,time:t.getTime(),formatedDate:r+"-"+a+"-"+o,date:t}},e.prototype.getNextNDay=function(t,r){return r=r||0,r===0?this.getDateInfo(t):(t=new Date(this.getDateInfo(t).time),t.setDate(t.getDate()+r),this.getDateInfo(t))},e.prototype.update=function(t,r){this._firstDayOfWeek=+this._model.getModel("dayLabel").get("firstDay"),this._orient=this._model.get("orient"),this._lineWidth=this._model.getModel("itemStyle").getItemStyle().lineWidth||0,this._rangeInfo=this._getRangeInfo(this._initRangeOption());var n=this._rangeInfo.weeks||1,a=["width","height"],i=this._model.getCellSize().slice(),o=this._model.getBoxLayoutParams(),s=this._orient==="horizontal"?[n,7]:[7,n];R([0,1],function(h){c(i,h)&&(o[a[h]]=i[h]*s[h])});var l={width:r.getWidth(),height:r.getHeight()},u=this._rect=sr(o,l);R([0,1],function(h){c(i,h)||(i[h]=u[a[h]]/s[h])});function c(h,f){return h[f]!=null&&h[f]!=="auto"}this._sw=i[0],this._sh=i[1]},e.prototype.dataToPoint=function(t,r){te(t)&&(t=t[0]),r==null&&(r=!0);var n=this.getDateInfo(t),a=this._rangeInfo,i=n.formatedDate;if(r&&!(n.time>=a.start.time&&n.time<a.end.time+tc))return[NaN,NaN];var o=n.day,s=this._getRangeInfo([a.start.time,i]).nthWeek;return this._orient==="vertical"?[this._rect.x+o*this._sw+this._sw/2,this._rect.y+s*this._sh+this._sh/2]:[this._rect.x+s*this._sw+this._sw/2,this._rect.y+o*this._sh+this._sh/2]},e.prototype.pointToData=function(t){var r=this.pointToDate(t);return r&&r.time},e.prototype.dataToRect=function(t,r){var n=this.dataToPoint(t,r);return{contentShape:{x:n[0]-(this._sw-this._lineWidth)/2,y:n[1]-(this._sh-this._lineWidth)/2,width:this._sw-this._lineWidth,height:this._sh-this._lineWidth},center:n,tl:[n[0]-this._sw/2,n[1]-this._sh/2],tr:[n[0]+this._sw/2,n[1]-this._sh/2],br:[n[0]+this._sw/2,n[1]+this._sh/2],bl:[n[0]-this._sw/2,n[1]+this._sh/2]}},e.prototype.pointToDate=function(t){var r=Math.floor((t[0]-this._rect.x)/this._sw)+1,n=Math.floor((t[1]-this._rect.y)/this._sh)+1,a=this._rangeInfo.range;return this._orient==="vertical"?this._getDateByWeeksAndDay(n,r-1,a):this._getDateByWeeksAndDay(r,n-1,a)},e.prototype.convertToPixel=function(t,r,n){var a=Xp(r);return a===this?a.dataToPoint(n):null},e.prototype.convertFromPixel=function(t,r,n){var a=Xp(r);return a===this?a.pointToData(n):null},e.prototype.containPoint=function(t){return console.warn("Not implemented."),!1},e.prototype._initRangeOption=function(){var t=this._model.get("range"),r;if(te(t)&&t.length===1&&(t=t[0]),te(t))r=t;else{var n=t.toString();if(/^\d{4}$/.test(n)&&(r=[n+"-01-01",n+"-12-31"]),/^\d{4}[\/|-]\d{1,2}$/.test(n)){var a=this.getDateInfo(n),i=a.date;i.setMonth(i.getMonth()+1);var o=this.getNextNDay(i,-1);r=[a.formatedDate,o.formatedDate]}/^\d{4}[\/|-]\d{1,2}[\/|-]\d{1,2}$/.test(n)&&(r=[n,n])}if(!r)return t;var s=this._getRangeInfo(r);return s.start.time>s.end.time&&r.reverse(),r},e.prototype._getRangeInfo=function(t){var r=[this.getDateInfo(t[0]),this.getDateInfo(t[1])],n;r[0].time>r[1].time&&(n=!0,r.reverse());var a=Math.floor(r[1].time/tc)-Math.floor(r[0].time/tc)+1,i=new Date(r[0].time),o=i.getDate(),s=r[1].date.getDate();i.setDate(o+a-1);var l=i.getDate();if(l!==s)for(var u=i.getTime()-r[1].time>0?1:-1;(l=i.getDate())!==s&&(i.getTime()-r[1].time)*u>0;)a-=u,i.setDate(l-u);var c=Math.floor((a+r[0].day+6)/7),h=n?-c+1:c-1;return n&&r.reverse(),{range:[r[0].formatedDate,r[1].formatedDate],start:r[0],end:r[1],allDay:a,weeks:c,nthWeek:h,fweek:r[0].day,lweek:r[1].day}},e.prototype._getDateByWeeksAndDay=function(t,r,n){var a=this._getRangeInfo(n);if(t>a.weeks||t===0&&r<a.fweek||t===a.weeks&&r>a.lweek)return null;var i=(t-1)*7-a.fweek+r,o=new Date(a.start.time);return o.setDate(+a.start.d+i),this.getDateInfo(o)},e.create=function(t,r){var n=[];return t.eachComponent("calendar",function(a){var i=new e(a);n.push(i),a.coordinateSystem=i}),t.eachSeries(function(a){a.get("coordinateSystem")==="calendar"&&(a.coordinateSystem=n[a.get("calendarIndex")||0])}),n},e.dimensions=["time","value"],e}();function Xp(e){var t=e.calendarModel,r=e.seriesModel,n=t?t.coordinateSystem:r?r.coordinateSystem:null;return n}const dD=fD;function vD(e){e.registerComponentModel(uD),e.registerComponentView(hD),e.registerCoordinateSystem("calendar",dD)}function pD(e,t){var r=e.existing;if(t.id=e.keyInfo.id,!t.type&&r&&(t.type=r.type),t.parentId==null){var n=t.parentOption;n?t.parentId=n.id:r&&(t.parentId=r.parentId)}t.parentOption=null}function jp(e,t){var r;return R(t,function(n){e[n]!=null&&e[n]!=="auto"&&(r=!0)}),r}function gD(e,t,r){var n=le({},r),a=e[t],i=r.$action||"merge";i==="merge"?a?(fe(a,n,!0),Dm(a,n,{ignoreSize:!0}),IT(r,a),os(r,a),os(r,a,"shape"),os(r,a,"style"),os(r,a,"extra"),r.clipPath=a.clipPath):e[t]=n:i==="replace"?e[t]=n:i==="remove"&&a&&(e[t]=null)}var C_=["transition","enterFrom","leaveTo"],mD=C_.concat(["enterAnimation","updateAnimation","leaveAnimation"]);function os(e,t,r){if(r&&(!e[r]&&t[r]&&(e[r]={}),e=e[r],t=t[r]),!(!e||!t))for(var n=r?C_:mD,a=0;a<n.length;a++){var i=n[a];e[i]==null&&t[i]!=null&&(e[i]=t[i])}}function yD(e,t){if(e&&(e.hv=t.hv=[jp(t,["left","right"]),jp(t,["top","bottom"])],e.type==="group")){var r=e,n=t;r.width==null&&(r.width=n.width=0),r.height==null&&(r.height=n.height=0)}}var _D=function(e){U(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r.preventAutoZ=!0,r}return t.prototype.mergeOption=function(r,n){var a=this.option.elements;this.option.elements=null,e.prototype.mergeOption.call(this,r,n),this.option.elements=a},t.prototype.optionUpdated=function(r,n){var a=this.option,i=(n?a:r).elements,o=a.elements=n?[]:a.elements,s=[];this._flatten(i,s,null);var l=PT(o,s,"normalMerge"),u=this._elOptionsToUpdate=[];R(l,function(c,h){var f=c.newOption;f&&(u.push(f),pD(c,f),gD(o,h,f),yD(o[h],f))},this),a.elements=Vt(o,function(c){return c&&delete c.$action,c!=null})},t.prototype._flatten=function(r,n,a){R(r,function(i){if(i){a&&(i.parentOption=a),n.push(i);var o=i.children;o&&o.length&&this._flatten(o,n,i),delete i.children}},this)},t.prototype.useElOptionsToUpdate=function(){var r=this._elOptionsToUpdate;return this._elOptionsToUpdate=null,r},t.type="graphic",t.defaultOption={elements:[]},t}(Ot),Zp={path:null,compoundPath:null,group:Fe,image:un,text:rt},gr=Nt(),xD=function(e){U(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.init=function(){this._elMap=ot()},t.prototype.render=function(r,n,a){r!==this._lastGraphicModel&&this._clear(),this._lastGraphicModel=r,this._updateElements(r),this._relocate(r,a)},t.prototype._updateElements=function(r){var n=r.useElOptionsToUpdate();if(n){var a=this._elMap,i=this.group,o=r.get("z"),s=r.get("zlevel");R(n,function(l){var u=Qr(l.id,null),c=u!=null?a.get(u):null,h=Qr(l.parentId,null),f=h!=null?a.get(h):i,d=l.type,v=l.style;d==="text"&&v&&l.hv&&l.hv[1]&&(v.textVerticalAlign=v.textBaseline=v.verticalAlign=v.align=null);var p=l.textContent,g=l.textConfig;if(v&&d_(v,d,!!g,!!p)){var m=v_(v,d,!0);!g&&m.textConfig&&(g=l.textConfig=m.textConfig),!p&&m.textContent&&(p=m.textContent)}var _=SD(l),y=l.$action||"merge",x=y==="merge",S=y==="replace";if(x){var T=!c,b=c;T?b=Yp(u,f,l.type,a):(b&&(gr(b).isNew=!1),y_(b)),b&&(ws(b,_,r,{isInit:T}),qp(b,l,o,s))}else if(S){As(c,l,a,r);var w=Yp(u,f,l.type,a);w&&(ws(w,_,r,{isInit:!0}),qp(w,l,o,s))}else y==="remove"&&(g_(c,l),As(c,l,a,r));var A=a.get(u);if(A&&p)if(x){var E=A.getTextContent();E?E.attr(p):A.setTextContent(new rt(p))}else S&&A.setTextContent(new rt(p));if(A){var C=l.clipPath;if(C){var M=C.type,P=void 0,T=!1;if(x){var L=A.getClipPath();T=!L||gr(L).type!==M,P=T?Th(M):L}else S&&(T=!0,P=Th(M));A.setClipPath(P),ws(P,C,r,{isInit:T}),qs(P,C.keyframeAnimation,r)}var I=gr(A);A.setTextConfig(g),I.option=l,TD(A,r,l),Pm({el:A,componentModel:r,itemName:A.name,itemTooltipOption:l.tooltip}),qs(A,l.keyframeAnimation,r)}})}},t.prototype._relocate=function(r,n){for(var a=r.option.elements,i=this.group,o=this._elMap,s=n.getWidth(),l=n.getHeight(),u=["x","y"],c=0;c<a.length;c++){var h=a[c],f=Qr(h.id,null),d=f!=null?o.get(f):null;if(!(!d||!d.isGroup)){var v=d.parent,p=v===i,g=gr(d),m=gr(v);g.width=ee(g.option.width,p?s:m.width)||0,g.height=ee(g.option.height,p?l:m.height)||0}}for(var c=a.length-1;c>=0;c--){var h=a[c],f=Qr(h.id,null),d=f!=null?o.get(f):null;if(d){var v=d.parent,m=gr(v),_=v===i?{width:s,height:l}:{width:m.width,height:m.height},y={},x=lm(d,h,_,null,{hv:h.hv,boundingMode:h.bounding},y);if(!gr(d).isNew&&x){for(var S=h.transition,T={},b=0;b<u.length;b++){var w=u[b],A=y[w];S&&(ua(S)||pt(S,w)>=0)?T[w]=A:d[w]=A}st(d,T,r,0)}else d.attr(y)}}},t.prototype._clear=function(){var r=this,n=this._elMap;n.each(function(a){As(a,gr(a).option,n,r._lastGraphicModel)}),this._elMap=ot()},t.prototype.dispose=function(){this._clear()},t.type="graphic",t}(kt);function Th(e){var t=Z(Zp,e)?Zp[e]:bm(e),r=new t({});return gr(r).type=e,r}function Yp(e,t,r,n){var a=Th(r);return t.add(a),n.set(e,a),gr(a).id=e,gr(a).isNew=!0,a}function As(e,t,r,n){var a=e&&e.parent;a&&(e.type==="group"&&e.traverse(function(i){As(i,t,r,n)}),Wl(e,t,n),r.removeKey(gr(e).id))}function qp(e,t,r,n){e.isGroup||R([["cursor",Io.prototype.cursor],["zlevel",n||0],["z",r||0],["z2",0]],function(a){var i=a[0];Z(t,i)?e[i]=jt(t[i],a[1]):e[i]==null&&(e[i]=a[1])}),R(It(t),function(a){if(a.indexOf("on")===0){var i=t[a];e[a]=xt(i)?i:null}}),Z(t,"draggable")&&(e.draggable=t.draggable),t.name!=null&&(e.name=t.name),t.id!=null&&(e.id=t.id)}function SD(e){return e=le({},e),R(["id","parentId","$action","hv","bounding","textContent","clipPath"].concat(RT),function(t){delete e[t]}),e}function TD(e,t,r){var n=et(e).eventData;!e.silent&&!e.ignore&&!n&&(n=et(e).eventData={componentType:"graphic",componentIndex:t.componentIndex,name:e.name}),n&&(n.info=r.info)}function bD(e){e.registerComponentModel(_D),e.registerComponentView(xD),e.registerPreprocessor(function(t){var r=t.graphic;te(r)?!r[0]||!r[0].elements?t.graphic=[{elements:r}]:t.graphic=[t.graphic[0]]:r&&!r.elements&&(t.graphic=[{elements:[r]}])})}var Kp=["x","y","radius","angle","single"],wD=["cartesian2d","polar","singleAxis"];function AD(e){var t=e.get("coordinateSystem");return pt(wD,t)>=0}function bn(e){return e+"Axis"}function ED(e,t){var r=ot(),n=[],a=ot();e.eachComponent({mainType:"dataZoom",query:t},function(c){a.get(c.uid)||s(c)});var i;do i=!1,e.eachComponent("dataZoom",o);while(i);function o(c){!a.get(c.uid)&&l(c)&&(s(c),i=!0)}function s(c){a.set(c.uid,!0),n.push(c),u(c)}function l(c){var h=!1;return c.eachTargetAxis(function(f,d){var v=r.get(f);v&&v[d]&&(h=!0)}),h}function u(c){c.eachTargetAxis(function(h,f){(r.get(h)||r.set(h,[]))[f]=!0})}return n}function L_(e){var t=e.ecModel,r={infoList:[],infoMap:ot()};return e.eachTargetAxis(function(n,a){var i=t.getComponent(bn(n),a);if(i){var o=i.getCoordSysModel();if(o){var s=o.uid,l=r.infoMap.get(s);l||(l={model:o,axisModels:[]},r.infoList.push(l),r.infoMap.set(s,l)),l.axisModels.push(i)}}}),r}var rc=function(){function e(){this.indexList=[],this.indexMap=[]}return e.prototype.add=function(t){this.indexMap[t]||(this.indexList.push(t),this.indexMap[t]=!0)},e}(),CD=function(e){U(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r._autoThrottle=!0,r._noTarget=!0,r._rangePropMode=["percent","percent"],r}return t.prototype.init=function(r,n,a){var i=Jp(r);this.settledOption=i,this.mergeDefaultAndTheme(r,a),this._doInit(i)},t.prototype.mergeOption=function(r){var n=Jp(r);fe(this.option,r,!0),fe(this.settledOption,n,!0),this._doInit(n)},t.prototype._doInit=function(r){var n=this.option;this._setDefaultThrottle(r),this._updateRangeUse(r);var a=this.settledOption;R([["start","startValue"],["end","endValue"]],function(i,o){this._rangePropMode[o]==="value"&&(n[i[0]]=a[i[0]]=null)},this),this._resetTarget()},t.prototype._resetTarget=function(){var r=this.get("orient",!0),n=this._targetAxisInfoMap=ot(),a=this._fillSpecifiedTargetAxis(n);a?this._orient=r||this._makeAutoOrientByTargetAxis():(this._orient=r||"horizontal",this._fillAutoTargetAxisByOrient(n,this._orient)),this._noTarget=!0,n.each(function(i){i.indexList.length&&(this._noTarget=!1)},this)},t.prototype._fillSpecifiedTargetAxis=function(r){var n=!1;return R(Kp,function(a){var i=this.getReferringComponents(bn(a),NT);if(i.specified){n=!0;var o=new rc;R(i.models,function(s){o.add(s.componentIndex)}),r.set(a,o)}},this),n},t.prototype._fillAutoTargetAxisByOrient=function(r,n){var a=this.ecModel,i=!0;if(i){var o=n==="vertical"?"y":"x",s=a.findComponents({mainType:o+"Axis"});l(s,o)}if(i){var s=a.findComponents({mainType:"singleAxis",filter:function(c){return c.get("orient",!0)===n}});l(s,"single")}function l(u,c){var h=u[0];if(h){var f=new rc;if(f.add(h.componentIndex),r.set(c,f),i=!1,c==="x"||c==="y"){var d=h.getReferringComponents("grid",sn).models[0];d&&R(u,function(v){h.componentIndex!==v.componentIndex&&d===v.getReferringComponents("grid",sn).models[0]&&f.add(v.componentIndex)})}}}i&&R(Kp,function(u){if(i){var c=a.findComponents({mainType:bn(u),filter:function(f){return f.get("type",!0)==="category"}});if(c[0]){var h=new rc;h.add(c[0].componentIndex),r.set(u,h),i=!1}}},this)},t.prototype._makeAutoOrientByTargetAxis=function(){var r;return this.eachTargetAxis(function(n){!r&&(r=n)},this),r==="y"?"vertical":"horizontal"},t.prototype._setDefaultThrottle=function(r){if(r.hasOwnProperty("throttle")&&(this._autoThrottle=!1),this._autoThrottle){var n=this.ecModel.option;this.option.throttle=n.animation&&n.animationDurationUpdate>0?100:20}},t.prototype._updateRangeUse=function(r){var n=this._rangePropMode,a=this.get("rangeMode");R([["start","startValue"],["end","endValue"]],function(i,o){var s=r[i[0]]!=null,l=r[i[1]]!=null;s&&!l?n[o]="percent":!s&&l?n[o]="value":a?n[o]=a[o]:s&&(n[o]="percent")})},t.prototype.noTarget=function(){return this._noTarget},t.prototype.getFirstTargetAxisModel=function(){var r;return this.eachTargetAxis(function(n,a){r==null&&(r=this.ecModel.getComponent(bn(n),a))},this),r},t.prototype.eachTargetAxis=function(r,n){this._targetAxisInfoMap.each(function(a,i){R(a.indexList,function(o){r.call(n,i,o)})})},t.prototype.getAxisProxy=function(r,n){var a=this.getAxisModel(r,n);if(a)return a.__dzAxisProxy},t.prototype.getAxisModel=function(r,n){var a=this._targetAxisInfoMap.get(r);if(a&&a.indexMap[n])return this.ecModel.getComponent(bn(r),n)},t.prototype.setRawRange=function(r){var n=this.option,a=this.settledOption;R([["start","startValue"],["end","endValue"]],function(i){(r[i[0]]!=null||r[i[1]]!=null)&&(n[i[0]]=a[i[0]]=r[i[0]],n[i[1]]=a[i[1]]=r[i[1]])},this),this._updateRangeUse(r)},t.prototype.setCalculatedRange=function(r){var n=this.option;R(["start","startValue","end","endValue"],function(a){n[a]=r[a]})},t.prototype.getPercentRange=function(){var r=this.findRepresentativeAxisProxy();if(r)return r.getDataPercentWindow()},t.prototype.getValueRange=function(r,n){if(r==null&&n==null){var a=this.findRepresentativeAxisProxy();if(a)return a.getDataValueWindow()}else return this.getAxisProxy(r,n).getDataValueWindow()},t.prototype.findRepresentativeAxisProxy=function(r){if(r)return r.__dzAxisProxy;for(var n,a=this._targetAxisInfoMap.keys(),i=0;i<a.length;i++)for(var o=a[i],s=this._targetAxisInfoMap.get(o),l=0;l<s.indexList.length;l++){var u=this.getAxisProxy(o,s.indexList[l]);if(u.hostedBy(this))return u;n||(n=u)}return n},t.prototype.getRangePropMode=function(){return this._rangePropMode.slice()},t.prototype.getOrient=function(){return this._orient},t.type="dataZoom",t.dependencies=["xAxis","yAxis","radiusAxis","angleAxis","singleAxis","series","toolbox"],t.defaultOption={z:4,filterMode:"filter",start:0,end:100},t}(Ot);function Jp(e){var t={};return R(["start","end","startValue","endValue","throttle"],function(r){e.hasOwnProperty(r)&&(t[r]=e[r])}),t}const mo=CD;var LD=function(e){U(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.type="dataZoom.select",t}(mo);const DD=LD;var MD=function(e){U(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.render=function(r,n,a,i){this.dataZoomModel=r,this.ecModel=n,this.api=a},t.type="dataZoom",t}(kt);const qf=MD;var PD=function(e){U(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.type="dataZoom.select",t}(qf);const ID=PD;var Ga=R,Qp=Vr,RD=function(){function e(t,r,n,a){this._dimName=t,this._axisIndex=r,this.ecModel=a,this._dataZoomModel=n}return e.prototype.hostedBy=function(t){return this._dataZoomModel===t},e.prototype.getDataValueWindow=function(){return this._valueWindow.slice()},e.prototype.getDataPercentWindow=function(){return this._percentWindow.slice()},e.prototype.getTargetSeriesModels=function(){var t=[];return this.ecModel.eachSeries(function(r){if(AD(r)){var n=bn(this._dimName),a=r.getReferringComponents(n,sn).models[0];a&&this._axisIndex===a.componentIndex&&t.push(r)}},this),t},e.prototype.getAxisModel=function(){return this.ecModel.getComponent(this._dimName+"Axis",this._axisIndex)},e.prototype.getMinMaxSpan=function(){return vt(this._minMaxSpan)},e.prototype.calculateDataWindow=function(t){var r=this._dataExtent,n=this.getAxisModel(),a=n.axis.scale,i=this._dataZoomModel.getRangePropMode(),o=[0,100],s=[],l=[],u;Ga(["start","end"],function(f,d){var v=t[f],p=t[f+"Value"];i[d]==="percent"?(v==null&&(v=o[d]),p=a.parse(Ye(v,o,r))):(u=!0,p=p==null?r[d]:a.parse(p),v=Ye(p,r,o)),l[d]=p==null||isNaN(p)?r[d]:p,s[d]=v==null||isNaN(v)?o[d]:v}),Qp(l),Qp(s);var c=this._minMaxSpan;u?h(l,s,r,o,!1):h(s,l,o,r,!0);function h(f,d,v,p,g){var m=g?"Span":"ValueSpan";ci(0,f,v,"all",c["min"+m],c["max"+m]);for(var _=0;_<2;_++)d[_]=Ye(f[_],v,p,!0),g&&(d[_]=a.parse(d[_]))}return{valueWindow:l,percentWindow:s}},e.prototype.reset=function(t){if(t===this._dataZoomModel){var r=this.getTargetSeriesModels();this._dataExtent=ND(this,this._dimName,r),this._updateMinMaxSpan();var n=this.calculateDataWindow(t.settledOption);this._valueWindow=n.valueWindow,this._percentWindow=n.percentWindow,this._setAxisModel()}},e.prototype.filterData=function(t,r){if(t!==this._dataZoomModel)return;var n=this._dimName,a=this.getTargetSeriesModels(),i=t.get("filterMode"),o=this._valueWindow;if(i==="none")return;Ga(a,function(l){var u=l.getData(),c=u.mapDimensionsAll(n);if(c.length){if(i==="weakFilter"){var h=u.getStore(),f=K(c,function(d){return u.getDimensionIndex(d)},u);u.filterSelf(function(d){for(var v,p,g,m=0;m<c.length;m++){var _=h.get(f[m],d),y=!isNaN(_),x=_<o[0],S=_>o[1];if(y&&!x&&!S)return!0;y&&(g=!0),x&&(v=!0),S&&(p=!0)}return g&&v&&p})}else Ga(c,function(d){if(i==="empty")l.setData(u=u.map(d,function(p){return s(p)?p:NaN}));else{var v={};v[d]=o,u.selectRange(v)}});Ga(c,function(d){u.setApproximateExtent(o,d)})}});function s(l){return l>=o[0]&&l<=o[1]}},e.prototype._updateMinMaxSpan=function(){var t=this._minMaxSpan={},r=this._dataZoomModel,n=this._dataExtent;Ga(["min","max"],function(a){var i=r.get(a+"Span"),o=r.get(a+"ValueSpan");o!=null&&(o=this.getAxisModel().axis.scale.parse(o)),o!=null?i=Ye(n[0]+o,n,[0,100],!0):i!=null&&(o=Ye(i,[0,100],n,!0)-n[0]),t[a+"Span"]=i,t[a+"ValueSpan"]=o},this)},e.prototype._setAxisModel=function(){var t=this.getAxisModel(),r=this._percentWindow,n=this._valueWindow;if(r){var a=OT(n,[0,500]);a=Math.min(a,20);var i=t.axis.scale.rawExtentInfo;r[0]!==0&&i.setDeterminedMinMax("min",+n[0].toFixed(a)),r[1]!==100&&i.setDeterminedMinMax("max",+n[1].toFixed(a)),i.freeze()}},e}();function ND(e,t,r){var n=[1/0,-1/0];Ga(r,function(o){BT(n,o.getData(),t)});var a=e.getAxisModel(),i=FT(a.axis.scale,a,n).calculate();return[i.min,i.max]}const OD=RD;var BD={getTargetSeries:function(e){function t(a){e.eachComponent("dataZoom",function(i){i.eachTargetAxis(function(o,s){var l=e.getComponent(bn(o),s);a(o,s,l,i)})})}t(function(a,i,o,s){o.__dzAxisProxy=null});var r=[];t(function(a,i,o,s){o.__dzAxisProxy||(o.__dzAxisProxy=new OD(a,i,s,e),r.push(o.__dzAxisProxy))});var n=ot();return R(r,function(a){R(a.getTargetSeriesModels(),function(i){n.set(i.uid,i)})}),n},overallReset:function(e,t){e.eachComponent("dataZoom",function(r){r.eachTargetAxis(function(n,a){r.getAxisProxy(n,a).reset(r)}),r.eachTargetAxis(function(n,a){r.getAxisProxy(n,a).filterData(r,t)})}),e.eachComponent("dataZoom",function(r){var n=r.findRepresentativeAxisProxy();if(n){var a=n.getDataPercentWindow(),i=n.getDataValueWindow();r.setCalculatedRange({start:a[0],end:a[1],startValue:i[0],endValue:i[1]})}})}};const FD=BD;function zD(e){e.registerAction("dataZoom",function(t,r){var n=ED(r,t);R(n,function(a){a.setRawRange({start:t.start,end:t.end,startValue:t.startValue,endValue:t.endValue})})})}var eg=!1;function Kf(e){eg||(eg=!0,e.registerProcessor(e.PRIORITY.PROCESSOR.FILTER,FD),zD(e),e.registerSubTypeDefaulter("dataZoom",function(){return"slider"}))}function GD(e){e.registerComponentModel(DD),e.registerComponentView(ID),Kf(e)}var mr=function(){function e(){}return e}(),D_={};function Va(e,t){D_[e]=t}function M_(e){return D_[e]}var VD=function(e){U(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.optionUpdated=function(){e.prototype.optionUpdated.apply(this,arguments);var r=this.ecModel;R(this.option.feature,function(n,a){var i=M_(a);i&&(i.getDefaultOption&&(i.defaultOption=i.getDefaultOption(r)),fe(n,i.defaultOption))})},t.type="toolbox",t.layoutMode={type:"box",ignoreSize:!0},t.defaultOption={show:!0,z:6,orient:"horizontal",left:"right",top:"top",backgroundColor:"transparent",borderColor:"#ccc",borderRadius:0,borderWidth:0,padding:5,itemSize:15,itemGap:8,showTitle:!0,iconStyle:{borderColor:"#666",color:"none"},emphasis:{iconStyle:{borderColor:"#3E98C5"}},tooltip:{show:!1,position:"bottom"}},t}(Ot);const UD=VD;var kD=function(e){U(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.render=function(r,n,a,i){var o=this.group;if(o.removeAll(),!r.get("show"))return;var s=+r.get("itemSize"),l=r.get("orient")==="vertical",u=r.get("feature")||{},c=this._features||(this._features={}),h=[];R(u,function(v,p){h.push(p)}),new Dn(this._featureNames||[],h).add(f).update(f).remove(Ge(f,null)).execute(),this._featureNames=h;function f(v,p){var g=h[v],m=h[p],_=u[g],y=new Ft(_,r,r.ecModel),x;if(i&&i.newTitle!=null&&i.featureName===g&&(_.title=i.newTitle),g&&!m){if(HD(g))x={onclick:y.option.onclick,featureName:g};else{var S=M_(g);if(!S)return;x=new S}c[g]=x}else if(x=c[m],!x)return;x.uid=zT("toolbox-feature"),x.model=y,x.ecModel=n,x.api=a;var T=x instanceof mr;if(!g&&m){T&&x.dispose&&x.dispose(n,a);return}if(!y.get("show")||T&&x.unusable){T&&x.remove&&x.remove(n,a);return}d(y,x,g),y.setIconStatus=function(b,w){var A=this.option,E=this.iconPaths;A.iconStatus=A.iconStatus||{},A.iconStatus[b]=w,E[b]&&(w==="emphasis"?Gs:Vs)(E[b])},x instanceof mr&&x.render&&x.render(y,n,a,i)}function d(v,p,g){var m=v.getModel("iconStyle"),_=v.getModel(["emphasis","iconStyle"]),y=p instanceof mr&&p.getIcons?p.getIcons():v.get("icon"),x=v.get("title")||{},S,T;Ve(y)?(S={},S[g]=y):S=y,Ve(x)?(T={},T[g]=x):T=x;var b=v.iconPaths={};R(S,function(w,A){var E=Im(w,{},{x:-s/2,y:-s/2,width:s,height:s});E.setStyle(m.getItemStyle());var C=E.ensureState("emphasis");C.style=_.getItemStyle();var M=new rt({style:{text:T[A],align:_.get("textAlign"),borderRadius:_.get("textBorderRadius"),padding:_.get("textPadding"),fill:null},ignore:!0});E.setTextContent(M),Pm({el:E,componentModel:r,itemName:A,formatterParamsExtra:{title:T[A]}}),E.__title=T[A],E.on("mouseover",function(){var P=_.getItemStyle(),L=l?r.get("right")==null&&r.get("left")!=="right"?"right":"left":r.get("bottom")==null&&r.get("top")!=="bottom"?"bottom":"top";M.setStyle({fill:_.get("textFill")||P.fill||P.stroke||"#000",backgroundColor:_.get("textBackgroundColor")}),E.setTextConfig({position:_.get("textPosition")||L}),M.ignore=!r.get("showTitle"),a.enterEmphasis(this)}).on("mouseout",function(){v.get(["iconStatus",A])!=="emphasis"&&a.leaveEmphasis(this),M.hide()}),(v.get(["iconStatus",A])==="emphasis"?Gs:Vs)(E),o.add(E),E.on("click",me(p.onclick,p,n,a,A)),b[A]=E})}GT(o,r,a),o.add(VT(o.getBoundingRect(),r)),l||o.eachChild(function(v){var p=v.__title,g=v.ensureState("emphasis"),m=g.textConfig||(g.textConfig={}),_=v.getTextContent(),y=_&&_.ensureState("emphasis");if(y&&!xt(y)&&p){var x=y.style||(y.style={}),S=Cm(p,rt.makeFont(x)),T=v.x+o.x,b=v.y+o.y+s,w=!1;b+S.height>a.getHeight()&&(m.position="top",w=!0);var A=w?-5-S.height:s+10;T+S.width/2>a.getWidth()?(m.position=["100%",A],x.align="right"):T-S.width/2<0&&(m.position=[0,A],x.align="left")}})},t.prototype.updateView=function(r,n,a,i){R(this._features,function(o){o instanceof mr&&o.updateView&&o.updateView(o.model,n,a,i)})},t.prototype.remove=function(r,n){R(this._features,function(a){a instanceof mr&&a.remove&&a.remove(r,n)}),this.group.removeAll()},t.prototype.dispose=function(r,n){R(this._features,function(a){a instanceof mr&&a.dispose&&a.dispose(r,n)})},t.type="toolbox",t}(kt);function HD(e){return e.indexOf("my")===0}const WD=kD;var $D=function(e){U(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.onclick=function(r,n){var a=this.model,i=a.get("name")||r.get("title.0.text")||"echarts",o=n.getZr().painter.getType()==="svg",s=o?"svg":a.get("type",!0)||"png",l=n.getConnectedDataURL({type:s,backgroundColor:a.get("backgroundColor",!0)||r.get("backgroundColor")||"#fff",connectedBackgroundColor:a.get("connectedBackgroundColor"),excludeComponents:a.get("excludeComponents"),pixelRatio:a.get("pixelRatio")}),u=UT.browser;if(xt(MouseEvent)&&(u.newEdge||!u.ie&&!u.edge)){var c=document.createElement("a");c.download=i+"."+s,c.target="_blank",c.href=l;var h=new MouseEvent("click",{view:document.defaultView,bubbles:!0,cancelable:!1});c.dispatchEvent(h)}else if(window.navigator.msSaveOrOpenBlob||o){var f=l.split(","),d=f[0].indexOf("base64")>-1,v=o?decodeURIComponent(f[1]):f[1];d&&(v=window.atob(v));var p=i+"."+s;if(window.navigator.msSaveOrOpenBlob){for(var g=v.length,m=new Uint8Array(g);g--;)m[g]=v.charCodeAt(g);var _=new Blob([m]);window.navigator.msSaveOrOpenBlob(_,p)}else{var y=document.createElement("iframe");document.body.appendChild(y);var x=y.contentWindow,S=x.document;S.open("image/svg+xml","replace"),S.write(v),S.close(),x.focus(),S.execCommand("SaveAs",!0,p),document.body.removeChild(y)}}else{var T=a.get("lang"),b='<body style="margin:0;"><img src="'+l+'" style="max-width:100%;" title="'+(T&&T[0]||"")+'" /></body>',w=window.open();w.document.write(b),w.document.title=i}},t.getDefaultOption=function(r){var n={show:!0,icon:"M4.7,22.9L29.3,45.5L54.7,23.4M4.6,43.6L4.6,58L53.8,58L53.8,43.6M29.2,45.1L29.2,0",title:r.getLocaleModel().get(["toolbox","saveAsImage","title"]),type:"png",connectedBackgroundColor:"#fff",name:"",excludeComponents:["toolbox"],lang:r.getLocaleModel().get(["toolbox","saveAsImage","lang"])};return n},t}(mr);const XD=$D;var tg="__ec_magicType_stack__",jD=[["line","bar"],["stack"]],ZD=function(e){U(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.getIcons=function(){var r=this.model,n=r.get("icon"),a={};return R(r.get("type"),function(i){n[i]&&(a[i]=n[i])}),a},t.getDefaultOption=function(r){var n={show:!0,type:[],icon:{line:"M4.1,28.9h7.1l9.3-22l7.4,38l9.7-19.7l3,12.8h14.9M4.1,58h51.4",bar:"M6.7,22.9h10V48h-10V22.9zM24.9,13h10v35h-10V13zM43.2,2h10v46h-10V2zM3.1,58h53.7",stack:"M8.2,38.4l-8.4,4.1l30.6,15.3L60,42.5l-8.1-4.1l-21.5,11L8.2,38.4z M51.9,30l-8.1,4.2l-13.4,6.9l-13.9-6.9L8.2,30l-8.4,4.2l8.4,4.2l22.2,11l21.5-11l8.1-4.2L51.9,30z M51.9,21.7l-8.1,4.2L35.7,30l-5.3,2.8L24.9,30l-8.4-4.1l-8.3-4.2l-8.4,4.2L8.2,30l8.3,4.2l13.9,6.9l13.4-6.9l8.1-4.2l8.1-4.1L51.9,21.7zM30.4,2.2L-0.2,17.5l8.4,4.1l8.3,4.2l8.4,4.2l5.5,2.7l5.3-2.7l8.1-4.2l8.1-4.2l8.1-4.1L30.4,2.2z"},title:r.getLocaleModel().get(["toolbox","magicType","title"]),option:{},seriesIndex:{}};return n},t.prototype.onclick=function(r,n,a){var i=this.model,o=i.get(["seriesIndex",a]);if(rg[a]){var s={series:[]},l=function(h){var f=h.subType,d=h.id,v=rg[a](f,d,h,i);v&&(Te(v,h.option),s.series.push(v));var p=h.coordinateSystem;if(p&&p.type==="cartesian2d"&&(a==="line"||a==="bar")){var g=p.getAxesByScale("ordinal")[0];if(g){var m=g.dim,_=m+"Axis",y=h.getReferringComponents(_,sn).models[0],x=y.componentIndex;s[_]=s[_]||[];for(var S=0;S<=x;S++)s[_][x]=s[_][x]||{};s[_][x].boundaryGap=a==="bar"}}};R(jD,function(h){pt(h,a)>=0&&R(h,function(f){i.setIconStatus(f,"normal")})}),i.setIconStatus(a,"emphasis"),r.eachComponent({mainType:"series",query:o==null?null:{seriesIndex:o}},l);var u,c=a;a==="stack"&&(u=fe({stack:i.option.title.tiled,tiled:i.option.title.stack},i.option.title),i.get(["iconStatus",a])!=="emphasis"&&(c="tiled")),n.dispatchAction({type:"changeMagicType",currentType:c,newOption:s,newTitle:u,featureName:"magicType"})}},t}(mr),rg={line:function(e,t,r,n){if(e==="bar")return fe({id:t,type:"line",data:r.get("data"),stack:r.get("stack"),markPoint:r.get("markPoint"),markLine:r.get("markLine")},n.get(["option","line"])||{},!0)},bar:function(e,t,r,n){if(e==="line")return fe({id:t,type:"bar",data:r.get("data"),stack:r.get("stack"),markPoint:r.get("markPoint"),markLine:r.get("markLine")},n.get(["option","bar"])||{},!0)},stack:function(e,t,r,n){var a=r.get("stack")===tg;if(e==="line"||e==="bar")return n.setIconStatus("stack",a?"normal":"emphasis"),fe({id:t,stack:a?"":tg},n.get(["option","stack"])||{},!0)}};ff({type:"changeMagicType",event:"magicTypeChanged",update:"prepareAndUpdate"},function(e,t){t.mergeOption(e.newOption)});const YD=ZD;var $l=new Array(60).join("-"),Qa="	";function qD(e){var t={},r=[],n=[];return e.eachRawSeries(function(a){var i=a.coordinateSystem;if(i&&(i.type==="cartesian2d"||i.type==="polar")){var o=i.getBaseAxis();if(o.type==="category"){var s=o.dim+"_"+o.index;t[s]||(t[s]={categoryAxis:o,valueAxis:i.getOtherAxis(o),series:[]},n.push({axisDim:o.dim,axisIndex:o.index})),t[s].series.push(a)}else r.push(a)}else r.push(a)}),{seriesGroupByCategoryAxis:t,other:r,meta:n}}function KD(e){var t=[];return R(e,function(r,n){var a=r.categoryAxis,i=r.valueAxis,o=i.dim,s=[" "].concat(K(r.series,function(d){return d.name})),l=[a.model.getCategories()];R(r.series,function(d){var v=d.getRawData();l.push(d.getRawData().mapArray(v.mapDimension(o),function(p){return p}))});for(var u=[s.join(Qa)],c=0;c<l[0].length;c++){for(var h=[],f=0;f<l.length;f++)h.push(l[f][c]);u.push(h.join(Qa))}t.push(u.join(`
`))}),t.join(`

`+$l+`

`)}function JD(e){return K(e,function(t){var r=t.getRawData(),n=[t.name],a=[];return r.each(r.dimensions,function(){for(var i=arguments.length,o=arguments[i-1],s=r.getName(o),l=0;l<i-1;l++)a[l]=arguments[l];n.push((s?s+Qa:"")+a.join(Qa))}),n.join(`
`)}).join(`

`+$l+`

`)}function QD(e){var t=qD(e);return{value:Vt([KD(t.seriesGroupByCategoryAxis),JD(t.other)],function(r){return!!r.replace(/[\n\t\s]/g,"")}).join(`

`+$l+`

`),meta:t.meta}}function Qs(e){return e.replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function eM(e){var t=e.slice(0,e.indexOf(`
`));if(t.indexOf(Qa)>=0)return!0}var bh=new RegExp("["+Qa+"]+","g");function tM(e){for(var t=e.split(/\n+/g),r=Qs(t.shift()).split(bh),n=[],a=K(r,function(l){return{name:l,data:[]}}),i=0;i<t.length;i++){var o=Qs(t[i]).split(bh);n.push(o.shift());for(var s=0;s<o.length;s++)a[s]&&(a[s].data[i]=o[s])}return{series:a,categories:n}}function rM(e){for(var t=e.split(/\n+/g),r=Qs(t.shift()),n=[],a=0;a<t.length;a++){var i=Qs(t[a]);if(i){var o=i.split(bh),s="",l=void 0,u=!1;isNaN(o[0])?(u=!0,s=o[0],o=o.slice(1),n[a]={name:s,value:[]},l=n[a].value):l=n[a]=[];for(var c=0;c<o.length;c++)l.push(+o[c]);l.length===1&&(u?n[a].value=l[0]:n[a]=l[0])}}return{name:r,data:n}}function nM(e,t){var r=e.split(new RegExp(`
*`+$l+`
*`,"g")),n={series:[]};return R(r,function(a,i){if(eM(a)){var o=tM(a),s=t[i],l=s.axisDim+"Axis";s&&(n[l]=n[l]||[],n[l][s.axisIndex]={data:o.categories},n.series=n.series.concat(o.series))}else{var o=rM(a);n.series.push(o)}}),n}var aM=function(e){U(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.onclick=function(r,n){setTimeout(function(){n.dispatchAction({type:"hideTip"})});var a=n.getDom(),i=this.model;this._dom&&a.removeChild(this._dom);var o=document.createElement("div");o.style.cssText="position:absolute;top:0;bottom:0;left:0;right:0;padding:5px",o.style.backgroundColor=i.get("backgroundColor")||"#fff";var s=document.createElement("h4"),l=i.get("lang")||[];s.innerHTML=l[0]||i.get("title"),s.style.cssText="margin:10px 20px",s.style.color=i.get("textColor");var u=document.createElement("div"),c=document.createElement("textarea");u.style.cssText="overflow:auto";var h=i.get("optionToContent"),f=i.get("contentToOption"),d=QD(r);if(xt(h)){var v=h(n.getOption());Ve(v)?u.innerHTML=v:kT(v)&&u.appendChild(v)}else{c.readOnly=i.get("readOnly");var p=c.style;p.cssText="display:block;width:100%;height:100%;font-family:monospace;font-size:14px;line-height:1.6rem;resize:none;box-sizing:border-box;outline:none",p.color=i.get("textColor"),p.borderColor=i.get("textareaBorderColor"),p.backgroundColor=i.get("textareaColor"),c.value=d.value,u.appendChild(c)}var g=d.meta,m=document.createElement("div");m.style.cssText="position:absolute;bottom:5px;left:0;right:0";var _="float:right;margin-right:20px;border:none;cursor:pointer;padding:2px 5px;font-size:12px;border-radius:3px",y=document.createElement("div"),x=document.createElement("div");_+=";background-color:"+i.get("buttonColor"),_+=";color:"+i.get("buttonTextColor");var S=this;function T(){a.removeChild(o),S._dom=null}lv(y,"click",T),lv(x,"click",function(){if(f==null&&h!=null||f!=null&&h==null){T();return}var b;try{xt(f)?b=f(u,n.getOption()):b=nM(c.value,g)}catch(w){throw T(),new Error("Data view format error "+w)}b&&n.dispatchAction({type:"changeDataView",newOption:b}),T()}),y.innerHTML=l[1],x.innerHTML=l[2],x.style.cssText=y.style.cssText=_,!i.get("readOnly")&&m.appendChild(x),m.appendChild(y),o.appendChild(s),o.appendChild(u),o.appendChild(m),u.style.height=a.clientHeight-80+"px",a.appendChild(o),this._dom=o},t.prototype.remove=function(r,n){this._dom&&n.getDom().removeChild(this._dom)},t.prototype.dispose=function(r,n){this.remove(r,n)},t.getDefaultOption=function(r){var n={show:!0,readOnly:!1,optionToContent:null,contentToOption:null,icon:"M17.5,17.3H33 M17.5,17.3H33 M45.4,29.5h-28 M11.5,2v56H51V14.8L38.4,2H11.5z M38.4,2.2v12.7H51 M45.4,41.7h-28",title:r.getLocaleModel().get(["toolbox","dataView","title"]),lang:r.getLocaleModel().get(["toolbox","dataView","lang"]),backgroundColor:"#fff",textColor:"#000",textareaColor:"#fff",textareaBorderColor:"#333",buttonColor:"#c23531",buttonTextColor:"#fff"};return n},t}(mr);function iM(e,t){return K(e,function(r,n){var a=t&&t[n];if(Hr(a)&&!te(a)){var i=Hr(r)&&!te(r);i||(r={value:r});var o=a.name!=null&&r.name==null;return r=Te(r,a),o&&delete r.name,r}else return r})}ff({type:"changeDataView",event:"dataViewChanged",update:"prepareAndUpdate"},function(e,t){var r=[];R(e.newOption.series,function(n){var a=t.getSeriesByName(n.name)[0];if(!a)r.push(le({type:"scatter"},n));else{var i=a.get("data");r.push({name:n.name,data:iM(n.data,i)})}}),t.mergeOption(Te({series:r},e.newOption))});const oM=aM;var P_=R,I_=Nt();function sM(e,t){var r=Jf(e);P_(t,function(n,a){for(var i=r.length-1;i>=0;i--){var o=r[i];if(o[a])break}if(i<0){var s=e.queryComponents({mainType:"dataZoom",subType:"select",id:a})[0];if(s){var l=s.getPercentRange();r[0][a]={dataZoomId:a,start:l[0],end:l[1]}}}}),r.push(t)}function lM(e){var t=Jf(e),r=t[t.length-1];t.length>1&&t.pop();var n={};return P_(r,function(a,i){for(var o=t.length-1;o>=0;o--)if(a=t[o][i],a){n[i]=a;break}}),n}function uM(e){I_(e).snapshots=null}function cM(e){return Jf(e).length}function Jf(e){var t=I_(e);return t.snapshots||(t.snapshots=[{}]),t.snapshots}var hM=function(e){U(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.onclick=function(r,n){uM(r),n.dispatchAction({type:"restore",from:this.uid})},t.getDefaultOption=function(r){var n={show:!0,icon:"M3.8,33.4 M47,18.9h9.8V8.7 M56.3,20.1 C52.1,9,40.5,0.6,26.8,2.1C12.6,3.7,1.6,16.2,2.1,30.6 M13,41.1H3.1v10.2 M3.7,39.9c4.2,11.1,15.8,19.5,29.5,18 c14.2-1.6,25.2-14.1,24.7-28.5",title:r.getLocaleModel().get(["toolbox","restore","title"])};return n},t}(mr);ff({type:"restore",event:"restore",update:"prepareAndUpdate"},function(e,t){t.resetOption("recreate")});const fM=hM;var dM=["grid","xAxis","yAxis","geo","graph","polar","radiusAxis","angleAxis","bmap"],vM=function(){function e(t,r,n){var a=this;this._targetInfoList=[];var i=ng(r,t);R(pM,function(o,s){(!n||!n.include||pt(n.include,s)>=0)&&o(i,a._targetInfoList)})}return e.prototype.setOutputRanges=function(t,r){return this.matchOutputRanges(t,r,function(n,a,i){if((n.coordRanges||(n.coordRanges=[])).push(a),!n.coordRange){n.coordRange=a;var o=nc[n.brushType](0,i,a);n.__rangeOffset={offset:sg[n.brushType](o.values,n.range,[1,1]),xyMinMax:o.xyMinMax}}}),t},e.prototype.matchOutputRanges=function(t,r,n){R(t,function(a){var i=this.findTargetInfo(a,r);i&&i!==!0&&R(i.coordSyses,function(o){var s=nc[a.brushType](1,o,a.range,!0);n(a,s.values,o,r)})},this)},e.prototype.setInputRanges=function(t,r){R(t,function(n){var a=this.findTargetInfo(n,r);if(n.range=n.range||[],a&&a!==!0){n.panelId=a.panelId;var i=nc[n.brushType](0,a.coordSys,n.coordRange),o=n.__rangeOffset;n.range=o?sg[n.brushType](i.values,o.offset,gM(i.xyMinMax,o.xyMinMax)):i.values}},this)},e.prototype.makePanelOpts=function(t,r){return K(this._targetInfoList,function(n){var a=n.getPanelRect();return{panelId:n.panelId,defaultBrushType:r?r(n):null,clipPath:jy(a),isTargetByCursor:Yy(a,t,n.coordSysModel),getLinearBrushOtherExtent:Zy(a)}})},e.prototype.controlSeries=function(t,r,n){var a=this.findTargetInfo(t,n);return a===!0||a&&pt(a.coordSyses,r.coordinateSystem)>=0},e.prototype.findTargetInfo=function(t,r){for(var n=this._targetInfoList,a=ng(r,t),i=0;i<n.length;i++){var o=n[i],s=t.panelId;if(s){if(o.panelId===s)return o}else for(var l=0;l<ag.length;l++)if(ag[l](a,o))return o}return!0},e}();function wh(e){return e[0]>e[1]&&e.reverse(),e}function ng(e,t){return Rm(e,t,{includeMainTypes:dM})}var pM={grid:function(e,t){var r=e.xAxisModels,n=e.yAxisModels,a=e.gridModels,i=ot(),o={},s={};!r&&!n&&!a||(R(r,function(l){var u=l.axis.grid.model;i.set(u.id,u),o[u.id]=!0}),R(n,function(l){var u=l.axis.grid.model;i.set(u.id,u),s[u.id]=!0}),R(a,function(l){i.set(l.id,l),o[l.id]=!0,s[l.id]=!0}),i.each(function(l){var u=l.coordinateSystem,c=[];R(u.getCartesians(),function(h,f){(pt(r,h.getAxis("x").model)>=0||pt(n,h.getAxis("y").model)>=0)&&c.push(h)}),t.push({panelId:"grid--"+l.id,gridModel:l,coordSysModel:l,coordSys:c[0],coordSyses:c,getPanelRect:ig.grid,xAxisDeclared:o[l.id],yAxisDeclared:s[l.id]})}))},geo:function(e,t){R(e.geoModels,function(r){var n=r.coordinateSystem;t.push({panelId:"geo--"+r.id,geoModel:r,coordSysModel:r,coordSys:n,coordSyses:[n],getPanelRect:ig.geo})})}},ag=[function(e,t){var r=e.xAxisModel,n=e.yAxisModel,a=e.gridModel;return!a&&r&&(a=r.axis.grid.model),!a&&n&&(a=n.axis.grid.model),a&&a===t.gridModel},function(e,t){var r=e.geoModel;return r&&r===t.geoModel}],ig={grid:function(){return this.coordSys.master.getRect().clone()},geo:function(){var e=this.coordSys,t=e.getBoundingRect().clone();return t.applyTransform(sf(e)),t}},nc={lineX:Ge(og,0),lineY:Ge(og,1),rect:function(e,t,r,n){var a=e?t.pointToData([r[0][0],r[1][0]],n):t.dataToPoint([r[0][0],r[1][0]],n),i=e?t.pointToData([r[0][1],r[1][1]],n):t.dataToPoint([r[0][1],r[1][1]],n),o=[wh([a[0],i[0]]),wh([a[1],i[1]])];return{values:o,xyMinMax:o}},polygon:function(e,t,r,n){var a=[[1/0,-1/0],[1/0,-1/0]],i=K(r,function(o){var s=e?t.pointToData(o,n):t.dataToPoint(o,n);return a[0][0]=Math.min(a[0][0],s[0]),a[1][0]=Math.min(a[1][0],s[1]),a[0][1]=Math.max(a[0][1],s[0]),a[1][1]=Math.max(a[1][1],s[1]),s});return{values:i,xyMinMax:a}}};function og(e,t,r,n){var a=r.getAxis(["x","y"][e]),i=wh(K([0,1],function(s){return t?a.coordToData(a.toLocalCoord(n[s]),!0):a.toGlobalCoord(a.dataToCoord(n[s]))})),o=[];return o[e]=i,o[1-e]=[NaN,NaN],{values:i,xyMinMax:o}}var sg={lineX:Ge(lg,0),lineY:Ge(lg,1),rect:function(e,t,r){return[[e[0][0]-r[0]*t[0][0],e[0][1]-r[0]*t[0][1]],[e[1][0]-r[1]*t[1][0],e[1][1]-r[1]*t[1][1]]]},polygon:function(e,t,r){return K(e,function(n,a){return[n[0]-r[0]*t[a][0],n[1]-r[1]*t[a][1]]})}};function lg(e,t,r,n){return[t[0]-n[e]*r[0],t[1]-n[e]*r[1]]}function gM(e,t){var r=ug(e),n=ug(t),a=[r[0]/n[0],r[1]/n[1]];return isNaN(a[0])&&(a[0]=1),isNaN(a[1])&&(a[1]=1),a}function ug(e){return e?[e[0][1]-e[0][0],e[1][1]-e[1][0]]:[NaN,NaN]}const Qf=vM;var Ah=R,mM=WT("toolbox-dataZoom_"),yM=function(e){U(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.render=function(r,n,a,i){this._brushController||(this._brushController=new Ff(a.getZr()),this._brushController.on("brush",me(this._onBrush,this)).mount()),SM(r,n,this,i,a),xM(r,n)},t.prototype.onclick=function(r,n,a){_M[a].call(this)},t.prototype.remove=function(r,n){this._brushController&&this._brushController.unmount()},t.prototype.dispose=function(r,n){this._brushController&&this._brushController.dispose()},t.prototype._onBrush=function(r){var n=r.areas;if(!r.isEnd||!n.length)return;var a={},i=this.ecModel;this._brushController.updateCovers([]);var o=new Qf(ed(this.model),i,{include:["grid"]});o.matchOutputRanges(n,i,function(u,c,h){if(h.type==="cartesian2d"){var f=u.brushType;f==="rect"?(s("x",h,c[0]),s("y",h,c[1])):s({lineX:"x",lineY:"y"}[f],h,c)}}),sM(i,a),this._dispatchZoomAction(a);function s(u,c,h){var f=c.getAxis(u),d=f.model,v=l(u,d,i),p=v.findRepresentativeAxisProxy(d).getMinMaxSpan();(p.minValueSpan!=null||p.maxValueSpan!=null)&&(h=ci(0,h.slice(),f.scale.getExtent(),0,p.minValueSpan,p.maxValueSpan)),v&&(a[v.id]={dataZoomId:v.id,startValue:h[0],endValue:h[1]})}function l(u,c,h){var f;return h.eachComponent({mainType:"dataZoom",subType:"select"},function(d){var v=d.getAxisModel(u,c.componentIndex);v&&(f=d)}),f}},t.prototype._dispatchZoomAction=function(r){var n=[];Ah(r,function(a,i){n.push(vt(a))}),n.length&&this.api.dispatchAction({type:"dataZoom",from:this.uid,batch:n})},t.getDefaultOption=function(r){var n={show:!0,filterMode:"filter",icon:{zoom:"M0,13.5h26.9 M13.5,26.9V0 M32.1,13.5H58V58H13.5 V32.1",back:"M22,1.4L9.9,13.5l12.3,12.3 M10.3,13.5H54.9v44.6 H10.3v-26"},title:r.getLocaleModel().get(["toolbox","dataZoom","title"]),brushStyle:{borderWidth:0,color:"rgba(210,219,238,0.2)"}};return n},t}(mr),_M={zoom:function(){var e=!this._isZoomActive;this.api.dispatchAction({type:"takeGlobalCursor",key:"dataZoomSelect",dataZoomSelectActive:e})},back:function(){this._dispatchZoomAction(lM(this.ecModel))}};function ed(e){var t={xAxisIndex:e.get("xAxisIndex",!0),yAxisIndex:e.get("yAxisIndex",!0),xAxisId:e.get("xAxisId",!0),yAxisId:e.get("yAxisId",!0)};return t.xAxisIndex==null&&t.xAxisId==null&&(t.xAxisIndex="all"),t.yAxisIndex==null&&t.yAxisId==null&&(t.yAxisIndex="all"),t}function xM(e,t){e.setIconStatus("back",cM(t)>1?"emphasis":"normal")}function SM(e,t,r,n,a){var i=r._isZoomActive;n&&n.type==="takeGlobalCursor"&&(i=n.key==="dataZoomSelect"?n.dataZoomSelectActive:!1),r._isZoomActive=i,e.setIconStatus("zoom",i?"emphasis":"normal");var o=new Qf(ed(e),t,{include:["grid"]}),s=o.makePanelOpts(a,function(l){return l.xAxisDeclared&&!l.yAxisDeclared?"lineX":!l.xAxisDeclared&&l.yAxisDeclared?"lineY":"rect"});r._brushController.setPanels(s).enableBrush(i&&s.length?{brushType:"auto",brushStyle:e.getModel("brushStyle").getItemStyle()}:!1)}HT("dataZoom",function(e){var t=e.getComponent("toolbox",0),r=["feature","dataZoom"];if(!t||t.get(r)==null)return;var n=t.getModel(r),a=[],i=ed(n),o=Rm(e,i);Ah(o.xAxisModels,function(l){return s(l,"xAxis","xAxisIndex")}),Ah(o.yAxisModels,function(l){return s(l,"yAxis","yAxisIndex")});function s(l,u,c){var h=l.componentIndex,f={type:"select",$fromToolbox:!0,filterMode:n.get("filterMode",!0)||"filter",id:mM+u+h};f[c]=h,a.push(f)}return a});const TM=yM;function bM(e){e.registerComponentModel(UD),e.registerComponentView(WD),Va("saveAsImage",XD),Va("magicType",YD),Va("dataView",oM),Va("dataZoom",TM),Va("restore",fM),oe(GD)}var wM=["rect","polygon","keep","clear"];function AM(e,t){var r=rr(e?e.brush:[]);if(r.length){var n=[];R(r,function(l){var u=l.hasOwnProperty("toolbox")?l.toolbox:[];u instanceof Array&&(n=n.concat(u))});var a=e&&e.toolbox;te(a)&&(a=a[0]),a||(a={feature:{}},e.toolbox=[a]);var i=a.feature||(a.feature={}),o=i.brush||(i.brush={}),s=o.type||(o.type=[]);s.push.apply(s,n),EM(s),t&&!s.length&&s.push.apply(s,wM)}}function EM(e){var t={};R(e,function(r){t[r]=1}),e.length=0,R(t,function(r,n){e.push(n)})}function CM(e){var t=e.brushType,r={point:function(n){return cg[t].point(n,r,e)},rect:function(n){return cg[t].rect(n,r,e)}};return r}var cg={lineX:hg(0),lineY:hg(1),rect:{point:function(e,t,r){return e&&r.boundingRect.contain(e[0],e[1])},rect:function(e,t,r){return e&&r.boundingRect.intersect(e)}},polygon:{point:function(e,t,r){return e&&r.boundingRect.contain(e[0],e[1])&&Ai(r.range,e[0],e[1])},rect:function(e,t,r){var n=r.range;if(!e||n.length<=1)return!1;var a=e.x,i=e.y,o=e.width,s=e.height,l=n[0];if(Ai(n,a,i)||Ai(n,a+o,i)||Ai(n,a,i+s)||Ai(n,a+o,i+s)||Yt.create(e).contain(l[0],l[1])||Zo(a,i,a+o,i,n)||Zo(a,i,a,i+s,n)||Zo(a+o,i,a+o,i+s,n)||Zo(a,i+s,a+o,i+s,n))return!0}}};function hg(e){var t=["x","y"],r=["width","height"];return{point:function(n,a,i){if(n){var o=i.range,s=n[e];return Di(s,o)}},rect:function(n,a,i){if(n){var o=i.range,s=[n[t[e]],n[t[e]]+n[r[e]]];return s[1]<s[0]&&s.reverse(),Di(s[0],o)||Di(s[1],o)||Di(o[0],s)||Di(o[1],s)}}}}function Di(e,t){return t[0]<=e&&e<=t[1]}var fg=["inBrush","outOfBrush"],ac="__ecBrushSelect",Eh="__ecInBrushSelectEvent";function R_(e){e.eachComponent({mainType:"brush"},function(t){var r=t.brushTargetManager=new Qf(t.option,e);r.setInputRanges(t.areas,e)})}function LM(e,t,r){var n=[],a,i;e.eachComponent({mainType:"brush"},function(o){r&&r.type==="takeGlobalCursor"&&o.setBrushOption(r.key==="brush"?r.brushOption:{brushType:!1})}),R_(e),e.eachComponent({mainType:"brush"},function(o,s){var l={brushId:o.id,brushIndex:s,brushName:o.name,areas:vt(o.areas),selected:[]};n.push(l);var u=o.option,c=u.brushLink,h=[],f=[],d=[],v=!1;s||(a=u.throttleType,i=u.throttleDelay);var p=K(o.areas,function(S){var T=IM[S.brushType],b=Te({boundingRect:T?T(S):void 0},S);return b.selectors=CM(b),b}),g=$T(o.option,fg,function(S){S.mappingMethod="fixed"});te(c)&&R(c,function(S){h[S]=1});function m(S){return c==="all"||!!h[S]}function _(S){return!!S.length}e.eachSeries(function(S,T){var b=d[T]=[];S.subType==="parallel"?y(S,T):x(S,T,b)});function y(S,T){var b=S.coordinateSystem;v=v||b.hasAxisBrushed(),m(T)&&b.eachActiveState(S.getData(),function(w,A){w==="active"&&(f[A]=1)})}function x(S,T,b){if(!(!S.brushSelector||PM(o,T))&&(R(p,function(A){o.brushTargetManager.controlSeries(A,S,e)&&b.push(A),v=v||_(b)}),m(T)&&_(b))){var w=S.getData();w.each(function(A){dg(S,b,w,A)&&(f[A]=1)})}}e.eachSeries(function(S,T){var b={seriesId:S.id,seriesIndex:T,seriesName:S.name,dataIndex:[]};l.selected.push(b);var w=d[T],A=S.getData(),E=m(T)?function(C){return f[C]?(b.dataIndex.push(A.getRawIndex(C)),"inBrush"):"outOfBrush"}:function(C){return dg(S,w,A,C)?(b.dataIndex.push(A.getRawIndex(C)),"inBrush"):"outOfBrush"};(m(T)?v:_(w))&&XT(fg,g,A,E)})}),DM(t,a,i,n,r)}function DM(e,t,r,n,a){if(a){var i=e.getZr();if(!i[Eh]){i[ac]||(i[ac]=MM);var o=Nl(i,ac,r,t);o(e,n)}}}function MM(e,t){if(!e.isDisposed()){var r=e.getZr();r[Eh]=!0,e.dispatchAction({type:"brushSelect",batch:t}),r[Eh]=!1}}function dg(e,t,r,n){for(var a=0,i=t.length;a<i;a++){var o=t[a];if(e.brushSelector(n,r,o.selectors,o))return!0}}function PM(e,t){var r=e.option.seriesIndex;return r!=null&&r!=="all"&&(te(r)?pt(r,t)<0:t!==r)}var IM={rect:function(e){return vg(e.range)},polygon:function(e){for(var t,r=e.range,n=0,a=r.length;n<a;n++){t=t||[[1/0,-1/0],[1/0,-1/0]];var i=r[n];i[0]<t[0][0]&&(t[0][0]=i[0]),i[0]>t[0][1]&&(t[0][1]=i[0]),i[1]<t[1][0]&&(t[1][0]=i[1]),i[1]>t[1][1]&&(t[1][1]=i[1])}return t&&vg(t)}};function vg(e){return new Yt(e[0][0],e[1][0],e[0][1]-e[0][0],e[1][1]-e[1][0])}var RM=function(e){U(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.init=function(r,n){this.ecModel=r,this.api=n,this.model,(this._brushController=new Ff(n.getZr())).on("brush",me(this._onBrush,this)).mount()},t.prototype.render=function(r,n,a,i){this.model=r,this._updateController(r,n,a,i)},t.prototype.updateTransform=function(r,n,a,i){R_(n),this._updateController(r,n,a,i)},t.prototype.updateVisual=function(r,n,a,i){this.updateTransform(r,n,a,i)},t.prototype.updateView=function(r,n,a,i){this._updateController(r,n,a,i)},t.prototype._updateController=function(r,n,a,i){(!i||i.$from!==r.id)&&this._brushController.setPanels(r.brushTargetManager.makePanelOpts(a)).enableBrush(r.brushOption).updateCovers(r.areas.slice())},t.prototype.dispose=function(){this._brushController.dispose()},t.prototype._onBrush=function(r){var n=this.model.id,a=this.model.brushTargetManager.setOutputRanges(r.areas,this.ecModel);(!r.isEnd||r.removeOnClick)&&this.api.dispatchAction({type:"brush",brushId:n,areas:vt(a),$from:n}),r.isEnd&&this.api.dispatchAction({type:"brushEnd",brushId:n,areas:vt(a),$from:n})},t.type="brush",t}(kt);const NM=RM;var OM="#ddd",BM=function(e){U(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r.areas=[],r.brushOption={},r}return t.prototype.optionUpdated=function(r,n){var a=this.option;!n&&jT(a,r,["inBrush","outOfBrush"]);var i=a.inBrush=a.inBrush||{};a.outOfBrush=a.outOfBrush||{color:OM},i.hasOwnProperty("liftZ")||(i.liftZ=5)},t.prototype.setAreas=function(r){r&&(this.areas=K(r,function(n){return pg(this.option,n)},this))},t.prototype.setBrushOption=function(r){this.brushOption=pg(this.option,r),this.brushType=this.brushOption.brushType},t.type="brush",t.dependencies=["geo","grid","xAxis","yAxis","parallel","series"],t.defaultOption={seriesIndex:"all",brushType:"rect",brushMode:"single",transformable:!0,brushStyle:{borderWidth:1,color:"rgba(210,219,238,0.3)",borderColor:"#D2DBEE"},throttleType:"fixRate",throttleDelay:0,removeOnClick:!0,z:1e4},t}(Ot);function pg(e,t){return fe({brushType:e.brushType,brushMode:e.brushMode,transformable:e.transformable,brushStyle:new Ft(e.brushStyle).getItemStyle(),removeOnClick:e.removeOnClick,z:e.z},t,!0)}const FM=BM;var zM=["rect","polygon","lineX","lineY","keep","clear"],GM=function(e){U(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.render=function(r,n,a){var i,o,s;n.eachComponent({mainType:"brush"},function(l){i=l.brushType,o=l.brushOption.brushMode||"single",s=s||!!l.areas.length}),this._brushType=i,this._brushMode=o,R(r.get("type",!0),function(l){r.setIconStatus(l,(l==="keep"?o==="multiple":l==="clear"?s:l===i)?"emphasis":"normal")})},t.prototype.updateView=function(r,n,a){this.render(r,n,a)},t.prototype.getIcons=function(){var r=this.model,n=r.get("icon",!0),a={};return R(r.get("type",!0),function(i){n[i]&&(a[i]=n[i])}),a},t.prototype.onclick=function(r,n,a){var i=this._brushType,o=this._brushMode;a==="clear"?(n.dispatchAction({type:"axisAreaSelect",intervals:[]}),n.dispatchAction({type:"brush",command:"clear",areas:[]})):n.dispatchAction({type:"takeGlobalCursor",key:"brush",brushOption:{brushType:a==="keep"?i:i===a?!1:a,brushMode:a==="keep"?o==="multiple"?"single":"multiple":o}})},t.getDefaultOption=function(r){var n={show:!0,type:zM.slice(),icon:{rect:"M7.3,34.7 M0.4,10V-0.2h9.8 M89.6,10V-0.2h-9.8 M0.4,60v10.2h9.8 M89.6,60v10.2h-9.8 M12.3,22.4V10.5h13.1 M33.6,10.5h7.8 M49.1,10.5h7.8 M77.5,22.4V10.5h-13 M12.3,31.1v8.2 M77.7,31.1v8.2 M12.3,47.6v11.9h13.1 M33.6,59.5h7.6 M49.1,59.5 h7.7 M77.5,47.6v11.9h-13",polygon:"M55.2,34.9c1.7,0,3.1,1.4,3.1,3.1s-1.4,3.1-3.1,3.1 s-3.1-1.4-3.1-3.1S53.5,34.9,55.2,34.9z M50.4,51c1.7,0,3.1,1.4,3.1,3.1c0,1.7-1.4,3.1-3.1,3.1c-1.7,0-3.1-1.4-3.1-3.1 C47.3,52.4,48.7,51,50.4,51z M55.6,37.1l1.5-7.8 M60.1,13.5l1.6-8.7l-7.8,4 M59,19l-1,5.3 M24,16.1l6.4,4.9l6.4-3.3 M48.5,11.6 l-5.9,3.1 M19.1,12.8L9.7,5.1l1.1,7.7 M13.4,29.8l1,7.3l6.6,1.6 M11.6,18.4l1,6.1 M32.8,41.9 M26.6,40.4 M27.3,40.2l6.1,1.6 M49.9,52.1l-5.6-7.6l-4.9-1.2",lineX:"M15.2,30 M19.7,15.6V1.9H29 M34.8,1.9H40.4 M55.3,15.6V1.9H45.9 M19.7,44.4V58.1H29 M34.8,58.1H40.4 M55.3,44.4 V58.1H45.9 M12.5,20.3l-9.4,9.6l9.6,9.8 M3.1,29.9h16.5 M62.5,20.3l9.4,9.6L62.3,39.7 M71.9,29.9H55.4",lineY:"M38.8,7.7 M52.7,12h13.2v9 M65.9,26.6V32 M52.7,46.3h13.2v-9 M24.9,12H11.8v9 M11.8,26.6V32 M24.9,46.3H11.8v-9 M48.2,5.1l-9.3-9l-9.4,9.2 M38.9-3.9V12 M48.2,53.3l-9.3,9l-9.4-9.2 M38.9,62.3V46.4",keep:"M4,10.5V1h10.3 M20.7,1h6.1 M33,1h6.1 M55.4,10.5V1H45.2 M4,17.3v6.6 M55.6,17.3v6.6 M4,30.5V40h10.3 M20.7,40 h6.1 M33,40h6.1 M55.4,30.5V40H45.2 M21,18.9h62.9v48.6H21V18.9z",clear:"M22,14.7l30.9,31 M52.9,14.7L22,45.7 M4.7,16.8V4.2h13.1 M26,4.2h7.8 M41.6,4.2h7.8 M70.3,16.8V4.2H57.2 M4.7,25.9v8.6 M70.3,25.9v8.6 M4.7,43.2v12.6h13.1 M26,55.8h7.8 M41.6,55.8h7.8 M70.3,43.2v12.6H57.2"},title:r.getLocaleModel().get(["toolbox","brush","title"])};return n},t}(mr);const VM=GM;function UM(e){e.registerComponentView(NM),e.registerComponentModel(FM),e.registerPreprocessor(AM),e.registerVisual(e.PRIORITY.VISUAL.BRUSH,LM),e.registerAction({type:"brush",event:"brush",update:"updateVisual"},function(t,r){r.eachComponent({mainType:"brush",query:t},function(n){n.setAreas(t.areas)})}),e.registerAction({type:"brushSelect",event:"brushSelected",update:"none"},Ya),e.registerAction({type:"brushEnd",event:"brushEnd",update:"none"},Ya),Va("brush",VM)}var kM=function(e){U(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r.layoutMode="box",r}return t.prototype.init=function(r,n,a){this.mergeDefaultAndTheme(r,a),this._initData()},t.prototype.mergeOption=function(r){e.prototype.mergeOption.apply(this,arguments),this._initData()},t.prototype.setCurrentIndex=function(r){r==null&&(r=this.option.currentIndex);var n=this._data.count();this.option.loop?r=(r%n+n)%n:(r>=n&&(r=n-1),r<0&&(r=0)),this.option.currentIndex=r},t.prototype.getCurrentIndex=function(){return this.option.currentIndex},t.prototype.isIndexMax=function(){return this.getCurrentIndex()>=this._data.count()-1},t.prototype.setPlayState=function(r){this.option.autoPlay=!!r},t.prototype.getPlayState=function(){return!!this.option.autoPlay},t.prototype._initData=function(){var r=this.option,n=r.data||[],a=r.axisType,i=this._names=[],o;a==="category"?(o=[],R(n,function(u,c){var h=Qr(ZT(u),""),f;Hr(u)?(f=vt(u),f.value=c):f=c,o.push(f),i.push(h)})):o=n;var s={category:"ordinal",time:"time",value:"number"}[a]||"number",l=this._data=new it([{name:"value",type:s}],this);l.initData(o,i)},t.prototype.getData=function(){return this._data},t.prototype.getCategories=function(){if(this.get("axisType")==="category")return this._names.slice()},t.type="timeline",t.defaultOption={z:4,show:!0,axisType:"time",realtime:!0,left:"20%",top:null,right:"20%",bottom:0,width:null,height:40,padding:5,controlPosition:"left",autoPlay:!1,rewind:!1,loop:!0,playInterval:2e3,currentIndex:0,itemStyle:{},label:{color:"#000"},data:[]},t}(Ot);const gg=kM;var N_=function(e){U(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.type="timeline.slider",t.defaultOption=Bl(gg.defaultOption,{backgroundColor:"rgba(0,0,0,0)",borderColor:"#ccc",borderWidth:0,orient:"horizontal",inverse:!1,tooltip:{trigger:"item"},symbol:"circle",symbolSize:12,lineStyle:{show:!0,width:2,color:"#DAE1F5"},label:{position:"auto",show:!0,interval:"auto",rotate:0,color:"#A4B1D7"},itemStyle:{color:"#A4B1D7",borderWidth:1},checkpointStyle:{symbol:"circle",symbolSize:15,color:"#316bf3",borderColor:"#fff",borderWidth:2,shadowBlur:2,shadowOffsetX:1,shadowOffsetY:1,shadowColor:"rgba(0, 0, 0, 0.3)",animation:!0,animationDuration:300,animationEasing:"quinticInOut"},controlStyle:{show:!0,showPlayBtn:!0,showPrevBtn:!0,showNextBtn:!0,itemSize:24,itemGap:12,position:"left",playIcon:"path://M31.6,53C17.5,53,6,41.5,6,27.4S17.5,1.8,31.6,1.8C45.7,1.8,57.2,13.3,57.2,27.4S45.7,53,31.6,53z M31.6,3.3 C18.4,3.3,7.5,14.1,7.5,27.4c0,13.3,10.8,24.1,24.1,24.1C44.9,51.5,55.7,40.7,55.7,27.4C55.7,14.1,44.9,3.3,31.6,3.3z M24.9,21.3 c0-2.2,1.6-3.1,3.5-2l10.5,6.1c1.899,1.1,1.899,2.9,0,4l-10.5,6.1c-1.9,1.1-3.5,0.2-3.5-2V21.3z",stopIcon:"path://M30.9,53.2C16.8,53.2,5.3,41.7,5.3,27.6S16.8,2,30.9,2C45,2,56.4,13.5,56.4,27.6S45,53.2,30.9,53.2z M30.9,3.5C17.6,3.5,6.8,14.4,6.8,27.6c0,13.3,10.8,24.1,24.101,24.1C44.2,51.7,55,40.9,55,27.6C54.9,14.4,44.1,3.5,30.9,3.5z M36.9,35.8c0,0.601-0.4,1-0.9,1h-1.3c-0.5,0-0.9-0.399-0.9-1V19.5c0-0.6,0.4-1,0.9-1H36c0.5,0,0.9,0.4,0.9,1V35.8z M27.8,35.8 c0,0.601-0.4,1-0.9,1h-1.3c-0.5,0-0.9-0.399-0.9-1V19.5c0-0.6,0.4-1,0.9-1H27c0.5,0,0.9,0.4,0.9,1L27.8,35.8L27.8,35.8z",nextIcon:"M2,18.5A1.52,1.52,0,0,1,.92,18a1.49,1.49,0,0,1,0-2.12L7.81,9.36,1,3.11A1.5,1.5,0,1,1,3,.89l8,7.34a1.48,1.48,0,0,1,.49,1.09,1.51,1.51,0,0,1-.46,1.1L3,18.08A1.5,1.5,0,0,1,2,18.5Z",prevIcon:"M10,.5A1.52,1.52,0,0,1,11.08,1a1.49,1.49,0,0,1,0,2.12L4.19,9.64,11,15.89a1.5,1.5,0,1,1-2,2.22L1,10.77A1.48,1.48,0,0,1,.5,9.68,1.51,1.51,0,0,1,1,8.58L9,.92A1.5,1.5,0,0,1,10,.5Z",prevBtnSize:18,nextBtnSize:18,color:"#A4B1D7",borderColor:"#A4B1D7",borderWidth:1},emphasis:{label:{show:!0,color:"#6f778d"},itemStyle:{color:"#316BF3"},controlStyle:{color:"#316BF3",borderColor:"#316BF3",borderWidth:2}},progress:{lineStyle:{color:"#316BF3"},itemStyle:{color:"#316BF3"},label:{color:"#6f778d"}},data:[]}),t}(gg);Xr(N_,YT.prototype);const HM=N_;var WM=function(e){U(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.type="timeline",t}(kt);const $M=WM;var XM=function(e){U(t,e);function t(r,n,a,i){var o=e.call(this,r,n,a)||this;return o.type=i||"value",o}return t.prototype.getLabelModel=function(){return this.model.getModel("label")},t.prototype.isHorizontal=function(){return this.model.get("orient")==="horizontal"},t}(or);const jM=XM;var ic=Math.PI,mg=Nt(),ZM=function(e){U(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.init=function(r,n){this.api=n},t.prototype.render=function(r,n,a){if(this.model=r,this.api=a,this.ecModel=n,this.group.removeAll(),r.get("show",!0)){var i=this._layout(r,a),o=this._createGroup("_mainGroup"),s=this._createGroup("_labelGroup"),l=this._axis=this._createAxis(i,r);r.formatTooltip=function(u){var c=l.scale.getLabel({value:u});return $r("nameValue",{noName:!0,value:c})},R(["AxisLine","AxisTick","Control","CurrentPointer"],function(u){this["_render"+u](i,o,l,r)},this),this._renderAxisLabel(i,s,l,r),this._position(i,r)}this._doPlayStop(),this._updateTicksStatus()},t.prototype.remove=function(){this._clearTimer(),this.group.removeAll()},t.prototype.dispose=function(){this._clearTimer()},t.prototype._layout=function(r,n){var a=r.get(["label","position"]),i=r.get("orient"),o=qM(r,n),s;a==null||a==="auto"?s=i==="horizontal"?o.y+o.height/2<n.getHeight()/2?"-":"+":o.x+o.width/2<n.getWidth()/2?"+":"-":Ve(a)?s={horizontal:{top:"-",bottom:"+"},vertical:{left:"-",right:"+"}}[i][a]:s=a;var l={horizontal:"center",vertical:s>=0||s==="+"?"left":"right"},u={horizontal:s>=0||s==="+"?"top":"bottom",vertical:"middle"},c={horizontal:0,vertical:ic/2},h=i==="vertical"?o.height:o.width,f=r.getModel("controlStyle"),d=f.get("show",!0),v=d?f.get("itemSize"):0,p=d?f.get("itemGap"):0,g=v+p,m=r.get(["label","rotate"])||0;m=m*ic/180;var _,y,x,S=f.get("position",!0),T=d&&f.get("showPlayBtn",!0),b=d&&f.get("showPrevBtn",!0),w=d&&f.get("showNextBtn",!0),A=0,E=h;S==="left"||S==="bottom"?(T&&(_=[0,0],A+=g),b&&(y=[A,0],A+=g),w&&(x=[E-v,0],E-=g)):(T&&(_=[E-v,0],E-=g),b&&(y=[0,0],A+=g),w&&(x=[E-v,0],E-=g));var C=[A,E];return r.get("inverse")&&C.reverse(),{viewRect:o,mainLength:h,orient:i,rotation:c[i],labelRotation:m,labelPosOpt:s,labelAlign:r.get(["label","align"])||l[i],labelBaseline:r.get(["label","verticalAlign"])||r.get(["label","baseline"])||u[i],playPosition:_,prevBtnPosition:y,nextBtnPosition:x,axisExtent:C,controlSize:v,controlGap:p}},t.prototype._position=function(r,n){var a=this._mainGroup,i=this._labelGroup,o=r.viewRect;if(r.orient==="vertical"){var s=Po(),l=o.x,u=o.y+o.height;qa(s,s,[-l,-u]),of(s,s,-ic/2),qa(s,s,[l,u]),o=o.clone(),o.applyTransform(s)}var c=_(o),h=_(a.getBoundingRect()),f=_(i.getBoundingRect()),d=[a.x,a.y],v=[i.x,i.y];v[0]=d[0]=c[0][0];var p=r.labelPosOpt;if(p==null||Ve(p)){var g=p==="+"?0:1;y(d,h,c,1,g),y(v,f,c,1,1-g)}else{var g=p>=0?0:1;y(d,h,c,1,g),v[1]=d[1]+p}a.setPosition(d),i.setPosition(v),a.rotation=i.rotation=r.rotation,m(a),m(i);function m(x){x.originX=c[0][0]-x.x,x.originY=c[1][0]-x.y}function _(x){return[[x.x,x.x+x.width],[x.y,x.y+x.height]]}function y(x,S,T,b,w){x[b]+=T[b][w]-S[b][w]}},t.prototype._createAxis=function(r,n){var a=n.getData(),i=n.get("axisType"),o=YM(n,i);o.getTicks=function(){return a.mapArray(["value"],function(u){return{value:u}})};var s=a.getDataExtent("value");o.setExtent(s[0],s[1]),o.calcNiceTicks();var l=new jM("value",o,r.axisExtent,i);return l.model=n,l},t.prototype._createGroup=function(r){var n=this[r]=new Fe;return this.group.add(n),n},t.prototype._renderAxisLine=function(r,n,a,i){var o=a.getExtent();if(i.get(["lineStyle","show"])){var s=new Gr({shape:{x1:o[0],y1:0,x2:o[1],y2:0},style:le({lineCap:"round"},i.getModel("lineStyle").getLineStyle()),silent:!0,z2:1});n.add(s);var l=this._progressLine=new Gr({shape:{x1:o[0],x2:this._currentPointer?this._currentPointer.x:o[0],y1:0,y2:0},style:Te({lineCap:"round",lineWidth:s.style.lineWidth},i.getModel(["progress","lineStyle"]).getLineStyle()),silent:!0,z2:1});n.add(l)}},t.prototype._renderAxisTick=function(r,n,a,i){var o=this,s=i.getData(),l=a.scale.getTicks();this._tickSymbols=[],R(l,function(u){var c=a.dataToCoord(u.value),h=s.getItemModel(u.value),f=h.getModel("itemStyle"),d=h.getModel(["emphasis","itemStyle"]),v=h.getModel(["progress","itemStyle"]),p={x:c,y:0,onclick:me(o._changeTimeline,o,u.value)},g=yg(h,f,n,p);g.ensureState("emphasis").style=d.getItemStyle(),g.ensureState("progress").style=v.getItemStyle(),bs(g);var m=et(g);h.get("tooltip")?(m.dataIndex=u.value,m.dataModel=i):m.dataIndex=m.dataModel=null,o._tickSymbols.push(g)})},t.prototype._renderAxisLabel=function(r,n,a,i){var o=this,s=a.getLabelModel();if(s.get("show")){var l=i.getData(),u=a.getViewLabels();this._tickLabels=[],R(u,function(c){var h=c.tickValue,f=l.getItemModel(h),d=f.getModel("label"),v=f.getModel(["emphasis","label"]),p=f.getModel(["progress","label"]),g=a.dataToCoord(c.tickValue),m=new rt({x:g,y:0,rotation:r.labelRotation-r.rotation,onclick:me(o._changeTimeline,o,h),silent:!1,style:ft(d,{text:c.formattedLabel,align:r.labelAlign,verticalAlign:r.labelBaseline})});m.ensureState("emphasis").style=ft(v),m.ensureState("progress").style=ft(p),n.add(m),bs(m),mg(m).dataIndex=h,o._tickLabels.push(m)})}},t.prototype._renderControl=function(r,n,a,i){var o=r.controlSize,s=r.rotation,l=i.getModel("controlStyle").getItemStyle(),u=i.getModel(["emphasis","controlStyle"]).getItemStyle(),c=i.getPlayState(),h=i.get("inverse",!0);f(r.nextBtnPosition,"next",me(this._changeTimeline,this,h?"-":"+")),f(r.prevBtnPosition,"prev",me(this._changeTimeline,this,h?"+":"-")),f(r.playPosition,c?"stop":"play",me(this._handlePlayClick,this,!c),!0);function f(d,v,p,g){if(d){var m=qT(jt(i.get(["controlStyle",v+"BtnSize"]),o),o),_=[0,-m/2,m,m],y=KM(i,v+"Icon",_,{x:d[0],y:d[1],originX:o/2,originY:0,rotation:g?-s:0,rectHover:!0,style:l,onclick:p});y.ensureState("emphasis").style=u,n.add(y),bs(y)}}},t.prototype._renderCurrentPointer=function(r,n,a,i){var o=i.getData(),s=i.getCurrentIndex(),l=o.getItemModel(s).getModel("checkpointStyle"),u=this,c={onCreate:function(h){h.draggable=!0,h.drift=me(u._handlePointerDrag,u),h.ondragend=me(u._handlePointerDragend,u),_g(h,u._progressLine,s,a,i,!0)},onUpdate:function(h){_g(h,u._progressLine,s,a,i)}};this._currentPointer=yg(l,l,this._mainGroup,{},this._currentPointer,c)},t.prototype._handlePlayClick=function(r){this._clearTimer(),this.api.dispatchAction({type:"timelinePlayChange",playState:r,from:this.uid})},t.prototype._handlePointerDrag=function(r,n,a){this._clearTimer(),this._pointerChangeTimeline([a.offsetX,a.offsetY])},t.prototype._handlePointerDragend=function(r){this._pointerChangeTimeline([r.offsetX,r.offsetY],!0)},t.prototype._pointerChangeTimeline=function(r,n){var a=this._toAxisCoord(r)[0],i=this._axis,o=Vr(i.getExtent().slice());a>o[1]&&(a=o[1]),a<o[0]&&(a=o[0]),this._currentPointer.x=a,this._currentPointer.markRedraw();var s=this._progressLine;s&&(s.shape.x2=a,s.dirty());var l=this._findNearestTick(a),u=this.model;(n||l!==u.getCurrentIndex()&&u.get("realtime"))&&this._changeTimeline(l)},t.prototype._doPlayStop=function(){var r=this;this._clearTimer(),this.model.getPlayState()&&(this._timer=setTimeout(function(){var n=r.model;r._changeTimeline(n.getCurrentIndex()+(n.get("rewind",!0)?-1:1))},this.model.get("playInterval")))},t.prototype._toAxisCoord=function(r){var n=this._mainGroup.getLocalTransform();return lo(r,n,!0)},t.prototype._findNearestTick=function(r){var n=this.model.getData(),a=1/0,i,o=this._axis;return n.each(["value"],function(s,l){var u=o.dataToCoord(s),c=Math.abs(u-r);c<a&&(a=c,i=l)}),i},t.prototype._clearTimer=function(){this._timer&&(clearTimeout(this._timer),this._timer=null)},t.prototype._changeTimeline=function(r){var n=this.model.getCurrentIndex();r==="+"?r=n+1:r==="-"&&(r=n-1),this.api.dispatchAction({type:"timelineChange",currentIndex:r,from:this.uid})},t.prototype._updateTicksStatus=function(){var r=this.model.getCurrentIndex(),n=this._tickSymbols,a=this._tickLabels;if(n)for(var i=0;i<n.length;i++)n&&n[i]&&n[i].toggleState("progress",i<r);if(a)for(var i=0;i<a.length;i++)a&&a[i]&&a[i].toggleState("progress",mg(a[i]).dataIndex<=r)},t.type="timeline.slider",t}($M);function YM(e,t){if(t=t||e.get("type"),t)switch(t){case"category":return new JT({ordinalMeta:e.getCategories(),extent:[1/0,-1/0]});case"time":return new KT({locale:e.ecModel.getLocaleModel(),useUTC:e.ecModel.get("useUTC")});default:return new Zc}}function qM(e,t){return sr(e.getBoxLayoutParams(),{width:t.getWidth(),height:t.getHeight()},e.get("padding"))}function KM(e,t,r,n){var a=n.style,i=Im(e.get(["controlStyle",t]),n||{},new Yt(r[0],r[1],r[2],r[3]));return a&&i.setStyle(a),i}function yg(e,t,r,n,a,i){var o=t.get("color");if(a)a.setColor(o),r.add(a),i&&i.onUpdate(a);else{var s=e.get("symbol");a=Pr(s,-1,-1,2,2,o),a.setStyle("strokeNoScale",!0),r.add(a),i&&i.onCreate(a)}var l=t.getItemStyle(["color"]);a.setStyle(l),n=fe({rectHover:!0,z2:100},n,!0);var u=Al(e.get("symbolSize"));n.scaleX=u[0]/2,n.scaleY=u[1]/2;var c=Il(e.get("symbolOffset"),u);c&&(n.x=(n.x||0)+c[0],n.y=(n.y||0)+c[1]);var h=e.get("symbolRotate");return n.rotation=(h||0)*Math.PI/180||0,a.attr(n),a.updateTransform(),a}function _g(e,t,r,n,a,i){if(!e.dragging){var o=a.getModel("checkpointStyle"),s=n.dataToCoord(a.getData().get("value",r));if(i||!o.get("animation",!0))e.attr({x:s,y:0}),t&&t.attr({shape:{x2:s}});else{var l={duration:o.get("animationDuration",!0),easing:o.get("animationEasing",!0)};e.stopAnimation(null,!0),e.animateTo({x:s,y:0},l),t&&t.animateTo({shape:{x2:s}},l)}}}const JM=ZM;function QM(e){e.registerAction({type:"timelineChange",event:"timelineChanged",update:"prepareAndUpdate"},function(t,r,n){var a=r.getComponent("timeline");return a&&t.currentIndex!=null&&(a.setCurrentIndex(t.currentIndex),!a.get("loop",!0)&&a.isIndexMax()&&a.getPlayState()&&(a.setPlayState(!1),n.dispatchAction({type:"timelinePlayChange",playState:!1,from:t.from}))),r.resetOption("timeline",{replaceMerge:a.get("replaceMerge",!0)}),Te({currentIndex:a.option.currentIndex},t)}),e.registerAction({type:"timelinePlayChange",event:"timelinePlayChanged",update:"update"},function(t,r){var n=r.getComponent("timeline");n&&t.playState!=null&&n.setPlayState(t.playState)})}function eP(e){var t=e&&e.timeline;te(t)||(t=t?[t]:[]),R(t,function(r){r&&tP(r)})}function tP(e){var t=e.type,r={number:"value",time:"time"};if(r[t]&&(e.axisType=r[t],delete e.type),xg(e),ta(e,"controlPosition")){var n=e.controlStyle||(e.controlStyle={});ta(n,"position")||(n.position=e.controlPosition),n.position==="none"&&!ta(n,"show")&&(n.show=!1,delete n.position),delete e.controlPosition}R(e.data||[],function(a){Hr(a)&&!te(a)&&(!ta(a,"value")&&ta(a,"name")&&(a.value=a.name),xg(a))})}function xg(e){var t=e.itemStyle||(e.itemStyle={}),r=t.emphasis||(t.emphasis={}),n=e.label||e.label||{},a=n.normal||(n.normal={}),i={normal:1,emphasis:1};R(n,function(o,s){!i[s]&&!ta(a,s)&&(a[s]=o)}),r.label&&!ta(n,"emphasis")&&(n.emphasis=r.label,delete r.label)}function ta(e,t){return e.hasOwnProperty(t)}function rP(e){e.registerComponentModel(HM),e.registerComponentView(JM),e.registerSubTypeDefaulter("timeline",function(){return"slider"}),QM(e),e.registerPreprocessor(eP)}var nP=function(e){U(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.createMarkerModelFromSeries=function(r,n,a){return new t(r,n,a)},t.type="markLine",t.defaultOption={z:5,symbol:["circle","arrow"],symbolSize:[8,16],symbolOffset:0,precision:2,tooltip:{trigger:"item"},label:{show:!0,position:"end",distance:5},lineStyle:{type:"dashed"},emphasis:{label:{show:!0},lineStyle:{width:3}},animationEasing:"linear"},t}(zl);const aP=nP;var ss=Nt(),iP=function(e,t,r,n){var a=e.getData(),i;if(te(n))i=n;else{var o=n.type;if(o==="min"||o==="max"||o==="average"||o==="median"||n.xAxis!=null||n.yAxis!=null){var s=void 0,l=void 0;if(n.yAxis!=null||n.xAxis!=null)s=t.getAxis(n.yAxis!=null?"y":"x"),l=Lr(n.yAxis,n.xAxis);else{var u=QT(n,a,t,e);s=u.valueAxis;var c=X0(a,u.valueDataDim);l=e3(a,c,o)}var h=s.dim==="x"?0:1,f=1-h,d=vt(n),v={coord:[]};d.type=null,d.coord=[],d.coord[f]=-1/0,v.coord[f]=1/0;var p=r.get("precision");p>=0&&Mr(l)&&(l=+l.toFixed(Math.min(p,20))),d.coord[h]=v.coord[h]=l,i=[d,v,{type:o,valueIndex:n.valueIndex,value:l}]}else i=[]}var g=[ks(e,i[0]),ks(e,i[1]),le({},i[2])];return g[2].type=g[2].type||null,fe(g[2],g[0]),fe(g[2],g[1]),g};function el(e){return!isNaN(e)&&!isFinite(e)}function Sg(e,t,r,n){var a=1-e,i=n.dimensions[e];return el(t[a])&&el(r[a])&&t[e]===r[e]&&n.getAxis(i).containData(t[e])}function oP(e,t){if(e.type==="cartesian2d"){var r=t[0].coord,n=t[1].coord;if(r&&n&&(Sg(1,r,n,e)||Sg(0,r,n,e)))return!0}return Hs(e,t[0])&&Hs(e,t[1])}function oc(e,t,r,n,a){var i=n.coordinateSystem,o=e.getItemModel(t),s,l=ee(o.get("x"),a.getWidth()),u=ee(o.get("y"),a.getHeight());if(!isNaN(l)&&!isNaN(u))s=[l,u];else{if(n.getMarkerPosition)s=n.getMarkerPosition(e.getValues(e.dimensions,t));else{var c=i.dimensions,h=e.get(c[0],t),f=e.get(c[1],t);s=i.dataToPoint([h,f])}if(Ol(i,"cartesian2d")){var d=i.getAxis("x"),v=i.getAxis("y"),c=i.dimensions;el(e.get(c[0],t))?s[0]=d.toGlobalCoord(d.getExtent()[r?0:1]):el(e.get(c[1],t))&&(s[1]=v.toGlobalCoord(v.getExtent()[r?0:1]))}isNaN(l)||(s[0]=l),isNaN(u)||(s[1]=u)}e.setItemLayout(t,s)}var sP=function(e){U(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.updateTransform=function(r,n,a){n.eachSeries(function(i){var o=zl.getMarkerModelFromSeries(i,"markLine");if(o){var s=o.getData(),l=ss(o).from,u=ss(o).to;l.each(function(c){oc(l,c,!0,i,a),oc(u,c,!1,i,a)}),s.each(function(c){s.setItemLayout(c,[l.getItemLayout(c),u.getItemLayout(c)])}),this.markerGroupMap.get(i.id).updateLayout()}},this)},t.prototype.renderSeries=function(r,n,a,i){var o=r.coordinateSystem,s=r.id,l=r.getData(),u=this.markerGroupMap,c=u.get(s)||u.set(s,new Pf);this.group.add(c.group);var h=lP(o,r,n),f=h.from,d=h.to,v=h.line;ss(n).from=f,ss(n).to=d,n.setData(v);var p=n.get("symbol"),g=n.get("symbolSize"),m=n.get("symbolRotate"),_=n.get("symbolOffset");te(p)||(p=[p,p]),te(g)||(g=[g,g]),te(m)||(m=[m,m]),te(_)||(_=[_,_]),h.from.each(function(x){y(f,x,!0),y(d,x,!1)}),v.each(function(x){var S=v.getItemModel(x).getModel("lineStyle").getLineStyle();v.setItemLayout(x,[f.getItemLayout(x),d.getItemLayout(x)]),S.stroke==null&&(S.stroke=f.getItemVisual(x,"style").fill),v.setItemVisual(x,{fromSymbolKeepAspect:f.getItemVisual(x,"symbolKeepAspect"),fromSymbolOffset:f.getItemVisual(x,"symbolOffset"),fromSymbolRotate:f.getItemVisual(x,"symbolRotate"),fromSymbolSize:f.getItemVisual(x,"symbolSize"),fromSymbol:f.getItemVisual(x,"symbol"),toSymbolKeepAspect:d.getItemVisual(x,"symbolKeepAspect"),toSymbolOffset:d.getItemVisual(x,"symbolOffset"),toSymbolRotate:d.getItemVisual(x,"symbolRotate"),toSymbolSize:d.getItemVisual(x,"symbolSize"),toSymbol:d.getItemVisual(x,"symbol"),style:S})}),c.updateData(v),h.line.eachItemGraphicEl(function(x){et(x).dataModel=n,x.traverse(function(S){et(S).dataModel=n})});function y(x,S,T){var b=x.getItemModel(S);oc(x,S,T,r,i);var w=b.getModel("itemStyle").getItemStyle();w.fill==null&&(w.fill=Nm(l,"color")),x.setItemVisual(S,{symbolKeepAspect:b.get("symbolKeepAspect"),symbolOffset:jt(b.get("symbolOffset",!0),_[T?0:1]),symbolRotate:jt(b.get("symbolRotate",!0),m[T?0:1]),symbolSize:jt(b.get("symbolSize"),g[T?0:1]),symbol:jt(b.get("symbol",!0),p[T?0:1]),style:w})}this.markKeep(c),c.group.silent=n.get("silent")||r.get("silent")},t.type="markLine",t}(Om);function lP(e,t,r){var n;e?n=K(e&&e.dimensions,function(u){var c=t.getData().getDimensionInfo(t.getData().mapDimension(u))||{};return le(le({},c),{name:u,ordinalMeta:null})}):n=[{name:"value",type:"float"}];var a=new it(n,r),i=new it(n,r),o=new it([],r),s=K(r.get("data"),Ge(iP,t,e,r));e&&(s=Vt(s,Ge(oP,e)));var l=t3(!!e,n);return a.initData(K(s,function(u){return u[0]}),null,l),i.initData(K(s,function(u){return u[1]}),null,l),o.initData(K(s,function(u){return u[2]})),o.hasItemOption=!0,{from:a,to:i,line:o}}const uP=sP;function cP(e){e.registerComponentModel(aP),e.registerComponentView(uP),e.registerPreprocessor(function(t){Bm(t.series,"markLine")&&(t.markLine=t.markLine||{})})}var hP=function(e){U(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.createMarkerModelFromSeries=function(r,n,a){return new t(r,n,a)},t.type="markArea",t.defaultOption={z:1,tooltip:{trigger:"item"},animation:!1,label:{show:!0,position:"top"},itemStyle:{borderWidth:0},emphasis:{label:{show:!0,position:"top"}}},t}(zl);const fP=hP;var ls=Nt(),dP=function(e,t,r,n){var a=n[0],i=n[1];if(!(!a||!i)){var o=ks(e,a),s=ks(e,i),l=o.coord,u=s.coord;l[0]=Lr(l[0],-1/0),l[1]=Lr(l[1],-1/0),u[0]=Lr(u[0],1/0),u[1]=Lr(u[1],1/0);var c=_m([{},o,s]);return c.coord=[o.coord,s.coord],c.x0=o.x,c.y0=o.y,c.x1=s.x,c.y1=s.y,c}};function tl(e){return!isNaN(e)&&!isFinite(e)}function Tg(e,t,r,n){var a=1-e;return tl(t[a])&&tl(r[a])}function vP(e,t){var r=t.coord[0],n=t.coord[1],a={coord:r,x:t.x0,y:t.y0},i={coord:n,x:t.x1,y:t.y1};return Ol(e,"cartesian2d")?r&&n&&(Tg(1,r,n)||Tg(0,r,n))?!0:r3(e,a,i):Hs(e,a)||Hs(e,i)}function bg(e,t,r,n,a){var i=n.coordinateSystem,o=e.getItemModel(t),s,l=ee(o.get(r[0]),a.getWidth()),u=ee(o.get(r[1]),a.getHeight());if(!isNaN(l)&&!isNaN(u))s=[l,u];else{if(n.getMarkerPosition){var c=e.getValues(["x0","y0"],t),h=e.getValues(["x1","y1"],t),f=i.clampData(c),d=i.clampData(h),v=[];r[0]==="x0"?v[0]=f[0]>d[0]?h[0]:c[0]:v[0]=f[0]>d[0]?c[0]:h[0],r[1]==="y0"?v[1]=f[1]>d[1]?h[1]:c[1]:v[1]=f[1]>d[1]?c[1]:h[1],s=n.getMarkerPosition(v,r,!0)}else{var p=e.get(r[0],t),g=e.get(r[1],t),m=[p,g];i.clampData&&i.clampData(m,m),s=i.dataToPoint(m,!0)}if(Ol(i,"cartesian2d")){var _=i.getAxis("x"),y=i.getAxis("y"),p=e.get(r[0],t),g=e.get(r[1],t);tl(p)?s[0]=_.toGlobalCoord(_.getExtent()[r[0]==="x0"?0:1]):tl(g)&&(s[1]=y.toGlobalCoord(y.getExtent()[r[1]==="y0"?0:1]))}isNaN(l)||(s[0]=l),isNaN(u)||(s[1]=u)}return s}var wg=[["x0","y0"],["x1","y0"],["x1","y1"],["x0","y1"]],pP=function(e){U(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.updateTransform=function(r,n,a){n.eachSeries(function(i){var o=zl.getMarkerModelFromSeries(i,"markArea");if(o){var s=o.getData();s.each(function(l){var u=K(wg,function(h){return bg(s,l,h,i,a)});s.setItemLayout(l,u);var c=s.getItemGraphicEl(l);c.setShape("points",u)})}},this)},t.prototype.renderSeries=function(r,n,a,i){var o=r.coordinateSystem,s=r.id,l=r.getData(),u=this.markerGroupMap,c=u.get(s)||u.set(s,{group:new Fe});this.group.add(c.group),this.markKeep(c);var h=gP(o,r,n);n.setData(h),h.each(function(f){var d=K(wg,function(w){return bg(h,f,w,r,i)}),v=o.getAxis("x").scale,p=o.getAxis("y").scale,g=v.getExtent(),m=p.getExtent(),_=[v.parse(h.get("x0",f)),v.parse(h.get("x1",f))],y=[p.parse(h.get("y0",f)),p.parse(h.get("y1",f))];Vr(_),Vr(y);var x=!(g[0]>_[1]||g[1]<_[0]||m[0]>y[1]||m[1]<y[0]),S=!x;h.setItemLayout(f,{points:d,allClipped:S});var T=h.getItemModel(f).getModel("itemStyle").getItemStyle(),b=Nm(l,"color");T.fill||(T.fill=b,Ve(T.fill)&&(T.fill=qc(T.fill,.4))),T.stroke||(T.stroke=b),h.setItemVisual(f,"style",T)}),h.diff(ls(c).data).add(function(f){var d=h.getItemLayout(f);if(!d.allClipped){var v=new on({shape:{points:d.points}});h.setItemGraphicEl(f,v),c.group.add(v)}}).update(function(f,d){var v=ls(c).data.getItemGraphicEl(d),p=h.getItemLayout(f);p.allClipped?v&&c.group.remove(v):(v?st(v,{shape:{points:p.points}},n,f):v=new on({shape:{points:p.points}}),h.setItemGraphicEl(f,v),c.group.add(v))}).remove(function(f){var d=ls(c).data.getItemGraphicEl(f);c.group.remove(d)}).execute(),h.eachItemGraphicEl(function(f,d){var v=h.getItemModel(d),p=h.getItemVisual(d,"style");f.useStyle(h.getItemVisual(d,"style")),Wr(f,wr(v),{labelFetcher:n,labelDataIndex:d,defaultText:h.getName(d)||"",inheritColor:Ve(p.fill)?qc(p.fill,1):"#000"}),ur(f,v),zt(f,null,null,v.get(["emphasis","disabled"])),et(f).dataModel=n}),ls(c).data=h,c.group.silent=n.get("silent")||r.get("silent")},t.type="markArea",t}(Om);function gP(e,t,r){var n,a,i=["x0","y0","x1","y1"];if(e){var o=K(e&&e.dimensions,function(u){var c=t.getData(),h=c.getDimensionInfo(c.mapDimension(u))||{};return le(le({},h),{name:u,ordinalMeta:null})});a=K(i,function(u,c){return{name:u,type:o[c%2].type}}),n=new it(a,r)}else a=[{name:"value",type:"float"}],n=new it(a,r);var s=K(r.get("data"),Ge(dP,t,e,r));e&&(s=Vt(s,Ge(vP,e)));var l=e?function(u,c,h,f){var d=u.coord[Math.floor(f/2)][f%2];return uv(d,a[f])}:function(u,c,h,f){return uv(u.value,a[f])};return n.initData(s,null,l),n.hasItemOption=!0,n}const mP=pP;function yP(e){e.registerComponentModel(fP),e.registerComponentView(mP),e.registerPreprocessor(function(t){Bm(t.series,"markArea")&&(t.markArea=t.markArea||{})})}var _P=function(e){U(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.type="dataZoom.inside",t.defaultOption=Bl(mo.defaultOption,{disabled:!1,zoomLock:!1,zoomOnMouseWheel:!0,moveOnMouseMove:!0,moveOnMouseWheel:!1,preventDefaultMouseMove:!0}),t}(mo);const xP=_P;var td=Nt();function SP(e,t,r){td(e).coordSysRecordMap.each(function(n){var a=n.dataZoomInfoMap.get(t.uid);a&&(a.getRange=r)})}function TP(e,t){for(var r=td(e).coordSysRecordMap,n=r.keys(),a=0;a<n.length;a++){var i=n[a],o=r.get(i),s=o.dataZoomInfoMap;if(s){var l=t.uid,u=s.get(l);u&&(s.removeKey(l),s.keys().length||O_(r,o))}}}function O_(e,t){if(t){e.removeKey(t.model.uid);var r=t.controller;r&&r.dispose()}}function bP(e,t){var r={model:t,containsPoint:Ge(AP,t),dispatchAction:Ge(wP,e),dataZoomInfoMap:null,controller:null},n=r.controller=new Dl(e.getZr());return R(["pan","zoom","scrollMove"],function(a){n.on(a,function(i){var o=[];r.dataZoomInfoMap.each(function(s){if(i.isAvailableBehavior(s.model.option)){var l=(s.getRange||{})[a],u=l&&l(s.dzReferCoordSysInfo,r.model.mainType,r.controller,i);!s.model.get("disabled",!0)&&u&&o.push({dataZoomId:s.model.id,start:u[0],end:u[1]})}}),o.length&&r.dispatchAction(o)})}),r}function wP(e,t){e.isDisposed()||e.dispatchAction({type:"dataZoom",animation:{easing:"cubicOut",duration:100},batch:t})}function AP(e,t,r,n){return e.coordinateSystem.containPoint([r,n])}function EP(e){var t,r="type_",n={type_true:2,type_move:1,type_false:0,type_undefined:-1},a=!0;return e.each(function(i){var o=i.model,s=o.get("disabled",!0)?!1:o.get("zoomLock",!0)?"move":!0;n[r+s]>n[r+t]&&(t=s),a=a&&o.get("preventDefaultMouseMove",!0)}),{controlType:t,opt:{zoomOnMouseWheel:!0,moveOnMouseMove:!0,moveOnMouseWheel:!0,preventDefaultMouseMove:!!a}}}function CP(e){e.registerProcessor(e.PRIORITY.PROCESSOR.FILTER,function(t,r){var n=td(r),a=n.coordSysRecordMap||(n.coordSysRecordMap=ot());a.each(function(i){i.dataZoomInfoMap=null}),t.eachComponent({mainType:"dataZoom",subType:"inside"},function(i){var o=L_(i);R(o.infoList,function(s){var l=s.model.uid,u=a.get(l)||a.set(l,bP(r,s.model)),c=u.dataZoomInfoMap||(u.dataZoomInfoMap=ot());c.set(i.uid,{dzReferCoordSysInfo:s,model:i,getRange:null})})}),a.each(function(i){var o=i.controller,s,l=i.dataZoomInfoMap;if(l){var u=l.keys()[0];u!=null&&(s=l.get(u))}if(!s){O_(a,i);return}var c=EP(l);o.enable(c.controlType,c.opt),o.setPointerChecker(i.containsPoint),Nl(i,"dispatchAction",s.model.get("throttle",!0),"fixRate")})})}var LP=function(e){U(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type="dataZoom.inside",r}return t.prototype.render=function(r,n,a){if(e.prototype.render.apply(this,arguments),r.noTarget()){this._clear();return}this.range=r.getPercentRange(),SP(a,r,{pan:me(sc.pan,this),zoom:me(sc.zoom,this),scrollMove:me(sc.scrollMove,this)})},t.prototype.dispose=function(){this._clear(),e.prototype.dispose.apply(this,arguments)},t.prototype._clear=function(){TP(this.api,this.dataZoomModel),this.range=null},t.type="dataZoom.inside",t}(qf),sc={zoom:function(e,t,r,n){var a=this.range,i=a.slice(),o=e.axisModels[0];if(o){var s=lc[t](null,[n.originX,n.originY],o,r,e),l=(s.signal>0?s.pixelStart+s.pixelLength-s.pixel:s.pixel-s.pixelStart)/s.pixelLength*(i[1]-i[0])+i[0],u=Math.max(1/n.scale,0);i[0]=(i[0]-l)*u+l,i[1]=(i[1]-l)*u+l;var c=this.dataZoomModel.findRepresentativeAxisProxy().getMinMaxSpan();if(ci(0,i,[0,100],0,c.minSpan,c.maxSpan),this.range=i,a[0]!==i[0]||a[1]!==i[1])return i}},pan:Ag(function(e,t,r,n,a,i){var o=lc[n]([i.oldX,i.oldY],[i.newX,i.newY],t,a,r);return o.signal*(e[1]-e[0])*o.pixel/o.pixelLength}),scrollMove:Ag(function(e,t,r,n,a,i){var o=lc[n]([0,0],[i.scrollDelta,i.scrollDelta],t,a,r);return o.signal*(e[1]-e[0])*i.scrollDelta})};function Ag(e){return function(t,r,n,a){var i=this.range,o=i.slice(),s=t.axisModels[0];if(s){var l=e(o,s,t,r,n,a);if(ci(l,o,[0,100],"all"),this.range=o,i[0]!==o[0]||i[1]!==o[1])return o}}}var lc={grid:function(e,t,r,n,a){var i=r.axis,o={},s=a.model.coordinateSystem.getRect();return e=e||[0,0],i.dim==="x"?(o.pixel=t[0]-e[0],o.pixelLength=s.width,o.pixelStart=s.x,o.signal=i.inverse?1:-1):(o.pixel=t[1]-e[1],o.pixelLength=s.height,o.pixelStart=s.y,o.signal=i.inverse?-1:1),o},polar:function(e,t,r,n,a){var i=r.axis,o={},s=a.model.coordinateSystem,l=s.getRadiusAxis().getExtent(),u=s.getAngleAxis().getExtent();return e=e?s.pointToCoord(e):[0,0],t=s.pointToCoord(t),r.mainType==="radiusAxis"?(o.pixel=t[0]-e[0],o.pixelLength=l[1]-l[0],o.pixelStart=l[0],o.signal=i.inverse?1:-1):(o.pixel=t[1]-e[1],o.pixelLength=u[1]-u[0],o.pixelStart=u[0],o.signal=i.inverse?-1:1),o},singleAxis:function(e,t,r,n,a){var i=r.axis,o=a.model.coordinateSystem.getRect(),s={};return e=e||[0,0],i.orient==="horizontal"?(s.pixel=t[0]-e[0],s.pixelLength=o.width,s.pixelStart=o.x,s.signal=i.inverse?1:-1):(s.pixel=t[1]-e[1],s.pixelLength=o.height,s.pixelStart=o.y,s.signal=i.inverse?-1:1),s}};const DP=LP;function B_(e){Kf(e),e.registerComponentModel(xP),e.registerComponentView(DP),CP(e)}var MP=function(e){U(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.type="dataZoom.slider",t.layoutMode="box",t.defaultOption=Bl(mo.defaultOption,{show:!0,right:"ph",top:"ph",width:"ph",height:"ph",left:null,bottom:null,borderColor:"#d2dbee",borderRadius:3,backgroundColor:"rgba(47,69,84,0)",dataBackground:{lineStyle:{color:"#d2dbee",width:.5},areaStyle:{color:"#d2dbee",opacity:.2}},selectedDataBackground:{lineStyle:{color:"#8fb0f7",width:.5},areaStyle:{color:"#8fb0f7",opacity:.2}},fillerColor:"rgba(135,175,274,0.2)",handleIcon:"path://M-9.35,34.56V42m0-40V9.5m-2,0h4a2,2,0,0,1,2,2v21a2,2,0,0,1-2,2h-4a2,2,0,0,1-2-2v-21A2,2,0,0,1-11.35,9.5Z",handleSize:"100%",handleStyle:{color:"#fff",borderColor:"#ACB8D1"},moveHandleSize:7,moveHandleIcon:"path://M-320.9-50L-320.9-50c18.1,0,27.1,9,27.1,27.1V85.7c0,18.1-9,27.1-27.1,27.1l0,0c-18.1,0-27.1-9-27.1-27.1V-22.9C-348-41-339-50-320.9-50z M-212.3-50L-212.3-50c18.1,0,27.1,9,27.1,27.1V85.7c0,18.1-9,27.1-27.1,27.1l0,0c-18.1,0-27.1-9-27.1-27.1V-22.9C-239.4-41-230.4-50-212.3-50z M-103.7-50L-103.7-50c18.1,0,27.1,9,27.1,27.1V85.7c0,18.1-9,27.1-27.1,27.1l0,0c-18.1,0-27.1-9-27.1-27.1V-22.9C-130.9-41-121.8-50-103.7-50z",moveHandleStyle:{color:"#D2DBEE",opacity:.7},showDetail:!0,showDataShadow:"auto",realtime:!0,zoomLock:!1,textStyle:{color:"#6E7079"},brushSelect:!0,brushStyle:{color:"rgba(135,175,274,0.15)"},emphasis:{handleStyle:{borderColor:"#8FB0F7"},moveHandleStyle:{color:"#8FB0F7"}}}),t}(mo);const PP=MP;var Mi=Et,Eg=7,IP=1,uc=30,RP=7,Pi="horizontal",Cg="vertical",NP=5,OP=["line","bar","candlestick","scatter"],BP={easing:"cubicOut",duration:100,delay:0},FP=function(e){U(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r._displayables={},r}return t.prototype.init=function(r,n){this.api=n,this._onBrush=me(this._onBrush,this),this._onBrushEnd=me(this._onBrushEnd,this)},t.prototype.render=function(r,n,a,i){if(e.prototype.render.apply(this,arguments),Nl(this,"_dispatchZoomAction",r.get("throttle"),"fixRate"),this._orient=r.getOrient(),r.get("show")===!1){this.group.removeAll();return}if(r.noTarget()){this._clear(),this.group.removeAll();return}(!i||i.type!=="dataZoom"||i.from!==this.uid)&&this._buildView(),this._updateView()},t.prototype.dispose=function(){this._clear(),e.prototype.dispose.apply(this,arguments)},t.prototype._clear=function(){gm(this,"_dispatchZoomAction");var r=this.api.getZr();r.off("mousemove",this._onBrush),r.off("mouseup",this._onBrushEnd)},t.prototype._buildView=function(){var r=this.group;r.removeAll(),this._brushing=!1,this._displayables.brushRect=null,this._resetLocation(),this._resetInterval();var n=this._displayables.sliderGroup=new Fe;this._renderBackground(),this._renderHandle(),this._renderDataShadow(),r.add(n),this._positionGroup()},t.prototype._resetLocation=function(){var r=this.dataZoomModel,n=this.api,a=r.get("brushSelect"),i=a?RP:0,o=this._findCoordRect(),s={width:n.getWidth(),height:n.getHeight()},l=this._orient===Pi?{right:s.width-o.x-o.width,top:s.height-uc-Eg-i,width:o.width,height:uc}:{right:Eg,top:o.y,width:uc,height:o.height},u=Lm(r.option);R(["right","top","width","height"],function(h){u[h]==="ph"&&(u[h]=l[h])});var c=sr(u,s);this._location={x:c.x,y:c.y},this._size=[c.width,c.height],this._orient===Cg&&this._size.reverse()},t.prototype._positionGroup=function(){var r=this.group,n=this._location,a=this._orient,i=this.dataZoomModel.getFirstTargetAxisModel(),o=i&&i.get("inverse"),s=this._displayables.sliderGroup,l=(this._dataShadowInfo||{}).otherAxisInverse;s.attr(a===Pi&&!o?{scaleY:l?1:-1,scaleX:1}:a===Pi&&o?{scaleY:l?1:-1,scaleX:-1}:a===Cg&&!o?{scaleY:l?-1:1,scaleX:1,rotation:Math.PI/2}:{scaleY:l?-1:1,scaleX:-1,rotation:Math.PI/2});var u=r.getBoundingRect([s]);r.x=n.x-u.x,r.y=n.y-u.y,r.markRedraw()},t.prototype._getViewExtent=function(){return[0,this._size[0]]},t.prototype._renderBackground=function(){var r=this.dataZoomModel,n=this._size,a=this._displayables.sliderGroup,i=r.get("brushSelect");a.add(new Mi({silent:!0,shape:{x:0,y:0,width:n[0],height:n[1]},style:{fill:r.get("backgroundColor")},z2:-40}));var o=new Mi({shape:{x:0,y:0,width:n[0],height:n[1]},style:{fill:"transparent"},z2:0,onclick:me(this._onClickPanel,this)}),s=this.api.getZr();i?(o.on("mousedown",this._onBrushStart,this),o.cursor="crosshair",s.on("mousemove",this._onBrush),s.on("mouseup",this._onBrushEnd)):(s.off("mousemove",this._onBrush),s.off("mouseup",this._onBrushEnd)),a.add(o)},t.prototype._renderDataShadow=function(){var r=this._dataShadowInfo=this._prepareDataShadowInfo();if(this._displayables.dataShadowSegs=[],!r)return;var n=this._size,a=this._shadowSize||[],i=r.series,o=i.getRawData(),s=i.getShadowDim&&i.getShadowDim(),l=s&&o.getDimensionInfo(s)?i.getShadowDim():r.otherDim;if(l==null)return;var u=this._shadowPolygonPts,c=this._shadowPolylinePts;if(o!==this._shadowData||l!==this._shadowDim||n[0]!==a[0]||n[1]!==a[1]){var h=o.getDataExtent(l),f=(h[1]-h[0])*.3;h=[h[0]-f,h[1]+f];var d=[0,n[1]],v=[0,n[0]],p=[[n[0],0],[0,0]],g=[],m=v[1]/(o.count()-1),_=0,y=Math.round(o.count()/n[0]),x;o.each([l],function(A,E){if(y>0&&E%y){_+=m;return}var C=A==null||isNaN(A)||A==="",M=C?0:Ye(A,h,d,!0);C&&!x&&E?(p.push([p[p.length-1][0],0]),g.push([g[g.length-1][0],0])):!C&&x&&(p.push([_,0]),g.push([_,0])),p.push([_,M]),g.push([_,M]),_+=m,x=C}),u=this._shadowPolygonPts=p,c=this._shadowPolylinePts=g}this._shadowData=o,this._shadowDim=l,this._shadowSize=[n[0],n[1]];var S=this.dataZoomModel;function T(A){var E=S.getModel(A?"selectedDataBackground":"dataBackground"),C=new Fe,M=new on({shape:{points:u},segmentIgnoreThreshold:1,style:E.getModel("areaStyle").getAreaStyle(),silent:!0,z2:-20}),P=new Nn({shape:{points:c},segmentIgnoreThreshold:1,style:E.getModel("lineStyle").getLineStyle(),silent:!0,z2:-19});return C.add(M),C.add(P),C}for(var b=0;b<3;b++){var w=T(b===1);this._displayables.sliderGroup.add(w),this._displayables.dataShadowSegs.push(w)}},t.prototype._prepareDataShadowInfo=function(){var r=this.dataZoomModel,n=r.get("showDataShadow");if(n!==!1){var a,i=this.ecModel;return r.eachTargetAxis(function(o,s){var l=r.getAxisProxy(o,s).getTargetSeriesModels();R(l,function(u){if(!a&&!(n!==!0&&pt(OP,u.get("type"))<0)){var c=i.getComponent(bn(o),s).axis,h=zP(o),f,d=u.coordinateSystem;h!=null&&d.getOtherAxis&&(f=d.getOtherAxis(c).inverse),h=u.getData().mapDimension(h),a={thisAxis:c,series:u,thisDim:o,otherDim:h,otherAxisInverse:f}}},this)},this),a}},t.prototype._renderHandle=function(){var r=this.group,n=this._displayables,a=n.handles=[null,null],i=n.handleLabels=[null,null],o=this._displayables.sliderGroup,s=this._size,l=this.dataZoomModel,u=this.api,c=l.get("borderRadius")||0,h=l.get("brushSelect"),f=n.filler=new Mi({silent:h,style:{fill:l.get("fillerColor")},textConfig:{position:"inside"}});o.add(f),o.add(new Mi({silent:!0,subPixelOptimize:!0,shape:{x:0,y:0,width:s[0],height:s[1],r:c},style:{stroke:l.get("dataBackgroundColor")||l.get("borderColor"),lineWidth:IP,fill:"rgba(0,0,0,0)"}})),R([0,1],function(y){var x=l.get("handleIcon");!n3[x]&&x.indexOf("path://")<0&&x.indexOf("image://")<0&&(x="path://"+x);var S=Pr(x,-1,0,2,2,null,!0);S.attr({cursor:Lg(this._orient),draggable:!0,drift:me(this._onDragMove,this,y),ondragend:me(this._onDragEnd,this),onmouseover:me(this._showDataInfo,this,!0),onmouseout:me(this._showDataInfo,this,!1),z2:5});var T=S.getBoundingRect(),b=l.get("handleSize");this._handleHeight=ee(b,this._size[1]),this._handleWidth=T.width/T.height*this._handleHeight,S.setStyle(l.getModel("handleStyle").getItemStyle()),S.style.strokeNoScale=!0,S.rectHover=!0,S.ensureState("emphasis").style=l.getModel(["emphasis","handleStyle"]).getItemStyle(),bs(S);var w=l.get("handleColor");w!=null&&(S.style.fill=w),o.add(a[y]=S);var A=l.getModel("textStyle");r.add(i[y]=new rt({silent:!0,invisible:!0,style:ft(A,{x:0,y:0,text:"",verticalAlign:"middle",align:"center",fill:A.getTextColor(),font:A.getFont()}),z2:10}))},this);var d=f;if(h){var v=ee(l.get("moveHandleSize"),s[1]),p=n.moveHandle=new Et({style:l.getModel("moveHandleStyle").getItemStyle(),silent:!0,shape:{r:[0,0,2,2],y:s[1]-.5,height:v}}),g=v*.8,m=n.moveHandleIcon=Pr(l.get("moveHandleIcon"),-g/2,-g/2,g,g,"#fff",!0);m.silent=!0,m.y=s[1]+v/2-.5,p.ensureState("emphasis").style=l.getModel(["emphasis","moveHandleStyle"]).getItemStyle();var _=Math.min(s[1]/2,Math.max(v,10));d=n.moveZone=new Et({invisible:!0,shape:{y:s[1]-_,height:v+_}}),d.on("mouseover",function(){u.enterEmphasis(p)}).on("mouseout",function(){u.leaveEmphasis(p)}),o.add(p),o.add(m),o.add(d)}d.attr({draggable:!0,cursor:Lg(this._orient),drift:me(this._onDragMove,this,"all"),ondragstart:me(this._showDataInfo,this,!0),ondragend:me(this._onDragEnd,this),onmouseover:me(this._showDataInfo,this,!0),onmouseout:me(this._showDataInfo,this,!1)})},t.prototype._resetInterval=function(){var r=this._range=this.dataZoomModel.getPercentRange(),n=this._getViewExtent();this._handleEnds=[Ye(r[0],[0,100],n,!0),Ye(r[1],[0,100],n,!0)]},t.prototype._updateInterval=function(r,n){var a=this.dataZoomModel,i=this._handleEnds,o=this._getViewExtent(),s=a.findRepresentativeAxisProxy().getMinMaxSpan(),l=[0,100];ci(n,i,o,a.get("zoomLock")?"all":r,s.minSpan!=null?Ye(s.minSpan,l,o,!0):null,s.maxSpan!=null?Ye(s.maxSpan,l,o,!0):null);var u=this._range,c=this._range=Vr([Ye(i[0],o,l,!0),Ye(i[1],o,l,!0)]);return!u||u[0]!==c[0]||u[1]!==c[1]},t.prototype._updateView=function(r){var n=this._displayables,a=this._handleEnds,i=Vr(a.slice()),o=this._size;R([0,1],function(d){var v=n.handles[d],p=this._handleHeight;v.attr({scaleX:p/2,scaleY:p/2,x:a[d]+(d?-1:1),y:o[1]/2-p/2})},this),n.filler.setShape({x:i[0],y:0,width:i[1]-i[0],height:o[1]});var s={x:i[0],width:i[1]-i[0]};n.moveHandle&&(n.moveHandle.setShape(s),n.moveZone.setShape(s),n.moveZone.getBoundingRect(),n.moveHandleIcon&&n.moveHandleIcon.attr("x",s.x+s.width/2));for(var l=n.dataShadowSegs,u=[0,i[0],i[1],o[0]],c=0;c<l.length;c++){var h=l[c],f=h.getClipPath();f||(f=new Et,h.setClipPath(f)),f.setShape({x:u[c],y:0,width:u[c+1]-u[c],height:o[1]})}this._updateDataInfo(r)},t.prototype._updateDataInfo=function(r){var n=this.dataZoomModel,a=this._displayables,i=a.handleLabels,o=this._orient,s=["",""];if(n.get("showDetail")){var l=n.findRepresentativeAxisProxy();if(l){var u=l.getAxisModel().axis,c=this._range,h=r?l.calculateDataWindow({start:c[0],end:c[1]}).valueWindow:l.getDataValueWindow();s=[this._formatLabel(h[0],u),this._formatLabel(h[1],u)]}}var f=Vr(this._handleEnds.slice());d.call(this,0),d.call(this,1);function d(v){var p=sf(a.handles[v].parent,this.group),g=mm(v===0?"right":"left",p),m=this._handleWidth/2+NP,_=lo([f[v]+(v===0?-m:m),this._size[1]/2],p);i[v].setStyle({x:_[0],y:_[1],verticalAlign:o===Pi?"middle":g,align:o===Pi?g:"center",text:s[v]})}},t.prototype._formatLabel=function(r,n){var a=this.dataZoomModel,i=a.get("labelFormatter"),o=a.get("labelPrecision");(o==null||o==="auto")&&(o=n.getPixelPrecision());var s=r==null||isNaN(r)?"":n.type==="category"||n.type==="time"?n.scale.getLabel({value:Math.round(r)}):r.toFixed(Math.min(o,20));return xt(i)?i(r,s):Ve(i)?i.replace("{value}",s):s},t.prototype._showDataInfo=function(r){r=this._dragging||r;var n=this._displayables,a=n.handleLabels;a[0].attr("invisible",!r),a[1].attr("invisible",!r),n.moveHandle&&this.api[r?"enterEmphasis":"leaveEmphasis"](n.moveHandle,1)},t.prototype._onDragMove=function(r,n,a,i){this._dragging=!0,cv(i.event);var o=this._displayables.sliderGroup.getLocalTransform(),s=lo([n,a],o,!0),l=this._updateInterval(r,s[0]),u=this.dataZoomModel.get("realtime");this._updateView(!u),l&&u&&this._dispatchZoomAction(!0)},t.prototype._onDragEnd=function(){this._dragging=!1,this._showDataInfo(!1);var r=this.dataZoomModel.get("realtime");!r&&this._dispatchZoomAction(!1)},t.prototype._onClickPanel=function(r){var n=this._size,a=this._displayables.sliderGroup.transformCoordToLocal(r.offsetX,r.offsetY);if(!(a[0]<0||a[0]>n[0]||a[1]<0||a[1]>n[1])){var i=this._handleEnds,o=(i[0]+i[1])/2,s=this._updateInterval("all",a[0]-o);this._updateView(),s&&this._dispatchZoomAction(!1)}},t.prototype._onBrushStart=function(r){var n=r.offsetX,a=r.offsetY;this._brushStart=new en(n,a),this._brushing=!0,this._brushStartTime=+new Date},t.prototype._onBrushEnd=function(r){if(this._brushing){var n=this._displayables.brushRect;if(this._brushing=!1,!!n){n.attr("ignore",!0);var a=n.shape,i=+new Date;if(!(i-this._brushStartTime<200&&Math.abs(a.width)<5)){var o=this._getViewExtent(),s=[0,100];this._range=Vr([Ye(a.x,o,s,!0),Ye(a.x+a.width,o,s,!0)]),this._handleEnds=[a.x,a.x+a.width],this._updateView(),this._dispatchZoomAction(!1)}}}},t.prototype._onBrush=function(r){this._brushing&&(cv(r.event),this._updateBrushRect(r.offsetX,r.offsetY))},t.prototype._updateBrushRect=function(r,n){var a=this._displayables,i=this.dataZoomModel,o=a.brushRect;o||(o=a.brushRect=new Mi({silent:!0,style:i.getModel("brushStyle").getItemStyle()}),a.sliderGroup.add(o)),o.attr("ignore",!1);var s=this._brushStart,l=this._displayables.sliderGroup,u=l.transformCoordToLocal(r,n),c=l.transformCoordToLocal(s.x,s.y),h=this._size;u[0]=Math.max(Math.min(h[0],u[0]),0),o.setShape({x:c[0],y:0,width:u[0]-c[0],height:h[1]})},t.prototype._dispatchZoomAction=function(r){var n=this._range;this.api.dispatchAction({type:"dataZoom",from:this.uid,dataZoomId:this.dataZoomModel.id,animation:r?BP:null,start:n[0],end:n[1]})},t.prototype._findCoordRect=function(){var r,n=L_(this.dataZoomModel).infoList;if(!r&&n.length){var a=n[0].model.coordinateSystem;r=a.getRect&&a.getRect()}if(!r){var i=this.api.getWidth(),o=this.api.getHeight();r={x:i*.2,y:o*.2,width:i*.6,height:o*.6}}return r},t.type="dataZoom.slider",t}(qf);function zP(e){var t={x:"y",y:"x",radius:"angle",angle:"radius"};return t[e]}function Lg(e){return e==="vertical"?"ns-resize":"ew-resize"}const GP=FP;function F_(e){e.registerComponentModel(PP),e.registerComponentView(GP),Kf(e)}function VP(e){oe(B_),oe(F_)}var UP={label:{enabled:!0},decal:{show:!1}},Dg=Nt(),kP={};function HP(e,t){var r=e.getModel("aria");if(!r.get("enabled"))return;var n=vt(UP);fe(n.label,e.getLocaleModel().get("aria"),!1),fe(r.option,n,!1),a(),i();function a(){var u=r.getModel("decal"),c=u.get("show");if(c){var h=ot();e.eachSeries(function(f){if(!f.isColorBySeries()){var d=h.get(f.type);d||(d={},h.set(f.type,d)),Dg(f).scope=d}}),e.eachRawSeries(function(f){if(e.isSeriesFiltered(f))return;if(xt(f.enableAriaDecal)){f.enableAriaDecal();return}var d=f.getData();if(f.isColorBySeries()){var _=Yc(f.ecModel,f.name,kP,e.getSeriesCount()),y=d.getVisual("decal");d.setVisual("decal",x(y,_))}else{var v=f.getRawData(),p={},g=Dg(f).scope;d.each(function(S){var T=d.getRawIndex(S);p[T]=S});var m=v.count();v.each(function(S){var T=p[S],b=v.getName(S)||S+"",w=Yc(f.ecModel,b,g,m),A=d.getItemVisual(T,"decal");d.setItemVisual(T,"decal",x(A,w))})}function x(S,T){var b=S?le(le({},T),S):T;return b.dirty=!0,b}})}}function i(){var u=e.getLocaleModel().get("aria"),c=r.getModel("label");if(c.option=Te(c.option,u),!!c.get("enabled")){var h=t.getZr().dom;if(c.get("description")){h.setAttribute("aria-label",c.get("description"));return}var f=e.getSeriesCount(),d=c.get(["data","maxCount"])||10,v=c.get(["series","maxCount"])||10,p=Math.min(f,v),g;if(!(f<1)){var m=s();if(m){var _=c.get(["general","withTitle"]);g=o(_,{title:m})}else g=c.get(["general","withoutTitle"]);var y=[],x=f>1?c.get(["series","multiple","prefix"]):c.get(["series","single","prefix"]);g+=o(x,{seriesCount:f}),e.eachSeries(function(w,A){if(A<p){var E=void 0,C=w.get("name"),M=C?"withName":"withoutName";E=f>1?c.get(["series","multiple",M]):c.get(["series","single",M]),E=o(E,{seriesId:w.seriesIndex,seriesName:w.get("name"),seriesType:l(w.subType)});var P=w.getData();if(P.count()>d){var L=c.get(["data","partialData"]);E+=o(L,{displayCnt:d})}else E+=c.get(["data","allData"]);for(var I=c.get(["data","separator","middle"]),N=c.get(["data","separator","end"]),F=[],B=0;B<P.count();B++)if(B<d){var k=P.getName(B),z=P.getValues(B),W=c.get(["data",k?"withName":"withoutName"]);F.push(o(W,{name:k,value:z.join(I)}))}E+=F.join(I)+N,y.push(E)}});var S=c.getModel(["series","multiple","separator"]),T=S.get("middle"),b=S.get("end");g+=y.join(T)+b,h.setAttribute("aria-label",g)}}}function o(u,c){if(!Ve(u))return u;var h=u;return R(c,function(f,d){h=h.replace(new RegExp("\\{\\s*"+d+"\\s*\\}","g"),f)}),h}function s(){var u=e.get("title");return u&&u.length&&(u=u[0]),u&&u.text}function l(u){return e.getLocaleModel().get(["series","typeNames"])[u]||"自定义图"}}function WP(e){if(!(!e||!e.aria)){var t=e.aria;t.show!=null&&(t.enabled=t.show),t.label=t.label||{},R(["description","general","series","data"],function(r){t[r]!=null&&(t.label[r]=t[r])})}}function $P(e){e.registerPreprocessor(WP),e.registerVisual(e.PRIORITY.VISUAL.ARIA,HP)}var Mg={value:"eq","<":"lt","<=":"lte",">":"gt",">=":"gte","=":"eq","!=":"ne","<>":"ne"},XP=function(){function e(t){var r=this._condVal=Ve(t)?new RegExp(t):i3(t)?t:null;if(r==null){var n="";ct(n)}}return e.prototype.evaluate=function(t){var r=typeof t;return Ve(r)?this._condVal.test(t):Mr(r)?this._condVal.test(t+""):!1},e}(),jP=function(){function e(){}return e.prototype.evaluate=function(){return this.value},e}(),ZP=function(){function e(){}return e.prototype.evaluate=function(){for(var t=this.children,r=0;r<t.length;r++)if(!t[r].evaluate())return!1;return!0},e}(),YP=function(){function e(){}return e.prototype.evaluate=function(){for(var t=this.children,r=0;r<t.length;r++)if(t[r].evaluate())return!0;return!1},e}(),qP=function(){function e(){}return e.prototype.evaluate=function(){return!this.child.evaluate()},e}(),KP=function(){function e(){}return e.prototype.evaluate=function(){for(var t=!!this.valueParser,r=this.getValue,n=r(this.valueGetterParam),a=t?this.valueParser(n):null,i=0;i<this.subCondList.length;i++)if(!this.subCondList[i].evaluate(t?a:n))return!1;return!0},e}();function rd(e,t){if(e===!0||e===!1){var r=new jP;return r.value=e,r}var n="";return z_(e)||ct(n),e.and?Pg("and",e,t):e.or?Pg("or",e,t):e.not?JP(e,t):QP(e,t)}function Pg(e,t,r){var n=t[e],a="";te(n)||ct(a),n.length||ct(a);var i=e==="and"?new ZP:new YP;return i.children=K(n,function(o){return rd(o,r)}),i.children.length||ct(a),i}function JP(e,t){var r=e.not,n="";z_(r)||ct(n);var a=new qP;return a.child=rd(r,t),a.child||ct(n),a}function QP(e,t){for(var r="",n=t.prepareGetValue(e),a=[],i=It(e),o=e.parser,s=o?Fm(o):null,l=0;l<i.length;l++){var u=i[l];if(!(u==="parser"||t.valueGetterAttrMap.get(u))){var c=Z(Mg,u)?Mg[u]:u,h=e[u],f=s?s(h):h,d=a3(c,f)||c==="reg"&&new XP(f);d||ct(r),a.push(d)}}a.length||ct(r);var v=new KP;return v.valueGetterParam=n,v.valueParser=s,v.getValue=t.getValue,v.subCondList=a,v}function z_(e){return Hr(e)&&!Tm(e)}var e8=function(){function e(t,r){this._cond=rd(t,r)}return e.prototype.evaluate=function(){return this._cond.evaluate()},e}();function t8(e,t){return new e8(e,t)}var r8={type:"echarts:filter",transform:function(e){for(var t=e.upstream,r,n=t8(e.config,{valueGetterAttrMap:ot({dimension:!0}),prepareGetValue:function(s){var l="",u=s.dimension;Z(s,"dimension")||ct(l);var c=t.getDimensionInfo(u);return c||ct(l),{dimIdx:c.index}},getValue:function(s){return t.retrieveValueFromItem(r,s.dimIdx)}}),a=[],i=0,o=t.count();i<o;i++)r=t.getRawDataItem(i),n.evaluate()&&a.push(r);return{data:a}}},n8={type:"echarts:sort",transform:function(e){var t=e.upstream,r=e.config,n="",a=rr(r);a.length||ct(n);var i=[];R(a,function(c){var h=c.dimension,f=c.order,d=c.parser,v=c.incomparable;if(h==null&&ct(n),f!=="asc"&&f!=="desc"&&ct(n),v&&v!=="min"&&v!=="max"){var p="";ct(p)}if(f!=="asc"&&f!=="desc"){var g="";ct(g)}var m=t.getDimensionInfo(h);m||ct(n);var _=d?Fm(d):null;d&&!_&&ct(n),i.push({dimIdx:m.index,parser:_,comparator:new o3(f,v)})});var o=t.sourceFormat;o!==ym&&o!==s3&&ct(n);for(var s=[],l=0,u=t.count();l<u;l++)s.push(t.getRawDataItem(l));return s.sort(function(c,h){for(var f=0;f<i.length;f++){var d=i[f],v=t.retrieveValueFromItem(c,d.dimIdx),p=t.retrieveValueFromItem(h,d.dimIdx);d.parser&&(v=d.parser(v),p=d.parser(p));var g=d.comparator.evaluate(v,p);if(g!==0)return g}return 0}),{data:s}}};function a8(e){e.registerTransform(r8),e.registerTransform(n8)}const gX=Gl({__name:"normalbar",setup(e){const t=ka({}),r=()=>{var a=["唐山","张家港","秦皇岛","承德","廊坊"],i=[90,80,70,80,60],o=[100,100,100,100,100];n(a,i,o)},n=async(a,i,o)=>{t.value={grid:{left:"1%",right:"4%",bottom:"1%",containLabel:!0},xAxis:{show:!1},yAxis:{data:a,show:!1},series:[{name:"",type:"pictorialBar",symbol:"rect",barWidth:"3%",barMaxWidth:"20%",label:{show:!0,position:"insideRight",offset:[0,-20],formatter:function(s){return`在线：{online|${i[s.dataIndex]}}   离线:${o[s.dataIndex]}`},rich:{online:{color:"#2d96ff",fontSize:12}}},itemStyle:{normal:{color:"#515f7a"}},z:-11,symbolRepeat:!0,symbolSize:[6,10],data:o,barGap:50,barCategoryGap:0,animationEasing:"elasticOut"},{name:"",type:"pictorialBar",symbol:"rect",barWidth:"3%",barMaxWidth:100,label:{show:!0,position:"insideLeft",offset:[0,-20],formatter:function(s){return a[s.dataIndex]}},itemStyle:{normal:{barMaxWidth:"20%",barBorderRadius:100,color:"#2d96ff"}},symbolRepeat:!0,symbolSize:[6,10],data:i}]}};return df(()=>{r()}),(a,i)=>{const o=vf("v-chart");return JSON.stringify(t.value)!="{}"?(tr(),zm(o,{key:0,class:"chart",option:t.value},null,8,["option"])):Xa("",!0)}}}),mX=Gl({__name:"bar",setup(e){const t=ka({}),r=()=>{n([{name:"计算任务",value:32.7,unit:"%"},{name:"入库任务",value:24.8,unit:"%"},{name:"数据推送",value:18.2,unit:"%"},{name:"数据整合",value:15.4,unit:"%"},{name:"调控任务",value:11.6,unit:"%"}])},n=async a=>{t.value={tooltip:{show:!0,trigger:"item",padding:[8,15],textStyle:{color:"rgba(255, 255, 255, 1)"}},legend:{show:!1},grid:{left:"22%",right:"12%",top:"5%",bottom:"3%"},xAxis:[{splitLine:{show:!1},type:"value",show:!1,axisLine:{show:!1}}],yAxis:[{show:!0,splitLine:{show:!1},axisLine:{show:!1},type:"category",axisTick:{show:!1},inverse:!0,axisLabel:{show:!1}},{type:"category",inverse:!0,axisTick:"none",axisLine:"none",show:!0,axisLabel:{textStyle:{color:"#fff",fontSize:12},formatter:function(i,o){return i+a[o].unit}},data:a}],series:[{show:!0,name:"",type:"bar",data:a,barWidth:5,showBackground:!0,label:{show:!0,width:200,offset:[0,0],color:"rgba(255, 255, 255, 0.6)",fontFamily:"SourceHanSansCN-Normal",fontSize:12,fontWeight:500,position:"left",formatter:function(i){return i.data.name}},itemStyle:{show:!0,barBorderRadius:[10,10,10,10],color:{type:"linear",colorStops:[{offset:0,color:"rgba(31, 113, 134, 1)"},{offset:1,color:"rgba(47, 232, 226, 1)"}]}},emphasis:{disabled:!0}},{name:"",type:"scatter",emphasis:{scale:!1},symbol:"rect",symbolSize:[3,9],itemStyle:{show:!0,barBorderRadius:[10,10,10,10],color:"#FFF",shadowColor:"rgba(255, 255, 255, 0.5)",shadowBlur:5,borderWidth:1,opacity:1},z:2,data:a,animationDelay:500}]}};return df(()=>{r()}),(a,i)=>{const o=vf("v-chart");return JSON.stringify(t.value)!="{}"?(tr(),zm(o,{key:0,class:"chart",option:t.value},null,8,["option"])):Xa("",!0)}}}),i8={class:"item_content"},o8={key:0,class:"item_title"},s8={class:"title-inner"},l8={class:"item_title_content"},u8=Gl({__name:"item-wrap",props:{title:{default:""}},setup(e){return(t,r)=>{const n=vf("dv-border-box8");return tr(),pr("div",i8,[t.title!==""?(tr(),pr("div",o8,[aa("span",s8,"   "+Hi(t.title)+"   ",1)])):Xa("",!0),l3(n,{style:{width:"100%",height:"calc(100% - 40px)"}},{default:u3(()=>[aa("div",l8,[c3(t.$slots,"default",{},void 0,!0)])]),_:3})])}}}),yX=Ym(u8,[["__scopeId","data-v-ab5f9db1"]]);var Nr=J0.CMD;function Ha(e,t){return Math.abs(e-t)<1e-5}function Ch(e){var t=e.data,r=e.len(),n=[],a,i=0,o=0,s=0,l=0;function u(P,L){a&&a.length>2&&n.push(a),a=[P,L]}function c(P,L,I,N){Ha(P,I)&&Ha(L,N)||a.push(P,L,I,N,I,N)}function h(P,L,I,N,F,B){var k=Math.abs(L-P),z=Math.tan(k/4)*4/3,W=L<P?-1:1,J=Math.cos(P),re=Math.sin(P),Q=Math.cos(L),q=Math.sin(L),Ee=J*F+I,ae=re*B+N,j=Q*F+I,pe=q*B+N,de=F*z*W,ge=B*z*W;a.push(Ee-de*re,ae+ge*J,j+de*q,pe-ge*Q,j,pe)}for(var f,d,v,p,g=0;g<r;){var m=t[g++],_=g===1;switch(_&&(i=t[g],o=t[g+1],s=i,l=o,(m===Nr.L||m===Nr.C||m===Nr.Q)&&(a=[s,l])),m){case Nr.M:i=s=t[g++],o=l=t[g++],u(s,l);break;case Nr.L:f=t[g++],d=t[g++],c(i,o,f,d),i=f,o=d;break;case Nr.C:a.push(t[g++],t[g++],t[g++],t[g++],i=t[g++],o=t[g++]);break;case Nr.Q:f=t[g++],d=t[g++],v=t[g++],p=t[g++],a.push(i+2/3*(f-i),o+2/3*(d-o),v+2/3*(f-v),p+2/3*(d-p),v,p),i=v,o=p;break;case Nr.A:var y=t[g++],x=t[g++],S=t[g++],T=t[g++],b=t[g++],w=t[g++]+b;g+=1;var A=!t[g++];f=Math.cos(b)*S+y,d=Math.sin(b)*T+x,_?(s=f,l=d,u(s,l)):c(i,o,f,d),i=Math.cos(w)*S+y,o=Math.sin(w)*T+x;for(var E=(A?-1:1)*Math.PI/2,C=b;A?C>w:C<w;C+=E){var M=A?Math.max(C+E,w):Math.min(C+E,w);h(C,M,y,x,S,T)}break;case Nr.R:s=i=t[g++],l=o=t[g++],f=s+t[g++],d=l+t[g++],u(f,l),c(f,l,f,d),c(f,d,s,d),c(s,d,s,l),c(s,l,f,l);break;case Nr.Z:a&&c(i,o,s,l),i=s,o=l;break}}return a&&a.length>2&&n.push(a),n}function Lh(e,t,r,n,a,i,o,s,l,u){if(Ha(e,r)&&Ha(t,n)&&Ha(a,o)&&Ha(i,s)){l.push(o,s);return}var c=2/u,h=c*c,f=o-e,d=s-t,v=Math.sqrt(f*f+d*d);f/=v,d/=v;var p=r-e,g=n-t,m=a-o,_=i-s,y=p*p+g*g,x=m*m+_*_;if(y<h&&x<h){l.push(o,s);return}var S=f*p+d*g,T=-f*m-d*_,b=y-S*S,w=x-T*T;if(b<h&&S>=0&&w<h&&T>=0){l.push(o,s);return}var A=[],E=[];Ws(e,r,a,o,.5,A),Ws(t,n,i,s,.5,E),Lh(A[0],E[0],A[1],E[1],A[2],E[2],A[3],E[3],l,u),Lh(A[4],E[4],A[5],E[5],A[6],E[6],A[7],E[7],l,u)}function c8(e,t){var r=Ch(e),n=[];t=t||1;for(var a=0;a<r.length;a++){var i=r[a],o=[],s=i[0],l=i[1];o.push(s,l);for(var u=2;u<i.length;){var c=i[u++],h=i[u++],f=i[u++],d=i[u++],v=i[u++],p=i[u++];Lh(s,l,c,h,f,d,v,p,o,t),s=v,l=p}n.push(o)}return n}function G_(e,t,r){var n=e[t],a=e[1-t],i=Math.abs(n/a),o=Math.ceil(Math.sqrt(i*r)),s=Math.floor(r/o);s===0&&(s=1,o=r);for(var l=[],u=0;u<o;u++)l.push(s);var c=o*s,h=r-c;if(h>0)for(var u=0;u<h;u++)l[u%o]+=1;return l}function Ig(e,t,r){for(var n=e.r0,a=e.r,i=e.startAngle,o=e.endAngle,s=Math.abs(o-i),l=s*a,u=a-n,c=l>Math.abs(u),h=G_([l,u],c?0:1,t),f=(c?s:u)/h.length,d=0;d<h.length;d++)for(var v=(c?u:s)/h[d],p=0;p<h[d];p++){var g={};c?(g.startAngle=i+f*d,g.endAngle=i+f*(d+1),g.r0=n+v*p,g.r=n+v*(p+1)):(g.startAngle=i+v*p,g.endAngle=i+v*(p+1),g.r0=n+f*d,g.r=n+f*(d+1)),g.clockwise=e.clockwise,g.cx=e.cx,g.cy=e.cy,r.push(g)}}function h8(e,t,r){for(var n=e.width,a=e.height,i=n>a,o=G_([n,a],i?0:1,t),s=i?"width":"height",l=i?"height":"width",u=i?"x":"y",c=i?"y":"x",h=e[s]/o.length,f=0;f<o.length;f++)for(var d=e[l]/o[f],v=0;v<o[f];v++){var p={};p[u]=f*h,p[c]=v*d,p[s]=h,p[l]=d,p.x+=e.x,p.y+=e.y,r.push(p)}}function Rg(e,t,r,n){return e*n-r*t}function f8(e,t,r,n,a,i,o,s){var l=r-e,u=n-t,c=o-a,h=s-i,f=Rg(c,h,l,u);if(Math.abs(f)<1e-6)return null;var d=e-a,v=t-i,p=Rg(d,v,c,h)/f;return p<0||p>1?null:new en(p*l+e,p*u+t)}function d8(e,t,r){var n=new en;en.sub(n,r,t),n.normalize();var a=new en;en.sub(a,e,t);var i=a.dot(n);return i}function Ca(e,t){var r=e[e.length-1];r&&r[0]===t[0]&&r[1]===t[1]||e.push(t)}function v8(e,t,r){for(var n=e.length,a=[],i=0;i<n;i++){var o=e[i],s=e[(i+1)%n],l=f8(o[0],o[1],s[0],s[1],t.x,t.y,r.x,r.y);l&&a.push({projPt:d8(l,t,r),pt:l,idx:i})}if(a.length<2)return[{points:e},{points:e}];a.sort(function(g,m){return g.projPt-m.projPt});var u=a[0],c=a[a.length-1];if(c.idx<u.idx){var h=u;u=c,c=h}for(var f=[u.pt.x,u.pt.y],d=[c.pt.x,c.pt.y],v=[f],p=[d],i=u.idx+1;i<=c.idx;i++)Ca(v,e[i].slice());Ca(v,d),Ca(v,f);for(var i=c.idx+1;i<=u.idx+n;i++)Ca(p,e[i%n].slice());return Ca(p,f),Ca(p,d),[{points:v},{points:p}]}function Ng(e){var t=e.points,r=[],n=[];Ml(t,r,n);var a=new Yt(r[0],r[1],n[0]-r[0],n[1]-r[1]),i=a.width,o=a.height,s=a.x,l=a.y,u=new en,c=new en;return i>o?(u.x=c.x=s+i/2,u.y=l,c.y=l+o):(u.y=c.y=l+o/2,u.x=s,c.x=s+i),v8(t,u,c)}function rl(e,t,r,n){if(r===1)n.push(t);else{var a=Math.floor(r/2),i=e(t);rl(e,i[0],a,n),rl(e,i[1],r-a,n)}return n}function p8(e,t){for(var r=[],n=0;n<t;n++)r.push(pf(e));return r}function g8(e,t){t.setStyle(e.style),t.z=e.z,t.z2=e.z2,t.zlevel=e.zlevel}function m8(e){for(var t=[],r=0;r<e.length;)t.push([e[r++],e[r++]]);return t}function y8(e,t){var r=[],n=e.shape,a;switch(e.type){case"rect":h8(n,t,r),a=Et;break;case"sector":Ig(n,t,r),a=da;break;case"circle":Ig({r0:0,r:n.r,startAngle:0,endAngle:Math.PI*2,cx:n.cx,cy:n.cy},t,r),a=da;break;default:var i=e.getComputedTransform(),o=i?Math.sqrt(Math.max(i[0]*i[0]+i[1]*i[1],i[2]*i[2]+i[3]*i[3])):1,s=K(c8(e.getUpdatedPathProxy(),o),function(m){return m8(m)}),l=s.length;if(l===0)rl(Ng,{points:s[0]},t,r);else if(l===t)for(var u=0;u<l;u++)r.push({points:s[u]});else{var c=0,h=K(s,function(m){var _=[],y=[];Ml(m,_,y);var x=(y[1]-_[1])*(y[0]-_[0]);return c+=x,{poly:m,area:x}});h.sort(function(m,_){return _.area-m.area});for(var f=t,u=0;u<l;u++){var d=h[u];if(f<=0)break;var v=u===l-1?f:Math.ceil(d.area/c*t);v<0||(rl(Ng,{points:d.poly},v,r),f-=v)}}a=on;break}if(!a)return p8(e,t);for(var p=[],u=0;u<r.length;u++){var g=new a;g.setShape(r[u]),g8(e,g),p.push(g)}return p}function _8(e,t){var r=e.length,n=t.length;if(r===n)return[e,t];for(var a=[],i=[],o=r<n?e:t,s=Math.min(r,n),l=Math.abs(n-r)/6,u=(s-2)/6,c=Math.ceil(l/u)+1,h=[o[0],o[1]],f=l,d=2;d<s;){var v=o[d-2],p=o[d-1],g=o[d++],m=o[d++],_=o[d++],y=o[d++],x=o[d++],S=o[d++];if(f<=0){h.push(g,m,_,y,x,S);continue}for(var T=Math.min(f,c-1)+1,b=1;b<=T;b++){var w=b/T;Ws(v,g,_,x,w,a),Ws(p,m,y,S,w,i),v=a[3],p=i[3],h.push(a[1],i[1],a[2],i[2],v,p),g=a[5],m=i[5],_=a[6],y=i[6]}f-=T-1}return o===e?[h,t]:[e,h]}function Og(e,t){for(var r=e.length,n=e[r-2],a=e[r-1],i=[],o=0;o<t.length;)i[o++]=n,i[o++]=a;return i}function x8(e,t){for(var r,n,a,i=[],o=[],s=0;s<Math.max(e.length,t.length);s++){var l=e[s],u=t[s],c=void 0,h=void 0;l?u?(r=_8(l,u),c=r[0],h=r[1],n=c,a=h):(h=Og(a||l,l),c=l):(c=Og(n||u,u),h=u),i.push(c),o.push(h)}return[i,o]}function Bg(e){for(var t=0,r=0,n=0,a=e.length,i=0,o=a-2;i<a;o=i,i+=2){var s=e[o],l=e[o+1],u=e[i],c=e[i+1],h=s*c-u*l;t+=h,r+=(s+u)*h,n+=(l+c)*h}return t===0?[e[0]||0,e[1]||0]:[r/t/3,n/t/3,t]}function S8(e,t,r,n){for(var a=(e.length-2)/6,i=1/0,o=0,s=e.length,l=s-2,u=0;u<a;u++){for(var c=u*6,h=0,f=0;f<s;f+=2){var d=f===0?c:(c+f-2)%l+2,v=e[d]-r[0],p=e[d+1]-r[1],g=t[f]-n[0],m=t[f+1]-n[1],_=g-v,y=m-p;h+=_*_+y*y}h<i&&(i=h,o=u)}return o}function T8(e){for(var t=[],r=e.length,n=0;n<r;n+=2)t[n]=e[r-n-2],t[n+1]=e[r-n-1];return t}function b8(e,t,r,n){for(var a=[],i,o=0;o<e.length;o++){var s=e[o],l=t[o],u=Bg(s),c=Bg(l);i==null&&(i=u[2]<0!=c[2]<0);var h=[],f=[],d=0,v=1/0,p=[],g=s.length;i&&(s=T8(s));for(var m=S8(s,l,u,c)*6,_=g-2,y=0;y<_;y+=2){var x=(m+y)%_+2;h[y+2]=s[x]-u[0],h[y+3]=s[x+1]-u[1]}if(h[0]=s[m]-u[0],h[1]=s[m+1]-u[1],r>0)for(var S=n/r,T=-n/2;T<=n/2;T+=S){for(var b=Math.sin(T),w=Math.cos(T),A=0,y=0;y<s.length;y+=2){var E=h[y],C=h[y+1],M=l[y]-c[0],P=l[y+1]-c[1],L=M*w-P*b,I=M*b+P*w;p[y]=L,p[y+1]=I;var N=L-E,F=I-C;A+=N*N+F*F}if(A<v){v=A,d=T;for(var B=0;B<p.length;B++)f[B]=p[B]}}else for(var k=0;k<g;k+=2)f[k]=l[k]-c[0],f[k+1]=l[k+1]-c[1];a.push({from:h,to:f,fromCp:u,toCp:c,rotation:-d})}return a}function nl(e){return e.__isCombineMorphing}var V_="__mOriginal_";function al(e,t,r){var n=V_+t,a=e[n]||e[t];e[n]||(e[n]=e[t]);var i=r.replace,o=r.after,s=r.before;e[t]=function(){var l=arguments,u;return s&&s.apply(this,l),i?u=i.apply(this,l):u=a.apply(this,l),o&&o.apply(this,l),u}}function to(e,t){var r=V_+t;e[r]&&(e[t]=e[r],e[r]=null)}function Fg(e,t){for(var r=0;r<e.length;r++)for(var n=e[r],a=0;a<n.length;){var i=n[a],o=n[a+1];n[a++]=t[0]*i+t[2]*o+t[4],n[a++]=t[1]*i+t[3]*o+t[5]}}function U_(e,t){var r=e.getUpdatedPathProxy(),n=t.getUpdatedPathProxy(),a=x8(Ch(r),Ch(n)),i=a[0],o=a[1],s=e.getComputedTransform(),l=t.getComputedTransform();function u(){this.transform=null}s&&Fg(i,s),l&&Fg(o,l),al(t,"updateTransform",{replace:u}),t.transform=null;var c=b8(i,o,10,Math.PI),h=[];al(t,"buildPath",{replace:function(f){for(var d=t.__morphT,v=1-d,p=[],g=0;g<c.length;g++){var m=c[g],_=m.from,y=m.to,x=m.rotation*d,S=m.fromCp,T=m.toCp,b=Math.sin(x),w=Math.cos(x);h3(p,S,T,d);for(var A=0;A<_.length;A+=2){var E=_[A],C=_[A+1],M=y[A],P=y[A+1],L=E*v+M*d,I=C*v+P*d;h[A]=L*w-I*b+p[0],h[A+1]=L*b+I*w+p[1]}var N=h[0],F=h[1];f.moveTo(N,F);for(var A=2;A<_.length;){var M=h[A++],P=h[A++],B=h[A++],k=h[A++],z=h[A++],W=h[A++];N===M&&F===P&&B===z&&k===W?f.lineTo(z,W):f.bezierCurveTo(M,P,B,k,z,W),N=z,F=W}}}})}function nd(e,t,r){if(!e||!t)return t;var n=r.done,a=r.during;U_(e,t),t.__morphT=0;function i(){to(t,"buildPath"),to(t,"updateTransform"),t.__morphT=-1,t.createPathProxy(),t.dirtyShape()}return t.animateTo({__morphT:1},Te({during:function(o){t.dirtyShape(),a&&a(o)},done:function(){i(),n&&n()}},r)),t}function w8(e,t,r,n,a,i){var o=16;e=a===r?0:Math.round(32767*(e-r)/(a-r)),t=i===n?0:Math.round(32767*(t-n)/(i-n));for(var s=0,l,u=(1<<o)/2;u>0;u/=2){var c=0,h=0;(e&u)>0&&(c=1),(t&u)>0&&(h=1),s+=u*u*(3*c^h),h===0&&(c===1&&(e=u-1-e,t=u-1-t),l=e,e=t,t=l)}return s}function il(e){var t=1/0,r=1/0,n=-1/0,a=-1/0,i=K(e,function(s){var l=s.getBoundingRect(),u=s.getComputedTransform(),c=l.x+l.width/2+(u?u[4]:0),h=l.y+l.height/2+(u?u[5]:0);return t=Math.min(c,t),r=Math.min(h,r),n=Math.max(c,n),a=Math.max(h,a),[c,h]}),o=K(i,function(s,l){return{cp:s,z:w8(s[0],s[1],t,r,n,a),path:e[l]}});return o.sort(function(s,l){return s.z-l.z}).map(function(s){return s.path})}function k_(e){return y8(e.path,e.count)}function Dh(){return{fromIndividuals:[],toIndividuals:[],count:0}}function A8(e,t,r){var n=[];function a(S){for(var T=0;T<S.length;T++){var b=S[T];nl(b)?a(b.childrenRef()):b instanceof Gt&&n.push(b)}}a(e);var i=n.length;if(!i)return Dh();var o=r.dividePath||k_,s=o({path:t,count:i});if(s.length!==i)return console.error("Invalid morphing: unmatched splitted path"),Dh();n=il(n),s=il(s);for(var l=r.done,u=r.during,c=r.individualDelay,h=new j0,f=0;f<i;f++){var d=n[f],v=s[f];v.parent=t,v.copyTransform(h),c||U_(d,v)}t.__isCombineMorphing=!0,t.childrenRef=function(){return s};function p(S){for(var T=0;T<s.length;T++)s[T].addSelfToZr(S)}al(t,"addSelfToZr",{after:function(S){p(S)}}),al(t,"removeSelfFromZr",{after:function(S){for(var T=0;T<s.length;T++)s[T].removeSelfFromZr(S)}});function g(){t.__isCombineMorphing=!1,t.__morphT=-1,t.childrenRef=null,to(t,"addSelfToZr"),to(t,"removeSelfFromZr")}var m=s.length;if(c)for(var _=m,y=function(){_--,_===0&&(g(),l&&l())},f=0;f<m;f++){var x=c?Te({delay:(r.delay||0)+c(f,m,n[f],s[f]),done:y},r):r;nd(n[f],s[f],x)}else t.__morphT=0,t.animateTo({__morphT:1},Te({during:function(S){for(var T=0;T<m;T++){var b=s[T];b.__morphT=t.__morphT,b.dirtyShape()}u&&u(S)},done:function(){g();for(var S=0;S<e.length;S++)to(e[S],"updateTransform");l&&l()}},r));return t.__zr&&p(t.__zr),{fromIndividuals:n,toIndividuals:s,count:m}}function E8(e,t,r){var n=t.length,a=[],i=r.dividePath||k_;function o(d){for(var v=0;v<d.length;v++){var p=d[v];nl(p)?o(p.childrenRef()):p instanceof Gt&&a.push(p)}}if(nl(e)){o(e.childrenRef());var s=a.length;if(s<n)for(var l=0,u=s;u<n;u++)a.push(pf(a[l++%s]));a.length=n}else{a=i({path:e,count:n});for(var c=e.getComputedTransform(),u=0;u<a.length;u++)a[u].setLocalTransform(c);if(a.length!==n)return console.error("Invalid morphing: unmatched splitted path"),Dh()}a=il(a),t=il(t);for(var h=r.individualDelay,u=0;u<n;u++){var f=h?Te({delay:(r.delay||0)+h(u,n,a[u],t[u])},r):r;nd(a[u],t[u],f)}return{fromIndividuals:a,toIndividuals:t,count:t.length}}function zg(e){return te(e[0])}function Gg(e,t){for(var r=[],n=e.length,a=0;a<n;a++)r.push({one:e[a],many:[]});for(var a=0;a<t.length;a++){var i=t[a].length,o=void 0;for(o=0;o<i;o++)r[o%n].many.push(t[a][o])}for(var s=0,a=n-1;a>=0;a--)if(!r[a].many.length){var l=r[s].many;if(l.length<=1)if(s)s=0;else return r;var i=l.length,u=Math.ceil(i/2);r[a].many=l.slice(u,i),r[s].many=l.slice(0,u),s++}return r}var C8={clone:function(e){for(var t=[],r=1-Math.pow(1-e.path.style.opacity,1/e.count),n=0;n<e.count;n++){var a=pf(e.path);a.setStyle("opacity",r),t.push(a)}return t},split:null};function cc(e,t,r,n,a,i){if(!e.length||!t.length)return;var o=Oo("update",n,a);if(!(o&&o.duration>0))return;var s=n.getModel("universalTransition").get("delay"),l=Object.assign({setToFinal:!0},o),u,c;zg(e)&&(u=e,c=t),zg(t)&&(u=t,c=e);function h(m,_,y,x,S){var T=m.many,b=m.one;if(T.length===1&&!S){var w=_?T[0]:b,A=_?b:T[0];if(nl(w))h({many:[w],one:A},!0,y,x,!0);else{var E=s?Te({delay:s(y,x)},l):l;nd(w,A,E),i(w,A,w,A,E)}}else for(var C=Te({dividePath:C8[r],individualDelay:s&&function(F,B,k,z){return s(F+y,x)}},l),M=_?A8(T,b,C):E8(b,T,C),P=M.fromIndividuals,L=M.toIndividuals,I=P.length,N=0;N<I;N++){var E=s?Te({delay:s(N,I)},l):l;i(P[N],L[N],_?T[N]:m.one,_?m.one:T[N],E)}}for(var f=u?u===e:e.length>t.length,d=u?Gg(c,u):Gg(f?t:e,[f?e:t]),v=0,p=0;p<d.length;p++)v+=d[p].many.length;for(var g=0,p=0;p<d.length;p++)h(d[p],f,g,v),g+=d[p].many.length}function Jn(e){if(!e)return[];if(te(e)){for(var t=[],r=0;r<e.length;r++)t.push(Jn(e[r]));return t}var n=[];return e.traverse(function(a){a instanceof Gt&&!a.disableMorphing&&!a.invisible&&!a.ignore&&n.push(a)}),n}var H_=1e4,L8=Nt();function D8(e){for(var t=e.dimensions,r=0;r<t.length;r++){var n=e.getDimensionInfo(t[r]);if(n&&n.otherDims.itemGroupId===0)return t[r]}}function Vg(e){var t=[];return R(e,function(r){var n=r.data;if(!(n.count()>H_))for(var a=n.getIndices(),i=D8(n),o=0;o<a.length;o++)t.push({dataGroupId:r.dataGroupId,data:n,dim:r.dim||i,divide:r.divide,dataIndex:o})}),t}function hc(e,t,r){e.traverse(function(n){n instanceof Gt&&ar(n,{style:{opacity:0}},t,{dataIndex:r,isFrom:!0})})}function fc(e){if(e.parent){var t=e.getComputedTransform();e.setLocalTransform(t),e.parent.remove(e)}}function La(e){e.stopAnimation(),e.isGroup&&e.traverse(function(t){t.stopAnimation()})}function M8(e,t,r){var n=Oo("update",r,t);n&&e.traverse(function(a){if(a instanceof Io){var i=f3(a);i&&a.animateFrom({style:i},n)}})}function P8(e,t){var r=e.length;if(r!==t.length)return!1;for(var n=0;n<r;n++){var a=e[n],i=t[n];if(a.data.getId(a.dataIndex)!==i.data.getId(i.dataIndex))return!1}return!0}function W_(e,t,r){var n=Vg(e),a=Vg(t);function i(m,_,y,x,S){(y||m)&&_.animateFrom({style:y&&y!==m?le(le({},y.style),m.style):m.style},S)}function o(m){for(var _=0;_<m.length;_++)if(m[_].dim)return m[_].dim}var s=o(n),l=o(a),u=!1;function c(m,_){return function(y){var x=y.data,S=y.dataIndex;if(_)return x.getId(S);var T=y.dataGroupId,b=m?s||l:l||s,w=b&&x.getDimensionInfo(b),A=w&&w.ordinalMeta;if(w){var E=x.get(w.name,S);return A&&A.categories[E]||E+""}var C=x.getRawDataItem(S);return C&&C.groupId?C.groupId+"":T||x.getId(S)}}var h=P8(n,a),f={};if(!h)for(var d=0;d<a.length;d++){var v=a[d],p=v.data.getItemGraphicEl(v.dataIndex);p&&(f[p.id]=!0)}function g(m,_){var y=n[_],x=a[m],S=x.data.hostModel,T=y.data.getItemGraphicEl(y.dataIndex),b=x.data.getItemGraphicEl(x.dataIndex);if(T===b){b&&M8(b,x.dataIndex,S);return}T&&f[T.id]||b&&(La(b),T?(La(T),fc(T),u=!0,cc(Jn(T),Jn(b),x.divide,S,m,i)):hc(b,S,m))}new Dn(n,a,c(!0,h),c(!1,h),null,"multiple").update(g).updateManyToOne(function(m,_){var y=a[m],x=y.data,S=x.hostModel,T=x.getItemGraphicEl(y.dataIndex),b=Vt(K(_,function(w){return n[w].data.getItemGraphicEl(n[w].dataIndex)}),function(w){return w&&w!==T&&!f[w.id]});T&&(La(T),b.length?(R(b,function(w){La(w),fc(w)}),u=!0,cc(Jn(b),Jn(T),y.divide,S,m,i)):hc(T,S,y.dataIndex))}).updateOneToMany(function(m,_){var y=n[_],x=y.data.getItemGraphicEl(y.dataIndex);if(!(x&&f[x.id])){var S=Vt(K(m,function(b){return a[b].data.getItemGraphicEl(a[b].dataIndex)}),function(b){return b&&b!==x}),T=a[m[0]].data.hostModel;S.length&&(R(S,function(b){return La(b)}),x?(La(x),fc(x),u=!0,cc(Jn(x),Jn(S),y.divide,T,m[0],i)):R(S,function(b){return hc(b,T,m[0])}))}}).updateManyToMany(function(m,_){new Dn(_,m,function(y){return n[y].data.getId(n[y].dataIndex)},function(y){return a[y].data.getId(a[y].dataIndex)}).update(function(y,x){g(m[y],_[x])}).execute()}).execute(),u&&R(t,function(m){var _=m.data,y=_.hostModel,x=y&&r.getViewOfSeriesModel(y),S=Oo("update",y,0);x&&y.isAnimationEnabled()&&S&&S.duration>0&&x.group.traverse(function(T){T instanceof Gt&&!T.animators.length&&T.animateFrom({style:{opacity:0}},S)})})}function Ug(e){var t=e.getModel("universalTransition").get("seriesKey");return t||e.id}function kg(e){return te(e)?e.sort().join(","):e}function xn(e){if(e.hostModel)return e.hostModel.getModel("universalTransition").get("divideShape")}function I8(e,t){var r=ot(),n=ot(),a=ot();return R(e.oldSeries,function(i,o){var s=e.oldDataGroupIds[o],l=e.oldData[o],u=Ug(i),c=kg(u);n.set(c,{dataGroupId:s,data:l}),te(u)&&R(u,function(h){a.set(h,{key:c,dataGroupId:s,data:l})})}),R(t.updatedSeries,function(i){if(i.isUniversalTransitionEnabled()&&i.isAnimationEnabled()){var o=i.get("dataGroupId"),s=i.getData(),l=Ug(i),u=kg(l),c=n.get(u);if(c)r.set(u,{oldSeries:[{dataGroupId:c.dataGroupId,divide:xn(c.data),data:c.data}],newSeries:[{dataGroupId:o,divide:xn(s),data:s}]});else if(te(l)){var h=[];R(l,function(v){var p=n.get(v);p.data&&h.push({dataGroupId:p.dataGroupId,divide:xn(p.data),data:p.data})}),h.length&&r.set(u,{oldSeries:h,newSeries:[{dataGroupId:o,data:s,divide:xn(s)}]})}else{var f=a.get(l);if(f){var d=r.get(f.key);d||(d={oldSeries:[{dataGroupId:f.dataGroupId,data:f.data,divide:xn(f.data)}],newSeries:[]},r.set(f.key,d)),d.newSeries.push({dataGroupId:o,data:s,divide:xn(s)})}}}}),r}function Hg(e,t){for(var r=0;r<e.length;r++){var n=t.seriesIndex!=null&&t.seriesIndex===e[r].seriesIndex||t.seriesId!=null&&t.seriesId===e[r].id;if(n)return r}}function R8(e,t,r,n){var a=[],i=[];R(rr(e.from),function(o){var s=Hg(t.oldSeries,o);s>=0&&a.push({dataGroupId:t.oldDataGroupIds[s],data:t.oldData[s],divide:xn(t.oldData[s]),dim:o.dimension})}),R(rr(e.to),function(o){var s=Hg(r.updatedSeries,o);if(s>=0){var l=r.updatedSeries[s].getData();i.push({dataGroupId:t.oldDataGroupIds[s],data:l,divide:xn(l),dim:o.dimension})}}),a.length>0&&i.length>0&&W_(a,i,n)}function N8(e){e.registerUpdateLifecycle("series:beforeupdate",function(t,r,n){R(rr(n.seriesTransition),function(a){R(rr(a.to),function(i){for(var o=n.updatedSeries,s=0;s<o.length;s++)(i.seriesIndex!=null&&i.seriesIndex===o[s].seriesIndex||i.seriesId!=null&&i.seriesId===o[s].id)&&(o[s][mu]=!0)})})}),e.registerUpdateLifecycle("series:transition",function(t,r,n){var a=L8(r);if(a.oldSeries&&n.updatedSeries&&n.optionChanged){var i=n.seriesTransition;if(i)R(rr(i),function(d){R8(d,a,n,r)});else{var o=I8(a,n);R(o.keys(),function(d){var v=o.get(d);W_(v.oldSeries,v.newSeries,r)})}R(n.updatedSeries,function(d){d[mu]&&(d[mu]=!1)})}for(var s=t.getSeries(),l=a.oldSeries=[],u=a.oldDataGroupIds=[],c=a.oldData=[],h=0;h<s.length;h++){var f=s[h].getData();f.count()<H_&&(l.push(s[h]),u.push(s[h].get("dataGroupId")),c.push(f))}})}oe([Gm]);oe([D4]);oe([d3,v3,p3,z4,tb,g3,Ib,vw,Uw,qw,sA,hE,zE,KE,mC,m3,OC,$C,a5,f5,A5,cL]);oe(y3);oe(WL);oe(_3);oe(sD);oe(qy);oe(vD);oe(bD);oe(bM);oe(x3);oe(hf);oe(UM);oe(S3);oe(rP);oe(T3);oe(cP);oe(yP);oe(b3);oe(VP);oe(B_);oe(F_);oe(w3);oe(A3);oe(E3);oe($P);oe(a8);oe(Vm);oe(N8);oe(qm);oe([Gm,Vm]);oe(qm);function Wg(e,t,r){typeof t=="object"&&(r=t,t=null);var n=this,a;if(!(e instanceof Function)){a=[];for(var i in e)e.hasOwnProperty(i)&&a.push(i)}var o=function(l){if(n.apply(this,arguments),e instanceof Function?$g(this,e.call(this,l)):O8(this,e,a),this.constructor===o)for(var u=o.__initializers__,c=0;c<u.length;c++)u[c].apply(this,arguments)};o.__super__=n,n.__initializers__?o.__initializers__=n.__initializers__.slice():o.__initializers__=[],t&&o.__initializers__.push(t);var s=function(){};return s.prototype=n.prototype,o.prototype=new s,o.prototype.constructor=o,$g(o.prototype,r),o.extend=n.extend,o.derive=n.extend,o}function $g(e,t){if(t)for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])}function O8(e,t,r){for(var n=0;n<r.length;n++){var a=r[n];e[a]=t[a]}}const B8={extend:Wg,derive:Wg};function F8(e,t){this.action=e,this.context=t}var z8={trigger:function(e){if(this.hasOwnProperty("__handlers__")&&this.__handlers__.hasOwnProperty(e)){var t=this.__handlers__[e],r=t.length,n=-1,a=arguments;switch(a.length){case 1:for(;++n<r;)t[n].action.call(t[n].context);return;case 2:for(;++n<r;)t[n].action.call(t[n].context,a[1]);return;case 3:for(;++n<r;)t[n].action.call(t[n].context,a[1],a[2]);return;case 4:for(;++n<r;)t[n].action.call(t[n].context,a[1],a[2],a[3]);return;case 5:for(;++n<r;)t[n].action.call(t[n].context,a[1],a[2],a[3],a[4]);return;default:for(;++n<r;)t[n].action.apply(t[n].context,Array.prototype.slice.call(a,1));return}}},on:function(e,t,r){if(!(!e||!t)){var n=this.__handlers__||(this.__handlers__={});if(!n[e])n[e]=[];else if(this.has(e,t))return;var a=new F8(t,r||this);return n[e].push(a),this}},once:function(e,t,r){if(!e||!t)return;var n=this;function a(){n.off(e,a),t.apply(this,arguments)}return this.on(e,a,r)},before:function(e,t,r){if(!(!e||!t))return e="before"+e,this.on(e,t,r)},after:function(e,t,r){if(!(!e||!t))return e="after"+e,this.on(e,t,r)},success:function(e,t){return this.once("success",e,t)},error:function(e,t){return this.once("error",e,t)},off:function(e,t){var r=this.__handlers__||(this.__handlers__={});if(!t){r[e]=[];return}if(r[e]){for(var n=r[e],a=[],i=0;i<n.length;i++)t&&n[i].action!==t&&a.push(n[i]);r[e]=a}return this},has:function(e,t){var r=this.__handlers__;if(!r||!r[e])return!1;for(var n=r[e],a=0;a<n.length;a++)if(n[a].action===t)return!0}};const ad=z8;var G8=0,V8=Array.prototype,U8=V8.forEach,Zi={genGUID:function(){return++G8},relative2absolute:function(e,t){if(!t||e.match(/^\//))return e;for(var r=e.split("/"),n=t.split("/"),a=r[0];a==="."||a==="..";)a===".."&&n.pop(),r.shift(),a=r[0];return n.join("/")+"/"+r.join("/")},extend:function(e,t){if(t)for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);return e},defaults:function(e,t){if(t)for(var r in t)e[r]===void 0&&(e[r]=t[r]);return e},extendWithPropList:function(e,t,r){if(t)for(var n=0;n<r.length;n++){var a=r[n];e[a]=t[a]}return e},defaultsWithPropList:function(e,t,r){if(t)for(var n=0;n<r.length;n++){var a=r[n];e[a]==null&&(e[a]=t[a])}return e},each:function(e,t,r){if(e&&t)if(e.forEach&&e.forEach===U8)e.forEach(t,r);else if(e.length===+e.length)for(var n=0,a=e.length;n<a;n++)t.call(r,e[n],n,e);else for(var i in e)e.hasOwnProperty(i)&&t.call(r,e[i],i,e)},isObject:function(e){return e===Object(e)},isArray:function(e){return Array.isArray(e)},isArrayLike:function(e){return e?e.length===+e.length:!1},clone:function(e){if(Zi.isObject(e)){if(Zi.isArray(e))return e.slice();if(Zi.isArrayLike(e)){for(var t=new e.constructor(e.length),r=0;r<e.length;r++)t[r]=e[r];return t}else return Zi.extend({},e)}else return e}};const Pt=Zi;var Xl=function(){this.__uid__=Pt.genGUID()};Xl.__initializers__=[function(e){Pt.extend(this,e)}];Pt.extend(Xl,B8);Pt.extend(Xl.prototype,ad);const qt=Xl;var Xg=["OES_texture_float","OES_texture_half_float","OES_texture_float_linear","OES_texture_half_float_linear","OES_standard_derivatives","OES_vertex_array_object","OES_element_index_uint","WEBGL_compressed_texture_s3tc","WEBGL_depth_texture","EXT_texture_filter_anisotropic","EXT_shader_texture_lod","WEBGL_draw_buffers","EXT_frag_depth","EXT_sRGB","ANGLE_instanced_arrays"],jg=["MAX_TEXTURE_SIZE","MAX_CUBE_MAP_TEXTURE_SIZE"];function k8(e){for(var t={},r={},n=0;n<Xg.length;n++){var a=Xg[n];o(a)}for(var n=0;n<jg.length;n++){var i=jg[n];r[i]=e.getParameter(e[i])}this.getExtension=function(s){return s in t||o(s),t[s]},this.getParameter=function(s){return r[s]};function o(s){if(e.getExtension){var l=e.getExtension(s);l||(l=e.getExtension("MOZ_"+s)),l||(l=e.getExtension("WEBKIT_"+s)),t[s]=l}}}const G={DEPTH_BUFFER_BIT:256,STENCIL_BUFFER_BIT:1024,COLOR_BUFFER_BIT:16384,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,ZERO:0,ONE:1,SRC_COLOR:768,ONE_MINUS_SRC_COLOR:769,SRC_ALPHA:770,ONE_MINUS_SRC_ALPHA:771,DST_ALPHA:772,ONE_MINUS_DST_ALPHA:773,DST_COLOR:774,ONE_MINUS_DST_COLOR:775,SRC_ALPHA_SATURATE:776,FUNC_ADD:32774,BLEND_EQUATION:32777,BLEND_EQUATION_RGB:32777,BLEND_EQUATION_ALPHA:34877,FUNC_SUBTRACT:32778,FUNC_REVERSE_SUBTRACT:32779,BLEND_DST_RGB:32968,BLEND_SRC_RGB:32969,BLEND_DST_ALPHA:32970,BLEND_SRC_ALPHA:32971,CONSTANT_COLOR:32769,ONE_MINUS_CONSTANT_COLOR:32770,CONSTANT_ALPHA:32771,ONE_MINUS_CONSTANT_ALPHA:32772,BLEND_COLOR:32773,ARRAY_BUFFER:34962,ELEMENT_ARRAY_BUFFER:34963,ARRAY_BUFFER_BINDING:34964,ELEMENT_ARRAY_BUFFER_BINDING:34965,STREAM_DRAW:35040,STATIC_DRAW:35044,DYNAMIC_DRAW:35048,BUFFER_SIZE:34660,BUFFER_USAGE:34661,CURRENT_VERTEX_ATTRIB:34342,FRONT:1028,BACK:1029,FRONT_AND_BACK:1032,CULL_FACE:2884,BLEND:3042,DITHER:3024,STENCIL_TEST:2960,DEPTH_TEST:2929,SCISSOR_TEST:3089,POLYGON_OFFSET_FILL:32823,SAMPLE_ALPHA_TO_COVERAGE:32926,SAMPLE_COVERAGE:32928,NO_ERROR:0,INVALID_ENUM:1280,INVALID_VALUE:1281,INVALID_OPERATION:1282,OUT_OF_MEMORY:1285,CW:2304,CCW:2305,LINE_WIDTH:2849,ALIASED_POINT_SIZE_RANGE:33901,ALIASED_LINE_WIDTH_RANGE:33902,CULL_FACE_MODE:2885,FRONT_FACE:2886,DEPTH_RANGE:2928,DEPTH_WRITEMASK:2930,DEPTH_CLEAR_VALUE:2931,DEPTH_FUNC:2932,STENCIL_CLEAR_VALUE:2961,STENCIL_FUNC:2962,STENCIL_FAIL:2964,STENCIL_PASS_DEPTH_FAIL:2965,STENCIL_PASS_DEPTH_PASS:2966,STENCIL_REF:2967,STENCIL_VALUE_MASK:2963,STENCIL_WRITEMASK:2968,STENCIL_BACK_FUNC:34816,STENCIL_BACK_FAIL:34817,STENCIL_BACK_PASS_DEPTH_FAIL:34818,STENCIL_BACK_PASS_DEPTH_PASS:34819,STENCIL_BACK_REF:36003,STENCIL_BACK_VALUE_MASK:36004,STENCIL_BACK_WRITEMASK:36005,VIEWPORT:2978,SCISSOR_BOX:3088,COLOR_CLEAR_VALUE:3106,COLOR_WRITEMASK:3107,UNPACK_ALIGNMENT:3317,PACK_ALIGNMENT:3333,MAX_TEXTURE_SIZE:3379,MAX_VIEWPORT_DIMS:3386,SUBPIXEL_BITS:3408,RED_BITS:3410,GREEN_BITS:3411,BLUE_BITS:3412,ALPHA_BITS:3413,DEPTH_BITS:3414,STENCIL_BITS:3415,POLYGON_OFFSET_UNITS:10752,POLYGON_OFFSET_FACTOR:32824,TEXTURE_BINDING_2D:32873,SAMPLE_BUFFERS:32936,SAMPLES:32937,SAMPLE_COVERAGE_VALUE:32938,SAMPLE_COVERAGE_INVERT:32939,COMPRESSED_TEXTURE_FORMATS:34467,DONT_CARE:4352,FASTEST:4353,NICEST:4354,GENERATE_MIPMAP_HINT:33170,BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,INT:5124,UNSIGNED_INT:5125,FLOAT:5126,DEPTH_COMPONENT:6402,ALPHA:6406,RGB:6407,RGBA:6408,LUMINANCE:6409,LUMINANCE_ALPHA:6410,UNSIGNED_SHORT_4_4_4_4:32819,UNSIGNED_SHORT_5_5_5_1:32820,UNSIGNED_SHORT_5_6_5:33635,FRAGMENT_SHADER:35632,VERTEX_SHADER:35633,MAX_VERTEX_ATTRIBS:34921,MAX_VERTEX_UNIFORM_VECTORS:36347,MAX_VARYING_VECTORS:36348,MAX_COMBINED_TEXTURE_IMAGE_UNITS:35661,MAX_VERTEX_TEXTURE_IMAGE_UNITS:35660,MAX_TEXTURE_IMAGE_UNITS:34930,MAX_FRAGMENT_UNIFORM_VECTORS:36349,SHADER_TYPE:35663,DELETE_STATUS:35712,LINK_STATUS:35714,VALIDATE_STATUS:35715,ATTACHED_SHADERS:35717,ACTIVE_UNIFORMS:35718,ACTIVE_ATTRIBUTES:35721,SHADING_LANGUAGE_VERSION:35724,CURRENT_PROGRAM:35725,NEVER:512,LESS:513,EQUAL:514,LEQUAL:515,GREATER:516,NOTEQUAL:517,GEQUAL:518,ALWAYS:519,KEEP:7680,REPLACE:7681,INCR:7682,DECR:7683,INVERT:5386,INCR_WRAP:34055,DECR_WRAP:34056,VENDOR:7936,RENDERER:7937,VERSION:7938,NEAREST:9728,LINEAR:9729,NEAREST_MIPMAP_NEAREST:9984,LINEAR_MIPMAP_NEAREST:9985,NEAREST_MIPMAP_LINEAR:9986,LINEAR_MIPMAP_LINEAR:9987,TEXTURE_MAG_FILTER:10240,TEXTURE_MIN_FILTER:10241,TEXTURE_WRAP_S:10242,TEXTURE_WRAP_T:10243,TEXTURE_2D:3553,TEXTURE:5890,TEXTURE_CUBE_MAP:34067,TEXTURE_BINDING_CUBE_MAP:34068,TEXTURE_CUBE_MAP_POSITIVE_X:34069,TEXTURE_CUBE_MAP_NEGATIVE_X:34070,TEXTURE_CUBE_MAP_POSITIVE_Y:34071,TEXTURE_CUBE_MAP_NEGATIVE_Y:34072,TEXTURE_CUBE_MAP_POSITIVE_Z:34073,TEXTURE_CUBE_MAP_NEGATIVE_Z:34074,MAX_CUBE_MAP_TEXTURE_SIZE:34076,TEXTURE0:33984,TEXTURE1:33985,TEXTURE2:33986,TEXTURE3:33987,TEXTURE4:33988,TEXTURE5:33989,TEXTURE6:33990,TEXTURE7:33991,TEXTURE8:33992,TEXTURE9:33993,TEXTURE10:33994,TEXTURE11:33995,TEXTURE12:33996,TEXTURE13:33997,TEXTURE14:33998,TEXTURE15:33999,TEXTURE16:34e3,TEXTURE17:34001,TEXTURE18:34002,TEXTURE19:34003,TEXTURE20:34004,TEXTURE21:34005,TEXTURE22:34006,TEXTURE23:34007,TEXTURE24:34008,TEXTURE25:34009,TEXTURE26:34010,TEXTURE27:34011,TEXTURE28:34012,TEXTURE29:34013,TEXTURE30:34014,TEXTURE31:34015,ACTIVE_TEXTURE:34016,REPEAT:10497,CLAMP_TO_EDGE:33071,MIRRORED_REPEAT:33648,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,INT_VEC2:35667,INT_VEC3:35668,INT_VEC4:35669,BOOL:35670,BOOL_VEC2:35671,BOOL_VEC3:35672,BOOL_VEC4:35673,FLOAT_MAT2:35674,FLOAT_MAT3:35675,FLOAT_MAT4:35676,SAMPLER_2D:35678,SAMPLER_CUBE:35680,VERTEX_ATTRIB_ARRAY_ENABLED:34338,VERTEX_ATTRIB_ARRAY_SIZE:34339,VERTEX_ATTRIB_ARRAY_STRIDE:34340,VERTEX_ATTRIB_ARRAY_TYPE:34341,VERTEX_ATTRIB_ARRAY_NORMALIZED:34922,VERTEX_ATTRIB_ARRAY_POINTER:34373,VERTEX_ATTRIB_ARRAY_BUFFER_BINDING:34975,COMPILE_STATUS:35713,LOW_FLOAT:36336,MEDIUM_FLOAT:36337,HIGH_FLOAT:36338,LOW_INT:36339,MEDIUM_INT:36340,HIGH_INT:36341,FRAMEBUFFER:36160,RENDERBUFFER:36161,RGBA4:32854,RGB5_A1:32855,RGB565:36194,DEPTH_COMPONENT16:33189,STENCIL_INDEX:6401,STENCIL_INDEX8:36168,DEPTH_STENCIL:34041,RENDERBUFFER_WIDTH:36162,RENDERBUFFER_HEIGHT:36163,RENDERBUFFER_INTERNAL_FORMAT:36164,RENDERBUFFER_RED_SIZE:36176,RENDERBUFFER_GREEN_SIZE:36177,RENDERBUFFER_BLUE_SIZE:36178,RENDERBUFFER_ALPHA_SIZE:36179,RENDERBUFFER_DEPTH_SIZE:36180,RENDERBUFFER_STENCIL_SIZE:36181,FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE:36048,FRAMEBUFFER_ATTACHMENT_OBJECT_NAME:36049,FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL:36050,FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE:36051,COLOR_ATTACHMENT0:36064,DEPTH_ATTACHMENT:36096,STENCIL_ATTACHMENT:36128,DEPTH_STENCIL_ATTACHMENT:33306,NONE:0,FRAMEBUFFER_COMPLETE:36053,FRAMEBUFFER_INCOMPLETE_ATTACHMENT:36054,FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:36055,FRAMEBUFFER_INCOMPLETE_DIMENSIONS:36057,FRAMEBUFFER_UNSUPPORTED:36061,FRAMEBUFFER_BINDING:36006,RENDERBUFFER_BINDING:36007,MAX_RENDERBUFFER_SIZE:34024,INVALID_FRAMEBUFFER_OPERATION:1286,UNPACK_FLIP_Y_WEBGL:37440,UNPACK_PREMULTIPLY_ALPHA_WEBGL:37441,CONTEXT_LOST_WEBGL:37442,UNPACK_COLORSPACE_CONVERSION_WEBGL:37443,BROWSER_DEFAULT_WEBGL:37444};function H8(e){var t=new XMLHttpRequest;t.open("get",e.url),t.responseType=e.responseType||"text",e.onprogress&&(t.onprogress=function(r){if(r.lengthComputable){var n=r.loaded/r.total;e.onprogress(n,r.loaded,r.total)}else e.onprogress(null)}),t.onload=function(r){t.status>=400?e.onerror&&e.onerror():e.onload&&e.onload(t.response)},e.onerror&&(t.onerror=e.onerror),t.send(null)}const W8={get:H8};var dc,Kt={};Kt.supportWebGL=function(){if(dc==null)try{var e=document.createElement("canvas"),t=e.getContext("webgl")||e.getContext("experimental-webgl");if(!t)throw new Error}catch{dc=!1}return dc};Kt.Int8Array=typeof Int8Array>"u"?Array:Int8Array;Kt.Uint8Array=typeof Uint8Array>"u"?Array:Uint8Array;Kt.Uint16Array=typeof Uint16Array>"u"?Array:Uint16Array;Kt.Uint32Array=typeof Uint32Array>"u"?Array:Uint32Array;Kt.Int16Array=typeof Int16Array>"u"?Array:Int16Array;Kt.Float32Array=typeof Float32Array>"u"?Array:Float32Array;Kt.Float64Array=typeof Float64Array>"u"?Array:Float64Array;var ia={};typeof window<"u"?ia=window:typeof global<"u"&&(ia=global);Kt.requestAnimationFrame=ia.requestAnimationFrame||ia.msRequestAnimationFrame||ia.mozRequestAnimationFrame||ia.webkitRequestAnimationFrame||function(e){setTimeout(e,16)};Kt.createCanvas=function(){return document.createElement("canvas")};Kt.createImage=function(){return new ia.Image};Kt.request={get:W8.get};Kt.addEventListener=function(e,t,r,n){e.addEventListener(t,r,n)};Kt.removeEventListener=function(e,t,r){e.removeEventListener(t,r)};const ht=Kt;var Lt=function(){this.head=null,this.tail=null,this._length=0};Lt.prototype.insert=function(e){var t=new Lt.Entry(e);return this.insertEntry(t),t};Lt.prototype.insertAt=function(e,t){if(!(e<0)){for(var r=this.head,n=0;r&&n!=e;)r=r.next,n++;if(r){var a=new Lt.Entry(t),i=r.prev;i?(i.next=a,a.prev=i):this.head=a,a.next=r,r.prev=a}else this.insert(t)}};Lt.prototype.insertBeforeEntry=function(e,t){var r=new Lt.Entry(e),n=t.prev;n?(n.next=r,r.prev=n):this.head=r,r.next=t,t.prev=r,this._length++};Lt.prototype.insertEntry=function(e){this.head?(this.tail.next=e,e.prev=this.tail,this.tail=e):this.head=this.tail=e,this._length++};Lt.prototype.remove=function(e){var t=e.prev,r=e.next;t?t.next=r:this.head=r,r?r.prev=t:this.tail=t,e.next=e.prev=null,this._length--};Lt.prototype.removeAt=function(e){if(!(e<0)){for(var t=this.head,r=0;t&&r!=e;)t=t.next,r++;if(t)return this.remove(t),t.value}};Lt.prototype.getHead=function(){if(this.head)return this.head.value};Lt.prototype.getTail=function(){if(this.tail)return this.tail.value};Lt.prototype.getAt=function(e){if(!(e<0)){for(var t=this.head,r=0;t&&r!=e;)t=t.next,r++;return t.value}};Lt.prototype.indexOf=function(e){for(var t=this.head,r=0;t;){if(t.value===e)return r;t=t.next,r++}};Lt.prototype.length=function(){return this._length};Lt.prototype.isEmpty=function(){return this._length===0};Lt.prototype.forEach=function(e,t){for(var r=this.head,n=0,a=typeof t<"u";r;)a?e.call(t,r.value,n):e(r.value,n),r=r.next,n++};Lt.prototype.clear=function(){this.tail=this.head=null,this._length=0};Lt.Entry=function(e){this.value=e,this.next=null,this.prev=null};const $8=Lt;var hi=function(e){this._list=new $8,this._map={},this._maxSize=e||10};hi.prototype.setMaxSize=function(e){this._maxSize=e};hi.prototype.put=function(e,t){if(!this._map.hasOwnProperty(e)){var r=this._list.length();if(r>=this._maxSize&&r>0){var n=this._list.head;this._list.remove(n),delete this._map[n.key]}var a=this._list.insert(t);a.key=e,this._map[e]=a}};hi.prototype.get=function(e){var t=this._map[e];if(this._map.hasOwnProperty(e))return t!==this._list.tail&&(this._list.remove(t),this._list.insertEntry(t)),t.value};hi.prototype.remove=function(e){var t=this._map[e];typeof t<"u"&&(delete this._map[e],this._list.remove(t))};hi.prototype.clear=function(){this._list.clear(),this._map={}};const $_=hi;var Ke={},Zg={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function Dr(e){return e=Math.round(e),e<0?0:e>255?255:e}function X8(e){return e=Math.round(e),e<0?0:e>360?360:e}function yo(e){return e<0?0:e>1?1:e}function vc(e){return e.length&&e.charAt(e.length-1)==="%"?Dr(parseFloat(e)/100*255):Dr(parseInt(e,10))}function ei(e){return e.length&&e.charAt(e.length-1)==="%"?yo(parseFloat(e)/100):yo(parseFloat(e))}function pc(e,t,r){return r<0?r+=1:r>1&&(r-=1),r*6<1?e+(t-e)*r*6:r*2<1?t:r*3<2?e+(t-e)*(2/3-r)*6:e}function wn(e,t,r){return e+(t-e)*r}function Er(e,t,r,n,a){return e[0]=t,e[1]=r,e[2]=n,e[3]=a,e}function Mh(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}var X_=new $_(20),us=null;function Da(e,t){us&&Mh(us,t),us=X_.put(e,us||t.slice())}Ke.parse=function(e,t){if(e){t=t||[];var r=X_.get(e);if(r)return Mh(t,r);e=e+"";var n=e.replace(/ /g,"").toLowerCase();if(n in Zg)return Mh(t,Zg[n]),Da(e,t),t;if(n.charAt(0)==="#"){if(n.length===4){var a=parseInt(n.substr(1),16);if(!(a>=0&&a<=4095)){Er(t,0,0,0,1);return}return Er(t,(a&3840)>>4|(a&3840)>>8,a&240|(a&240)>>4,a&15|(a&15)<<4,1),Da(e,t),t}else if(n.length===7){var a=parseInt(n.substr(1),16);if(!(a>=0&&a<=16777215)){Er(t,0,0,0,1);return}return Er(t,(a&16711680)>>16,(a&65280)>>8,a&255,1),Da(e,t),t}return}var i=n.indexOf("("),o=n.indexOf(")");if(i!==-1&&o+1===n.length){var s=n.substr(0,i),l=n.substr(i+1,o-(i+1)).split(","),u=1;switch(s){case"rgba":if(l.length!==4){Er(t,0,0,0,1);return}u=ei(l.pop());case"rgb":if(l.length!==3){Er(t,0,0,0,1);return}return Er(t,vc(l[0]),vc(l[1]),vc(l[2]),u),Da(e,t),t;case"hsla":if(l.length!==4){Er(t,0,0,0,1);return}return l[3]=ei(l[3]),Ph(l,t),Da(e,t),t;case"hsl":if(l.length!==3){Er(t,0,0,0,1);return}return Ph(l,t),Da(e,t),t;default:return}}Er(t,0,0,0,1)}};Ke.parseToFloat=function(e,t){if(t=Ke.parse(e,t),!!t)return t[0]/=255,t[1]/=255,t[2]/=255,t};function Ph(e,t){var r=(parseFloat(e[0])%360+360)%360/360,n=ei(e[1]),a=ei(e[2]),i=a<=.5?a*(n+1):a+n-a*n,o=a*2-i;return t=t||[],Er(t,Dr(pc(o,i,r+1/3)*255),Dr(pc(o,i,r)*255),Dr(pc(o,i,r-1/3)*255),1),e.length===4&&(t[3]=e[3]),t}function j8(e){if(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,a=Math.min(t,r,n),i=Math.max(t,r,n),o=i-a,s=(i+a)/2,l,u;if(o===0)l=0,u=0;else{s<.5?u=o/(i+a):u=o/(2-i-a);var c=((i-t)/6+o/2)/o,h=((i-r)/6+o/2)/o,f=((i-n)/6+o/2)/o;t===i?l=f-h:r===i?l=1/3+c-f:n===i&&(l=2/3+h-c),l<0&&(l+=1),l>1&&(l-=1)}var d=[l*360,u,s];return e[3]!=null&&d.push(e[3]),d}}Ke.lift=function(e,t){var r=Ke.parse(e);if(r){for(var n=0;n<3;n++)t<0?r[n]=r[n]*(1-t)|0:r[n]=(255-r[n])*t+r[n]|0;return Ke.stringify(r,r.length===4?"rgba":"rgb")}};Ke.toHex=function(e){var t=Ke.parse(e);if(t)return((1<<24)+(t[0]<<16)+(t[1]<<8)+ +t[2]).toString(16).slice(1)};Ke.fastLerp=function(e,t,r){if(!(!(t&&t.length)||!(e>=0&&e<=1))){r=r||[];var n=e*(t.length-1),a=Math.floor(n),i=Math.ceil(n),o=t[a],s=t[i],l=n-a;return r[0]=Dr(wn(o[0],s[0],l)),r[1]=Dr(wn(o[1],s[1],l)),r[2]=Dr(wn(o[2],s[2],l)),r[3]=yo(wn(o[3],s[3],l)),r}};Ke.fastMapToColor=Ke.fastLerp;Ke.lerp=function(e,t,r){if(!(!(t&&t.length)||!(e>=0&&e<=1))){var n=e*(t.length-1),a=Math.floor(n),i=Math.ceil(n),o=Ke.parse(t[a]),s=Ke.parse(t[i]),l=n-a,u=Ke.stringify([Dr(wn(o[0],s[0],l)),Dr(wn(o[1],s[1],l)),Dr(wn(o[2],s[2],l)),yo(wn(o[3],s[3],l))],"rgba");return r?{color:u,leftIndex:a,rightIndex:i,value:n}:u}};Ke.mapToColor=Ke.lerp;Ke.modifyHSL=function(e,t,r,n){if(e=Ke.parse(e),e)return e=j8(e),t!=null&&(e[0]=X8(t)),r!=null&&(e[1]=ei(r)),n!=null&&(e[2]=ei(n)),Ke.stringify(Ph(e),"rgba")};Ke.modifyAlpha=function(e,t){if(e=Ke.parse(e),e&&t!=null)return e[3]=yo(t),Ke.stringify(e,"rgba")};Ke.stringify=function(e,t){if(!(!e||!e.length)){var r=e[0]+","+e[1]+","+e[2];return(t==="rgba"||t==="hsva"||t==="hsla")&&(r+=","+e[3]),t+"("+r+")"}};const Z8=Ke;var Y8=Z8.parseToFloat,gc={};function Yg(e){var t=Object.keys(e);t.sort();for(var r=[],n=0;n<t.length;n++){var a=t[n],i=e[a];i===null?r.push(a):r.push(a+" "+i.toString())}return r.join(`
`)}function q8(e,t,r){r.sort();for(var n=[],a=0;a<r.length;a++){var i=r[a];n.push(i)}var o=Yg(e)+`
`+Yg(t)+`
`+n.join(`
`);if(gc[o])return gc[o];var s=Pt.genGUID();return gc[o]=s,s}var K8=qt.extend(function(){return{name:"",depthTest:!0,depthMask:!0,transparent:!1,blend:null,autoUpdateTextureStatus:!0,uniforms:{},vertexDefines:{},fragmentDefines:{},_textureStatus:{},_enabledUniforms:null}},function(){this.name||(this.name="MATERIAL_"+this.__uid__),this.shader&&this.attachShader(this.shader,!0)},{precision:"highp",setUniform:function(e,t){t===void 0&&console.warn('Uniform value "'+e+'" is undefined');var r=this.uniforms[e];r&&(typeof t=="string"&&(t=Y8(t)||t),r.value=t,this.autoUpdateTextureStatus&&r.type==="t"&&(t?this.enableTexture(e):this.disableTexture(e)))},setUniforms:function(e){for(var t in e){var r=e[t];this.setUniform(t,r)}},isUniformEnabled:function(e){return this._enabledUniforms.indexOf(e)>=0},getEnabledUniforms:function(){return this._enabledUniforms},getTextureUniforms:function(){return this._textureUniforms},set:function(e,t){if(typeof e=="object")for(var r in e){var n=e[r];this.setUniform(r,n)}else this.setUniform(e,t)},get:function(e){var t=this.uniforms[e];if(t)return t.value},attachShader:function(e,t){var r=this.uniforms;this.uniforms=e.createUniforms(),this.shader=e;var n=this.uniforms;this._enabledUniforms=Object.keys(n),this._enabledUniforms.sort(),this._textureUniforms=this._enabledUniforms.filter(function(u){var c=this.uniforms[u].type;return c==="t"||c==="tv"},this);var a=this.vertexDefines,i=this.fragmentDefines;if(this.vertexDefines=Pt.clone(e.vertexDefines),this.fragmentDefines=Pt.clone(e.fragmentDefines),t){for(var o in r)n[o]&&(n[o].value=r[o].value);Pt.defaults(this.vertexDefines,a),Pt.defaults(this.fragmentDefines,i)}var s={};for(var l in e.textures)s[l]={shaderType:e.textures[l].shaderType,type:e.textures[l].type,enabled:t&&this._textureStatus[l]?this._textureStatus[l].enabled:!1};this._textureStatus=s,this._programKey=""},clone:function(){var e=new this.constructor({name:this.name,shader:this.shader});for(var t in this.uniforms)e.uniforms[t].value=this.uniforms[t].value;return e.depthTest=this.depthTest,e.depthMask=this.depthMask,e.transparent=this.transparent,e.blend=this.blend,e.vertexDefines=Pt.clone(this.vertexDefines),e.fragmentDefines=Pt.clone(this.fragmentDefines),e.enableTexture(this.getEnabledTextures()),e.precision=this.precision,e},define:function(e,t,r){var n=this.vertexDefines,a=this.fragmentDefines;e!=="vertex"&&e!=="fragment"&&e!=="both"&&arguments.length<3&&(r=t,t=e,e="both"),r=r??null,(e==="vertex"||e==="both")&&n[t]!==r&&(n[t]=r,this._programKey=""),(e==="fragment"||e==="both")&&a[t]!==r&&(a[t]=r,e!=="both"&&(this._programKey=""))},undefine:function(e,t){e!=="vertex"&&e!=="fragment"&&e!=="both"&&arguments.length<2&&(t=e,e="both"),(e==="vertex"||e==="both")&&this.isDefined("vertex",t)&&(delete this.vertexDefines[t],this._programKey=""),(e==="fragment"||e==="both")&&this.isDefined("fragment",t)&&(delete this.fragmentDefines[t],e!=="both"&&(this._programKey=""))},isDefined:function(e,t){switch(e){case"vertex":return this.vertexDefines[t]!==void 0;case"fragment":return this.fragmentDefines[t]!==void 0}},getDefine:function(e,t){switch(e){case"vertex":return this.vertexDefines[t];case"fragment":return this.fragmentDefines[t]}},enableTexture:function(e){if(Array.isArray(e)){for(var t=0;t<e.length;t++)this.enableTexture(e[t]);return}var r=this._textureStatus[e];if(r){var n=r.enabled;n||(r.enabled=!0,this._programKey="")}},enableTexturesAll:function(){var e=this._textureStatus;for(var t in e)e[t].enabled=!0;this._programKey=""},disableTexture:function(e){if(Array.isArray(e)){for(var t=0;t<e.length;t++)this.disableTexture(e[t]);return}var r=this._textureStatus[e];if(r){var n=!r.enabled;n||(r.enabled=!1,this._programKey="")}},disableTexturesAll:function(){var e=this._textureStatus;for(var t in e)e[t].enabled=!1;this._programKey=""},isTextureEnabled:function(e){var t=this._textureStatus;return!!t[e]&&t[e].enabled},getEnabledTextures:function(){var e=[],t=this._textureStatus;for(var r in t)t[r].enabled&&e.push(r);return e},dirtyDefines:function(){this._programKey=""},getProgramKey:function(){return this._programKey||(this._programKey=q8(this.vertexDefines,this.fragmentDefines,this.getEnabledTextures())),this._programKey}});const Sr=K8;var Es=1e-6,Bt=Array,Wa=Math.random,ye={};ye.create=function(){var e=new Bt(2);return e[0]=0,e[1]=0,e};ye.clone=function(e){var t=new Bt(2);return t[0]=e[0],t[1]=e[1],t};ye.fromValues=function(e,t){var r=new Bt(2);return r[0]=e,r[1]=t,r};ye.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e};ye.set=function(e,t,r){return e[0]=t,e[1]=r,e};ye.add=function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e};ye.subtract=function(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e};ye.sub=ye.subtract;ye.multiply=function(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e};ye.mul=ye.multiply;ye.divide=function(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e};ye.div=ye.divide;ye.min=function(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e};ye.max=function(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e};ye.scale=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e};ye.scaleAndAdd=function(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e};ye.distance=function(e,t){var r=t[0]-e[0],n=t[1]-e[1];return Math.sqrt(r*r+n*n)};ye.dist=ye.distance;ye.squaredDistance=function(e,t){var r=t[0]-e[0],n=t[1]-e[1];return r*r+n*n};ye.sqrDist=ye.squaredDistance;ye.length=function(e){var t=e[0],r=e[1];return Math.sqrt(t*t+r*r)};ye.len=ye.length;ye.squaredLength=function(e){var t=e[0],r=e[1];return t*t+r*r};ye.sqrLen=ye.squaredLength;ye.negate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e};ye.inverse=function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e};ye.normalize=function(e,t){var r=t[0],n=t[1],a=r*r+n*n;return a>0&&(a=1/Math.sqrt(a),e[0]=t[0]*a,e[1]=t[1]*a),e};ye.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]};ye.cross=function(e,t,r){var n=t[0]*r[1]-t[1]*r[0];return e[0]=e[1]=0,e[2]=n,e};ye.lerp=function(e,t,r,n){var a=t[0],i=t[1];return e[0]=a+n*(r[0]-a),e[1]=i+n*(r[1]-i),e};ye.random=function(e,t){t=t||1;var r=GLMAT_RANDOM()*2*Math.PI;return e[0]=Math.cos(r)*t,e[1]=Math.sin(r)*t,e};ye.transformMat2=function(e,t,r){var n=t[0],a=t[1];return e[0]=r[0]*n+r[2]*a,e[1]=r[1]*n+r[3]*a,e};ye.transformMat2d=function(e,t,r){var n=t[0],a=t[1];return e[0]=r[0]*n+r[2]*a+r[4],e[1]=r[1]*n+r[3]*a+r[5],e};ye.transformMat3=function(e,t,r){var n=t[0],a=t[1];return e[0]=r[0]*n+r[3]*a+r[6],e[1]=r[1]*n+r[4]*a+r[7],e};ye.transformMat4=function(e,t,r){var n=t[0],a=t[1];return e[0]=r[0]*n+r[4]*a+r[12],e[1]=r[1]*n+r[5]*a+r[13],e};ye.forEach=function(){var e=ye.create();return function(t,r,n,a,i,o){var s,l;for(r||(r=2),n||(n=0),a?l=Math.min(a*r+n,t.length):l=t.length,s=n;s<l;s+=r)e[0]=t[s],e[1]=t[s+1],i(e,e,o),t[s]=e[0],t[s+1]=e[1];return t}}();const se=ye;var be=function(e,t){e=e||0,t=t||0,this.array=se.fromValues(e,t),this._dirty=!0};be.prototype={constructor:be,add:function(e){return se.add(this.array,this.array,e.array),this._dirty=!0,this},set:function(e,t){return this.array[0]=e,this.array[1]=t,this._dirty=!0,this},setArray:function(e){return this.array[0]=e[0],this.array[1]=e[1],this._dirty=!0,this},clone:function(){return new be(this.x,this.y)},copy:function(e){return se.copy(this.array,e.array),this._dirty=!0,this},cross:function(e,t){return se.cross(e.array,this.array,t.array),e._dirty=!0,this},dist:function(e){return se.dist(this.array,e.array)},distance:function(e){return se.distance(this.array,e.array)},div:function(e){return se.div(this.array,this.array,e.array),this._dirty=!0,this},divide:function(e){return se.divide(this.array,this.array,e.array),this._dirty=!0,this},dot:function(e){return se.dot(this.array,e.array)},len:function(){return se.len(this.array)},length:function(){return se.length(this.array)},lerp:function(e,t,r){return se.lerp(this.array,e.array,t.array,r),this._dirty=!0,this},min:function(e){return se.min(this.array,this.array,e.array),this._dirty=!0,this},max:function(e){return se.max(this.array,this.array,e.array),this._dirty=!0,this},mul:function(e){return se.mul(this.array,this.array,e.array),this._dirty=!0,this},multiply:function(e){return se.multiply(this.array,this.array,e.array),this._dirty=!0,this},negate:function(){return se.negate(this.array,this.array),this._dirty=!0,this},normalize:function(){return se.normalize(this.array,this.array),this._dirty=!0,this},random:function(e){return se.random(this.array,e),this._dirty=!0,this},scale:function(e){return se.scale(this.array,this.array,e),this._dirty=!0,this},scaleAndAdd:function(e,t){return se.scaleAndAdd(this.array,this.array,e.array,t),this._dirty=!0,this},sqrDist:function(e){return se.sqrDist(this.array,e.array)},squaredDistance:function(e){return se.squaredDistance(this.array,e.array)},sqrLen:function(){return se.sqrLen(this.array)},squaredLength:function(){return se.squaredLength(this.array)},sub:function(e){return se.sub(this.array,this.array,e.array),this._dirty=!0,this},subtract:function(e){return se.subtract(this.array,this.array,e.array),this._dirty=!0,this},transformMat2:function(e){return se.transformMat2(this.array,this.array,e.array),this._dirty=!0,this},transformMat2d:function(e){return se.transformMat2d(this.array,this.array,e.array),this._dirty=!0,this},transformMat3:function(e){return se.transformMat3(this.array,this.array,e.array),this._dirty=!0,this},transformMat4:function(e){return se.transformMat4(this.array,this.array,e.array),this._dirty=!0,this},toString:function(){return"["+Array.prototype.join.call(this.array,",")+"]"},toArray:function(){return Array.prototype.slice.call(this.array)}};if(Object.defineProperty){var qg=be.prototype;Object.defineProperty(qg,"x",{get:function(){return this.array[0]},set:function(e){this.array[0]=e,this._dirty=!0}}),Object.defineProperty(qg,"y",{get:function(){return this.array[1]},set:function(e){this.array[1]=e,this._dirty=!0}})}be.add=function(e,t,r){return se.add(e.array,t.array,r.array),e._dirty=!0,e};be.set=function(e,t,r){return se.set(e.array,t,r),e._dirty=!0,e};be.copy=function(e,t){return se.copy(e.array,t.array),e._dirty=!0,e};be.cross=function(e,t,r){return se.cross(e.array,t.array,r.array),e._dirty=!0,e};be.dist=function(e,t){return se.distance(e.array,t.array)};be.distance=be.dist;be.div=function(e,t,r){return se.divide(e.array,t.array,r.array),e._dirty=!0,e};be.divide=be.div;be.dot=function(e,t){return se.dot(e.array,t.array)};be.len=function(e){return se.length(e.array)};be.lerp=function(e,t,r,n){return se.lerp(e.array,t.array,r.array,n),e._dirty=!0,e};be.min=function(e,t,r){return se.min(e.array,t.array,r.array),e._dirty=!0,e};be.max=function(e,t,r){return se.max(e.array,t.array,r.array),e._dirty=!0,e};be.mul=function(e,t,r){return se.multiply(e.array,t.array,r.array),e._dirty=!0,e};be.multiply=be.mul;be.negate=function(e,t){return se.negate(e.array,t.array),e._dirty=!0,e};be.normalize=function(e,t){return se.normalize(e.array,t.array),e._dirty=!0,e};be.random=function(e,t){return se.random(e.array,t),e._dirty=!0,e};be.scale=function(e,t,r){return se.scale(e.array,t.array,r),e._dirty=!0,e};be.scaleAndAdd=function(e,t,r,n){return se.scaleAndAdd(e.array,t.array,r.array,n),e._dirty=!0,e};be.sqrDist=function(e,t){return se.sqrDist(e.array,t.array)};be.squaredDistance=be.sqrDist;be.sqrLen=function(e){return se.sqrLen(e.array)};be.squaredLength=be.sqrLen;be.sub=function(e,t,r){return se.subtract(e.array,t.array,r.array),e._dirty=!0,e};be.subtract=be.sub;be.transformMat2=function(e,t,r){return se.transformMat2(e.array,t.array,r.array),e._dirty=!0,e};be.transformMat2d=function(e,t,r){return se.transformMat2d(e.array,t.array,r.array),e._dirty=!0,e};be.transformMat3=function(e,t,r){return se.transformMat3(e.array,t.array,r.array),e._dirty=!0,e};be.transformMat4=function(e,t,r){return se.transformMat4(e.array,t.array,r.array),e._dirty=!0,e};const lr=be;var Kg=1,Jg=2,mc=3,Qg={};function J8(e){for(var t=e.split(`
`),r=0,n=t.length;r<n;r++)t[r]=r+1+": "+t[r];return t.join(`
`)}function e1(e,t,r){if(!e.getShaderParameter(t,e.COMPILE_STATUS))return[e.getShaderInfoLog(t),J8(r)].join(`
`)}var t1=new ht.Float32Array(16),Q8=qt.extend({uniformSemantics:{},attributes:{}},function(){this._locations={},this._textureSlot=0,this._program=null},{bind:function(e){this._textureSlot=0,e.gl.useProgram(this._program)},hasUniform:function(e){var t=this._locations[e];return t!=null},useTextureSlot:function(e,t,r){t&&(e.gl.activeTexture(e.gl.TEXTURE0+r),t.isRenderable()?t.bind(e):t.unbind(e))},currentTextureSlot:function(){return this._textureSlot},resetTextureSlot:function(e){this._textureSlot=e||0},takeCurrentTextureSlot:function(e,t){var r=this._textureSlot;return this.useTextureSlot(e,t,r),this._textureSlot++,r},setUniform:function(e,t,r,n){var a=this._locations,i=a[r];if(i==null)return!1;switch(t){case"m4":if(!(n instanceof Float32Array)){for(var o=0;o<n.length;o++)t1[o]=n[o];n=t1}e.uniformMatrix4fv(i,!1,n);break;case"2i":e.uniform2i(i,n[0],n[1]);break;case"2f":e.uniform2f(i,n[0],n[1]);break;case"3i":e.uniform3i(i,n[0],n[1],n[2]);break;case"3f":e.uniform3f(i,n[0],n[1],n[2]);break;case"4i":e.uniform4i(i,n[0],n[1],n[2],n[3]);break;case"4f":e.uniform4f(i,n[0],n[1],n[2],n[3]);break;case"1i":e.uniform1i(i,n);break;case"1f":e.uniform1f(i,n);break;case"1fv":e.uniform1fv(i,n);break;case"1iv":e.uniform1iv(i,n);break;case"2iv":e.uniform2iv(i,n);break;case"2fv":e.uniform2fv(i,n);break;case"3iv":e.uniform3iv(i,n);break;case"3fv":e.uniform3fv(i,n);break;case"4iv":e.uniform4iv(i,n);break;case"4fv":e.uniform4fv(i,n);break;case"m2":case"m2v":e.uniformMatrix2fv(i,!1,n);break;case"m3":case"m3v":e.uniformMatrix3fv(i,!1,n);break;case"m4v":if(Array.isArray(n)&&Array.isArray(n[0])){for(var s=new ht.Float32Array(n.length*16),l=0,o=0;o<n.length;o++)for(var u=n[o],c=0;c<16;c++)s[l++]=u[c];e.uniformMatrix4fv(i,!1,s)}else e.uniformMatrix4fv(i,!1,n);break}return!0},setUniformOfSemantic:function(e,t,r){var n=this.uniformSemantics[t];return n?this.setUniform(e,n.type,n.symbol,r):!1},enableAttributes:function(e,t,r){var n=e.gl,a=this._program,i=this._locations,o;r?o=r.__enabledAttributeList:o=Qg[e.__uid__],o||(r?o=r.__enabledAttributeList=[]:o=Qg[e.__uid__]=[]);for(var s=[],l=0;l<t.length;l++){var u=t[l];if(!this.attributes[u]){s[l]=-1;continue}var c=i[u];if(c==null){if(c=n.getAttribLocation(a,u),c===-1){s[l]=-1;continue}i[u]=c}s[l]=c,o[c]?o[c]=Jg:o[c]=Kg}for(var l=0;l<o.length;l++)switch(o[l]){case Kg:n.enableVertexAttribArray(l),o[l]=mc;break;case Jg:o[l]=mc;break;case mc:n.disableVertexAttribArray(l),o[l]=0;break}return s},getAttribLocation:function(e,t){var r=this._locations,n=r[t];return n==null&&(n=e.getAttribLocation(this._program,t),r[t]=n),n},buildProgram:function(e,t,r,n){var a=e.createShader(e.VERTEX_SHADER),i=e.createProgram();e.shaderSource(a,r),e.compileShader(a);var o=e.createShader(e.FRAGMENT_SHADER);e.shaderSource(o,n),e.compileShader(o);var s=e1(e,a,r);if(s||(s=e1(e,o,n),s))return s;if(e.attachShader(i,a),e.attachShader(i,o),t.attributeSemantics.POSITION)e.bindAttribLocation(i,0,t.attributeSemantics.POSITION.symbol);else{var l=Object.keys(this.attributes);e.bindAttribLocation(i,0,l[0])}if(e.linkProgram(i),e.deleteShader(a),e.deleteShader(o),this._program=i,this.vertexCode=r,this.fragmentCode=n,!e.getProgramParameter(i,e.LINK_STATUS))return`Could not link program
`+e.getProgramInfoLog(i);for(var u=0;u<t.uniforms.length;u++){var c=t.uniforms[u];this._locations[c]=e.getUniformLocation(i,c)}}});const eI=Q8;var tI=/for\s*?\(int\s*?_idx_\s*\=\s*([\w-]+)\;\s*_idx_\s*<\s*([\w-]+);\s*_idx_\s*\+\+\s*\)\s*\{\{([\s\S]+?)(?=\}\})\}\}/g;function r1(e,t,r){function n(o,s,l,u){var c="";isNaN(s)&&(s in t?s=t[s]:s=a[s]),isNaN(l)&&(l in t?l=t[l]:l=a[l]);for(var h=parseInt(s);h<parseInt(l);h++)c+="{"+u.replace(/float\s*\(\s*_idx_\s*\)/g,h.toFixed(1)).replace(/_idx_/g,h)+"}";return c}var a={};for(var i in r)a[i+"_COUNT"]=r[i];return e.replace(tI,n)}function yc(e,t,r){var n=[];if(t)for(var a in t){var i=t[a];i>0&&n.push("#define "+a.toUpperCase()+"_COUNT "+i)}if(r)for(var o=0;o<r.length;o++){var s=r[o];n.push("#define "+s.toUpperCase()+"_ENABLED")}for(var s in e){var l=e[s];l===null?n.push("#define "+s):n.push("#define "+s+" "+l.toString())}return n.join(`
`)}function rI(e){for(var t=[],r=0;r<e.length;r++)t.push("#extension GL_"+e[r]+" : enable");return t.join(`
`)}function nI(e){return["precision",e,"float"].join(" ")+`;
`+["precision",e,"int"].join(" ")+`;
`+["precision",e,"sampler2D"].join(" ")+`;
`}function j_(e){this._renderer=e,this._cache={}}j_.prototype.getProgram=function(e,t,r){var n=this._cache,a=e.isSkinnedMesh&&e.isSkinnedMesh(),i=e.isInstancedMesh&&e.isInstancedMesh(),o="s"+t.shader.shaderID+"m"+t.getProgramKey();r&&(o+="se"+r.getProgramKey(e.lightGroup)),a&&(o+=",sk"+e.joints.length),i&&(o+=",is");var x=n[o];if(x)return x;var s=r?r.getLightsNumbers(e.lightGroup):{},l=this._renderer,u=l.gl,c=t.getEnabledTextures(),h="";if(a){var f={SKINNING:null,JOINT_COUNT:e.joints.length};e.joints.length>l.getMaxJointNumber()&&(f.USE_SKIN_MATRICES_TEXTURE=null),h+=`
`+yc(f)+`
`}i&&(h+=`
#define INSTANCING
`);var d=h+yc(t.vertexDefines,s,c),v=h+yc(t.fragmentDefines,s,c),p=d+`
`+t.shader.vertex,g=["OES_standard_derivatives","EXT_shader_texture_lod"].filter(function(T){return l.getGLExtension(T)!=null});g.indexOf("EXT_shader_texture_lod")>=0&&(v+=`
#define SUPPORT_TEXTURE_LOD`),g.indexOf("OES_standard_derivatives")>=0&&(v+=`
#define SUPPORT_STANDARD_DERIVATIVES`);var m=rI(g)+`
`+nI(t.precision)+`
`+v+`
`+t.shader.fragment,_=r1(p,t.vertexDefines,s),y=r1(m,t.fragmentDefines,s),x=new eI;x.uniformSemantics=t.shader.uniformSemantics,x.attributes=t.shader.attributes;var S=x.buildProgram(u,t.shader,_,y);return x.__error=S,n[o]=x,x};var n1=/uniform\s+(bool|float|int|vec2|vec3|vec4|ivec2|ivec3|ivec4|mat2|mat3|mat4|sampler2D|samplerCube)\s+([\s\S]*?);/g,aI=/attribute\s+(float|int|vec2|vec3|vec4)\s+([\s\S]*?);/g,a1=/#define\s+(\w+)?(\s+[\d-.]+)?\s*;?\s*\n/g,iI={bool:"1i",int:"1i",sampler2D:"t",samplerCube:"t",float:"1f",vec2:"2f",vec3:"3f",vec4:"4f",ivec2:"2i",ivec3:"3i",ivec4:"4i",mat2:"m2",mat3:"m3",mat4:"m4"};function qr(e){for(var t=[],r=0;r<e;r++)t[r]=0;return t}var i1={bool:function(){return!0},int:function(){return 0},float:function(){return 0},sampler2D:function(){return null},samplerCube:function(){return null},vec2:function(){return qr(2)},vec3:function(){return qr(3)},vec4:function(){return qr(4)},ivec2:function(){return qr(2)},ivec3:function(){return qr(3)},ivec4:function(){return qr(4)},mat2:function(){return qr(4)},mat3:function(){return qr(9)},mat4:function(){return qr(16)},array:function(){return[]}},Ih=["POSITION","NORMAL","BINORMAL","TANGENT","TEXCOORD","TEXCOORD_0","TEXCOORD_1","COLOR","JOINT","WEIGHT"],Z_=["SKIN_MATRIX","VIEWPORT_SIZE","VIEWPORT","DEVICEPIXELRATIO","WINDOW_SIZE","NEAR","FAR","TIME"],Y_=["WORLD","VIEW","PROJECTION","WORLDVIEW","VIEWPROJECTION","WORLDVIEWPROJECTION","WORLDINVERSE","VIEWINVERSE","PROJECTIONINVERSE","WORLDVIEWINVERSE","VIEWPROJECTIONINVERSE","WORLDVIEWPROJECTIONINVERSE","WORLDTRANSPOSE","VIEWTRANSPOSE","PROJECTIONTRANSPOSE","WORLDVIEWTRANSPOSE","VIEWPROJECTIONTRANSPOSE","WORLDVIEWPROJECTIONTRANSPOSE","WORLDINVERSETRANSPOSE","VIEWINVERSETRANSPOSE","PROJECTIONINVERSETRANSPOSE","WORLDVIEWINVERSETRANSPOSE","VIEWPROJECTIONINVERSETRANSPOSE","WORLDVIEWPROJECTIONINVERSETRANSPOSE"],oI={vec4:4,vec3:3,vec2:2,float:1},_c={},q_={};function sI(e,t){var r="vertex:"+e+"fragment:"+t;if(_c[r])return _c[r];var n=Pt.genGUID();return _c[r]=n,q_[n]={vertex:e,fragment:t},n}function o1(e){return e.replace(/[ \t]*\/\/.*\n/g,"").replace(/[ \t]*\/\*[\s\S]*?\*\//g,"")}function Ma(){console.error("Wrong uniform/attributes syntax")}function s1(e,t){for(var r=/[,=\(\):]/,n=t.replace(/:\s*\[\s*(.*)\s*\]/g,"="+e+"($1)").replace(/\s+/g,"").split(/(?=[,=\(\):])/g),a=[],i=0;i<n.length;i++)n[i].match(r)?a.push(n[i].charAt(0),n[i].slice(1)):a.push(n[i]);n=a;var o=0,s=1,l=2,u=3,c=4,h=5,f=o,d={},v=null,p;g(n[0]);function g(y){y||Ma();var x=y.match(/\[(.*?)\]/);p=y.replace(/\[(.*?)\]/,""),d[p]={},x&&(d[p].isArray=!0,d[p].arraySize=x[1])}for(var i=1;i<n.length;i++){var m=n[i];if(m){if(m==="="){if(f!==o&&f!==u){Ma();break}f=s;continue}else if(m===":"){f=c;continue}else if(m===","){if(f===l){if(!(v instanceof Array)){Ma();break}v.push(+n[++i])}else f=h;continue}else if(m===")"){d[p].value=new ht.Float32Array(v),v=null,f=h;continue}else if(m==="("){if(f!==l){Ma();break}if(!(v instanceof Array)){Ma();break}v.push(+n[++i]);continue}else if(m.indexOf("vec")>=0){if(f!==s&&f!==c){Ma();break}f=l,v=[];continue}else if(f===s){e==="bool"?d[p].value=m==="true":d[p].value=parseFloat(m),v=null;continue}else if(f===c){var _=m;Ih.indexOf(_)>=0||Z_.indexOf(_)>=0||Y_.indexOf(_)>=0?d[p].semantic=_:_==="ignore"||_==="unconfigurable"?d[p].ignore=!0:e==="bool"?d[p].value=_==="true":d[p].value=parseFloat(_);continue}g(m),f=o}}return d}function H(e,t){typeof e=="object"&&(t=e.fragment,e=e.vertex),e=o1(e),t=o1(t),this._shaderID=sI(e,t),this._vertexCode=H.parseImport(e),this._fragmentCode=H.parseImport(t),this.attributeSemantics={},this.matrixSemantics={},this.uniformSemantics={},this.matrixSemanticKeys=[],this.uniformTemplates={},this.attributes={},this.textures={},this.vertexDefines={},this.fragmentDefines={},this._parseAttributes(),this._parseUniforms(),this._parseDefines()}H.prototype={constructor:H,createUniforms:function(){var e={};for(var t in this.uniformTemplates){var r=this.uniformTemplates[t];e[t]={type:r.type,value:r.value()}}return e},_parseImport:function(){this._vertexCode=H.parseImport(this.vertex),this._fragmentCode=H.parseImport(this.fragment)},_addSemanticUniform:function(e,t,r){if(Ih.indexOf(r)>=0)this.attributeSemantics[r]={symbol:e,type:t};else if(Y_.indexOf(r)>=0){var n=!1,a=r;r.match(/TRANSPOSE$/)&&(n=!0,a=r.slice(0,-9)),this.matrixSemantics[r]={symbol:e,type:t,isTranspose:n,semanticNoTranspose:a}}else Z_.indexOf(r)>=0&&(this.uniformSemantics[r]={symbol:e,type:t})},_addMaterialUniform:function(e,t,r,n,a,i){i[e]={type:r,value:a?i1.array:n||i1[t],semantic:null}},_parseUniforms:function(){var e={},t=this,r="vertex";this._uniformList=[],this._vertexCode=this._vertexCode.replace(n1,a),r="fragment",this._fragmentCode=this._fragmentCode.replace(n1,a),t.matrixSemanticKeys=Object.keys(this.matrixSemantics);function n(i){return i!=null?function(){return i}:null}function a(i,o,s){var l=s1(o,s),u=[];for(var c in l){var h=l[c],f=h.semantic,d=c,v=iI[o],p=n(l[c].value);l[c].isArray&&(d+="["+l[c].arraySize+"]",v+="v"),u.push(d),t._uniformList.push(c),h.ignore||((o==="sampler2D"||o==="samplerCube")&&(t.textures[c]={shaderType:r,type:o}),f?t._addSemanticUniform(c,v,f):t._addMaterialUniform(c,o,v,p,l[c].isArray,e))}return u.length>0?"uniform "+o+" "+u.join(",")+`;
`:""}this.uniformTemplates=e},_parseAttributes:function(){var e={},t=this;this._vertexCode=this._vertexCode.replace(aI,r);function r(n,a,i){var o=s1(a,i),s=oI[a]||1,l=[];for(var u in o){var c=o[u].semantic;if(e[u]={type:"float",size:s,semantic:c||null},c){if(Ih.indexOf(c)<0)throw new Error('Unkown semantic "'+c+'"');t.attributeSemantics[c]={symbol:u,type:a}}l.push(u)}return"attribute "+a+" "+l.join(",")+`;
`}this.attributes=e},_parseDefines:function(){var e=this,t="vertex";this._vertexCode=this._vertexCode.replace(a1,r),t="fragment",this._fragmentCode=this._fragmentCode.replace(a1,r);function r(n,a,i){var o=t==="vertex"?e.vertexDefines:e.fragmentDefines;return o[a]||(i==="false"?o[a]=!1:i==="true"?o[a]=!0:o[a]=i?isNaN(parseFloat(i))?i.trim():parseFloat(i):null),""}},clone:function(){var e=q_[this._shaderID],t=new H(e.vertex,e.fragment);return t}};Object.defineProperty&&(Object.defineProperty(H.prototype,"shaderID",{get:function(){return this._shaderID}}),Object.defineProperty(H.prototype,"vertex",{get:function(){return this._vertexCode}}),Object.defineProperty(H.prototype,"fragment",{get:function(){return this._fragmentCode}}),Object.defineProperty(H.prototype,"uniforms",{get:function(){return this._uniformList}}));var lI=/(@import)\s*([0-9a-zA-Z_\-\.]*)/g;H.parseImport=function(e){return e=e.replace(lI,function(a,r,n){var a=H.source(n);return a?H.parseImport(a):(console.error('Shader chunk "'+n+'" not existed in library'),"")}),e};var uI=/(@export)\s*([0-9a-zA-Z_\-\.]*)\s*\n([\s\S]*?)@end/g;H.import=function(e){e.replace(uI,function(t,r,n,i){var i=i.replace(/(^[\s\t\xa0\u3000]+)|([\u3000\xa0\s\t]+\x24)/g,"");if(i){for(var o=n.split("."),s=H.codes,l=0,u;l<o.length-1;)u=o[l++],s[u]||(s[u]={}),s=s[u];u=o[l],s[u]=i}return i})};H.codes={};H.source=function(e){for(var t=e.split("."),r=H.codes,n=0;r&&n<t.length;){var a=t[n++];r=r[a]}return typeof r!="string"?(console.error('Shader "'+e+'" not existed in library'),""):r};const K_=`@export clay.prez.vertex
uniform mat4 WVP : WORLDVIEWPROJECTION;
attribute vec3 pos : POSITION;
attribute vec2 uv : TEXCOORD_0;
uniform vec2 uvRepeat : [1.0, 1.0];
uniform vec2 uvOffset : [0.0, 0.0];
@import clay.chunk.skinning_header
@import clay.chunk.instancing_header
varying vec2 v_Texcoord;
void main()
{
 vec4 P = vec4(pos, 1.0);
#ifdef SKINNING
 @import clay.chunk.skin_matrix
 P = skinMatrixWS * P;
#endif
#ifdef INSTANCING
 @import clay.chunk.instancing_matrix
 P = instanceMat * P;
#endif
 gl_Position = WVP * P;
 v_Texcoord = uv * uvRepeat + uvOffset;
}
@end
@export clay.prez.fragment
uniform sampler2D alphaMap;
uniform float alphaCutoff: 0.0;
varying vec2 v_Texcoord;
void main()
{
 if (alphaCutoff > 0.0) {
 if (texture2D(alphaMap, v_Texcoord).a <= alphaCutoff) {
 discard;
 }
 }
 gl_FragColor = vec4(0.0,0.0,0.0,1.0);
}
@end`;var Ue={};Ue.create=function(){var e=new Bt(16);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e};Ue.clone=function(e){var t=new Bt(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t};Ue.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e};Ue.identity=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e};Ue.transpose=function(e,t){if(e===t){var r=t[1],n=t[2],a=t[3],i=t[6],o=t[7],s=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=r,e[6]=t[9],e[7]=t[13],e[8]=n,e[9]=i,e[11]=t[14],e[12]=a,e[13]=o,e[14]=s}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15];return e};Ue.invert=function(e,t){var r=t[0],n=t[1],a=t[2],i=t[3],o=t[4],s=t[5],l=t[6],u=t[7],c=t[8],h=t[9],f=t[10],d=t[11],v=t[12],p=t[13],g=t[14],m=t[15],_=r*s-n*o,y=r*l-a*o,x=r*u-i*o,S=n*l-a*s,T=n*u-i*s,b=a*u-i*l,w=c*p-h*v,A=c*g-f*v,E=c*m-d*v,C=h*g-f*p,M=h*m-d*p,P=f*m-d*g,L=_*P-y*M+x*C+S*E-T*A+b*w;return L?(L=1/L,e[0]=(s*P-l*M+u*C)*L,e[1]=(a*M-n*P-i*C)*L,e[2]=(p*b-g*T+m*S)*L,e[3]=(f*T-h*b-d*S)*L,e[4]=(l*E-o*P-u*A)*L,e[5]=(r*P-a*E+i*A)*L,e[6]=(g*x-v*b-m*y)*L,e[7]=(c*b-f*x+d*y)*L,e[8]=(o*M-s*E+u*w)*L,e[9]=(n*E-r*M-i*w)*L,e[10]=(v*T-p*x+m*_)*L,e[11]=(h*x-c*T-d*_)*L,e[12]=(s*A-o*C-l*w)*L,e[13]=(r*C-n*A+a*w)*L,e[14]=(p*y-v*S-g*_)*L,e[15]=(c*S-h*y+f*_)*L,e):null};Ue.adjoint=function(e,t){var r=t[0],n=t[1],a=t[2],i=t[3],o=t[4],s=t[5],l=t[6],u=t[7],c=t[8],h=t[9],f=t[10],d=t[11],v=t[12],p=t[13],g=t[14],m=t[15];return e[0]=s*(f*m-d*g)-h*(l*m-u*g)+p*(l*d-u*f),e[1]=-(n*(f*m-d*g)-h*(a*m-i*g)+p*(a*d-i*f)),e[2]=n*(l*m-u*g)-s*(a*m-i*g)+p*(a*u-i*l),e[3]=-(n*(l*d-u*f)-s*(a*d-i*f)+h*(a*u-i*l)),e[4]=-(o*(f*m-d*g)-c*(l*m-u*g)+v*(l*d-u*f)),e[5]=r*(f*m-d*g)-c*(a*m-i*g)+v*(a*d-i*f),e[6]=-(r*(l*m-u*g)-o*(a*m-i*g)+v*(a*u-i*l)),e[7]=r*(l*d-u*f)-o*(a*d-i*f)+c*(a*u-i*l),e[8]=o*(h*m-d*p)-c*(s*m-u*p)+v*(s*d-u*h),e[9]=-(r*(h*m-d*p)-c*(n*m-i*p)+v*(n*d-i*h)),e[10]=r*(s*m-u*p)-o*(n*m-i*p)+v*(n*u-i*s),e[11]=-(r*(s*d-u*h)-o*(n*d-i*h)+c*(n*u-i*s)),e[12]=-(o*(h*g-f*p)-c*(s*g-l*p)+v*(s*f-l*h)),e[13]=r*(h*g-f*p)-c*(n*g-a*p)+v*(n*f-a*h),e[14]=-(r*(s*g-l*p)-o*(n*g-a*p)+v*(n*l-a*s)),e[15]=r*(s*f-l*h)-o*(n*f-a*h)+c*(n*l-a*s),e};Ue.determinant=function(e){var t=e[0],r=e[1],n=e[2],a=e[3],i=e[4],o=e[5],s=e[6],l=e[7],u=e[8],c=e[9],h=e[10],f=e[11],d=e[12],v=e[13],p=e[14],g=e[15],m=t*o-r*i,_=t*s-n*i,y=t*l-a*i,x=r*s-n*o,S=r*l-a*o,T=n*l-a*s,b=u*v-c*d,w=u*p-h*d,A=u*g-f*d,E=c*p-h*v,C=c*g-f*v,M=h*g-f*p;return m*M-_*C+y*E+x*A-S*w+T*b};Ue.multiply=function(e,t,r){var n=t[0],a=t[1],i=t[2],o=t[3],s=t[4],l=t[5],u=t[6],c=t[7],h=t[8],f=t[9],d=t[10],v=t[11],p=t[12],g=t[13],m=t[14],_=t[15],y=r[0],x=r[1],S=r[2],T=r[3];return e[0]=y*n+x*s+S*h+T*p,e[1]=y*a+x*l+S*f+T*g,e[2]=y*i+x*u+S*d+T*m,e[3]=y*o+x*c+S*v+T*_,y=r[4],x=r[5],S=r[6],T=r[7],e[4]=y*n+x*s+S*h+T*p,e[5]=y*a+x*l+S*f+T*g,e[6]=y*i+x*u+S*d+T*m,e[7]=y*o+x*c+S*v+T*_,y=r[8],x=r[9],S=r[10],T=r[11],e[8]=y*n+x*s+S*h+T*p,e[9]=y*a+x*l+S*f+T*g,e[10]=y*i+x*u+S*d+T*m,e[11]=y*o+x*c+S*v+T*_,y=r[12],x=r[13],S=r[14],T=r[15],e[12]=y*n+x*s+S*h+T*p,e[13]=y*a+x*l+S*f+T*g,e[14]=y*i+x*u+S*d+T*m,e[15]=y*o+x*c+S*v+T*_,e};Ue.multiplyAffine=function(e,t,r){var n=t[0],a=t[1],i=t[2],o=t[4],s=t[5],l=t[6],u=t[8],c=t[9],h=t[10],f=t[12],d=t[13],v=t[14],p=r[0],g=r[1],m=r[2];return e[0]=p*n+g*o+m*u,e[1]=p*a+g*s+m*c,e[2]=p*i+g*l+m*h,p=r[4],g=r[5],m=r[6],e[4]=p*n+g*o+m*u,e[5]=p*a+g*s+m*c,e[6]=p*i+g*l+m*h,p=r[8],g=r[9],m=r[10],e[8]=p*n+g*o+m*u,e[9]=p*a+g*s+m*c,e[10]=p*i+g*l+m*h,p=r[12],g=r[13],m=r[14],e[12]=p*n+g*o+m*u+f,e[13]=p*a+g*s+m*c+d,e[14]=p*i+g*l+m*h+v,e};Ue.mul=Ue.multiply;Ue.mulAffine=Ue.multiplyAffine;Ue.translate=function(e,t,r){var n=r[0],a=r[1],i=r[2],o,s,l,u,c,h,f,d,v,p,g,m;return t===e?(e[12]=t[0]*n+t[4]*a+t[8]*i+t[12],e[13]=t[1]*n+t[5]*a+t[9]*i+t[13],e[14]=t[2]*n+t[6]*a+t[10]*i+t[14],e[15]=t[3]*n+t[7]*a+t[11]*i+t[15]):(o=t[0],s=t[1],l=t[2],u=t[3],c=t[4],h=t[5],f=t[6],d=t[7],v=t[8],p=t[9],g=t[10],m=t[11],e[0]=o,e[1]=s,e[2]=l,e[3]=u,e[4]=c,e[5]=h,e[6]=f,e[7]=d,e[8]=v,e[9]=p,e[10]=g,e[11]=m,e[12]=o*n+c*a+v*i+t[12],e[13]=s*n+h*a+p*i+t[13],e[14]=l*n+f*a+g*i+t[14],e[15]=u*n+d*a+m*i+t[15]),e};Ue.scale=function(e,t,r){var n=r[0],a=r[1],i=r[2];return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*a,e[5]=t[5]*a,e[6]=t[6]*a,e[7]=t[7]*a,e[8]=t[8]*i,e[9]=t[9]*i,e[10]=t[10]*i,e[11]=t[11]*i,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e};Ue.rotate=function(e,t,r,n){var a=n[0],i=n[1],o=n[2],s=Math.sqrt(a*a+i*i+o*o),l,u,c,h,f,d,v,p,g,m,_,y,x,S,T,b,w,A,E,C,M,P,L,I;return Math.abs(s)<Es?null:(s=1/s,a*=s,i*=s,o*=s,l=Math.sin(r),u=Math.cos(r),c=1-u,h=t[0],f=t[1],d=t[2],v=t[3],p=t[4],g=t[5],m=t[6],_=t[7],y=t[8],x=t[9],S=t[10],T=t[11],b=a*a*c+u,w=i*a*c+o*l,A=o*a*c-i*l,E=a*i*c-o*l,C=i*i*c+u,M=o*i*c+a*l,P=a*o*c+i*l,L=i*o*c-a*l,I=o*o*c+u,e[0]=h*b+p*w+y*A,e[1]=f*b+g*w+x*A,e[2]=d*b+m*w+S*A,e[3]=v*b+_*w+T*A,e[4]=h*E+p*C+y*M,e[5]=f*E+g*C+x*M,e[6]=d*E+m*C+S*M,e[7]=v*E+_*C+T*M,e[8]=h*P+p*L+y*I,e[9]=f*P+g*L+x*I,e[10]=d*P+m*L+S*I,e[11]=v*P+_*L+T*I,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e)};Ue.rotateX=function(e,t,r){var n=Math.sin(r),a=Math.cos(r),i=t[4],o=t[5],s=t[6],l=t[7],u=t[8],c=t[9],h=t[10],f=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=i*a+u*n,e[5]=o*a+c*n,e[6]=s*a+h*n,e[7]=l*a+f*n,e[8]=u*a-i*n,e[9]=c*a-o*n,e[10]=h*a-s*n,e[11]=f*a-l*n,e};Ue.rotateY=function(e,t,r){var n=Math.sin(r),a=Math.cos(r),i=t[0],o=t[1],s=t[2],l=t[3],u=t[8],c=t[9],h=t[10],f=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=i*a-u*n,e[1]=o*a-c*n,e[2]=s*a-h*n,e[3]=l*a-f*n,e[8]=i*n+u*a,e[9]=o*n+c*a,e[10]=s*n+h*a,e[11]=l*n+f*a,e};Ue.rotateZ=function(e,t,r){var n=Math.sin(r),a=Math.cos(r),i=t[0],o=t[1],s=t[2],l=t[3],u=t[4],c=t[5],h=t[6],f=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=i*a+u*n,e[1]=o*a+c*n,e[2]=s*a+h*n,e[3]=l*a+f*n,e[4]=u*a-i*n,e[5]=c*a-o*n,e[6]=h*a-s*n,e[7]=f*a-l*n,e};Ue.fromRotationTranslation=function(e,t,r){var n=t[0],a=t[1],i=t[2],o=t[3],s=n+n,l=a+a,u=i+i,c=n*s,h=n*l,f=n*u,d=a*l,v=a*u,p=i*u,g=o*s,m=o*l,_=o*u;return e[0]=1-(d+p),e[1]=h+_,e[2]=f-m,e[3]=0,e[4]=h-_,e[5]=1-(c+p),e[6]=v+g,e[7]=0,e[8]=f+m,e[9]=v-g,e[10]=1-(c+d),e[11]=0,e[12]=r[0],e[13]=r[1],e[14]=r[2],e[15]=1,e};Ue.fromQuat=function(e,t){var r=t[0],n=t[1],a=t[2],i=t[3],o=r+r,s=n+n,l=a+a,u=r*o,c=n*o,h=n*s,f=a*o,d=a*s,v=a*l,p=i*o,g=i*s,m=i*l;return e[0]=1-h-v,e[1]=c+m,e[2]=f-g,e[3]=0,e[4]=c-m,e[5]=1-u-v,e[6]=d+p,e[7]=0,e[8]=f+g,e[9]=d-p,e[10]=1-u-h,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e};Ue.frustum=function(e,t,r,n,a,i,o){var s=1/(r-t),l=1/(a-n),u=1/(i-o);return e[0]=i*2*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=i*2*l,e[6]=0,e[7]=0,e[8]=(r+t)*s,e[9]=(a+n)*l,e[10]=(o+i)*u,e[11]=-1,e[12]=0,e[13]=0,e[14]=o*i*2*u,e[15]=0,e};Ue.perspective=function(e,t,r,n,a){var i=1/Math.tan(t/2),o=1/(n-a);return e[0]=i/r,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=i,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=(a+n)*o,e[11]=-1,e[12]=0,e[13]=0,e[14]=2*a*n*o,e[15]=0,e};Ue.ortho=function(e,t,r,n,a,i,o){var s=1/(t-r),l=1/(n-a),u=1/(i-o);return e[0]=-2*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*l,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*u,e[11]=0,e[12]=(t+r)*s,e[13]=(a+n)*l,e[14]=(o+i)*u,e[15]=1,e};Ue.lookAt=function(e,t,r,n){var a,i,o,s,l,u,c,h,f,d,v=t[0],p=t[1],g=t[2],m=n[0],_=n[1],y=n[2],x=r[0],S=r[1],T=r[2];return Math.abs(v-x)<Es&&Math.abs(p-S)<Es&&Math.abs(g-T)<Es?Ue.identity(e):(c=v-x,h=p-S,f=g-T,d=1/Math.sqrt(c*c+h*h+f*f),c*=d,h*=d,f*=d,a=_*f-y*h,i=y*c-m*f,o=m*h-_*c,d=Math.sqrt(a*a+i*i+o*o),d?(d=1/d,a*=d,i*=d,o*=d):(a=0,i=0,o=0),s=h*o-f*i,l=f*a-c*o,u=c*i-h*a,d=Math.sqrt(s*s+l*l+u*u),d?(d=1/d,s*=d,l*=d,u*=d):(s=0,l=0,u=0),e[0]=a,e[1]=s,e[2]=c,e[3]=0,e[4]=i,e[5]=l,e[6]=h,e[7]=0,e[8]=o,e[9]=u,e[10]=f,e[11]=0,e[12]=-(a*v+i*p+o*g),e[13]=-(s*v+l*p+u*g),e[14]=-(c*v+h*p+f*g),e[15]=1,e)};Ue.frob=function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2)+Math.pow(e[4],2)+Math.pow(e[5],2)+Math.pow(e[6],2)+Math.pow(e[7],2)+Math.pow(e[8],2)+Math.pow(e[9],2)+Math.pow(e[10],2)+Math.pow(e[11],2)+Math.pow(e[12],2)+Math.pow(e[13],2)+Math.pow(e[14],2)+Math.pow(e[15],2))};const $=Ue;var ce={};ce.create=function(){var e=new Bt(3);return e[0]=0,e[1]=0,e[2]=0,e};ce.clone=function(e){var t=new Bt(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t};ce.fromValues=function(e,t,r){var n=new Bt(3);return n[0]=e,n[1]=t,n[2]=r,n};ce.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e};ce.set=function(e,t,r,n){return e[0]=t,e[1]=r,e[2]=n,e};ce.add=function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e};ce.subtract=function(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e};ce.sub=ce.subtract;ce.multiply=function(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e[2]=t[2]*r[2],e};ce.mul=ce.multiply;ce.divide=function(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e[2]=t[2]/r[2],e};ce.div=ce.divide;ce.min=function(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e[2]=Math.min(t[2],r[2]),e};ce.max=function(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e[2]=Math.max(t[2],r[2]),e};ce.scale=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e};ce.scaleAndAdd=function(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e};ce.distance=function(e,t){var r=t[0]-e[0],n=t[1]-e[1],a=t[2]-e[2];return Math.sqrt(r*r+n*n+a*a)};ce.dist=ce.distance;ce.squaredDistance=function(e,t){var r=t[0]-e[0],n=t[1]-e[1],a=t[2]-e[2];return r*r+n*n+a*a};ce.sqrDist=ce.squaredDistance;ce.length=function(e){var t=e[0],r=e[1],n=e[2];return Math.sqrt(t*t+r*r+n*n)};ce.len=ce.length;ce.squaredLength=function(e){var t=e[0],r=e[1],n=e[2];return t*t+r*r+n*n};ce.sqrLen=ce.squaredLength;ce.negate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e};ce.inverse=function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e};ce.normalize=function(e,t){var r=t[0],n=t[1],a=t[2],i=r*r+n*n+a*a;return i>0&&(i=1/Math.sqrt(i),e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i),e};ce.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]};ce.cross=function(e,t,r){var n=t[0],a=t[1],i=t[2],o=r[0],s=r[1],l=r[2];return e[0]=a*l-i*s,e[1]=i*o-n*l,e[2]=n*s-a*o,e};ce.lerp=function(e,t,r,n){var a=t[0],i=t[1],o=t[2];return e[0]=a+n*(r[0]-a),e[1]=i+n*(r[1]-i),e[2]=o+n*(r[2]-o),e};ce.random=function(e,t){t=t||1;var r=Wa()*2*Math.PI,n=Wa()*2-1,a=Math.sqrt(1-n*n)*t;return e[0]=Math.cos(r)*a,e[1]=Math.sin(r)*a,e[2]=n*t,e};ce.transformMat4=function(e,t,r){var n=t[0],a=t[1],i=t[2],o=r[3]*n+r[7]*a+r[11]*i+r[15];return o=o||1,e[0]=(r[0]*n+r[4]*a+r[8]*i+r[12])/o,e[1]=(r[1]*n+r[5]*a+r[9]*i+r[13])/o,e[2]=(r[2]*n+r[6]*a+r[10]*i+r[14])/o,e};ce.transformMat3=function(e,t,r){var n=t[0],a=t[1],i=t[2];return e[0]=n*r[0]+a*r[3]+i*r[6],e[1]=n*r[1]+a*r[4]+i*r[7],e[2]=n*r[2]+a*r[5]+i*r[8],e};ce.transformQuat=function(e,t,r){var n=t[0],a=t[1],i=t[2],o=r[0],s=r[1],l=r[2],u=r[3],c=u*n+s*i-l*a,h=u*a+l*n-o*i,f=u*i+o*a-s*n,d=-o*n-s*a-l*i;return e[0]=c*u+d*-o+h*-l-f*-s,e[1]=h*u+d*-s+f*-o-c*-l,e[2]=f*u+d*-l+c*-s-h*-o,e};ce.rotateX=function(e,t,r,n){var a=[],i=[];return a[0]=t[0]-r[0],a[1]=t[1]-r[1],a[2]=t[2]-r[2],i[0]=a[0],i[1]=a[1]*Math.cos(n)-a[2]*Math.sin(n),i[2]=a[1]*Math.sin(n)+a[2]*Math.cos(n),e[0]=i[0]+r[0],e[1]=i[1]+r[1],e[2]=i[2]+r[2],e};ce.rotateY=function(e,t,r,n){var a=[],i=[];return a[0]=t[0]-r[0],a[1]=t[1]-r[1],a[2]=t[2]-r[2],i[0]=a[2]*Math.sin(n)+a[0]*Math.cos(n),i[1]=a[1],i[2]=a[2]*Math.cos(n)-a[0]*Math.sin(n),e[0]=i[0]+r[0],e[1]=i[1]+r[1],e[2]=i[2]+r[2],e};ce.rotateZ=function(e,t,r,n){var a=[],i=[];return a[0]=t[0]-r[0],a[1]=t[1]-r[1],a[2]=t[2]-r[2],i[0]=a[0]*Math.cos(n)-a[1]*Math.sin(n),i[1]=a[0]*Math.sin(n)+a[1]*Math.cos(n),i[2]=a[2],e[0]=i[0]+r[0],e[1]=i[1]+r[1],e[2]=i[2]+r[2],e};ce.forEach=function(){var e=ce.create();return function(t,r,n,a,i,o){var s,l;for(r||(r=3),n||(n=0),a?l=Math.min(a*r+n,t.length):l=t.length,s=n;s<l;s+=r)e[0]=t[s],e[1]=t[s+1],e[2]=t[s+2],i(e,e,o),t[s]=e[0],t[s+1]=e[1],t[s+2]=e[2];return t}}();ce.angle=function(e,t){var r=ce.fromValues(e[0],e[1],e[2]),n=ce.fromValues(t[0],t[1],t[2]);ce.normalize(r,r),ce.normalize(n,n);var a=ce.dot(r,n);return a>1?0:Math.acos(a)};const O=ce;H.import(K_);var je=$.create,l1={};function u1(e){return e.material}function cI(e,t,r){return t.uniforms[r].value}function hI(e,t,r,n){return r!==n}function fI(e){return!0}function c1(){}var h1={float:G.FLOAT,byte:G.BYTE,ubyte:G.UNSIGNED_BYTE,short:G.SHORT,ushort:G.UNSIGNED_SHORT};function dI(e,t,r){this.availableAttributes=e,this.availableAttributeSymbols=t,this.indicesBuffer=r,this.vao=null}function vI(e){var t,r;this.bind=function(n){t||(t=ht.createCanvas(),t.width=t.height=1,t.getContext("2d"));var a=n.gl,i=!r;i&&(r=a.createTexture()),a.bindTexture(a.TEXTURE_2D,r),i&&a.texImage2D(a.TEXTURE_2D,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,t)},this.unbind=function(n){n.gl.bindTexture(n.gl.TEXTURE_2D,null)},this.isRenderable=function(){return!0}}var In=qt.extend(function(){return{canvas:null,_width:100,_height:100,devicePixelRatio:typeof window<"u"&&window.devicePixelRatio||1,clearColor:[0,0,0,0],clearBit:17664,alpha:!0,depth:!0,stencil:!1,antialias:!0,premultipliedAlpha:!0,preserveDrawingBuffer:!1,throwError:!0,gl:null,viewport:{},maxJointNumber:20,__currentFrameBuffer:null,_viewportStack:[],_clearStack:[],_sceneRendering:null}},function(){this.canvas||(this.canvas=ht.createCanvas());var e=this.canvas;try{var t={alpha:this.alpha,depth:this.depth,stencil:this.stencil,antialias:this.antialias,premultipliedAlpha:this.premultipliedAlpha,preserveDrawingBuffer:this.preserveDrawingBuffer};if(this.gl=e.getContext("webgl",t)||e.getContext("experimental-webgl",t),!this.gl)throw new Error;this._glinfo=new k8(this.gl),this.gl.targetRenderer&&console.error("Already created a renderer"),this.gl.targetRenderer=this,this.resize()}catch(r){throw"Error creating WebGL Context "+r}this._programMgr=new j_(this),this._placeholderTexture=new vI},{resize:function(e,t){var r=this.canvas,n=this.devicePixelRatio;e!=null?(r.style&&(r.style.width=e+"px",r.style.height=t+"px"),r.width=e*n,r.height=t*n,this._width=e,this._height=t):(this._width=r.width/n,this._height=r.height/n),this.setViewport(0,0,this._width,this._height)},getWidth:function(){return this._width},getHeight:function(){return this._height},getViewportAspect:function(){var e=this.viewport;return e.width/e.height},setDevicePixelRatio:function(e){this.devicePixelRatio=e,this.resize(this._width,this._height)},getDevicePixelRatio:function(){return this.devicePixelRatio},getGLExtension:function(e){return this._glinfo.getExtension(e)},getGLParameter:function(e){return this._glinfo.getParameter(e)},setViewport:function(e,t,r,n,a){if(typeof e=="object"){var i=e;e=i.x,t=i.y,r=i.width,n=i.height,a=i.devicePixelRatio}a=a||this.devicePixelRatio,this.gl.viewport(e*a,t*a,r*a,n*a),this.viewport={x:e,y:t,width:r,height:n,devicePixelRatio:a}},saveViewport:function(){this._viewportStack.push(this.viewport)},restoreViewport:function(){this._viewportStack.length>0&&this.setViewport(this._viewportStack.pop())},saveClear:function(){this._clearStack.push({clearBit:this.clearBit,clearColor:this.clearColor})},restoreClear:function(){if(this._clearStack.length>0){var e=this._clearStack.pop();this.clearColor=e.clearColor,this.clearBit=e.clearBit}},bindSceneRendering:function(e){this._sceneRendering=e},render:function(e,t,r,n){var a=this.gl,i=this.clearColor;if(this.clearBit){a.colorMask(!0,!0,!0,!0),a.depthMask(!0);var o=this.viewport,s=!1,l=o.devicePixelRatio;(o.width!==this._width||o.height!==this._height||l&&l!==this.devicePixelRatio||o.x||o.y)&&(s=!0,a.enable(a.SCISSOR_TEST),a.scissor(o.x*l,o.y*l,o.width*l,o.height*l)),a.clearColor(i[0],i[1],i[2],i[3]),a.clear(this.clearBit),s&&a.disable(a.SCISSOR_TEST)}if(r||e.update(!1),e.updateLights(),t=t||e.getMainCamera(),!t){console.error("Can't find camera in the scene.");return}t.update();var u=e.updateRenderList(t,!0);this._sceneRendering=e;var c=u.opaque,h=u.transparent,f=e.material;e.trigger("beforerender",this,e,t,u),n?(this.renderPreZ(c,e,t),a.depthFunc(a.LEQUAL)):a.depthFunc(a.LESS);for(var d=je(),v=O.create(),p=0;p<h.length;p++){var g=h[p];$.multiplyAffine(d,t.viewMatrix.array,g.worldTransform.array),O.transformMat4(v,g.position.array,d),g.__depth=v[2]}this.renderPass(c,t,{getMaterial:function(m){return f||m.material},sortCompare:this.opaqueSortCompare}),this.renderPass(h,t,{getMaterial:function(m){return f||m.material},sortCompare:this.transparentSortCompare}),e.trigger("afterrender",this,e,t,u),this._sceneRendering=null},getProgram:function(e,t,r){return t=t||e.material,this._programMgr.getProgram(e,t,r)},validateProgram:function(e){if(e.__error){var t=e.__error;if(l1[e.__uid__])return;if(l1[e.__uid__]=!0,this.throwError)throw new Error(t);this.trigger("error",t)}},updatePrograms:function(e,t,r){var n=r&&r.getMaterial||u1;t=t||null;for(var a=0;a<e.length;a++){var i=e[a],o=n.call(this,i);if(a>0){var s=e[a-1],l=s.joints?s.joints.length:0,u=i.joints?i.joints.length:0;if(u===l&&i.material===s.material&&i.lightGroup===s.lightGroup){i.__program=s.__program;continue}}var c=this._programMgr.getProgram(i,o,t);this.validateProgram(c),i.__program=c}},renderPass:function(e,t,r){this.trigger("beforerenderpass",this,e,t,r),r=r||{},r.getMaterial=r.getMaterial||u1,r.getUniform=r.getUniform||cI,r.isMaterialChanged=r.isMaterialChanged||hI,r.beforeRender=r.beforeRender||c1,r.afterRender=r.afterRender||c1;var n=r.ifRender||fI;this.updatePrograms(e,this._sceneRendering,r),r.sortCompare&&e.sort(r.sortCompare);var a=this.viewport,i=a.devicePixelRatio,o=[a.x*i,a.y*i,a.width*i,a.height*i],s=this.devicePixelRatio,l=this.__currentFrameBuffer?[this.__currentFrameBuffer.getTextureWidth(),this.__currentFrameBuffer.getTextureHeight()]:[this._width*s,this._height*s],u=[o[2],o[3]],c=Date.now();t?($.copy(Xe.VIEW,t.viewMatrix.array),$.copy(Xe.PROJECTION,t.projectionMatrix.array),$.copy(Xe.VIEWINVERSE,t.worldTransform.array)):($.identity(Xe.VIEW),$.identity(Xe.PROJECTION),$.identity(Xe.VIEWINVERSE)),$.multiply(Xe.VIEWPROJECTION,Xe.PROJECTION,Xe.VIEW),$.invert(Xe.PROJECTIONINVERSE,Xe.PROJECTION),$.invert(Xe.VIEWPROJECTIONINVERSE,Xe.VIEWPROJECTION);for(var h=this.gl,f=this._sceneRendering,d,v,p,g,m,_,y,x,S,T,b,w,A=null,E=0;E<e.length;E++){var C=e[E],M=C.worldTransform!=null,P;if(n(C)){M&&(P=C.isSkinnedMesh&&C.isSkinnedMesh()?C.offsetMatrix?C.offsetMatrix.array:Xe.IDENTITY:C.worldTransform.array);var L=C.geometry,I=r.getMaterial.call(this,C),N=C.__program,F=I.shader,B=L.__uid__+"-"+N.__uid__,k=B!==T;T=B,k&&A&&A.bindVertexArrayOES(null),M&&($.copy(Xe.WORLD,P),$.multiply(Xe.WORLDVIEWPROJECTION,Xe.VIEWPROJECTION,P),$.multiplyAffine(Xe.WORLDVIEW,Xe.VIEW,P),(F.matrixSemantics.WORLDINVERSE||F.matrixSemantics.WORLDINVERSETRANSPOSE)&&$.invert(Xe.WORLDINVERSE,P),(F.matrixSemantics.WORLDVIEWINVERSE||F.matrixSemantics.WORLDVIEWINVERSETRANSPOSE)&&$.invert(Xe.WORLDVIEWINVERSE,Xe.WORLDVIEW),(F.matrixSemantics.WORLDVIEWPROJECTIONINVERSE||F.matrixSemantics.WORLDVIEWPROJECTIONINVERSETRANSPOSE)&&$.invert(Xe.WORLDVIEWPROJECTIONINVERSE,Xe.WORLDVIEWPROJECTION)),C.beforeRender&&C.beforeRender(this),r.beforeRender.call(this,C,I,d);var z=N!==v;z?(N.bind(this),N.setUniformOfSemantic(h,"VIEWPORT",o),N.setUniformOfSemantic(h,"WINDOW_SIZE",l),t&&(N.setUniformOfSemantic(h,"NEAR",t.near),N.setUniformOfSemantic(h,"FAR",t.far)),N.setUniformOfSemantic(h,"DEVICEPIXELRATIO",i),N.setUniformOfSemantic(h,"TIME",c),N.setUniformOfSemantic(h,"VIEWPORT_SIZE",u),f&&f.setLightUniforms(N,C.lightGroup,this)):N=v,(z||r.isMaterialChanged(C,p,I,d))&&(I.depthTest!==g&&(I.depthTest?h.enable(h.DEPTH_TEST):h.disable(h.DEPTH_TEST),g=I.depthTest),I.depthMask!==m&&(h.depthMask(I.depthMask),m=I.depthMask),I.transparent!==S&&(I.transparent?h.enable(h.BLEND):h.disable(h.BLEND),S=I.transparent),I.transparent&&(I.blend?I.blend(h):(h.blendEquationSeparate(h.FUNC_ADD,h.FUNC_ADD),h.blendFuncSeparate(h.SRC_ALPHA,h.ONE_MINUS_SRC_ALPHA,h.ONE,h.ONE_MINUS_SRC_ALPHA))),w=this._bindMaterial(C,I,N,p||null,d||null,v||null,r.getUniform),d=I);var W=F.matrixSemanticKeys;if(M)for(var J=0;J<W.length;J++){var re=W[J],Q=F.matrixSemantics[re],q=Xe[re];if(Q.isTranspose){var Ee=Xe[Q.semanticNoTranspose];$.transpose(q,Ee)}N.setUniform(h,Q.type,Q.symbol,q)}C.cullFace!==y&&(y=C.cullFace,h.cullFace(y)),C.frontFace!==x&&(x=C.frontFace,h.frontFace(x)),C.culling!==_&&(_=C.culling,_?h.enable(h.CULL_FACE):h.disable(h.CULL_FACE)),this._updateSkeleton(C,N,w),k&&(b=this._bindVAO(A,F,L,N)),this._renderObject(C,b,N),r.afterRender(this,C),C.afterRender&&C.afterRender(this),v=N,p=C}}this.trigger("afterrenderpass",this,e,t,r)},getMaxJointNumber:function(){return this.maxJointNumber},_updateSkeleton:function(e,t,r){var n=this.gl,a=e.skeleton;if(a)if(a.update(),e.joints.length>this.getMaxJointNumber()){var i=a.getSubSkinMatricesTexture(e.__uid__,e.joints);t.useTextureSlot(this,i,r),t.setUniform(n,"1i","skinMatricesTexture",r),t.setUniform(n,"1f","skinMatricesTextureSize",i.width)}else{var o=a.getSubSkinMatrices(e.__uid__,e.joints);t.setUniformOfSemantic(n,"SKIN_MATRIX",o)}},_renderObject:function(e,t,r){var n=this.gl,a=e.geometry,i=e.mode;i==null&&(i=4);var o=null,s=e.isInstancedMesh&&e.isInstancedMesh();if(s&&(o=this.getGLExtension("ANGLE_instanced_arrays"),!o)){console.warn("Device not support ANGLE_instanced_arrays extension");return}var l;if(s&&(l=this._bindInstancedAttributes(e,r,o)),t.indicesBuffer){var u=this.getGLExtension("OES_element_index_uint"),c=u&&a.indices instanceof Uint32Array,h=c?n.UNSIGNED_INT:n.UNSIGNED_SHORT;s?o.drawElementsInstancedANGLE(i,t.indicesBuffer.count,h,0,e.getInstanceCount()):n.drawElements(i,t.indicesBuffer.count,h,0)}else s?o.drawArraysInstancedANGLE(i,0,a.vertexCount,e.getInstanceCount()):n.drawArrays(i,0,a.vertexCount);if(s)for(var f=0;f<l.length;f++)n.disableVertexAttribArray(l[f])},_bindInstancedAttributes:function(e,t,r){for(var n=this.gl,a=e.getInstancedAttributesBuffers(this),i=[],o=0;o<a.length;o++){var s=a[o],l=t.getAttribLocation(n,s.symbol);if(!(l<0)){var u=h1[s.type]||n.FLOAT;n.enableVertexAttribArray(l),n.bindBuffer(n.ARRAY_BUFFER,s.buffer),n.vertexAttribPointer(l,s.size,u,!1,0,0),r.vertexAttribDivisorANGLE(l,s.divisor),i.push(l)}}return i},_bindMaterial:function(e,t,r,n,a,i,o){for(var s=this.gl,l=i===r,u=r.currentTextureSlot(),c=t.getEnabledUniforms(),h=t.getTextureUniforms(),f=this._placeholderTexture,d=0;d<h.length;d++){var v=h[d],p=o(e,t,v),g=t.uniforms[v].type;if(g==="t"&&p)p.__slot=-1;else if(g==="tv")for(var m=0;m<p.length;m++)p[m]&&(p[m].__slot=-1)}f.__slot=-1;for(var d=0;d<c.length;d++){var v=c[d],_=t.uniforms[v],p=o(e,t,v),g=_.type,y=g==="t";if(y&&(!p||!p.isRenderable())&&(p=f),a&&l){var x=o(n,a,v);if(y&&(!x||!x.isRenderable())&&(x=f),x===p){if(y)r.takeCurrentTextureSlot(this,null);else if(g==="tv"&&p)for(var m=0;m<p.length;m++)r.takeCurrentTextureSlot(this,null);continue}}if(p!=null)if(y)if(p.__slot<0){var S=r.currentTextureSlot(),T=r.setUniform(s,"1i",v,S);T&&(r.takeCurrentTextureSlot(this,p),p.__slot=S)}else r.setUniform(s,"1i",v,p.__slot);else if(Array.isArray(p)){if(p.length===0)continue;if(g==="tv"){if(!r.hasUniform(v))continue;for(var b=[],m=0;m<p.length;m++){var w=p[m];if(w.__slot<0){var S=r.currentTextureSlot();b.push(S),r.takeCurrentTextureSlot(this,w),w.__slot=S}else b.push(w.__slot)}r.setUniform(s,"1iv",v,b)}else r.setUniform(s,_.type,v,p)}else r.setUniform(s,_.type,v,p)}var A=r.currentTextureSlot();return r.resetTextureSlot(u),A},_bindVAO:function(e,t,r,n){var a=!r.dynamic,i=this.gl,o=this.__uid__+"-"+n.__uid__,s=r.__vaoCache[o];if(!s){var l=r.getBufferChunks(this);if(!l||!l.length)return;for(var u=l[0],c=u.attributeBuffers,x=u.indicesBuffer,y=[],h=[],f=0;f<c.length;f++){var d=c[f],v=d.name,p=d.semantic,g;if(p){var m=t.attributeSemantics[p];g=m&&m.symbol}else g=v;g&&n.attributes[g]&&(y.push(d),h.push(g))}s=new dI(y,h,x),a&&(r.__vaoCache[o]=s)}var _=!0;e&&a&&(s.vao==null?s.vao=e.createVertexArrayOES():_=!1,e.bindVertexArrayOES(s.vao));var y=s.availableAttributes,x=s.indicesBuffer;if(_){for(var S=n.enableAttributes(this,s.availableAttributeSymbols,e&&a&&s),f=0;f<y.length;f++){var T=S[f];if(T!==-1){var d=y[f],b=d.buffer,w=d.size,A=h1[d.type]||i.FLOAT;i.bindBuffer(i.ARRAY_BUFFER,b),i.vertexAttribPointer(T,w,A,!1,0,0)}}r.isUseIndices()&&i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,x.buffer)}return s},renderPreZ:function(e,t,r){var n=this.gl,a=this._prezMaterial||new Sr({shader:new H(H.source("clay.prez.vertex"),H.source("clay.prez.fragment"))});this._prezMaterial=a,n.colorMask(!1,!1,!1,!1),n.depthMask(!0),this.renderPass(e,r,{ifRender:function(i){return!i.ignorePreZ},isMaterialChanged:function(i,o){var s=i.material,l=o.material;return s.get("diffuseMap")!==l.get("diffuseMap")||(s.get("alphaCutoff")||0)!==(l.get("alphaCutoff")||0)},getUniform:function(i,o,s){if(s==="alphaMap")return i.material.get("diffuseMap");if(s==="alphaCutoff"){if(i.material.isDefined("fragment","ALPHA_TEST")&&i.material.get("diffuseMap")){var l=i.material.get("alphaCutoff");return l||0}return 0}else return s==="uvRepeat"?i.material.get("uvRepeat"):s==="uvOffset"?i.material.get("uvOffset"):o.get(s)},getMaterial:function(){return a},sort:this.opaqueSortCompare}),n.colorMask(!0,!0,!0,!0),n.depthMask(!0)},disposeScene:function(e){this.disposeNode(e,!0,!0),e.dispose()},disposeNode:function(e,t,r){e.getParent()&&e.getParent().remove(e);var n={};e.traverse(function(a){var i=a.material;if(a.geometry&&t&&a.geometry.dispose(this),r&&i&&!n[i.__uid__]){for(var o=i.getTextureUniforms(),s=0;s<o.length;s++){var l=o[s],u=i.uniforms[l].value,c=i.uniforms[l].type;if(u){if(c==="t")u.dispose&&u.dispose(this);else if(c==="tv")for(var h=0;h<u.length;h++)u[h]&&u[h].dispose&&u[h].dispose(this)}}n[i.__uid__]=!0}a.dispose&&a.dispose(this)},this)},disposeGeometry:function(e){e.dispose(this)},disposeTexture:function(e){e.dispose(this)},disposeFrameBuffer:function(e){e.dispose(this)},dispose:function(){},screenToNDC:function(e,t,r){r||(r=new lr),t=this._height-t;var n=this.viewport,a=r.array;return a[0]=(e-n.x)/n.width,a[0]=a[0]*2-1,a[1]=(t-n.y)/n.height,a[1]=a[1]*2-1,r}});In.opaqueSortCompare=In.prototype.opaqueSortCompare=function(e,t){return e.renderOrder===t.renderOrder?e.__program===t.__program?e.material===t.material?e.geometry.__uid__-t.geometry.__uid__:e.material.__uid__-t.material.__uid__:e.__program&&t.__program?e.__program.__uid__-t.__program.__uid__:0:e.renderOrder-t.renderOrder};In.transparentSortCompare=In.prototype.transparentSortCompare=function(e,t){return e.renderOrder===t.renderOrder?e.__depth===t.__depth?e.__program===t.__program?e.material===t.material?e.geometry.__uid__-t.geometry.__uid__:e.material.__uid__-t.material.__uid__:e.__program&&t.__program?e.__program.__uid__-t.__program.__uid__:0:e.__depth-t.__depth:e.renderOrder-t.renderOrder};var Xe={IDENTITY:je(),WORLD:je(),VIEW:je(),PROJECTION:je(),WORLDVIEW:je(),VIEWPROJECTION:je(),WORLDVIEWPROJECTION:je(),WORLDINVERSE:je(),VIEWINVERSE:je(),PROJECTIONINVERSE:je(),WORLDVIEWINVERSE:je(),VIEWPROJECTIONINVERSE:je(),WORLDVIEWPROJECTIONINVERSE:je(),WORLDTRANSPOSE:je(),VIEWTRANSPOSE:je(),PROJECTIONTRANSPOSE:je(),WORLDVIEWTRANSPOSE:je(),VIEWPROJECTIONTRANSPOSE:je(),WORLDVIEWPROJECTIONTRANSPOSE:je(),WORLDINVERSETRANSPOSE:je(),VIEWINVERSETRANSPOSE:je(),PROJECTIONINVERSETRANSPOSE:je(),WORLDVIEWINVERSETRANSPOSE:je(),VIEWPROJECTIONINVERSETRANSPOSE:je(),WORLDVIEWPROJECTIONINVERSETRANSPOSE:je()};In.COLOR_BUFFER_BIT=G.COLOR_BUFFER_BIT;In.DEPTH_BUFFER_BIT=G.DEPTH_BUFFER_BIT;In.STENCIL_BUFFER_BIT=G.STENCIL_BUFFER_BIT;const ro=In;var ue=function(e,t,r){e=e||0,t=t||0,r=r||0,this.array=O.fromValues(e,t,r),this._dirty=!0};ue.prototype={constructor:ue,add:function(e){return O.add(this.array,this.array,e.array),this._dirty=!0,this},set:function(e,t,r){return this.array[0]=e,this.array[1]=t,this.array[2]=r,this._dirty=!0,this},setArray:function(e){return this.array[0]=e[0],this.array[1]=e[1],this.array[2]=e[2],this._dirty=!0,this},clone:function(){return new ue(this.x,this.y,this.z)},copy:function(e){return O.copy(this.array,e.array),this._dirty=!0,this},cross:function(e,t){return O.cross(this.array,e.array,t.array),this._dirty=!0,this},dist:function(e){return O.dist(this.array,e.array)},distance:function(e){return O.distance(this.array,e.array)},div:function(e){return O.div(this.array,this.array,e.array),this._dirty=!0,this},divide:function(e){return O.divide(this.array,this.array,e.array),this._dirty=!0,this},dot:function(e){return O.dot(this.array,e.array)},len:function(){return O.len(this.array)},length:function(){return O.length(this.array)},lerp:function(e,t,r){return O.lerp(this.array,e.array,t.array,r),this._dirty=!0,this},min:function(e){return O.min(this.array,this.array,e.array),this._dirty=!0,this},max:function(e){return O.max(this.array,this.array,e.array),this._dirty=!0,this},mul:function(e){return O.mul(this.array,this.array,e.array),this._dirty=!0,this},multiply:function(e){return O.multiply(this.array,this.array,e.array),this._dirty=!0,this},negate:function(){return O.negate(this.array,this.array),this._dirty=!0,this},normalize:function(){return O.normalize(this.array,this.array),this._dirty=!0,this},random:function(e){return O.random(this.array,e),this._dirty=!0,this},scale:function(e){return O.scale(this.array,this.array,e),this._dirty=!0,this},scaleAndAdd:function(e,t){return O.scaleAndAdd(this.array,this.array,e.array,t),this._dirty=!0,this},sqrDist:function(e){return O.sqrDist(this.array,e.array)},squaredDistance:function(e){return O.squaredDistance(this.array,e.array)},sqrLen:function(){return O.sqrLen(this.array)},squaredLength:function(){return O.squaredLength(this.array)},sub:function(e){return O.sub(this.array,this.array,e.array),this._dirty=!0,this},subtract:function(e){return O.subtract(this.array,this.array,e.array),this._dirty=!0,this},transformMat3:function(e){return O.transformMat3(this.array,this.array,e.array),this._dirty=!0,this},transformMat4:function(e){return O.transformMat4(this.array,this.array,e.array),this._dirty=!0,this},transformQuat:function(e){return O.transformQuat(this.array,this.array,e.array),this._dirty=!0,this},applyProjection:function(e){var t=this.array;if(e=e.array,e[15]===0){var r=-1/t[2];t[0]=e[0]*t[0]*r,t[1]=e[5]*t[1]*r,t[2]=(e[10]*t[2]+e[14])*r}else t[0]=e[0]*t[0]+e[12],t[1]=e[5]*t[1]+e[13],t[2]=e[10]*t[2]+e[14];return this._dirty=!0,this},eulerFromQuat:function(e,t){ue.eulerFromQuat(this,e,t)},eulerFromMat3:function(e,t){ue.eulerFromMat3(this,e,t)},toString:function(){return"["+Array.prototype.join.call(this.array,",")+"]"},toArray:function(){return Array.prototype.slice.call(this.array)}};var cs=Object.defineProperty;if(cs){var xc=ue.prototype;cs(xc,"x",{get:function(){return this.array[0]},set:function(e){this.array[0]=e,this._dirty=!0}}),cs(xc,"y",{get:function(){return this.array[1]},set:function(e){this.array[1]=e,this._dirty=!0}}),cs(xc,"z",{get:function(){return this.array[2]},set:function(e){this.array[2]=e,this._dirty=!0}})}ue.add=function(e,t,r){return O.add(e.array,t.array,r.array),e._dirty=!0,e};ue.set=function(e,t,r,n){O.set(e.array,t,r,n),e._dirty=!0};ue.copy=function(e,t){return O.copy(e.array,t.array),e._dirty=!0,e};ue.cross=function(e,t,r){return O.cross(e.array,t.array,r.array),e._dirty=!0,e};ue.dist=function(e,t){return O.distance(e.array,t.array)};ue.distance=ue.dist;ue.div=function(e,t,r){return O.divide(e.array,t.array,r.array),e._dirty=!0,e};ue.divide=ue.div;ue.dot=function(e,t){return O.dot(e.array,t.array)};ue.len=function(e){return O.length(e.array)};ue.lerp=function(e,t,r,n){return O.lerp(e.array,t.array,r.array,n),e._dirty=!0,e};ue.min=function(e,t,r){return O.min(e.array,t.array,r.array),e._dirty=!0,e};ue.max=function(e,t,r){return O.max(e.array,t.array,r.array),e._dirty=!0,e};ue.mul=function(e,t,r){return O.multiply(e.array,t.array,r.array),e._dirty=!0,e};ue.multiply=ue.mul;ue.negate=function(e,t){return O.negate(e.array,t.array),e._dirty=!0,e};ue.normalize=function(e,t){return O.normalize(e.array,t.array),e._dirty=!0,e};ue.random=function(e,t){return O.random(e.array,t),e._dirty=!0,e};ue.scale=function(e,t,r){return O.scale(e.array,t.array,r),e._dirty=!0,e};ue.scaleAndAdd=function(e,t,r,n){return O.scaleAndAdd(e.array,t.array,r.array,n),e._dirty=!0,e};ue.sqrDist=function(e,t){return O.sqrDist(e.array,t.array)};ue.squaredDistance=ue.sqrDist;ue.sqrLen=function(e){return O.sqrLen(e.array)};ue.squaredLength=ue.sqrLen;ue.sub=function(e,t,r){return O.subtract(e.array,t.array,r.array),e._dirty=!0,e};ue.subtract=ue.sub;ue.transformMat3=function(e,t,r){return O.transformMat3(e.array,t.array,r.array),e._dirty=!0,e};ue.transformMat4=function(e,t,r){return O.transformMat4(e.array,t.array,r.array),e._dirty=!0,e};ue.transformQuat=function(e,t,r){return O.transformQuat(e.array,t.array,r.array),e._dirty=!0,e};function yr(e,t,r){return e<t?t:e>r?r:e}var ze=Math.atan2,_r=Math.asin,Pa=Math.abs;ue.eulerFromQuat=function(e,t,f){e._dirty=!0,t=t.array;var n=e.array,a=t[0],i=t[1],o=t[2],s=t[3],l=a*a,u=i*i,c=o*o,h=s*s,f=(f||"XYZ").toUpperCase();switch(f){case"XYZ":n[0]=ze(2*(a*s-i*o),h-l-u+c),n[1]=_r(yr(2*(a*o+i*s),-1,1)),n[2]=ze(2*(o*s-a*i),h+l-u-c);break;case"YXZ":n[0]=_r(yr(2*(a*s-i*o),-1,1)),n[1]=ze(2*(a*o+i*s),h-l-u+c),n[2]=ze(2*(a*i+o*s),h-l+u-c);break;case"ZXY":n[0]=_r(yr(2*(a*s+i*o),-1,1)),n[1]=ze(2*(i*s-o*a),h-l-u+c),n[2]=ze(2*(o*s-a*i),h-l+u-c);break;case"ZYX":n[0]=ze(2*(a*s+o*i),h-l-u+c),n[1]=_r(yr(2*(i*s-a*o),-1,1)),n[2]=ze(2*(a*i+o*s),h+l-u-c);break;case"YZX":n[0]=ze(2*(a*s-o*i),h-l+u-c),n[1]=ze(2*(i*s-a*o),h+l-u-c),n[2]=_r(yr(2*(a*i+o*s),-1,1));break;case"XZY":n[0]=ze(2*(a*s+i*o),h-l+u-c),n[1]=ze(2*(a*o+i*s),h+l-u-c),n[2]=_r(yr(2*(o*s-a*i),-1,1));break;default:console.warn("Unkown order: "+f)}return e};ue.eulerFromMat3=function(e,t,v){var n=t.array,a=n[0],i=n[3],o=n[6],s=n[1],l=n[4],u=n[7],c=n[2],h=n[5],f=n[8],d=e.array,v=(v||"XYZ").toUpperCase();switch(v){case"XYZ":d[1]=_r(yr(o,-1,1)),Pa(o)<.99999?(d[0]=ze(-u,f),d[2]=ze(-i,a)):(d[0]=ze(h,l),d[2]=0);break;case"YXZ":d[0]=_r(-yr(u,-1,1)),Pa(u)<.99999?(d[1]=ze(o,f),d[2]=ze(s,l)):(d[1]=ze(-c,a),d[2]=0);break;case"ZXY":d[0]=_r(yr(h,-1,1)),Pa(h)<.99999?(d[1]=ze(-c,f),d[2]=ze(-i,l)):(d[1]=0,d[2]=ze(s,a));break;case"ZYX":d[1]=_r(-yr(c,-1,1)),Pa(c)<.99999?(d[0]=ze(h,f),d[2]=ze(s,a)):(d[0]=0,d[2]=ze(-i,l));break;case"YZX":d[2]=_r(yr(s,-1,1)),Pa(s)<.99999?(d[0]=ze(-u,l),d[1]=ze(-c,a)):(d[0]=0,d[1]=ze(o,f));break;case"XZY":d[2]=_r(-yr(i,-1,1)),Pa(i)<.99999?(d[0]=ze(h,l),d[1]=ze(o,a)):(d[0]=ze(-u,f),d[1]=0);break;default:console.warn("Unkown order: "+v)}return e._dirty=!0,e};Object.defineProperties(ue,{POSITIVE_X:{get:function(){return new ue(1,0,0)}},NEGATIVE_X:{get:function(){return new ue(-1,0,0)}},POSITIVE_Y:{get:function(){return new ue(0,1,0)}},NEGATIVE_Y:{get:function(){return new ue(0,-1,0)}},POSITIVE_Z:{get:function(){return new ue(0,0,1)}},NEGATIVE_Z:{get:function(){return new ue(0,0,-1)}},UP:{get:function(){return new ue(0,1,0)}},ZERO:{get:function(){return new ue}}});const X=ue;var Sc=1e-5,Cs=function(e,t){this.origin=e||new X,this.direction=t||new X};Cs.prototype={constructor:Cs,intersectPlane:function(e,t){var r=e.normal.array,n=e.distance,a=this.origin.array,i=this.direction.array,o=O.dot(r,i);if(o===0)return null;t||(t=new X);var s=(O.dot(r,a)-n)/o;return O.scaleAndAdd(t.array,a,i,-s),t._dirty=!0,t},mirrorAgainstPlane:function(e){var t=O.dot(e.normal.array,this.direction.array);O.scaleAndAdd(this.direction.array,this.direction.array,e.normal.array,-t*2),this.direction._dirty=!0},distanceToPoint:function(){var e=O.create();return function(t){O.sub(e,t,this.origin.array);var r=O.dot(e,this.direction.array);if(r<0)return O.distance(this.origin.array,t);var n=O.lenSquared(e);return Math.sqrt(n-r*r)}}(),intersectSphere:function(){var e=O.create();return function(t,r,n){var a=this.origin.array,i=this.direction.array;t=t.array,O.sub(e,t,a);var o=O.dot(e,i),s=O.squaredLength(e),l=s-o*o,u=r*r;if(!(l>u)){var c=Math.sqrt(u-l),h=o-c,f=o+c;return n||(n=new X),h<0?f<0?null:(O.scaleAndAdd(n.array,a,i,f),n):(O.scaleAndAdd(n.array,a,i,h),n)}}}(),intersectBoundingBox:function(e,t){var r=this.direction.array,n=this.origin.array,a=e.min.array,i=e.max.array,o=1/r[0],s=1/r[1],l=1/r[2],u,c,h,f,d,v;if(o>=0?(u=(a[0]-n[0])*o,c=(i[0]-n[0])*o):(c=(a[0]-n[0])*o,u=(i[0]-n[0])*o),s>=0?(h=(a[1]-n[1])*s,f=(i[1]-n[1])*s):(f=(a[1]-n[1])*s,h=(i[1]-n[1])*s),u>f||h>c||((h>u||u!==u)&&(u=h),(f<c||c!==c)&&(c=f),l>=0?(d=(a[2]-n[2])*l,v=(i[2]-n[2])*l):(v=(a[2]-n[2])*l,d=(i[2]-n[2])*l),u>v||d>c)||((d>u||u!==u)&&(u=d),(v<c||c!==c)&&(c=v),c<0))return null;var p=u>=0?u:c;return t||(t=new X),O.scaleAndAdd(t.array,n,r,p),t},intersectTriangle:function(){var e=O.create(),t=O.create(),r=O.create(),n=O.create();return function(a,i,o,s,l,u){var c=this.direction.array,h=this.origin.array;a=a.array,i=i.array,o=o.array,O.sub(e,i,a),O.sub(t,o,a),O.cross(n,t,c);var f=O.dot(e,n);if(s){if(f>-Sc)return null}else if(f>-Sc&&f<Sc)return null;O.sub(r,h,a);var d=O.dot(n,r)/f;if(d<0||d>1)return null;O.cross(n,e,r);var v=O.dot(c,n)/f;if(v<0||v>1||d+v>1)return null;O.cross(n,e,t);var p=-O.dot(r,n)/f;return p<0?null:(l||(l=new X),u&&X.set(u,1-d-v,d,v),O.scaleAndAdd(l.array,h,c,p),l)}}(),applyTransform:function(e){X.add(this.direction,this.direction,this.origin),X.transformMat4(this.origin,this.origin,e),X.transformMat4(this.direction,this.direction,e),X.sub(this.direction,this.direction,this.origin),X.normalize(this.direction,this.direction)},copy:function(e){X.copy(this.origin,e.origin),X.copy(this.direction,e.direction)},clone:function(){var e=new Cs;return e.copy(this),e}};const ol=Cs;var xe={};xe.create=function(){var e=new Bt(4);return e[0]=0,e[1]=0,e[2]=0,e[3]=0,e};xe.clone=function(e){var t=new Bt(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t};xe.fromValues=function(e,t,r,n){var a=new Bt(4);return a[0]=e,a[1]=t,a[2]=r,a[3]=n,a};xe.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e};xe.set=function(e,t,r,n,a){return e[0]=t,e[1]=r,e[2]=n,e[3]=a,e};xe.add=function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e};xe.subtract=function(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e};xe.sub=xe.subtract;xe.multiply=function(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e[2]=t[2]*r[2],e[3]=t[3]*r[3],e};xe.mul=xe.multiply;xe.divide=function(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e[2]=t[2]/r[2],e[3]=t[3]/r[3],e};xe.div=xe.divide;xe.min=function(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e[2]=Math.min(t[2],r[2]),e[3]=Math.min(t[3],r[3]),e};xe.max=function(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e[2]=Math.max(t[2],r[2]),e[3]=Math.max(t[3],r[3]),e};xe.scale=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e};xe.scaleAndAdd=function(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e[3]=t[3]+r[3]*n,e};xe.distance=function(e,t){var r=t[0]-e[0],n=t[1]-e[1],a=t[2]-e[2],i=t[3]-e[3];return Math.sqrt(r*r+n*n+a*a+i*i)};xe.dist=xe.distance;xe.squaredDistance=function(e,t){var r=t[0]-e[0],n=t[1]-e[1],a=t[2]-e[2],i=t[3]-e[3];return r*r+n*n+a*a+i*i};xe.sqrDist=xe.squaredDistance;xe.length=function(e){var t=e[0],r=e[1],n=e[2],a=e[3];return Math.sqrt(t*t+r*r+n*n+a*a)};xe.len=xe.length;xe.squaredLength=function(e){var t=e[0],r=e[1],n=e[2],a=e[3];return t*t+r*r+n*n+a*a};xe.sqrLen=xe.squaredLength;xe.negate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=-t[3],e};xe.inverse=function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e[3]=1/t[3],e};xe.normalize=function(e,t){var r=t[0],n=t[1],a=t[2],i=t[3],o=r*r+n*n+a*a+i*i;return o>0&&(o=1/Math.sqrt(o),e[0]=t[0]*o,e[1]=t[1]*o,e[2]=t[2]*o,e[3]=t[3]*o),e};xe.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]};xe.lerp=function(e,t,r,n){var a=t[0],i=t[1],o=t[2],s=t[3];return e[0]=a+n*(r[0]-a),e[1]=i+n*(r[1]-i),e[2]=o+n*(r[2]-o),e[3]=s+n*(r[3]-s),e};xe.random=function(e,t){return t=t||1,e[0]=Wa(),e[1]=Wa(),e[2]=Wa(),e[3]=Wa(),xe.normalize(e,e),xe.scale(e,e,t),e};xe.transformMat4=function(e,t,r){var n=t[0],a=t[1],i=t[2],o=t[3];return e[0]=r[0]*n+r[4]*a+r[8]*i+r[12]*o,e[1]=r[1]*n+r[5]*a+r[9]*i+r[13]*o,e[2]=r[2]*n+r[6]*a+r[10]*i+r[14]*o,e[3]=r[3]*n+r[7]*a+r[11]*i+r[15]*o,e};xe.transformQuat=function(e,t,r){var n=t[0],a=t[1],i=t[2],o=r[0],s=r[1],l=r[2],u=r[3],c=u*n+s*i-l*a,h=u*a+l*n-o*i,f=u*i+o*a-s*n,d=-o*n-s*a-l*i;return e[0]=c*u+d*-o+h*-l-f*-s,e[1]=h*u+d*-s+f*-o-c*-l,e[2]=f*u+d*-l+c*-s-h*-o,e};xe.forEach=function(){var e=xe.create();return function(t,r,n,a,i,o){var s,l;for(r||(r=4),n||(n=0),a?l=Math.min(a*r+n,t.length):l=t.length,s=n;s<l;s+=r)e[0]=t[s],e[1]=t[s+1],e[2]=t[s+2],e[3]=t[s+3],i(e,e,o),t[s]=e[0],t[s+1]=e[1],t[s+2]=e[2],t[s+3]=e[3];return t}}();const Y=xe;var St={};St.create=function(){var e=new Bt(9);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e};St.fromMat4=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[4],e[4]=t[5],e[5]=t[6],e[6]=t[8],e[7]=t[9],e[8]=t[10],e};St.clone=function(e){var t=new Bt(9);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t};St.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e};St.identity=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e};St.transpose=function(e,t){if(e===t){var r=t[1],n=t[2],a=t[5];e[1]=t[3],e[2]=t[6],e[3]=r,e[5]=t[7],e[6]=n,e[7]=a}else e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8];return e};St.invert=function(e,t){var r=t[0],n=t[1],a=t[2],i=t[3],o=t[4],s=t[5],l=t[6],u=t[7],c=t[8],h=c*o-s*u,f=-c*i+s*l,d=u*i-o*l,v=r*h+n*f+a*d;return v?(v=1/v,e[0]=h*v,e[1]=(-c*n+a*u)*v,e[2]=(s*n-a*o)*v,e[3]=f*v,e[4]=(c*r-a*l)*v,e[5]=(-s*r+a*i)*v,e[6]=d*v,e[7]=(-u*r+n*l)*v,e[8]=(o*r-n*i)*v,e):null};St.adjoint=function(e,t){var r=t[0],n=t[1],a=t[2],i=t[3],o=t[4],s=t[5],l=t[6],u=t[7],c=t[8];return e[0]=o*c-s*u,e[1]=a*u-n*c,e[2]=n*s-a*o,e[3]=s*l-i*c,e[4]=r*c-a*l,e[5]=a*i-r*s,e[6]=i*u-o*l,e[7]=n*l-r*u,e[8]=r*o-n*i,e};St.determinant=function(e){var t=e[0],r=e[1],n=e[2],a=e[3],i=e[4],o=e[5],s=e[6],l=e[7],u=e[8];return t*(u*i-o*l)+r*(-u*a+o*s)+n*(l*a-i*s)};St.multiply=function(e,t,r){var n=t[0],a=t[1],i=t[2],o=t[3],s=t[4],l=t[5],u=t[6],c=t[7],h=t[8],f=r[0],d=r[1],v=r[2],p=r[3],g=r[4],m=r[5],_=r[6],y=r[7],x=r[8];return e[0]=f*n+d*o+v*u,e[1]=f*a+d*s+v*c,e[2]=f*i+d*l+v*h,e[3]=p*n+g*o+m*u,e[4]=p*a+g*s+m*c,e[5]=p*i+g*l+m*h,e[6]=_*n+y*o+x*u,e[7]=_*a+y*s+x*c,e[8]=_*i+y*l+x*h,e};St.mul=St.multiply;St.translate=function(e,t,r){var n=t[0],a=t[1],i=t[2],o=t[3],s=t[4],l=t[5],u=t[6],c=t[7],h=t[8],f=r[0],d=r[1];return e[0]=n,e[1]=a,e[2]=i,e[3]=o,e[4]=s,e[5]=l,e[6]=f*n+d*o+u,e[7]=f*a+d*s+c,e[8]=f*i+d*l+h,e};St.rotate=function(e,t,r){var n=t[0],a=t[1],i=t[2],o=t[3],s=t[4],l=t[5],u=t[6],c=t[7],h=t[8],f=Math.sin(r),d=Math.cos(r);return e[0]=d*n+f*o,e[1]=d*a+f*s,e[2]=d*i+f*l,e[3]=d*o-f*n,e[4]=d*s-f*a,e[5]=d*l-f*i,e[6]=u,e[7]=c,e[8]=h,e};St.scale=function(e,t,r){var n=r[0],a=r[1];return e[0]=n*t[0],e[1]=n*t[1],e[2]=n*t[2],e[3]=a*t[3],e[4]=a*t[4],e[5]=a*t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e};St.fromMat2d=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=0,e[3]=t[2],e[4]=t[3],e[5]=0,e[6]=t[4],e[7]=t[5],e[8]=1,e};St.fromQuat=function(e,t){var r=t[0],n=t[1],a=t[2],i=t[3],o=r+r,s=n+n,l=a+a,u=r*o,c=n*o,h=n*s,f=a*o,d=a*s,v=a*l,p=i*o,g=i*s,m=i*l;return e[0]=1-h-v,e[3]=c-m,e[6]=f+g,e[1]=c+m,e[4]=1-u-v,e[7]=d-p,e[2]=f-g,e[5]=d+p,e[8]=1-u-h,e};St.normalFromMat4=function(e,t){var r=t[0],n=t[1],a=t[2],i=t[3],o=t[4],s=t[5],l=t[6],u=t[7],c=t[8],h=t[9],f=t[10],d=t[11],v=t[12],p=t[13],g=t[14],m=t[15],_=r*s-n*o,y=r*l-a*o,x=r*u-i*o,S=n*l-a*s,T=n*u-i*s,b=a*u-i*l,w=c*p-h*v,A=c*g-f*v,E=c*m-d*v,C=h*g-f*p,M=h*m-d*p,P=f*m-d*g,L=_*P-y*M+x*C+S*E-T*A+b*w;return L?(L=1/L,e[0]=(s*P-l*M+u*C)*L,e[1]=(l*E-o*P-u*A)*L,e[2]=(o*M-s*E+u*w)*L,e[3]=(a*M-n*P-i*C)*L,e[4]=(r*P-a*E+i*A)*L,e[5]=(n*E-r*M-i*w)*L,e[6]=(p*b-g*T+m*S)*L,e[7]=(g*x-v*b-m*y)*L,e[8]=(v*T-p*x+m*_)*L,e):null};St.frob=function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2)+Math.pow(e[4],2)+Math.pow(e[5],2)+Math.pow(e[6],2)+Math.pow(e[7],2)+Math.pow(e[8],2))};const Ae=St;var Pe={};Pe.create=function(){var e=new Bt(4);return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e};Pe.rotationTo=function(){var e=O.create(),t=O.fromValues(1,0,0),r=O.fromValues(0,1,0);return function(n,a,i){var o=O.dot(a,i);return o<-.999999?(O.cross(e,t,a),O.length(e)<1e-6&&O.cross(e,r,a),O.normalize(e,e),Pe.setAxisAngle(n,e,Math.PI),n):o>.999999?(n[0]=0,n[1]=0,n[2]=0,n[3]=1,n):(O.cross(e,a,i),n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=1+o,Pe.normalize(n,n))}}();Pe.setAxes=function(){var e=Ae.create();return function(t,r,n,a){return e[0]=n[0],e[3]=n[1],e[6]=n[2],e[1]=a[0],e[4]=a[1],e[7]=a[2],e[2]=-r[0],e[5]=-r[1],e[8]=-r[2],Pe.normalize(t,Pe.fromMat3(t,e))}}();Pe.clone=Y.clone;Pe.fromValues=Y.fromValues;Pe.copy=Y.copy;Pe.set=Y.set;Pe.identity=function(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e};Pe.setAxisAngle=function(e,t,r){r=r*.5;var n=Math.sin(r);return e[0]=n*t[0],e[1]=n*t[1],e[2]=n*t[2],e[3]=Math.cos(r),e};Pe.add=Y.add;Pe.multiply=function(e,t,r){var n=t[0],a=t[1],i=t[2],o=t[3],s=r[0],l=r[1],u=r[2],c=r[3];return e[0]=n*c+o*s+a*u-i*l,e[1]=a*c+o*l+i*s-n*u,e[2]=i*c+o*u+n*l-a*s,e[3]=o*c-n*s-a*l-i*u,e};Pe.mul=Pe.multiply;Pe.scale=Y.scale;Pe.rotateX=function(e,t,r){r*=.5;var n=t[0],a=t[1],i=t[2],o=t[3],s=Math.sin(r),l=Math.cos(r);return e[0]=n*l+o*s,e[1]=a*l+i*s,e[2]=i*l-a*s,e[3]=o*l-n*s,e};Pe.rotateY=function(e,t,r){r*=.5;var n=t[0],a=t[1],i=t[2],o=t[3],s=Math.sin(r),l=Math.cos(r);return e[0]=n*l-i*s,e[1]=a*l+o*s,e[2]=i*l+n*s,e[3]=o*l-a*s,e};Pe.rotateZ=function(e,t,r){r*=.5;var n=t[0],a=t[1],i=t[2],o=t[3],s=Math.sin(r),l=Math.cos(r);return e[0]=n*l+a*s,e[1]=a*l-n*s,e[2]=i*l+o*s,e[3]=o*l-i*s,e};Pe.calculateW=function(e,t){var r=t[0],n=t[1],a=t[2];return e[0]=r,e[1]=n,e[2]=a,e[3]=Math.sqrt(Math.abs(1-r*r-n*n-a*a)),e};Pe.dot=Y.dot;Pe.lerp=Y.lerp;Pe.slerp=function(e,t,r,n){var a=t[0],i=t[1],o=t[2],s=t[3],l=r[0],u=r[1],c=r[2],h=r[3],f,d,v,p,g;return d=a*l+i*u+o*c+s*h,d<0&&(d=-d,l=-l,u=-u,c=-c,h=-h),1-d>1e-6?(f=Math.acos(d),v=Math.sin(f),p=Math.sin((1-n)*f)/v,g=Math.sin(n*f)/v):(p=1-n,g=n),e[0]=p*a+g*l,e[1]=p*i+g*u,e[2]=p*o+g*c,e[3]=p*s+g*h,e};Pe.invert=function(e,t){var r=t[0],n=t[1],a=t[2],i=t[3],o=r*r+n*n+a*a+i*i,s=o?1/o:0;return e[0]=-r*s,e[1]=-n*s,e[2]=-a*s,e[3]=i*s,e};Pe.conjugate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e};Pe.length=Y.length;Pe.len=Pe.length;Pe.squaredLength=Y.squaredLength;Pe.sqrLen=Pe.squaredLength;Pe.normalize=Y.normalize;Pe.fromMat3=function(e,t){var r=t[0]+t[4]+t[8],n;if(r>0)n=Math.sqrt(r+1),e[3]=.5*n,n=.5/n,e[0]=(t[5]-t[7])*n,e[1]=(t[6]-t[2])*n,e[2]=(t[1]-t[3])*n;else{var a=0;t[4]>t[0]&&(a=1),t[8]>t[a*3+a]&&(a=2);var i=(a+1)%3,o=(a+2)%3;n=Math.sqrt(t[a*3+a]-t[i*3+i]-t[o*3+o]+1),e[a]=.5*n,n=.5/n,e[3]=(t[i*3+o]-t[o*3+i])*n,e[i]=(t[i*3+a]+t[a*3+i])*n,e[o]=(t[o*3+a]+t[a*3+o])*n}return e};const ve=Pe;var We=function(){this._axisX=new X,this._axisY=new X,this._axisZ=new X,this.array=$.create(),this._dirty=!0};We.prototype={constructor:We,setArray:function(e){for(var t=0;t<this.array.length;t++)this.array[t]=e[t];return this._dirty=!0,this},adjoint:function(){return $.adjoint(this.array,this.array),this._dirty=!0,this},clone:function(){return new We().copy(this)},copy:function(e){return $.copy(this.array,e.array),this._dirty=!0,this},determinant:function(){return $.determinant(this.array)},fromQuat:function(e){return $.fromQuat(this.array,e.array),this._dirty=!0,this},fromRotationTranslation:function(e,t){return $.fromRotationTranslation(this.array,e.array,t.array),this._dirty=!0,this},fromMat2d:function(e){return We.fromMat2d(this,e),this},frustum:function(e,t,r,n,a,i){return $.frustum(this.array,e,t,r,n,a,i),this._dirty=!0,this},identity:function(){return $.identity(this.array),this._dirty=!0,this},invert:function(){return $.invert(this.array,this.array),this._dirty=!0,this},lookAt:function(e,t,r){return $.lookAt(this.array,e.array,t.array,r.array),this._dirty=!0,this},mul:function(e){return $.mul(this.array,this.array,e.array),this._dirty=!0,this},mulLeft:function(e){return $.mul(this.array,e.array,this.array),this._dirty=!0,this},multiply:function(e){return $.multiply(this.array,this.array,e.array),this._dirty=!0,this},multiplyLeft:function(e){return $.multiply(this.array,e.array,this.array),this._dirty=!0,this},ortho:function(e,t,r,n,a,i){return $.ortho(this.array,e,t,r,n,a,i),this._dirty=!0,this},perspective:function(e,t,r,n){return $.perspective(this.array,e,t,r,n),this._dirty=!0,this},rotate:function(e,t){return $.rotate(this.array,this.array,e,t.array),this._dirty=!0,this},rotateX:function(e){return $.rotateX(this.array,this.array,e),this._dirty=!0,this},rotateY:function(e){return $.rotateY(this.array,this.array,e),this._dirty=!0,this},rotateZ:function(e){return $.rotateZ(this.array,this.array,e),this._dirty=!0,this},scale:function(e){return $.scale(this.array,this.array,e.array),this._dirty=!0,this},translate:function(e){return $.translate(this.array,this.array,e.array),this._dirty=!0,this},transpose:function(){return $.transpose(this.array,this.array),this._dirty=!0,this},decomposeMatrix:function(){var e=O.create(),t=O.create(),r=O.create(),n=Ae.create();return function(a,i,o){var s=this.array;O.set(e,s[0],s[1],s[2]),O.set(t,s[4],s[5],s[6]),O.set(r,s[8],s[9],s[10]);var l=O.length(e),u=O.length(t),c=O.length(r),h=this.determinant();h<0&&(l=-l),a&&a.set(l,u,c),o.set(s[12],s[13],s[14]),Ae.fromMat4(n,s),n[0]/=l,n[1]/=l,n[2]/=l,n[3]/=u,n[4]/=u,n[5]/=u,n[6]/=c,n[7]/=c,n[8]/=c,ve.fromMat3(i.array,n),ve.normalize(i.array,i.array),i._dirty=!0,o._dirty=!0}}(),toString:function(){return"["+Array.prototype.join.call(this.array,",")+"]"},toArray:function(){return Array.prototype.slice.call(this.array)}};var hs=Object.defineProperty;if(hs){var Tc=We.prototype;hs(Tc,"z",{get:function(){var e=this.array;return this._axisZ.set(e[8],e[9],e[10]),this._axisZ},set:function(e){var t=this.array;e=e.array,t[8]=e[0],t[9]=e[1],t[10]=e[2],this._dirty=!0}}),hs(Tc,"y",{get:function(){var e=this.array;return this._axisY.set(e[4],e[5],e[6]),this._axisY},set:function(e){var t=this.array;e=e.array,t[4]=e[0],t[5]=e[1],t[6]=e[2],this._dirty=!0}}),hs(Tc,"x",{get:function(){var e=this.array;return this._axisX.set(e[0],e[1],e[2]),this._axisX},set:function(e){var t=this.array;e=e.array,t[0]=e[0],t[1]=e[1],t[2]=e[2],this._dirty=!0}})}We.adjoint=function(e,t){return $.adjoint(e.array,t.array),e._dirty=!0,e};We.copy=function(e,t){return $.copy(e.array,t.array),e._dirty=!0,e};We.determinant=function(e){return $.determinant(e.array)};We.identity=function(e){return $.identity(e.array),e._dirty=!0,e};We.ortho=function(e,t,r,n,a,i,o){return $.ortho(e.array,t,r,n,a,i,o),e._dirty=!0,e};We.perspective=function(e,t,r,n,a){return $.perspective(e.array,t,r,n,a),e._dirty=!0,e};We.lookAt=function(e,t,r,n){return $.lookAt(e.array,t.array,r.array,n.array),e._dirty=!0,e};We.invert=function(e,t){return $.invert(e.array,t.array),e._dirty=!0,e};We.mul=function(e,t,r){return $.mul(e.array,t.array,r.array),e._dirty=!0,e};We.multiply=We.mul;We.fromQuat=function(e,t){return $.fromQuat(e.array,t.array),e._dirty=!0,e};We.fromRotationTranslation=function(e,t,r){return $.fromRotationTranslation(e.array,t.array,r.array),e._dirty=!0,e};We.fromMat2d=function(n,r){n._dirty=!0;var r=r.array,n=n.array;return n[0]=r[0],n[4]=r[2],n[12]=r[4],n[1]=r[1],n[5]=r[3],n[13]=r[5],n};We.rotate=function(e,t,r,n){return $.rotate(e.array,t.array,r,n.array),e._dirty=!0,e};We.rotateX=function(e,t,r){return $.rotateX(e.array,t.array,r),e._dirty=!0,e};We.rotateY=function(e,t,r){return $.rotateY(e.array,t.array,r),e._dirty=!0,e};We.rotateZ=function(e,t,r){return $.rotateZ(e.array,t.array,r),e._dirty=!0,e};We.scale=function(e,t,r){return $.scale(e.array,t.array,r.array),e._dirty=!0,e};We.transpose=function(e,t){return $.transpose(e.array,t.array),e._dirty=!0,e};We.translate=function(e,t,r){return $.translate(e.array,t.array,r.array),e._dirty=!0,e};const ne=We;var Ne=function(e,t,r,n){e=e||0,t=t||0,r=r||0,n=n===void 0?1:n,this.array=ve.fromValues(e,t,r,n),this._dirty=!0};Ne.prototype={constructor:Ne,add:function(e){return ve.add(this.array,this.array,e.array),this._dirty=!0,this},calculateW:function(){return ve.calculateW(this.array,this.array),this._dirty=!0,this},set:function(e,t,r,n){return this.array[0]=e,this.array[1]=t,this.array[2]=r,this.array[3]=n,this._dirty=!0,this},setArray:function(e){return this.array[0]=e[0],this.array[1]=e[1],this.array[2]=e[2],this.array[3]=e[3],this._dirty=!0,this},clone:function(){return new Ne(this.x,this.y,this.z,this.w)},conjugate:function(){return ve.conjugate(this.array,this.array),this._dirty=!0,this},copy:function(e){return ve.copy(this.array,e.array),this._dirty=!0,this},dot:function(e){return ve.dot(this.array,e.array)},fromMat3:function(e){return ve.fromMat3(this.array,e.array),this._dirty=!0,this},fromMat4:function(){var e=Ae.create();return function(t){return Ae.fromMat4(e,t.array),Ae.transpose(e,e),ve.fromMat3(this.array,e),this._dirty=!0,this}}(),identity:function(){return ve.identity(this.array),this._dirty=!0,this},invert:function(){return ve.invert(this.array,this.array),this._dirty=!0,this},len:function(){return ve.len(this.array)},length:function(){return ve.length(this.array)},lerp:function(e,t,r){return ve.lerp(this.array,e.array,t.array,r),this._dirty=!0,this},mul:function(e){return ve.mul(this.array,this.array,e.array),this._dirty=!0,this},mulLeft:function(e){return ve.multiply(this.array,e.array,this.array),this._dirty=!0,this},multiply:function(e){return ve.multiply(this.array,this.array,e.array),this._dirty=!0,this},multiplyLeft:function(e){return ve.multiply(this.array,e.array,this.array),this._dirty=!0,this},normalize:function(){return ve.normalize(this.array,this.array),this._dirty=!0,this},rotateX:function(e){return ve.rotateX(this.array,this.array,e),this._dirty=!0,this},rotateY:function(e){return ve.rotateY(this.array,this.array,e),this._dirty=!0,this},rotateZ:function(e){return ve.rotateZ(this.array,this.array,e),this._dirty=!0,this},rotationTo:function(e,t){return ve.rotationTo(this.array,e.array,t.array),this._dirty=!0,this},setAxes:function(e,t,r){return ve.setAxes(this.array,e.array,t.array,r.array),this._dirty=!0,this},setAxisAngle:function(e,t){return ve.setAxisAngle(this.array,e.array,t),this._dirty=!0,this},slerp:function(e,t,r){return ve.slerp(this.array,e.array,t.array,r),this._dirty=!0,this},sqrLen:function(){return ve.sqrLen(this.array)},squaredLength:function(){return ve.squaredLength(this.array)},fromEuler:function(e,t){return Ne.fromEuler(this,e,t)},toString:function(){return"["+Array.prototype.join.call(this.array,",")+"]"},toArray:function(){return Array.prototype.slice.call(this.array)}};var Ii=Object.defineProperty;if(Ii){var fs=Ne.prototype;Ii(fs,"x",{get:function(){return this.array[0]},set:function(e){this.array[0]=e,this._dirty=!0}}),Ii(fs,"y",{get:function(){return this.array[1]},set:function(e){this.array[1]=e,this._dirty=!0}}),Ii(fs,"z",{get:function(){return this.array[2]},set:function(e){this.array[2]=e,this._dirty=!0}}),Ii(fs,"w",{get:function(){return this.array[3]},set:function(e){this.array[3]=e,this._dirty=!0}})}Ne.add=function(e,t,r){return ve.add(e.array,t.array,r.array),e._dirty=!0,e};Ne.set=function(e,t,r,n,a){ve.set(e.array,t,r,n,a),e._dirty=!0};Ne.copy=function(e,t){return ve.copy(e.array,t.array),e._dirty=!0,e};Ne.calculateW=function(e,t){return ve.calculateW(e.array,t.array),e._dirty=!0,e};Ne.conjugate=function(e,t){return ve.conjugate(e.array,t.array),e._dirty=!0,e};Ne.identity=function(e){return ve.identity(e.array),e._dirty=!0,e};Ne.invert=function(e,t){return ve.invert(e.array,t.array),e._dirty=!0,e};Ne.dot=function(e,t){return ve.dot(e.array,t.array)};Ne.len=function(e){return ve.length(e.array)};Ne.lerp=function(e,t,r,n){return ve.lerp(e.array,t.array,r.array,n),e._dirty=!0,e};Ne.slerp=function(e,t,r,n){return ve.slerp(e.array,t.array,r.array,n),e._dirty=!0,e};Ne.mul=function(e,t,r){return ve.multiply(e.array,t.array,r.array),e._dirty=!0,e};Ne.multiply=Ne.mul;Ne.rotateX=function(e,t,r){return ve.rotateX(e.array,t.array,r),e._dirty=!0,e};Ne.rotateY=function(e,t,r){return ve.rotateY(e.array,t.array,r),e._dirty=!0,e};Ne.rotateZ=function(e,t,r){return ve.rotateZ(e.array,t.array,r),e._dirty=!0,e};Ne.setAxisAngle=function(e,t,r){return ve.setAxisAngle(e.array,t.array,r),e._dirty=!0,e};Ne.normalize=function(e,t){return ve.normalize(e.array,t.array),e._dirty=!0,e};Ne.sqrLen=function(e){return ve.sqrLen(e.array)};Ne.squaredLength=Ne.sqrLen;Ne.fromMat3=function(e,t){return ve.fromMat3(e.array,t.array),e._dirty=!0,e};Ne.setAxes=function(e,t,r,n){return ve.setAxes(e.array,t.array,r.array,n.array),e._dirty=!0,e};Ne.rotationTo=function(e,t,r){return ve.rotationTo(e.array,t.array,r.array),e._dirty=!0,e};Ne.fromEuler=function(e,t,c){e._dirty=!0,t=t.array;var n=e.array,a=Math.cos(t[0]/2),i=Math.cos(t[1]/2),o=Math.cos(t[2]/2),s=Math.sin(t[0]/2),l=Math.sin(t[1]/2),u=Math.sin(t[2]/2),c=(c||"XYZ").toUpperCase();switch(c){case"XYZ":n[0]=s*i*o+a*l*u,n[1]=a*l*o-s*i*u,n[2]=a*i*u+s*l*o,n[3]=a*i*o-s*l*u;break;case"YXZ":n[0]=s*i*o+a*l*u,n[1]=a*l*o-s*i*u,n[2]=a*i*u-s*l*o,n[3]=a*i*o+s*l*u;break;case"ZXY":n[0]=s*i*o-a*l*u,n[1]=a*l*o+s*i*u,n[2]=a*i*u+s*l*o,n[3]=a*i*o-s*l*u;break;case"ZYX":n[0]=s*i*o-a*l*u,n[1]=a*l*o+s*i*u,n[2]=a*i*u-s*l*o,n[3]=a*i*o+s*l*u;break;case"YZX":n[0]=s*i*o+a*l*u,n[1]=a*l*o+s*i*u,n[2]=a*i*u-s*l*o,n[3]=a*i*o-s*l*u;break;case"XZY":n[0]=s*i*o-a*l*u,n[1]=a*l*o-s*i*u,n[2]=a*i*u+s*l*o,n[3]=a*i*o+s*l*u;break}};const J_=Ne;var vn=O.set,ds=O.copy,Ls=function(e,t){this.min=e||new X(1/0,1/0,1/0),this.max=t||new X(-1/0,-1/0,-1/0),this.vertices=null};Ls.prototype={constructor:Ls,updateFromVertices:function(e){if(e.length>0){var t=this.min,r=this.max,n=t.array,a=r.array;ds(n,e[0]),ds(a,e[0]);for(var i=1;i<e.length;i++){var o=e[i];o[0]<n[0]&&(n[0]=o[0]),o[1]<n[1]&&(n[1]=o[1]),o[2]<n[2]&&(n[2]=o[2]),o[0]>a[0]&&(a[0]=o[0]),o[1]>a[1]&&(a[1]=o[1]),o[2]>a[2]&&(a[2]=o[2])}t._dirty=!0,r._dirty=!0}},union:function(e){var t=this.min,r=this.max;return O.min(t.array,t.array,e.min.array),O.max(r.array,r.array,e.max.array),t._dirty=!0,r._dirty=!0,this},intersection:function(e){var t=this.min,r=this.max;return O.max(t.array,t.array,e.min.array),O.min(r.array,r.array,e.max.array),t._dirty=!0,r._dirty=!0,this},intersectBoundingBox:function(e){var t=this.min.array,r=this.max.array,n=e.min.array,a=e.max.array;return!(t[0]>a[0]||t[1]>a[1]||t[2]>a[2]||r[0]<n[0]||r[1]<n[1]||r[2]<n[2])},containBoundingBox:function(e){var t=this.min.array,r=this.max.array,n=e.min.array,a=e.max.array;return t[0]<=n[0]&&t[1]<=n[1]&&t[2]<=n[2]&&r[0]>=a[0]&&r[1]>=a[1]&&r[2]>=a[2]},containPoint:function(e){var t=this.min.array,r=this.max.array,n=e.array;return t[0]<=n[0]&&t[1]<=n[1]&&t[2]<=n[2]&&r[0]>=n[0]&&r[1]>=n[1]&&r[2]>=n[2]},isFinite:function(){var e=this.min.array,t=this.max.array;return isFinite(e[0])&&isFinite(e[1])&&isFinite(e[2])&&isFinite(t[0])&&isFinite(t[1])&&isFinite(t[2])},applyTransform:function(e){this.transformFrom(this,e)},transformFrom:function(){var e=O.create(),t=O.create(),r=O.create(),n=O.create(),a=O.create(),i=O.create();return function(o,s){var l=o.min.array,u=o.max.array,c=s.array;return e[0]=c[0]*l[0],e[1]=c[1]*l[0],e[2]=c[2]*l[0],t[0]=c[0]*u[0],t[1]=c[1]*u[0],t[2]=c[2]*u[0],r[0]=c[4]*l[1],r[1]=c[5]*l[1],r[2]=c[6]*l[1],n[0]=c[4]*u[1],n[1]=c[5]*u[1],n[2]=c[6]*u[1],a[0]=c[8]*l[2],a[1]=c[9]*l[2],a[2]=c[10]*l[2],i[0]=c[8]*u[2],i[1]=c[9]*u[2],i[2]=c[10]*u[2],l=this.min.array,u=this.max.array,l[0]=Math.min(e[0],t[0])+Math.min(r[0],n[0])+Math.min(a[0],i[0])+c[12],l[1]=Math.min(e[1],t[1])+Math.min(r[1],n[1])+Math.min(a[1],i[1])+c[13],l[2]=Math.min(e[2],t[2])+Math.min(r[2],n[2])+Math.min(a[2],i[2])+c[14],u[0]=Math.max(e[0],t[0])+Math.max(r[0],n[0])+Math.max(a[0],i[0])+c[12],u[1]=Math.max(e[1],t[1])+Math.max(r[1],n[1])+Math.max(a[1],i[1])+c[13],u[2]=Math.max(e[2],t[2])+Math.max(r[2],n[2])+Math.max(a[2],i[2])+c[14],this.min._dirty=!0,this.max._dirty=!0,this}}(),applyProjection:function(e){var t=this.min.array,r=this.max.array,n=e.array,a=t[0],i=t[1],o=t[2],s=r[0],l=r[1],u=t[2],c=r[0],h=r[1],f=r[2];if(n[15]===1)t[0]=n[0]*a+n[12],t[1]=n[5]*i+n[13],r[2]=n[10]*o+n[14],r[0]=n[0]*c+n[12],r[1]=n[5]*h+n[13],t[2]=n[10]*f+n[14];else{var d=-1/o;t[0]=n[0]*a*d,t[1]=n[5]*i*d,r[2]=(n[10]*o+n[14])*d,d=-1/u,r[0]=n[0]*s*d,r[1]=n[5]*l*d,d=-1/f,t[2]=(n[10]*f+n[14])*d}return this.min._dirty=!0,this.max._dirty=!0,this},updateVertices:function(){var e=this.vertices;if(!e){e=[];for(var t=0;t<8;t++)e[t]=O.fromValues(0,0,0);this.vertices=e}var r=this.min.array,n=this.max.array;return vn(e[0],r[0],r[1],r[2]),vn(e[1],r[0],n[1],r[2]),vn(e[2],n[0],r[1],r[2]),vn(e[3],n[0],n[1],r[2]),vn(e[4],r[0],r[1],n[2]),vn(e[5],r[0],n[1],n[2]),vn(e[6],n[0],r[1],n[2]),vn(e[7],n[0],n[1],n[2]),this},copy:function(e){var t=this.min,r=this.max;return ds(t.array,e.min.array),ds(r.array,e.max.array),t._dirty=!0,r._dirty=!0,this},clone:function(){var e=new Ls;return e.copy(this),e}};const $t=Ls;var pI=0,gI=qt.extend({name:"",position:null,rotation:null,scale:null,worldTransform:null,localTransform:null,autoUpdateLocalTransform:!0,_parent:null,_scene:null,_needsUpdateWorldTransform:!0,_inIterating:!1,__depth:0},function(){this.name||(this.name=(this.type||"NODE")+"_"+pI++),this.position||(this.position=new X),this.rotation||(this.rotation=new J_),this.scale||(this.scale=new X(1,1,1)),this.worldTransform=new ne,this.localTransform=new ne,this._children=[]},{target:null,invisible:!1,isSkinnedMesh:function(){return!1},isRenderable:function(){return!1},setName:function(e){var t=this._scene;if(t){var r=t._nodeRepository;delete r[this.name],r[e]=this}this.name=e},add:function(e){var t=e._parent;if(t!==this){t&&t.remove(e),e._parent=this,this._children.push(e);var r=this._scene;r&&r!==e.scene&&e.traverse(this._addSelfToScene,this),e._needsUpdateWorldTransform=!0}},remove:function(e){var t=this._children,r=t.indexOf(e);r<0||(t.splice(r,1),e._parent=null,this._scene&&e.traverse(this._removeSelfFromScene,this))},removeAll:function(){for(var e=this._children,t=0;t<e.length;t++)e[t]._parent=null,this._scene&&e[t].traverse(this._removeSelfFromScene,this);this._children=[]},getScene:function(){return this._scene},getParent:function(){return this._parent},_removeSelfFromScene:function(e){e._scene.removeFromScene(e),e._scene=null},_addSelfToScene:function(e){this._scene.addToScene(e),e._scene=this._scene},isAncestor:function(e){for(var t=e._parent;t;){if(t===this)return!0;t=t._parent}return!1},children:function(){return this._children.slice()},childAt:function(e){return this._children[e]},getChildByName:function(e){for(var t=this._children,r=0;r<t.length;r++)if(t[r].name===e)return t[r]},getDescendantByName:function(e){for(var t=this._children,r=0;r<t.length;r++){var n=t[r];if(n.name===e)return n;var a=n.getDescendantByName(e);if(a)return a}},queryNode:function(e){if(e){for(var t=e.split("/"),r=this,n=0;n<t.length;n++){var a=t[n];if(a){for(var i=!1,o=r._children,s=0;s<o.length;s++){var l=o[s];if(l.name===a){r=l,i=!0;break}}if(!i)return}}return r}},getPath:function(e){if(!this._parent)return"/";for(var t=this._parent,r=this.name;t._parent&&(r=t.name+"/"+r,t._parent!=e);)t=t._parent;return!t._parent&&e?null:r},traverse:function(e,t){e.call(t,this);for(var r=this._children,n=0,a=r.length;n<a;n++)r[n].traverse(e,t)},eachChild:function(e,t){for(var r=this._children,n=0,a=r.length;n<a;n++){var i=r[n];e.call(t,i,n)}},setLocalTransform:function(e){$.copy(this.localTransform.array,e.array),this.decomposeLocalTransform()},decomposeLocalTransform:function(e){var t=e?null:this.scale;this.localTransform.decomposeMatrix(t,this.rotation,this.position)},setWorldTransform:function(e){$.copy(this.worldTransform.array,e.array),this.decomposeWorldTransform()},decomposeWorldTransform:function(){var e=$.create();return function(t){var r=this.localTransform,n=this.worldTransform;this._parent?($.invert(e,this._parent.worldTransform.array),$.multiply(r.array,e,n.array)):$.copy(r.array,n.array);var a=t?null:this.scale;r.decomposeMatrix(a,this.rotation,this.position)}}(),transformNeedsUpdate:function(){return this.position._dirty||this.rotation._dirty||this.scale._dirty},updateLocalTransform:function(){var e=this.position,t=this.rotation,r=this.scale;if(this.transformNeedsUpdate()){var n=this.localTransform.array;$.fromRotationTranslation(n,t.array,e.array),$.scale(n,n,r.array),t._dirty=!1,r._dirty=!1,e._dirty=!1,this._needsUpdateWorldTransform=!0}},_updateWorldTransformTopDown:function(){var e=this.localTransform.array,t=this.worldTransform.array;this._parent?$.multiplyAffine(t,this._parent.worldTransform.array,e):$.copy(t,e)},updateWorldTransform:function(){for(var e=this;e&&e.getParent()&&e.getParent().transformNeedsUpdate();)e=e.getParent();e.update()},update:function(e){this.autoUpdateLocalTransform?this.updateLocalTransform():e=!0,(e||this._needsUpdateWorldTransform)&&(this._updateWorldTransformTopDown(),e=!0,this._needsUpdateWorldTransform=!1);for(var t=this._children,r=0,n=t.length;r<n;r++)t[r].update(e)},getBoundingBox:function(){function e(a){return!a.invisible&&a.geometry}var t=new $t,r=new ne,n=new ne;return function(a,i){return i=i||new $t,this._parent?ne.invert(n,this._parent.worldTransform):ne.identity(n),this.traverse(function(o){o.geometry&&o.geometry.boundingBox&&(t.copy(o.geometry.boundingBox),ne.multiply(r,n,o.worldTransform),t.applyTransform(r),i.union(t))},this,e),i}}(),getWorldPosition:function(e){this.transformNeedsUpdate()&&this.updateWorldTransform();var t=this.worldTransform.array;if(e){var r=e.array;return r[0]=t[12],r[1]=t[13],r[2]=t[14],e}else return new X(t[12],t[13],t[14])},clone:function(){var e=new this.constructor,t=this._children;e.setName(this.name),e.position.copy(this.position),e.rotation.copy(this.rotation),e.scale.copy(this.scale);for(var r=0;r<t.length;r++)e.add(t[r].clone());return e},rotateAround:function(){var e=new X,t=new ne;return function(r,n,a){e.copy(this.position).subtract(r);var i=this.localTransform;i.identity(),i.translate(r),i.rotate(a,n),t.fromRotationTranslation(this.rotation,e),i.multiply(t),i.scale(this.scale),this.decomposeLocalTransform(),this._needsUpdateWorldTransform=!0}}(),lookAt:function(){var e=new ne;return function(t,r){e.lookAt(this.position,t,r||this.localTransform.y).invert(),this.setLocalTransform(e),this.target=t}}()});const kr=gI;var cr=kr.extend({material:null,geometry:null,mode:G.TRIANGLES,_renderInfo:null},{__program:null,lightGroup:0,renderOrder:0,culling:!0,cullFace:G.BACK,frontFace:G.CCW,frustumCulling:!0,receiveShadow:!0,castShadow:!0,ignorePicking:!1,ignorePreZ:!1,ignoreGBuffer:!1,isRenderable:function(){return this.geometry&&this.material&&this.material.shader&&!this.invisible&&this.geometry.vertexCount>0},beforeRender:function(e){},afterRender:function(e,t){},getBoundingBox:function(e,t){return t=kr.prototype.getBoundingBox.call(this,e,t),this.geometry&&this.geometry.boundingBox&&t.union(this.geometry.boundingBox),t},clone:function(){var e=["castShadow","receiveShadow","mode","culling","cullFace","frontFace","frustumCulling","renderOrder","lineWidth","ignorePicking","ignorePreZ","ignoreGBuffer"];return function(){var t=kr.prototype.clone.call(this);t.geometry=this.geometry,t.material=this.material;for(var r=0;r<e.length;r++){var n=e[r];t[n]!==this[n]&&(t[n]=this[n])}return t}}()});cr.POINTS=G.POINTS;cr.LINES=G.LINES;cr.LINE_LOOP=G.LINE_LOOP;cr.LINE_STRIP=G.LINE_STRIP;cr.TRIANGLES=G.TRIANGLES;cr.TRIANGLE_STRIP=G.TRIANGLE_STRIP;cr.TRIANGLE_FAN=G.TRIANGLE_FAN;cr.BACK=G.BACK;cr.FRONT=G.FRONT;cr.FRONT_AND_BACK=G.FRONT_AND_BACK;cr.CW=G.CW;cr.CCW=G.CCW;const Rh=cr;var id=qt.extend({scene:null,camera:null,renderer:null},function(){this._ray=new ol,this._ndc=new lr},{pick:function(e,t,r){var n=this.pickAll(e,t,[],r);return n[0]||null},pickAll:function(e,t,r,n){return this.renderer.screenToNDC(e,t,this._ndc),this.camera.castRay(this._ndc,this._ray),r=r||[],this._intersectNode(this.scene,r,n||!1),r.sort(this._intersectionCompareFunc),r},_intersectNode:function(e,t,r){e instanceof Rh&&e.isRenderable()&&(!e.ignorePicking||r)&&(e.mode===G.TRIANGLES&&e.geometry.isUseIndices()||e.geometry.pickByRay||e.geometry.pick)&&this._intersectRenderable(e,t);for(var n=0;n<e._children.length;n++)this._intersectNode(e._children[n],t,r)},_intersectRenderable:function(){var e=new X,t=new X,r=new X,n=new ol,a=new ne;return function(i,o){var s=i.isSkinnedMesh();n.copy(this._ray),ne.invert(a,i.worldTransform),s||n.applyTransform(a);var l=i.geometry,u=s?i.skeleton.boundingBox:l.boundingBox;if(!(u&&!n.intersectBoundingBox(u))){if(l.pick){l.pick(this._ndc.x,this._ndc.y,this.renderer,this.camera,i,o);return}else if(l.pickByRay){l.pickByRay(n,i,o);return}var c=i.cullFace===G.BACK&&i.frontFace===G.CCW||i.cullFace===G.FRONT&&i.frontFace===G.CW,h,f=l.indices,d=l.attributes.position,v=l.attributes.weight,p=l.attributes.joint,g,m=[];if(!(!d||!d.value||!f)){if(s){g=i.skeleton.getSubSkinMatrices(i.__uid__,i.joints);for(var _=0;_<i.joints.length;_++){m[_]=m[_]||[];for(var y=0;y<16;y++)m[_][y]=g[_*16+y]}var x=[],S=[],T=[],b=[],w=[],A=l.attributes.skinnedPosition;(!A||!A.value)&&(l.createAttribute("skinnedPosition","f",3),A=l.attributes.skinnedPosition,A.init(l.vertexCount));for(var _=0;_<l.vertexCount;_++){d.get(_,x),v.get(_,S),p.get(_,T),S[3]=1-S[0]-S[1]-S[2],O.set(b,0,0,0);for(var y=0;y<4;y++)T[y]>=0&&S[y]>1e-4&&(O.transformMat4(w,x,m[T[y]]),O.scaleAndAdd(b,b,w,S[y]));A.set(_,b)}}for(var _=0;_<f.length;_+=3){var E=f[_],C=f[_+1],M=f[_+2],P=s?l.attributes.skinnedPosition:d;if(P.get(E,e.array),P.get(C,t.array),P.get(M,r.array),c?h=n.intersectTriangle(e,t,r,i.culling):h=n.intersectTriangle(e,r,t,i.culling),h){var L=new X;s?X.copy(L,h):X.transformMat4(L,h,i.worldTransform),o.push(new id.Intersection(h,L,i,[E,C,M],_/3,X.dist(L,this._ray.origin)))}}}}}}(),_intersectionCompareFunc:function(e,t){return e.distance-t.distance}});id.Intersection=function(e,t,r,n,a,i){this.point=e,this.pointWorld=t,this.target=r,this.triangle=n,this.triangleIndex=a,this.distance=i};const mI=id;var Ri="__dt__",sl=function(){this._contextId=0,this._caches=[],this._context={}};sl.prototype={use:function(e,t){var r=this._caches;r[e]||(r[e]={},t&&(r[e]=t())),this._contextId=e,this._context=r[e]},put:function(e,t){this._context[e]=t},get:function(e){return this._context[e]},dirty:function(e){e=e||"";var t=Ri+e;this.put(t,!0)},dirtyAll:function(e){e=e||"";for(var t=Ri+e,r=this._caches,n=0;n<r.length;n++)r[n]&&(r[n][t]=!0)},fresh:function(e){e=e||"";var t=Ri+e;this.put(t,!1)},freshAll:function(e){e=e||"";for(var t=Ri+e,r=this._caches,n=0;n<r.length;n++)r[n]&&(r[n][t]=!1)},isDirty:function(e){e=e||"";var t=Ri+e,r=this._context;return!r.hasOwnProperty(t)||r[t]===!0},deleteContext:function(e){delete this._caches[e],this._context={}},delete:function(e){delete this._context[e]},clearAll:function(){this._caches={}},getContext:function(){return this._context},eachContext:function(e,t){var r=Object.keys(this._caches);r.forEach(function(n){e&&e.call(t,n)})},miss:function(e){return!this._context.hasOwnProperty(e)}};sl.prototype.constructor=sl;const od=sl;var Ce=qt.extend({width:512,height:512,type:G.UNSIGNED_BYTE,format:G.RGBA,wrapS:G.REPEAT,wrapT:G.REPEAT,minFilter:G.LINEAR_MIPMAP_LINEAR,magFilter:G.LINEAR,useMipmap:!0,anisotropic:1,flipY:!0,sRGB:!0,unpackAlignment:4,premultiplyAlpha:!1,dynamic:!1,NPOT:!1,__used:0},function(){this._cache=new od},{getWebGLTexture:function(e){var t=e.gl,r=this._cache;return r.use(e.__uid__),r.miss("webgl_texture")&&r.put("webgl_texture",t.createTexture()),this.dynamic?this.update(e):r.isDirty()&&(this.update(e),r.fresh()),r.get("webgl_texture")},bind:function(){},unbind:function(){},dirty:function(){this._cache&&this._cache.dirtyAll()},update:function(e){},updateCommon:function(e){var t=e.gl;t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,this.flipY),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,this.premultiplyAlpha),t.pixelStorei(t.UNPACK_ALIGNMENT,this.unpackAlignment),this.format===G.DEPTH_COMPONENT&&(this.useMipmap=!1);var r=e.getGLExtension("EXT_sRGB");this.format===Ce.SRGB&&!r&&(this.format=Ce.RGB),this.format===Ce.SRGB_ALPHA&&!r&&(this.format=Ce.RGBA),this.NPOT=!this.isPowerOfTwo()},getAvailableWrapS:function(){return this.NPOT?G.CLAMP_TO_EDGE:this.wrapS},getAvailableWrapT:function(){return this.NPOT?G.CLAMP_TO_EDGE:this.wrapT},getAvailableMinFilter:function(){var e=this.minFilter;return this.NPOT||!this.useMipmap?e===G.NEAREST_MIPMAP_NEAREST||e===G.NEAREST_MIPMAP_LINEAR?G.NEAREST:e===G.LINEAR_MIPMAP_LINEAR||e===G.LINEAR_MIPMAP_NEAREST?G.LINEAR:e:e},getAvailableMagFilter:function(){return this.magFilter},nextHighestPowerOfTwo:function(e){--e;for(var t=1;t<32;t<<=1)e=e|e>>t;return e+1},dispose:function(e){var t=this._cache;t.use(e.__uid__);var r=t.get("webgl_texture");r&&e.gl.deleteTexture(r),t.deleteContext(e.__uid__)},isRenderable:function(){},isPowerOfTwo:function(){}});Object.defineProperty(Ce.prototype,"width",{get:function(){return this._width},set:function(e){this._width=e}});Object.defineProperty(Ce.prototype,"height",{get:function(){return this._height},set:function(e){this._height=e}});Ce.BYTE=G.BYTE;Ce.UNSIGNED_BYTE=G.UNSIGNED_BYTE;Ce.SHORT=G.SHORT;Ce.UNSIGNED_SHORT=G.UNSIGNED_SHORT;Ce.INT=G.INT;Ce.UNSIGNED_INT=G.UNSIGNED_INT;Ce.FLOAT=G.FLOAT;Ce.HALF_FLOAT=36193;Ce.UNSIGNED_INT_24_8_WEBGL=34042;Ce.DEPTH_COMPONENT=G.DEPTH_COMPONENT;Ce.DEPTH_STENCIL=G.DEPTH_STENCIL;Ce.ALPHA=G.ALPHA;Ce.RGB=G.RGB;Ce.RGBA=G.RGBA;Ce.LUMINANCE=G.LUMINANCE;Ce.LUMINANCE_ALPHA=G.LUMINANCE_ALPHA;Ce.SRGB=35904;Ce.SRGB_ALPHA=35906;Ce.COMPRESSED_RGB_S3TC_DXT1_EXT=33776;Ce.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777;Ce.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778;Ce.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779;Ce.NEAREST=G.NEAREST;Ce.LINEAR=G.LINEAR;Ce.NEAREST_MIPMAP_NEAREST=G.NEAREST_MIPMAP_NEAREST;Ce.LINEAR_MIPMAP_NEAREST=G.LINEAR_MIPMAP_NEAREST;Ce.NEAREST_MIPMAP_LINEAR=G.NEAREST_MIPMAP_LINEAR;Ce.LINEAR_MIPMAP_LINEAR=G.LINEAR_MIPMAP_LINEAR;Ce.REPEAT=G.REPEAT;Ce.CLAMP_TO_EDGE=G.CLAMP_TO_EDGE;Ce.MIRRORED_REPEAT=G.MIRRORED_REPEAT;const ie=Ce;var hr=Rh.extend({skeleton:null,joints:null},function(){this.joints||(this.joints=[])},{offsetMatrix:null,isInstancedMesh:function(){return!1},isSkinnedMesh:function(){return!!(this.skeleton&&this.joints&&this.joints.length>0)},clone:function(){var e=Rh.prototype.clone.call(this);return e.skeleton=this.skeleton,this.joints&&(e.joints=this.joints.slice()),e}});hr.POINTS=G.POINTS;hr.LINES=G.LINES;hr.LINE_LOOP=G.LINE_LOOP;hr.LINE_STRIP=G.LINE_STRIP;hr.TRIANGLES=G.TRIANGLES;hr.TRIANGLE_STRIP=G.TRIANGLE_STRIP;hr.TRIANGLE_FAN=G.TRIANGLE_FAN;hr.BACK=G.BACK;hr.FRONT=G.FRONT;hr.FRONT_AND_BACK=G.FRONT_AND_BACK;hr.CW=G.CW;hr.CCW=G.CCW;const oa=hr;var jl={};jl.isPowerOfTwo=function(e){return(e&e-1)===0};jl.nextPowerOfTwo=function(e){return e--,e|=e>>1,e|=e>>2,e|=e>>4,e|=e>>8,e|=e>>16,e++,e};jl.nearestPowerOfTwo=function(e){return Math.pow(2,Math.round(Math.log(e)/Math.LN2))};const Q_=jl;var f1=Q_.isPowerOfTwo;function d1(e){return Math.pow(2,Math.round(Math.log(e)/Math.LN2))}function yI(e,t){var r=d1(e.width),n=d1(e.height);t=t||document.createElement("canvas"),t.width=r,t.height=n;var a=t.getContext("2d");return a.drawImage(e.image,0,0,r,n),t}var sd=ie.extend(function(){return{image:null,pixels:null,mipmaps:[],convertToPOT:!1}},{textureType:"texture2D",update:function(e){var t=e.gl;t.bindTexture(t.TEXTURE_2D,this._cache.get("webgl_texture")),this.updateCommon(e);var r=this.format,n=this.type,a=!!(this.convertToPOT&&!this.mipmaps.length&&this.image&&(this.wrapS===ie.REPEAT||this.wrapT===ie.REPEAT)&&this.NPOT);t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,a?this.wrapS:this.getAvailableWrapS()),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,a?this.wrapT:this.getAvailableWrapT()),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,a?this.magFilter:this.getAvailableMagFilter()),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,a?this.minFilter:this.getAvailableMinFilter());var i=e.getGLExtension("EXT_texture_filter_anisotropic");if(i&&this.anisotropic>1&&t.texParameterf(t.TEXTURE_2D,i.TEXTURE_MAX_ANISOTROPY_EXT,this.anisotropic),n===36193){var o=e.getGLExtension("OES_texture_half_float");o||(n=G.FLOAT)}if(this.mipmaps.length)for(var s=this.width,l=this.height,u=0;u<this.mipmaps.length;u++){var c=this.mipmaps[u];this._updateTextureData(t,c,u,s,l,r,n,!1),s/=2,l/=2}else this._updateTextureData(t,this,0,this.width,this.height,r,n,a),this.useMipmap&&(!this.NPOT||a)&&t.generateMipmap(t.TEXTURE_2D);t.bindTexture(t.TEXTURE_2D,null)},_updateTextureData:function(e,t,r,n,a,i,o,s){if(t.image){var l=t.image;s&&(this._potCanvas=yI(this,this._potCanvas),l=this._potCanvas),e.texImage2D(e.TEXTURE_2D,r,i,i,o,l)}else i<=ie.COMPRESSED_RGBA_S3TC_DXT5_EXT&&i>=ie.COMPRESSED_RGB_S3TC_DXT1_EXT?e.compressedTexImage2D(e.TEXTURE_2D,r,i,n,a,0,t.pixels):e.texImage2D(e.TEXTURE_2D,r,i,n,a,0,i,o,t.pixels)},generateMipmap:function(e){var t=e.gl;this.useMipmap&&!this.NPOT&&(t.bindTexture(t.TEXTURE_2D,this._cache.get("webgl_texture")),t.generateMipmap(t.TEXTURE_2D))},isPowerOfTwo:function(){return f1(this.width)&&f1(this.height)},isRenderable:function(){return this.image?this.image.width>0&&this.image.height>0:!!(this.width&&this.height)},bind:function(e){e.gl.bindTexture(e.gl.TEXTURE_2D,this.getWebGLTexture(e))},unbind:function(e){e.gl.bindTexture(e.gl.TEXTURE_2D,null)},load:function(e,t){var r=ht.createImage();t&&(r.crossOrigin=t);var n=this;return r.onload=function(){n.dirty(),n.trigger("success",n)},r.onerror=function(){n.trigger("error",n)},r.src=e,this.image=r,this}});Object.defineProperty(sd.prototype,"width",{get:function(){return this.image?this.image.width:this._width},set:function(e){this.image?console.warn("Texture from image can't set width"):(this._width!==e&&this.dirty(),this._width=e)}});Object.defineProperty(sd.prototype,"height",{get:function(){return this.image?this.image.height:this._height},set:function(e){this.image?console.warn("Texture from image can't set height"):(this._height!==e&&this.dirty(),this._height=e)}});const _e=sd;function ex(e){return{byte:ht.Int8Array,ubyte:ht.Uint8Array,short:ht.Int16Array,ushort:ht.Uint16Array}[e]||ht.Float32Array}function bc(e){return"attr_"+e}function ti(e,t,r,n){switch(this.name=e,this.type=t,this.size=r,this.semantic=n||"",this.value=null,r){case 1:this.get=function(a){return this.value[a]},this.set=function(a,i){this.value[a]=i},this.copy=function(a,i){this.value[a]=this.value[a]};break;case 2:this.get=function(a,i){var o=this.value;return i[0]=o[a*2],i[1]=o[a*2+1],i},this.set=function(a,i){var o=this.value;o[a*2]=i[0],o[a*2+1]=i[1]},this.copy=function(a,i){var o=this.value;i*=2,a*=2,o[a]=o[i],o[a+1]=o[i+1]};break;case 3:this.get=function(a,i){var o=a*3,s=this.value;return i[0]=s[o],i[1]=s[o+1],i[2]=s[o+2],i},this.set=function(a,i){var o=a*3,s=this.value;s[o]=i[0],s[o+1]=i[1],s[o+2]=i[2]},this.copy=function(a,i){var o=this.value;i*=3,a*=3,o[a]=o[i],o[a+1]=o[i+1],o[a+2]=o[i+2]};break;case 4:this.get=function(a,i){var o=this.value,s=a*4;return i[0]=o[s],i[1]=o[s+1],i[2]=o[s+2],i[3]=o[s+3],i},this.set=function(a,i){var o=this.value,s=a*4;o[s]=i[0],o[s+1]=i[1],o[s+2]=i[2],o[s+3]=i[3]},this.copy=function(a,i){var o=this.value;i*=4,a*=4,o[a]=o[i],o[a+1]=o[i+1],o[a+2]=o[i+2],o[a+3]=o[i+3]}}}ti.prototype.init=function(e){if(!this.value||this.value.length!==e*this.size){var t=ex(this.type);this.value=new t(e*this.size)}};ti.prototype.fromArray=function(e){var t=ex(this.type),r;if(e[0]&&e[0].length){var n=0,a=this.size;r=new t(e.length*a);for(var i=0;i<e.length;i++)for(var o=0;o<a;o++)r[n++]=e[i][o]}else r=new t(e);this.value=r};ti.prototype.clone=function(e){var t=new ti(this.name,this.type,this.size,this.semantic);return e&&console.warn("todo"),t};function tx(e,t,r,n,a){this.name=e,this.type=t,this.buffer=r,this.size=n,this.semantic=a,this.symbol="",this.needsRemove=!1}function rx(e){this.buffer=e,this.count=0}var ln=qt.extend(function(){return{attributes:{},indices:null,dynamic:!0,_enabledAttributes:null,__used:0}},function(){this._cache=new od,this._attributeList=Object.keys(this.attributes),this.__vaoCache={}},{mainAttribute:"",pick:null,pickByRay:null,dirty:function(){for(var e=this.getEnabledAttributes(),t=0;t<e.length;t++)this.dirtyAttribute(e[t]);this.dirtyIndices(),this._enabledAttributes=null,this._cache.dirty("any")},dirtyIndices:function(){this._cache.dirtyAll("indices")},dirtyAttribute:function(e){this._cache.dirtyAll(bc(e)),this._cache.dirtyAll("attributes")},getTriangleIndices:function(e,t){if(e<this.triangleCount&&e>=0){t||(t=[]);var r=this.indices;return t[0]=r[e*3],t[1]=r[e*3+1],t[2]=r[e*3+2],t}},setTriangleIndices:function(e,t){var r=this.indices;r[e*3]=t[0],r[e*3+1]=t[1],r[e*3+2]=t[2]},isUseIndices:function(){return!!this.indices},initIndicesFromArray:function(e){var t,r=this.vertexCount>65535?ht.Uint32Array:ht.Uint16Array;if(e[0]&&e[0].length){var n=0,a=3;t=new r(e.length*a);for(var i=0;i<e.length;i++)for(var o=0;o<a;o++)t[n++]=e[i][o]}else t=new r(e);this.indices=t},createAttribute:function(e,t,r,n){var a=new ti(e,t,r,n);return this.attributes[e]&&this.removeAttribute(e),this.attributes[e]=a,this._attributeList.push(e),a},removeAttribute:function(e){var t=this._attributeList,r=t.indexOf(e);return r>=0?(t.splice(r,1),delete this.attributes[e],!0):!1},getAttribute:function(e){return this.attributes[e]},getEnabledAttributes:function(){var e=this._enabledAttributes,t=this._attributeList;if(e)return e;for(var r=[],n=this.vertexCount,a=0;a<t.length;a++){var i=t[a],o=this.attributes[i];o.value&&o.value.length===n*o.size&&r.push(i)}return this._enabledAttributes=r,r},getBufferChunks:function(e){var t=this._cache;t.use(e.__uid__);var r=t.isDirty("attributes"),n=t.isDirty("indices");if(r||n){this._updateBuffer(e.gl,r,n);for(var a=this.getEnabledAttributes(),i=0;i<a.length;i++)t.fresh(bc(a[i]));t.fresh("attributes"),t.fresh("indices")}return t.fresh("any"),t.get("chunks")},_updateBuffer:function(e,t,r){var n=this._cache,a=n.get("chunks"),i=!1;a||(a=[],a[0]={attributeBuffers:[],indicesBuffer:null},n.put("chunks",a),i=!0);var o=a[0],s=o.attributeBuffers,l=o.indicesBuffer;if(t||i){var u=this.getEnabledAttributes(),c={};if(!i)for(var h=0;h<s.length;h++)c[s[h].name]=s[h];for(var f=0;f<u.length;f++){var d=u[f],v=this.attributes[d],p;i||(p=c[d]);var g;p?g=p.buffer:g=e.createBuffer(),n.isDirty(bc(d))&&(e.bindBuffer(e.ARRAY_BUFFER,g),e.bufferData(e.ARRAY_BUFFER,v.value,this.dynamic?e.DYNAMIC_DRAW:e.STATIC_DRAW)),s[f]=new tx(d,v.type,g,v.size,v.semantic)}for(var h=f;h<s.length;h++)e.deleteBuffer(s[h].buffer);s.length=f}this.isUseIndices()&&(r||i)&&(l||(l=new rx(e.createBuffer()),o.indicesBuffer=l),l.count=this.indices.length,e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,l.buffer),e.bufferData(e.ELEMENT_ARRAY_BUFFER,this.indices,this.dynamic?e.DYNAMIC_DRAW:e.STATIC_DRAW))},dispose:function(e){var t=this._cache;t.use(e.__uid__);var r=t.get("chunks");if(r)for(var n=0;n<r.length;n++){for(var a=r[n],i=0;i<a.attributeBuffers.length;i++){var o=a.attributeBuffers[i];e.gl.deleteBuffer(o.buffer)}a.indicesBuffer&&e.gl.deleteBuffer(a.indicesBuffer.buffer)}if(this.__vaoCache){var s=e.getGLExtension("OES_vertex_array_object");for(var l in this.__vaoCache){var u=this.__vaoCache[l].vao;u&&s.deleteVertexArrayOES(u)}}this.__vaoCache={},t.deleteContext(e.__uid__)}});Object.defineProperty&&(Object.defineProperty(ln.prototype,"vertexCount",{enumerable:!1,get:function(){var e=this.attributes[this.mainAttribute];return e||(e=this.attributes[this._attributeList[0]]),!e||!e.value?0:e.value.length/e.size}}),Object.defineProperty(ln.prototype,"triangleCount",{enumerable:!1,get:function(){var e=this.indices;return e?e.length/3:0}}));ln.STATIC_DRAW=G.STATIC_DRAW;ln.DYNAMIC_DRAW=G.DYNAMIC_DRAW;ln.STREAM_DRAW=G.STREAM_DRAW;ln.AttributeBuffer=tx;ln.IndicesBuffer=rx;ln.Attribute=ti;const _a=ln;var Wt=O.create,Ia=O.add,kn=O.set,Br=_a.Attribute,xa=_a.extend(function(){return{attributes:{position:new Br("position","float",3,"POSITION"),texcoord0:new Br("texcoord0","float",2,"TEXCOORD_0"),texcoord1:new Br("texcoord1","float",2,"TEXCOORD_1"),normal:new Br("normal","float",3,"NORMAL"),tangent:new Br("tangent","float",4,"TANGENT"),color:new Br("color","float",4,"COLOR"),weight:new Br("weight","float",3,"WEIGHT"),joint:new Br("joint","float",4,"JOINT"),barycentric:new Br("barycentric","float",3,null)},boundingBox:null}},{mainAttribute:"position",updateBoundingBox:function(){var e=this.boundingBox;e||(e=this.boundingBox=new $t);var t=this.attributes.position.value;if(t&&t.length){var r=e.min,n=e.max,a=r.array,i=n.array;O.set(a,t[0],t[1],t[2]),O.set(i,t[0],t[1],t[2]);for(var o=3;o<t.length;){var s=t[o++],l=t[o++],u=t[o++];s<a[0]&&(a[0]=s),l<a[1]&&(a[1]=l),u<a[2]&&(a[2]=u),s>i[0]&&(i[0]=s),l>i[1]&&(i[1]=l),u>i[2]&&(i[2]=u)}r._dirty=!0,n._dirty=!0}},generateVertexNormals:function(){if(this.vertexCount){var e=this.indices,t=this.attributes,r=t.position.value,n=t.normal.value;if(!n||n.length!==r.length)n=t.normal.value=new ht.Float32Array(r.length);else for(var a=0;a<n.length;a++)n[a]=0;for(var i=Wt(),o=Wt(),s=Wt(),l=Wt(),u=Wt(),c=Wt(),h=e?e.length:this.vertexCount,f,d,v,p=0;p<h;){e?(f=e[p++],d=e[p++],v=e[p++]):(f=p++,d=p++,v=p++),kn(i,r[f*3],r[f*3+1],r[f*3+2]),kn(o,r[d*3],r[d*3+1],r[d*3+2]),kn(s,r[v*3],r[v*3+1],r[v*3+2]),O.sub(l,i,o),O.sub(u,o,s),O.cross(c,l,u);for(var a=0;a<3;a++)n[f*3+a]=n[f*3+a]+c[a],n[d*3+a]=n[d*3+a]+c[a],n[v*3+a]=n[v*3+a]+c[a]}for(var a=0;a<n.length;)kn(c,n[a],n[a+1],n[a+2]),O.normalize(c,c),n[a++]=c[0],n[a++]=c[1],n[a++]=c[2];this.dirty()}},generateFaceNormals:function(){if(this.vertexCount){this.isUniqueVertex()||this.generateUniqueVertex();var e=this.indices,t=this.attributes,r=t.position.value,n=t.normal.value,a=Wt(),i=Wt(),o=Wt(),s=Wt(),l=Wt(),u=Wt();n||(n=t.normal.value=new Float32Array(r.length));for(var c=e?e.length:this.vertexCount,h,f,d,v=0;v<c;){e?(h=e[v++],f=e[v++],d=e[v++]):(h=v++,f=v++,d=v++),kn(a,r[h*3],r[h*3+1],r[h*3+2]),kn(i,r[f*3],r[f*3+1],r[f*3+2]),kn(o,r[d*3],r[d*3+1],r[d*3+2]),O.sub(s,a,i),O.sub(l,i,o),O.cross(u,s,l),O.normalize(u,u);for(var p=0;p<3;p++)n[h*3+p]=u[p],n[f*3+p]=u[p],n[d*3+p]=u[p]}this.dirty()}},generateTangents:function(){if(this.vertexCount){var e=this.vertexCount,t=this.attributes;t.tangent.value||(t.tangent.value=new Float32Array(e*4));var r=t.texcoord0.value,n=t.position.value,a=t.tangent.value,i=t.normal.value;if(!r){console.warn("Geometry without texcoords can't generate tangents.");return}for(var o=[],s=[],l=0;l<e;l++)o[l]=[0,0,0],s[l]=[0,0,0];for(var u=[0,0,0],c=[0,0,0],h=this.indices,f=h?h.length:this.vertexCount,d,v,p,l=0;l<f;){h?(d=h[l++],v=h[l++],p=h[l++]):(d=l++,v=l++,p=l++);var g=r[d*2],m=r[v*2],_=r[p*2],y=r[d*2+1],x=r[v*2+1],S=r[p*2+1],T=n[d*3],b=n[v*3],w=n[p*3],A=n[d*3+1],E=n[v*3+1],C=n[p*3+1],M=n[d*3+2],P=n[v*3+2],L=n[p*3+2],I=b-T,N=w-T,F=E-A,B=C-A,k=P-M,z=L-M,W=m-g,J=_-g,re=x-y,Q=S-y,q=1/(W*Q-re*J);u[0]=(Q*I-re*N)*q,u[1]=(Q*F-re*B)*q,u[2]=(Q*k-re*z)*q,c[0]=(W*N-J*I)*q,c[1]=(W*B-J*F)*q,c[2]=(W*z-J*k)*q,Ia(o[d],o[d],u),Ia(o[v],o[v],u),Ia(o[p],o[p],u),Ia(s[d],s[d],c),Ia(s[v],s[v],c),Ia(s[p],s[p],c)}for(var Ee=Wt(),ae=Wt(),j=Wt(),l=0;l<e;l++){j[0]=i[l*3],j[1]=i[l*3+1],j[2]=i[l*3+2];var pe=o[l];O.scale(Ee,j,O.dot(j,pe)),O.sub(Ee,pe,Ee),O.normalize(Ee,Ee),O.cross(ae,j,pe),a[l*4]=Ee[0],a[l*4+1]=Ee[1],a[l*4+2]=Ee[2],a[l*4+3]=O.dot(ae,s[l])<0?-1:1}this.dirty()}},isUniqueVertex:function(){return this.isUseIndices()?this.vertexCount===this.indices.length:!0},generateUniqueVertex:function(){if(!(!this.vertexCount||!this.indices)){this.indices.length>65535&&(this.indices=new ht.Uint32Array(this.indices));for(var e=this.attributes,t=this.indices,r=this.getEnabledAttributes(),n={},a=0;a<r.length;a++){var i=r[a];n[i]=e[i].value,e[i].init(this.indices.length)}for(var o=0,s=0;s<t.length;s++){for(var l=t[s],a=0;a<r.length;a++)for(var i=r[a],u=e[i].value,c=e[i].size,h=0;h<c;h++)u[o*c+h]=n[i][l*c+h];t[s]=o,o++}this.dirty()}},generateBarycentric:function(){if(this.vertexCount){this.isUniqueVertex()||this.generateUniqueVertex();var e=this.attributes,t=e.barycentric.value,r=this.indices;if(!(t&&t.length===r.length*3)){t=e.barycentric.value=new Float32Array(r.length*3);for(var n=0;n<(r?r.length:this.vertexCount/3);)for(var a=0;a<3;a++){var i=r?r[n++]:n*3+a;t[i*3+a]=1}this.dirty()}}},applyTransform:function(e){var t=this.attributes,r=t.position.value,n=t.normal.value,a=t.tangent.value;e=e.array;var i=$.create();$.invert(i,e),$.transpose(i,i);var o=O.transformMat4,s=O.forEach;s(r,3,0,null,o,e),n&&s(n,3,0,null,o,i),a&&s(a,4,0,null,o,i),this.boundingBox&&this.updateBoundingBox()},dispose:function(e){var t=this._cache;t.use(e.__uid__);var r=t.get("chunks");if(r)for(var n=0;n<r.length;n++){for(var a=r[n],i=0;i<a.attributeBuffers.length;i++){var o=a.attributeBuffers[i];e.gl.deleteBuffer(o.buffer)}a.indicesBuffer&&e.gl.deleteBuffer(a.indicesBuffer.buffer)}if(this.__vaoCache){var s=e.getGLExtension("OES_vertex_array_object");for(var l in this.__vaoCache){var u=this.__vaoCache[l].vao;u&&s.deleteVertexArrayOES(u)}}this.__vaoCache={},t.deleteContext(e.__uid__)}});xa.STATIC_DRAW=_a.STATIC_DRAW;xa.DYNAMIC_DRAW=_a.DYNAMIC_DRAW;xa.STREAM_DRAW=_a.STREAM_DRAW;xa.AttributeBuffer=_a.AttributeBuffer;xa.IndicesBuffer=_a.IndicesBuffer;xa.Attribute=Br;const Me=xa,_I=`vec3 calcAmbientSHLight(int idx, vec3 N) {
 int offset = 9 * idx;
 return ambientSHLightCoefficients[0]
 + ambientSHLightCoefficients[1] * N.x
 + ambientSHLightCoefficients[2] * N.y
 + ambientSHLightCoefficients[3] * N.z
 + ambientSHLightCoefficients[4] * N.x * N.z
 + ambientSHLightCoefficients[5] * N.z * N.y
 + ambientSHLightCoefficients[6] * N.y * N.x
 + ambientSHLightCoefficients[7] * (3.0 * N.z * N.z - 1.0)
 + ambientSHLightCoefficients[8] * (N.x * N.x - N.y * N.y);
}`;var Ar="uniform vec3 ",Ni="uniform float ",Ra="@export clay.header.",Na="@end",Mt=":unconfigurable;";const xI=[Ra+"directional_light",Ar+"directionalLightDirection[DIRECTIONAL_LIGHT_COUNT]"+Mt,Ar+"directionalLightColor[DIRECTIONAL_LIGHT_COUNT]"+Mt,Na,Ra+"ambient_light",Ar+"ambientLightColor[AMBIENT_LIGHT_COUNT]"+Mt,Na,Ra+"ambient_sh_light",Ar+"ambientSHLightColor[AMBIENT_SH_LIGHT_COUNT]"+Mt,Ar+"ambientSHLightCoefficients[AMBIENT_SH_LIGHT_COUNT * 9]"+Mt,_I,Na,Ra+"ambient_cubemap_light",Ar+"ambientCubemapLightColor[AMBIENT_CUBEMAP_LIGHT_COUNT]"+Mt,"uniform samplerCube ambientCubemapLightCubemap[AMBIENT_CUBEMAP_LIGHT_COUNT]"+Mt,"uniform sampler2D ambientCubemapLightBRDFLookup[AMBIENT_CUBEMAP_LIGHT_COUNT]"+Mt,Na,Ra+"point_light",Ar+"pointLightPosition[POINT_LIGHT_COUNT]"+Mt,Ni+"pointLightRange[POINT_LIGHT_COUNT]"+Mt,Ar+"pointLightColor[POINT_LIGHT_COUNT]"+Mt,Na,Ra+"spot_light",Ar+"spotLightPosition[SPOT_LIGHT_COUNT]"+Mt,Ar+"spotLightDirection[SPOT_LIGHT_COUNT]"+Mt,Ni+"spotLightRange[SPOT_LIGHT_COUNT]"+Mt,Ni+"spotLightUmbraAngleCosine[SPOT_LIGHT_COUNT]"+Mt,Ni+"spotLightPenumbraAngleCosine[SPOT_LIGHT_COUNT]"+Mt,Ni+"spotLightFalloffFactor[SPOT_LIGHT_COUNT]"+Mt,Ar+"spotLightColor[SPOT_LIGHT_COUNT]"+Mt,Na].join(`
`);H.import(xI);var SI=kr.extend(function(){return{color:[1,1,1],intensity:1,castShadow:!0,shadowResolution:512,group:0}},{type:"",clone:function(){var e=kr.prototype.clone.call(this);return e.color=Array.prototype.slice.call(this.color),e.intensity=this.intensity,e.castShadow=this.castShadow,e.shadowResolution=this.shadowResolution,e}});const Ir=SI;var Ds=function(e,t){this.normal=e||new X(0,1,0),this.distance=t||0};Ds.prototype={constructor:Ds,distanceToPoint:function(e){return O.dot(e.array,this.normal.array)-this.distance},projectPoint:function(e,t){t||(t=new X);var r=this.distanceToPoint(e);return O.scaleAndAdd(t.array,e.array,this.normal.array,-r),t._dirty=!0,t},normalize:function(){var e=1/O.len(this.normal.array);O.scale(this.normal.array,e),this.distance*=e},intersectFrustum:function(e){for(var t=e.vertices,r=this.normal.array,n=O.dot(t[0].array,r)>this.distance,a=1;a<8;a++)if(O.dot(t[a].array,r)>this.distance!=n)return!0},intersectLine:function(){var e=O.create();return function(t,r,n){var a=this.distanceToPoint(t),i=this.distanceToPoint(r);if(a>0&&i>0||a<0&&i<0)return null;var o=this.normal.array,s=this.distance,l=t.array;O.sub(e,r.array,t.array),O.normalize(e,e);var u=O.dot(o,e);if(u===0)return null;n||(n=new X);var c=(O.dot(o,l)-s)/u;return O.scaleAndAdd(n.array,l,e,-c),n._dirty=!0,n}}(),applyTransform:function(){var e=$.create(),t=Y.create(),r=Y.create();return r[3]=1,function(n){n=n.array,O.scale(r,this.normal.array,this.distance),Y.transformMat4(r,r,n),this.distance=O.dot(r,this.normal.array),$.invert(e,n),$.transpose(e,e),t[3]=0,O.copy(t,this.normal.array),Y.transformMat4(t,t,e),O.copy(this.normal.array,t)}}(),copy:function(e){O.copy(this.normal.array,e.normal.array),this.normal._dirty=!0,this.distance=e.distance},clone:function(){var e=new Ds;return e.copy(this),e}};const nx=Ds;var at=O.set,v1=O.copy,p1=O.transformMat4,wc=Math.min,Ac=Math.max,ax=function(){this.planes=[];for(var e=0;e<6;e++)this.planes.push(new nx);this.boundingBox=new $t,this.vertices=[];for(var e=0;e<8;e++)this.vertices[e]=O.fromValues(0,0,0)};ax.prototype={setFromProjection:function(e){var t=this.planes,r=e.array,n=r[0],a=r[1],i=r[2],o=r[3],s=r[4],l=r[5],u=r[6],c=r[7],h=r[8],f=r[9],d=r[10],v=r[11],p=r[12],g=r[13],m=r[14],_=r[15];at(t[0].normal.array,o-n,c-s,v-h),t[0].distance=-(_-p),t[0].normalize(),at(t[1].normal.array,o+n,c+s,v+h),t[1].distance=-(_+p),t[1].normalize(),at(t[2].normal.array,o+a,c+l,v+f),t[2].distance=-(_+g),t[2].normalize(),at(t[3].normal.array,o-a,c-l,v-f),t[3].distance=-(_-g),t[3].normalize(),at(t[4].normal.array,o-i,c-u,v-d),t[4].distance=-(_-m),t[4].normalize(),at(t[5].normal.array,o+i,c+u,v+d),t[5].distance=-(_+m),t[5].normalize();var y=this.boundingBox,x=this.vertices;if(_===0){var S=l/n,T=-m/(d-1),b=-m/(d+1),w=-b/l,A=-T/l;y.min.set(-w*S,-w,b),y.max.set(w*S,w,T),at(x[0],-w*S,-w,b),at(x[1],-w*S,w,b),at(x[2],w*S,-w,b),at(x[3],w*S,w,b),at(x[4],-A*S,-A,T),at(x[5],-A*S,A,T),at(x[6],A*S,-A,T),at(x[7],A*S,A,T)}else{var E=(-1-p)/n,C=(1-p)/n,M=(1-g)/l,P=(-1-g)/l,L=(-1-m)/d,I=(1-m)/d;y.min.set(Math.min(E,C),Math.min(P,M),Math.min(I,L)),y.max.set(Math.max(C,E),Math.max(M,P),Math.max(L,I));var N=y.min.array,F=y.max.array;at(x[0],N[0],N[1],N[2]),at(x[1],N[0],F[1],N[2]),at(x[2],F[0],N[1],N[2]),at(x[3],F[0],F[1],N[2]),at(x[4],N[0],N[1],F[2]),at(x[5],N[0],F[1],F[2]),at(x[6],F[0],N[1],F[2]),at(x[7],F[0],F[1],F[2])}},getTransformedBoundingBox:function(){var e=O.create();return function(t,r){var n=this.vertices,a=r.array,i=t.min,o=t.max,s=i.array,l=o.array,u=n[0];p1(e,u,a),v1(s,e),v1(l,e);for(var c=1;c<8;c++)u=n[c],p1(e,u,a),s[0]=wc(e[0],s[0]),s[1]=wc(e[1],s[1]),s[2]=wc(e[2],s[2]),l[0]=Ac(e[0],l[0]),l[1]=Ac(e[1],l[1]),l[2]=Ac(e[2],l[2]);return i._dirty=!0,o._dirty=!0,t}}()};const ld=ax;var TI=kr.extend(function(){return{projectionMatrix:new ne,invProjectionMatrix:new ne,viewMatrix:new ne,frustum:new ld}},function(){this.update(!0)},{update:function(e){kr.prototype.update.call(this,e),ne.invert(this.viewMatrix,this.worldTransform),this.updateProjectionMatrix(),ne.invert(this.invProjectionMatrix,this.projectionMatrix),this.frustum.setFromProjection(this.projectionMatrix)},setViewMatrix:function(e){ne.copy(this.viewMatrix,e),ne.invert(this.worldTransform,e),this.decomposeWorldTransform()},decomposeProjectionMatrix:function(){},setProjectionMatrix:function(e){ne.copy(this.projectionMatrix,e),ne.invert(this.invProjectionMatrix,e),this.decomposeProjectionMatrix()},updateProjectionMatrix:function(){},castRay:function(){var e=Y.create();return function(t,r){var n=r!==void 0?r:new ol,a=t.array[0],i=t.array[1];return Y.set(e,a,i,-1,1),Y.transformMat4(e,e,this.invProjectionMatrix.array),Y.transformMat4(e,e,this.worldTransform.array),O.scale(n.origin.array,e,1/e[3]),Y.set(e,a,i,1,1),Y.transformMat4(e,e,this.invProjectionMatrix.array),Y.transformMat4(e,e,this.worldTransform.array),O.scale(e,e,1/e[3]),O.sub(n.direction.array,e,n.origin.array),O.normalize(n.direction.array,n.direction.array),n.direction._dirty=!0,n.origin._dirty=!0,n}}()});const ri=TI;var bI=$.create(),g1=$.create(),Ec={};function wI(e){var t=[],r=Object.keys(e);r.sort();for(var n=0;n<r.length;n++){var a=r[n];t.push(a+" "+e[a])}var i=t.join(`
`);if(Ec[i])return Ec[i];var o=Pt.genGUID();return Ec[i]=o,o}function Zl(){this.opaque=[],this.transparent=[],this._opaqueCount=0,this._transparentCount=0}Zl.prototype.startCount=function(){this._opaqueCount=0,this._transparentCount=0};Zl.prototype.add=function(e,t){t?this.transparent[this._transparentCount++]=e:this.opaque[this._opaqueCount++]=e};Zl.prototype.endCount=function(){this.transparent.length=this._transparentCount,this.opaque.length=this._opaqueCount};var AI=kr.extend(function(){return{material:null,lights:[],viewBoundingBoxLastFrame:new $t,shadowUniforms:{},_cameraList:[],_lightUniforms:{},_previousLightNumber:{},_lightNumber:{},_lightProgramKeys:{},_nodeRepository:{},_renderLists:new $_(20)}},function(){this._scene=this},{addToScene:function(e){e instanceof ri?(this._cameraList.length>0&&console.warn("Found multiple camera in one scene. Use the fist one."),this._cameraList.push(e)):e instanceof Ir&&this.lights.push(e),e.name&&(this._nodeRepository[e.name]=e)},removeFromScene:function(e){var t;e instanceof ri?(t=this._cameraList.indexOf(e),t>=0&&this._cameraList.splice(t,1)):e instanceof Ir&&(t=this.lights.indexOf(e),t>=0&&this.lights.splice(t,1)),e.name&&delete this._nodeRepository[e.name]},getNode:function(e){return this._nodeRepository[e]},setMainCamera:function(e){var t=this._cameraList.indexOf(e);t>=0&&this._cameraList.splice(t,1),this._cameraList.unshift(e)},getMainCamera:function(){return this._cameraList[0]},getLights:function(){return this.lights},updateLights:function(){var e=this.lights;this._previousLightNumber=this._lightNumber;for(var t={},r=0;r<e.length;r++){var n=e[r];if(!n.invisible){var a=n.group;t[a]||(t[a]={}),t[a][n.type]=t[a][n.type]||0,t[a][n.type]++}}this._lightNumber=t;for(var i in t)this._lightProgramKeys[i]=wI(t[i]);this._updateLightUniforms()},cloneNode:function(e){var t=e.clone(),r={};function n(a,i){r[a.__uid__]=i;for(var o=0;o<a._children.length;o++){var s=a._children[o],l=i._children[o];n(s,l)}}return n(e,t),t.traverse(function(a){a.skeleton&&(a.skeleton=a.skeleton.clone(r)),a.material&&(a.material=a.material.clone())}),t},updateRenderList:function(e,t){var r=e.__uid__,n=this._renderLists.get(r);n||(n=new Zl,this._renderLists.put(r,n)),n.startCount(),t&&(this.viewBoundingBoxLastFrame.min.set(1/0,1/0,1/0),this.viewBoundingBoxLastFrame.max.set(-1/0,-1/0,-1/0));var a=this.material&&this.material.transparent||!1;return this._doUpdateRenderList(this,e,a,n,t),n.endCount(),n},getRenderList:function(e){return this._renderLists.get(e.__uid__)},_doUpdateRenderList:function(e,t,r,n,a){if(!e.invisible)for(var i=0;i<e._children.length;i++){var o=e._children[i];if(o.isRenderable()){var s=o.isSkinnedMesh()?bI:o.worldTransform.array,l=o.geometry;$.multiplyAffine(g1,t.viewMatrix.array,s),(a&&!l.boundingBox||!this.isFrustumCulled(o,t,g1))&&n.add(o,o.material.transparent||r)}o._children.length>0&&this._doUpdateRenderList(o,t,r,n,a)}},isFrustumCulled:function(){var e=new $t,t=new ne;return function(r,n,a){var i=r.boundingBox;if(i||(r.skeleton&&r.skeleton.boundingBox?i=r.skeleton.boundingBox:i=r.geometry.boundingBox),!i)return!1;if(t.array=a,e.transformFrom(i,t),r.castShadow&&this.viewBoundingBoxLastFrame.union(e),r.frustumCulling){if(!e.intersectBoundingBox(n.frustum.boundingBox))return!0;t.array=n.projectionMatrix.array,e.max.array[2]>0&&e.min.array[2]<0&&(e.max.array[2]=-1e-20),e.applyProjection(t);var o=e.min.array,s=e.max.array;if(s[0]<-1||o[0]>1||s[1]<-1||o[1]>1||s[2]<-1||o[2]>1)return!0}return!1}}(),_updateLightUniforms:function(){var e=this.lights;e.sort(EI);var t=this._lightUniforms;for(var r in t)for(var n in t[r])t[r][n].value.length=0;for(var a=0;a<e.length;a++){var i=e[a];if(!i.invisible){var r=i.group;for(var n in i.uniformTemplates){var o=i.uniformTemplates[n],s=o.value(i);if(s!=null){t[r]||(t[r]={}),t[r][n]||(t[r][n]={type:"",value:[]});var l=t[r][n];switch(l.type=o.type+"v",o.type){case"1i":case"1f":case"t":l.value.push(s);break;case"2f":case"3f":case"4f":for(var u=0;u<s.length;u++)l.value.push(s[u]);break;default:console.error("Unkown light uniform type "+o.type)}}}}}},getLightGroups:function(){var e=[];for(var t in this._lightNumber)e.push(t);return e},getNumberChangedLightGroups:function(){var e=[];for(var t in this._lightNumber)this.isLightNumberChanged(t)&&e.push(t);return e},isLightNumberChanged:function(e){var t=this._previousLightNumber,r=this._lightNumber;for(var n in r[e])if(!t[e]||r[e][n]!==t[e][n])return!0;for(var n in t[e])if(!r[e]||r[e][n]!==t[e][n])return!0;return!1},getLightsNumbers:function(e){return this._lightNumber[e]},getProgramKey:function(e){return this._lightProgramKeys[e]},setLightUniforms:function(){function e(t,r,n){for(var a in t){var i=t[a];if(i.type==="tv"){if(!r.hasUniform(a))continue;for(var o=[],s=0;s<i.value.length;s++){var l=i.value[s],u=r.takeCurrentTextureSlot(n,l);o.push(u)}r.setUniform(n.gl,"1iv",a,o)}else r.setUniform(n.gl,i.type,a,i.value)}}return function(t,r,n){e(this._lightUniforms[r],t,n),e(this.shadowUniforms,t,n)}}(),dispose:function(){this.material=null,this._opaqueList=[],this._transparentList=[],this.lights=[],this._lightUniforms={},this._lightNumber={},this._nodeRepository={}}});function EI(e,t){if(t.castShadow&&!e.castShadow)return!0}const On=AI;var vs=Q_.isPowerOfTwo,CI=["px","nx","py","ny","pz","nz"],ud=ie.extend(function(){return{image:{px:null,nx:null,py:null,ny:null,pz:null,nz:null},pixels:{px:null,nx:null,py:null,ny:null,pz:null,nz:null},mipmaps:[]}},{textureType:"textureCube",update:function(e){var t=e.gl;t.bindTexture(t.TEXTURE_CUBE_MAP,this._cache.get("webgl_texture")),this.updateCommon(e);var r=this.format,n=this.type;t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_WRAP_S,this.getAvailableWrapS()),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_WRAP_T,this.getAvailableWrapT()),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MAG_FILTER,this.getAvailableMagFilter()),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MIN_FILTER,this.getAvailableMinFilter());var a=e.getGLExtension("EXT_texture_filter_anisotropic");if(a&&this.anisotropic>1&&t.texParameterf(t.TEXTURE_CUBE_MAP,a.TEXTURE_MAX_ANISOTROPY_EXT,this.anisotropic),n===36193){var i=e.getGLExtension("OES_texture_half_float");i||(n=G.FLOAT)}if(this.mipmaps.length)for(var o=this.width,s=this.height,l=0;l<this.mipmaps.length;l++){var u=this.mipmaps[l];this._updateTextureData(t,u,l,o,s,r,n),o/=2,s/=2}else this._updateTextureData(t,this,0,this.width,this.height,r,n),!this.NPOT&&this.useMipmap&&t.generateMipmap(t.TEXTURE_CUBE_MAP);t.bindTexture(t.TEXTURE_CUBE_MAP,null)},_updateTextureData:function(e,t,r,n,a,i,o){for(var s=0;s<6;s++){var l=CI[s],u=t.image&&t.image[l];u?e.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+s,r,i,i,o,u):e.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+s,r,i,n,a,0,i,o,t.pixels&&t.pixels[l])}},generateMipmap:function(e){var t=e.gl;this.useMipmap&&!this.NPOT&&(t.bindTexture(t.TEXTURE_CUBE_MAP,this._cache.get("webgl_texture")),t.generateMipmap(t.TEXTURE_CUBE_MAP))},bind:function(e){e.gl.bindTexture(e.gl.TEXTURE_CUBE_MAP,this.getWebGLTexture(e))},unbind:function(e){e.gl.bindTexture(e.gl.TEXTURE_CUBE_MAP,null)},isPowerOfTwo:function(){return this.image.px?vs(this.image.px.width)&&vs(this.image.px.height):vs(this.width)&&vs(this.height)},isRenderable:function(){return this.image.px?Oa(this.image.px)&&Oa(this.image.nx)&&Oa(this.image.py)&&Oa(this.image.ny)&&Oa(this.image.pz)&&Oa(this.image.nz):!!(this.width&&this.height)},load:function(e,t){var r=0,n=this;return Pt.each(e,function(a,i){var o=ht.createImage();t&&(o.crossOrigin=t),o.onload=function(){r--,r===0&&(n.dirty(),n.trigger("success",n))},o.onerror=function(){r--},r++,o.src=a,n.image[i]=o}),this}});Object.defineProperty(ud.prototype,"width",{get:function(){return this.image&&this.image.px?this.image.px.width:this._width},set:function(e){this.image&&this.image.px?console.warn("Texture from image can't set width"):(this._width!==e&&this.dirty(),this._width=e)}});Object.defineProperty(ud.prototype,"height",{get:function(){return this.image&&this.image.px?this.image.px.height:this._height},set:function(e){this.image&&this.image.px?console.warn("Texture from image can't set height"):(this._height!==e&&this.dirty(),this._height=e)}});function Oa(e){return e.width>0&&e.height>0}const _o=ud;var LI=ri.extend({fov:50,aspect:1,near:.1,far:2e3},{updateProjectionMatrix:function(){var e=this.fov/180*Math.PI;this.projectionMatrix.perspective(e,this.aspect,this.near,this.far)},decomposeProjectionMatrix:function(){var e=this.projectionMatrix.array,t=Math.atan(1/e[5])*2;this.fov=t/Math.PI*180,this.aspect=e[5]/e[0],this.near=e[14]/(e[10]-1),this.far=e[14]/(e[10]+1)},clone:function(){var e=ri.prototype.clone.call(this);return e.fov=this.fov,e.aspect=this.aspect,e.near=this.near,e.far=this.far,e}});const bt=LI;var ps="framebuffer",Jr="renderbuffer",m1=Jr+"_width",y1=Jr+"_height",Cc=Jr+"_attached",Lc="depthtexture_attached",Hn=G.FRAMEBUFFER,Oi=G.RENDERBUFFER,Yi=G.DEPTH_ATTACHMENT,ix=G.COLOR_ATTACHMENT0,zo=qt.extend({depthBuffer:!0,viewport:null,_width:0,_height:0,_textures:null,_boundRenderer:null},function(){this._cache=new od,this._textures={}},{getTextureWidth:function(){return this._width},getTextureHeight:function(){return this._height},bind:function(e){if(e.__currentFrameBuffer){if(e.__currentFrameBuffer===this)return;console.warn("Renderer already bound with another framebuffer. Unbind it first")}e.__currentFrameBuffer=this;var t=e.gl;t.bindFramebuffer(Hn,this._getFrameBufferGL(e)),this._boundRenderer=e;var r=this._cache;r.put("viewport",e.viewport);var n=!1,a,i;for(var o in this._textures){n=!0;var s=this._textures[o];s&&(a=s.texture.width,i=s.texture.height,this._doAttach(e,s.texture,o,s.target))}this._width=a,this._height=i,!n&&this.depthBuffer&&console.error("Must attach texture before bind, or renderbuffer may have incorrect width and height."),this.viewport?e.setViewport(this.viewport):e.setViewport(0,0,a,i,1);var l=r.get("attached_textures");if(l){for(var o in l)if(!this._textures[o]){var u=l[o];this._doDetach(t,o,u)}}if(!r.get(Lc)&&this.depthBuffer){r.miss(Jr)&&r.put(Jr,t.createRenderbuffer());var c=r.get(Jr);(a!==r.get(m1)||i!==r.get(y1))&&(t.bindRenderbuffer(Oi,c),t.renderbufferStorage(Oi,t.DEPTH_COMPONENT16,a,i),r.put(m1,a),r.put(y1,i),t.bindRenderbuffer(Oi,null)),r.get(Cc)||(t.framebufferRenderbuffer(Hn,Yi,Oi,c),r.put(Cc,!0))}},unbind:function(e){e.__currentFrameBuffer=null;var t=e.gl;t.bindFramebuffer(Hn,null),this._boundRenderer=null,this._cache.use(e.__uid__);var r=this._cache.get("viewport");r&&e.setViewport(r),this.updateMipmap(e)},updateMipmap:function(e){var t=e.gl;for(var r in this._textures){var n=this._textures[r];if(n){var a=n.texture;if(!a.NPOT&&a.useMipmap&&a.minFilter===ie.LINEAR_MIPMAP_LINEAR){var i=a.textureType==="textureCube"?G.TEXTURE_CUBE_MAP:G.TEXTURE_2D;t.bindTexture(i,a.getWebGLTexture(e)),t.generateMipmap(i),t.bindTexture(i,null)}}}},checkStatus:function(e){return e.checkFramebufferStatus(Hn)},_getFrameBufferGL:function(e){var t=this._cache;return t.use(e.__uid__),t.miss(ps)&&t.put(ps,e.gl.createFramebuffer()),t.get(ps)},attach:function(e,t,r){if(!e.width)throw new Error("The texture attached to color buffer is not a valid.");t=t||ix,r=r||G.TEXTURE_2D;var n=this._boundRenderer,a=n&&n.gl,i;if(a){var o=this._cache;o.use(n.__uid__),i=o.get("attached_textures")}var s=this._textures[t];if(!(s&&s.target===r&&s.texture===e&&i&&i[t]!=null)){var l=!0;n&&(l=this._doAttach(n,e,t,r),this.viewport||n.setViewport(0,0,e.width,e.height,1)),l&&(this._textures[t]=this._textures[t]||{},this._textures[t].texture=e,this._textures[t].target=r)}},_doAttach:function(e,t,r,n){var a=e.gl,i=t.getWebGLTexture(e),o=this._cache.get("attached_textures");if(o&&o[r]){var s=o[r];if(s.texture===t&&s.target===n)return}r=+r;var l=!0;if(r===Yi||r===G.DEPTH_STENCIL_ATTACHMENT){var u=e.getGLExtension("WEBGL_depth_texture");if(u||(console.error("Depth texture is not supported by the browser"),l=!1),t.format!==G.DEPTH_COMPONENT&&t.format!==G.DEPTH_STENCIL&&(console.error("The texture attached to depth buffer is not a valid."),l=!1),l){var c=this._cache.get(Jr);c&&(a.framebufferRenderbuffer(Hn,Yi,Oi,null),a.deleteRenderbuffer(c),this._cache.put(Jr,!1)),this._cache.put(Cc,!1),this._cache.put(Lc,!0)}}return a.framebufferTexture2D(Hn,r,n,i,0),o||(o={},this._cache.put("attached_textures",o)),o[r]=o[r]||{},o[r].texture=t,o[r].target=n,l},_doDetach:function(e,t,r){e.framebufferTexture2D(Hn,t,r,null,0);var n=this._cache.get("attached_textures");n&&n[t]&&(n[t]=null),(t===Yi||t===G.DEPTH_STENCIL_ATTACHMENT)&&this._cache.put(Lc,!1)},detach:function(e,t){if(this._textures[e]=null,this._boundRenderer){var r=this._cache;r.use(this._boundRenderer.__uid__),this._doDetach(this._boundRenderer.gl,e,t)}},dispose:function(e){var t=e.gl,r=this._cache;r.use(e.__uid__);var n=r.get(Jr);n&&t.deleteRenderbuffer(n);var a=r.get(ps);a&&t.deleteFramebuffer(a),r.deleteContext(e.__uid__),this._textures={}}});zo.DEPTH_ATTACHMENT=Yi;zo.COLOR_ATTACHMENT0=ix;zo.STENCIL_ATTACHMENT=G.STENCIL_ATTACHMENT;zo.DEPTH_STENCIL_ATTACHMENT=G.DEPTH_STENCIL_ATTACHMENT;const Rt=zo;var DI=["px","nx","py","ny","pz","nz"],MI=qt.extend(function(){var e={position:new X,far:1e3,near:.1,texture:null,shadowMapPass:null},t=e._cameras={px:new bt({fov:90}),nx:new bt({fov:90}),py:new bt({fov:90}),ny:new bt({fov:90}),pz:new bt({fov:90}),nz:new bt({fov:90})};return t.px.lookAt(X.POSITIVE_X,X.NEGATIVE_Y),t.nx.lookAt(X.NEGATIVE_X,X.NEGATIVE_Y),t.py.lookAt(X.POSITIVE_Y,X.POSITIVE_Z),t.ny.lookAt(X.NEGATIVE_Y,X.NEGATIVE_Z),t.pz.lookAt(X.POSITIVE_Z,X.NEGATIVE_Y),t.nz.lookAt(X.NEGATIVE_Z,X.NEGATIVE_Y),e._frameBuffer=new Rt,e},{getCamera:function(e){return this._cameras[e]},render:function(e,t,r){var n=e.gl;r||t.update();for(var a=this.texture.width,i=2*Math.atan(a/(a-.5))/Math.PI*180,o=0;o<6;o++){var s=DI[o],l=this._cameras[s];if(X.copy(l.position,this.position),l.far=this.far,l.near=this.near,l.fov=i,this.shadowMapPass){l.update();var u=t.getBoundingBox();u.applyTransform(l.viewMatrix),t.viewBoundingBoxLastFrame.copy(u),this.shadowMapPass.render(e,t,l,!0)}this._frameBuffer.attach(this.texture,n.COLOR_ATTACHMENT0,n.TEXTURE_CUBE_MAP_POSITIVE_X+o),this._frameBuffer.bind(e),e.render(t,l,!0),this._frameBuffer.unbind(e)}},dispose:function(e){this._frameBuffer.dispose(e)}});const cd=MI;var PI=Me.extend({dynamic:!1,widthSegments:1,heightSegments:1},function(){this.build()},{build:function(){for(var e=this.heightSegments,t=this.widthSegments,r=this.attributes,n=[],a=[],i=[],o=[],s=0;s<=e;s++)for(var l=s/e,u=0;u<=t;u++){var c=u/t;if(n.push([2*c-1,2*l-1,0]),a&&a.push([c,l]),i&&i.push([0,0,1]),u<t&&s<e){var h=u+s*(t+1);o.push([h,h+1,h+t+1]),o.push([h+t+1,h+1,h+t+2])}}r.position.fromArray(n),r.texcoord0.fromArray(a),r.normal.fromArray(i),this.initIndicesFromArray(o),this.boundingBox=new $t,this.boundingBox.min.set(-1,-1,0),this.boundingBox.max.set(1,1,0)}});const Yl=PI;var Je=new ne,II=Me.extend({dynamic:!1,widthSegments:1,heightSegments:1,depthSegments:1,inside:!1},function(){this.build()},{build:function(){var e={px:Ba("px",this.depthSegments,this.heightSegments),nx:Ba("nx",this.depthSegments,this.heightSegments),py:Ba("py",this.widthSegments,this.depthSegments),ny:Ba("ny",this.widthSegments,this.depthSegments),pz:Ba("pz",this.widthSegments,this.heightSegments),nz:Ba("nz",this.widthSegments,this.heightSegments)},t=["position","texcoord0","normal"],r=0,n=0;for(var a in e)r+=e[a].vertexCount,n+=e[a].indices.length;for(var i=0;i<t.length;i++)this.attributes[t[i]].init(r);this.indices=new ht.Uint16Array(n);var o=0,s=0;for(var a in e){for(var l=e[a],i=0;i<t.length;i++)for(var u=t[i],c=l.attributes[u].value,h=l.attributes[u].size,f=u==="normal",d=0;d<c.length;d++){var v=c[d];this.inside&&f&&(v=-v),this.attributes[u].value[d+h*s]=v}for(var p=l.indices.length,d=0;d<l.indices.length;d++)this.indices[d+o]=s+l.indices[this.inside?p-d-1:d];o+=l.indices.length,s+=l.vertexCount}this.boundingBox=new $t,this.boundingBox.max.set(1,1,1),this.boundingBox.min.set(-1,-1,-1)}});function Ba(e,t,r){Je.identity();var n=new Yl({widthSegments:t,heightSegments:r});switch(e){case"px":ne.translate(Je,Je,X.POSITIVE_X),ne.rotateY(Je,Je,Math.PI/2);break;case"nx":ne.translate(Je,Je,X.NEGATIVE_X),ne.rotateY(Je,Je,-Math.PI/2);break;case"py":ne.translate(Je,Je,X.POSITIVE_Y),ne.rotateX(Je,Je,-Math.PI/2);break;case"ny":ne.translate(Je,Je,X.NEGATIVE_Y),ne.rotateX(Je,Je,Math.PI/2);break;case"pz":ne.translate(Je,Je,X.POSITIVE_Z);break;case"nz":ne.translate(Je,Je,X.NEGATIVE_Z),ne.rotateY(Je,Je,Math.PI);break}return n.applyTransform(Je),n}const ox=II,RI=`@export clay.skybox.vertex
#define SHADER_NAME skybox
uniform mat4 world : WORLD;
uniform mat4 worldViewProjection : WORLDVIEWPROJECTION;
attribute vec3 position : POSITION;
varying vec3 v_WorldPosition;
void main()
{
 v_WorldPosition = (world * vec4(position, 1.0)).xyz;
 gl_Position = worldViewProjection * vec4(position, 1.0);
}
@end
@export clay.skybox.fragment
#define PI 3.1415926
uniform mat4 viewInverse : VIEWINVERSE;
#ifdef EQUIRECTANGULAR
uniform sampler2D environmentMap;
#else
uniform samplerCube environmentMap;
#endif
uniform float lod: 0.0;
varying vec3 v_WorldPosition;
@import clay.util.rgbm
@import clay.util.srgb
@import clay.util.ACES
void main()
{
 vec3 eyePos = viewInverse[3].xyz;
 vec3 V = normalize(v_WorldPosition - eyePos);
#ifdef EQUIRECTANGULAR
 float phi = acos(V.y);
 float theta = atan(-V.x, V.z) + PI * 0.5;
 vec2 uv = vec2(theta / 2.0 / PI, phi / PI);
 vec4 texel = decodeHDR(texture2D(environmentMap, fract(uv)));
#else
 #if defined(LOD) || defined(SUPPORT_TEXTURE_LOD)
 vec4 texel = decodeHDR(textureCubeLodEXT(environmentMap, V, lod));
 #else
 vec4 texel = decodeHDR(textureCube(environmentMap, V));
 #endif
#endif
#ifdef SRGB_DECODE
 texel = sRGBToLinear(texel);
#endif
#ifdef TONEMAPPING
 texel.rgb = ACESToneMapping(texel.rgb);
#endif
#ifdef SRGB_ENCODE
 texel = linearTosRGB(texel);
#endif
 gl_FragColor = encodeHDR(vec4(texel.rgb, 1.0));
}
@end`;H.import(RI);var NI=oa.extend(function(){var e=new H({vertex:H.source("clay.skybox.vertex"),fragment:H.source("clay.skybox.fragment")}),t=new Sr({shader:e,depthMask:!1});return{scene:null,geometry:new ox,material:t,environmentMap:null,culling:!1,_dummyCamera:new bt}},function(){var e=this.scene;e&&this.attachScene(e),this.environmentMap&&this.setEnvironmentMap(this.environmentMap)},{attachScene:function(e){this.scene&&this.detachScene(),e.skybox=this,this.scene=e,e.on("beforerender",this._beforeRenderScene,this)},detachScene:function(){this.scene&&(this.scene.off("beforerender",this._beforeRenderScene),this.scene.skybox=null),this.scene=null},dispose:function(e){this.detachScene(),this.geometry.dispose(e)},setEnvironmentMap:function(e){e.textureType==="texture2D"?(this.material.define("EQUIRECTANGULAR"),e.minFilter=ie.LINEAR):this.material.undefine("EQUIRECTANGULAR"),this.material.set("environmentMap",e)},getEnvironmentMap:function(){return this.material.get("environmentMap")},_beforeRenderScene:function(e,t,r){this.renderSkybox(e,r)},renderSkybox:function(e,t){var r=this._dummyCamera;r.aspect=e.getViewportAspect(),r.fov=t.fov||50,r.updateProjectionMatrix(),ne.invert(r.invProjectionMatrix,r.projectionMatrix),r.worldTransform.copy(t.worldTransform),r.viewMatrix.copy(t.viewMatrix),this.position.copy(t.getWorldPosition()),this.update(),e.gl.disable(e.gl.BLEND),this.material.get("lod")>0?this.material.define("fragment","LOD"):this.material.undefine("fragment","LOD"),e.renderPass([this],r)}});const xo=NI;var OI=542327876,BI=131072,FI=512,zI=4;function hd(e){return e.charCodeAt(0)+(e.charCodeAt(1)<<8)+(e.charCodeAt(2)<<16)+(e.charCodeAt(3)<<24)}var GI=31,VI=hd("DXT1"),UI=hd("DXT3"),kI=hd("DXT5"),HI=0,WI=1,$I=2,XI=3,jI=4,ZI=7,YI=20,qI=21,KI=28,JI={parse:function(e,t){var r=new Int32Array(e,0,GI);if(r[HI]!==OI||!r(YI)&zI)return null;var n=r(qI),a=r[jI],i=r[XI],o=r[KI]&FI,s=r[$I]&BI,l,u;switch(n){case VI:l=8,u=ie.COMPRESSED_RGB_S3TC_DXT1_EXT;break;case UI:l=16,u=ie.COMPRESSED_RGBA_S3TC_DXT3_EXT;break;case kI:l=16,u=ie.COMPRESSED_RGBA_S3TC_DXT5_EXT;break;default:return null}var c=r[WI]+4,h=o?6:1,f=1;s&&(f=Math.max(1,r[ZI]));for(var d=[],v=0;v<h;v++){var p=a,g=i;d[v]=new _e({width:p,height:g,format:u});for(var m=[],_=0;_<f;_++){var y=Math.max(4,p)/4*Math.max(4,g)/4*l,x=new Uint8Array(e,c,y);c+=y,p*=.5,g*=.5,m[_]=x}d[v].pixels=m[0],s&&(d[v].mipmaps=m)}if(t)t.width=d[0].width,t.height=d[0].height,t.format=d[0].format,t.pixels=d[0].pixels,t.mipmaps=d[0].mipmaps;else return d[0]}};const QI=JI;var Ms=String.fromCharCode,e9=8,t9=32767;function r9(e,t,r,n){if(e[3]>0){var a=Math.pow(2,e[3]-128-8+n);t[r+0]=e[0]*a,t[r+1]=e[1]*a,t[r+2]=e[2]*a}else t[r+0]=0,t[r+1]=0,t[r+2]=0;return t[r+3]=1,t}function n9(e,t,r){for(var n="",a=t;a<r;a++)n+=Ms(e[a]);return n}function a9(e,t){t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3]}function _1(e,t,r,n){for(var a=0,i=0,o=n;o>0;)if(e[i][0]=t[r++],e[i][1]=t[r++],e[i][2]=t[r++],e[i][3]=t[r++],e[i][0]===1&&e[i][1]===1&&e[i][2]===1){for(var s=e[i][3]<<a>>>0;s>0;s--)a9(e[i-1],e[i]),i++,o--;a+=8}else i++,o--,a=0;return r}function i9(e,t,r,n){if(n<e9|n>t9)return _1(e,t,r,n);var a=t[r++];if(a!=2)return _1(e,t,r-1,n);if(e[0][1]=t[r++],e[0][2]=t[r++],a=t[r++],(e[0][2]<<8>>>0|a)>>>0!==n)return null;for(var a=0;a<4;a++)for(var i=0;i<n;){var o=t[r++];if(o>128){o=(o&127)>>>0;for(var s=t[r++];o--;)e[i++][a]=s}else for(;o--;)e[i++][a]=t[r++]}return r}var o9={parseRGBE:function(e,t,r){r==null&&(r=0);var n=new Uint8Array(e),a=n.length;if(n9(n,0,2)==="#?"){for(var i=2;i<a&&!(Ms(n[i])===`
`&&Ms(n[i+1])===`
`);i++);if(!(i>=a)){i+=2;for(var o="";i<a;i++){var s=Ms(n[i]);if(s===`
`)break;o+=s}var l=o.split(" "),u=parseInt(l[1]),c=parseInt(l[3]);if(!(!c||!u)){for(var h=i+1,f=[],d=0;d<c;d++){f[d]=[];for(var v=0;v<4;v++)f[d][v]=0}for(var p=new Float32Array(c*u*4),g=0,m=0;m<u;m++){var h=i9(f,n,h,c);if(!h)return null;for(var d=0;d<c;d++)r9(f[d],p,g,r),g+=4}return t||(t=new _e),t.width=c,t.height=u,t.pixels=p,t.type=ie.FLOAT,t}}}},parseRGBEFromPNG:function(e){}};const s9=o9;var Ps={loadTexture:function(e,t,r,n){var a;if(typeof t=="function"?(r=t,n=r,t={}):t=t||{},typeof e=="string"){if(e.match(/.hdr$/)||t.fileType==="hdr")return a=new _e({width:0,height:0,sRGB:!1}),Ps._fetchTexture(e,function(i){s9.parseRGBE(i,a,t.exposure),a.dirty(),r&&r(a)},n),a;e.match(/.dds$/)||t.fileType==="dds"?(a=new _e({width:0,height:0}),Ps._fetchTexture(e,function(i){QI.parse(i,a),a.dirty(),r&&r(a)},n)):(a=new _e,a.load(e),a.success(r),a.error(n))}else typeof e=="object"&&typeof e.px<"u"&&(a=new _o,a.load(e),a.success(r),a.error(n));return a},loadPanorama:function(e,t,r,n,a,i){var o=this;typeof n=="function"?(a=n,i=a,n={}):n=n||{},Ps.loadTexture(t,n,function(s){s.flipY=n.flipY||!1,o.panoramaToCubeMap(e,s,r,n),s.dispose(e),a&&a(r)},i)},panoramaToCubeMap:function(e,t,r,n){var a=new cd,i=new xo({scene:new On});return i.setEnvironmentMap(t),n=n||{},n.encodeRGBM&&i.material.define("fragment","RGBM_ENCODE"),r.sRGB=t.sRGB,a.texture=r,a.render(e,i.scene),a.texture=null,a.dispose(e),r},heightToNormal:function(e,t){var r=document.createElement("canvas"),n=r.width=e.width,a=r.height=e.height,i=r.getContext("2d");i.drawImage(e,0,0,n,a),t=t||!1;for(var o=i.getImageData(0,0,n,a),s=i.createImageData(n,a),l=0;l<o.data.length;l+=4){if(t){var u=o.data[l],c=o.data[l+1],h=o.data[l+2],f=Math.abs(u-c)+Math.abs(c-h);if(f>20)return console.warn("Given image is not a height map"),e}var d,v,p,g;l%(n*4)===0?(d=o.data[l],p=o.data[l+4]):l%(n*4)===(n-1)*4?(d=o.data[l-4],p=o.data[l]):(d=o.data[l-4],p=o.data[l+4]),l<n*4?(v=o.data[l],g=o.data[l+n*4]):l>n*(a-1)*4?(v=o.data[l-n*4],g=o.data[l]):(v=o.data[l-n*4],g=o.data[l+n*4]),s.data[l]=d-p+127,s.data[l+1]=v-g+127,s.data[l+2]=255,s.data[l+3]=255}return i.putImageData(s,0,0),r},isHeightImage:function(e,t,r){if(!e||!e.width||!e.height)return!1;var n=document.createElement("canvas"),a=n.getContext("2d"),i=t||32;r=r||20,n.width=n.height=i,a.drawImage(e,0,0,i,i);for(var o=a.getImageData(0,0,i,i),s=0;s<o.data.length;s+=4){var l=o.data[s],u=o.data[s+1],c=o.data[s+2],h=Math.abs(l-u)+Math.abs(u-c);if(h>r)return!1}return!0},_fetchTexture:function(e,t,r){ht.request.get({url:e,responseType:"arraybuffer",onload:t,onerror:r})},createChessboard:function(e,t,r,n){e=e||512,t=t||64,r=r||"black",n=n||"white";var a=Math.ceil(e/t),i=document.createElement("canvas");i.width=e,i.height=e;var o=i.getContext("2d");o.fillStyle=n,o.fillRect(0,0,e,e),o.fillStyle=r;for(var s=0;s<a;s++)for(var l=0;l<a;l++){var u=l%2?s%2:s%2-1;u&&o.fillRect(s*t,l*t,t,t)}var c=new _e({image:i,anisotropic:8});return c},createBlank:function(e){var t=document.createElement("canvas");t.width=1,t.height=1;var r=t.getContext("2d");r.fillStyle=e,r.fillRect(0,0,1,1);var n=new _e({image:t});return n}};const ca=Ps;var Nh=["mousedown","mouseup","mousemove","mouseover","mouseout","click","dblclick","contextmenu"];function Oh(e){return"_on"+e}var Bh=function(e){var t=this;this._texture=new _e({anisotropic:32,flipY:!1,surface:this,dispose:function(r){t.dispose(),_e.prototype.dispose.call(this,r)}}),Nh.forEach(function(r){this[Oh(r)]=function(n){n.triangle&&this._meshes.forEach(function(a){this.dispatchEvent(r,a,n.triangle,n.point)},this)}},this),this._meshes=[],e&&this.setECharts(e),this.onupdate=null};Bh.prototype={constructor:Bh,getTexture:function(){return this._texture},setECharts:function(e){this._chart=e;var t=e.getDom();if(!(t instanceof HTMLCanvasElement))console.error("ECharts must init on canvas if it is used as texture."),t=document.createElement("canvas");else{var r=this,n=e.getZr(),a=n.__oldRefreshImmediately||n.refreshImmediately;n.refreshImmediately=function(){a.call(this),r._texture.dirty(),r.onupdate&&r.onupdate()},n.__oldRefreshImmediately=a}this._texture.image=t,this._texture.dirty(),this.onupdate&&this.onupdate()},dispatchEvent:function(){var e=new X,t=new X,r=new X,n=new lr,a=new lr,i=new lr,o=new lr,s=new X;return function(l,u,c,h){var f=u.geometry,d=f.attributes.position,v=f.attributes.texcoord0,p=X.dot,g=X.cross;d.get(c[0],e.array),d.get(c[1],t.array),d.get(c[2],r.array),v.get(c[0],n.array),v.get(c[1],a.array),v.get(c[2],i.array),g(s,t,r);var m=p(e,s),_=p(h,s)/m;g(s,r,e);var y=p(h,s)/m;g(s,e,t);var x=p(h,s)/m;lr.scale(o,n,_),lr.scaleAndAdd(o,o,a,y),lr.scaleAndAdd(o,o,i,x);var S=o.x*this._chart.getWidth(),T=o.y*this._chart.getHeight();this._chart.getZr().handler.dispatch(l,{zrX:S,zrY:T})}}(),attachToMesh:function(e){this._meshes.indexOf(e)>=0||(Nh.forEach(function(t){e.on(t,this[Oh(t)],this)},this),this._meshes.push(e))},detachFromMesh:function(e){var t=this._meshes.indexOf(e);t>=0&&this._meshes.splice(t,1),Nh.forEach(function(r){e.off(r,this[Oh(r)])},this)},dispose:function(){this._meshes.forEach(function(e){this.detachFromMesh(e)},this)}};const l9=Bh;var u9=ri.extend({left:-1,right:1,near:-1,far:1,top:1,bottom:-1},{updateProjectionMatrix:function(){this.projectionMatrix.ortho(this.left,this.right,this.bottom,this.top,this.near,this.far)},decomposeProjectionMatrix:function(){var e=this.projectionMatrix.array;this.left=(-1-e[12])/e[0],this.right=(1-e[12])/e[0],this.top=(1-e[13])/e[5],this.bottom=(-1-e[13])/e[5],this.near=-(-1-e[14])/e[10],this.far=-(1-e[14])/e[10]},clone:function(){var e=ri.prototype.clone.call(this);return e.left=this.left,e.right=this.right,e.near=this.near,e.far=this.far,e.top=this.top,e.bottom=this.bottom,e}});const ni=u9,c9=`
@export clay.compositor.vertex
uniform mat4 worldViewProjection : WORLDVIEWPROJECTION;
attribute vec3 position : POSITION;
attribute vec2 texcoord : TEXCOORD_0;
varying vec2 v_Texcoord;
void main()
{
 v_Texcoord = texcoord;
 gl_Position = worldViewProjection * vec4(position, 1.0);
}
@end`;H.import(c9);var h9=new Yl,x1=new oa({geometry:h9,frustumCulling:!1}),f9=new ni,d9=qt.extend(function(){return{fragment:"",outputs:null,material:null,blendWithPrevious:!1,clearColor:!1,clearDepth:!0}},function(){var e=new H(H.source("clay.compositor.vertex"),this.fragment),t=new Sr({shader:e});t.enableTexturesAll(),this.material=t},{setUniform:function(e,t){this.material.setUniform(e,t)},getUniform:function(e){var t=this.material.uniforms[e];if(t)return t.value},attachOutput:function(e,t){this.outputs||(this.outputs={}),t=t||G.COLOR_ATTACHMENT0,this.outputs[t]=e},detachOutput:function(e){for(var t in this.outputs)this.outputs[t]===e&&(this.outputs[t]=null)},bind:function(e,t){if(this.outputs)for(var r in this.outputs){var n=this.outputs[r];n&&t.attach(n,r)}t&&t.bind(e)},unbind:function(e,t){t.unbind(e)},render:function(e,t){var r=e.gl;if(t){this.bind(e,t);var n=e.getGLExtension("EXT_draw_buffers");if(n&&this.outputs){var a=[];for(var i in this.outputs)i=+i,i>=r.COLOR_ATTACHMENT0&&i<=r.COLOR_ATTACHMENT0+8&&a.push(i);n.drawBuffersEXT(a)}}this.trigger("beforerender",this,e);var o=this.clearDepth?r.DEPTH_BUFFER_BIT:0;if(r.depthMask(!0),this.clearColor){o=o|r.COLOR_BUFFER_BIT,r.colorMask(!0,!0,!0,!0);var s=this.clearColor;Array.isArray(s)&&r.clearColor(s[0],s[1],s[2],s[3])}r.clear(o),this.blendWithPrevious?(r.enable(r.BLEND),this.material.transparent=!0):(r.disable(r.BLEND),this.material.transparent=!1),this.renderQuad(e),this.trigger("afterrender",this,e),t&&this.unbind(e,t)},renderQuad:function(e){x1.material=this.material,e.renderPass([x1],f9)},dispose:function(e){}});const dt=d9,v9=`#define SAMPLE_NUMBER 1024
#define PI 3.14159265358979
uniform sampler2D normalDistribution;
uniform vec2 viewportSize : [512, 256];
const vec3 N = vec3(0.0, 0.0, 1.0);
const float fSampleNumber = float(SAMPLE_NUMBER);
vec3 importanceSampleNormal(float i, float roughness, vec3 N) {
 vec3 H = texture2D(normalDistribution, vec2(roughness, i)).rgb;
 vec3 upVector = abs(N.y) > 0.999 ? vec3(1.0, 0.0, 0.0) : vec3(0.0, 1.0, 0.0);
 vec3 tangentX = normalize(cross(N, upVector));
 vec3 tangentZ = cross(N, tangentX);
 return normalize(tangentX * H.x + N * H.y + tangentZ * H.z);
}
float G_Smith(float roughness, float NoV, float NoL) {
 float k = roughness * roughness / 2.0;
 float G1V = NoV / (NoV * (1.0 - k) + k);
 float G1L = NoL / (NoL * (1.0 - k) + k);
 return G1L * G1V;
}
void main() {
 vec2 uv = gl_FragCoord.xy / viewportSize;
 float NoV = uv.x;
 float roughness = uv.y;
 vec3 V;
 V.x = sqrt(1.0 - NoV * NoV);
 V.y = 0.0;
 V.z = NoV;
 float A = 0.0;
 float B = 0.0;
 for (int i = 0; i < SAMPLE_NUMBER; i++) {
 vec3 H = importanceSampleNormal(float(i) / fSampleNumber, roughness, N);
 vec3 L = reflect(-V, H);
 float NoL = clamp(L.z, 0.0, 1.0);
 float NoH = clamp(H.z, 0.0, 1.0);
 float VoH = clamp(dot(V, H), 0.0, 1.0);
 if (NoL > 0.0) {
 float G = G_Smith(roughness, NoV, NoL);
 float G_Vis = G * VoH / (NoH * NoV);
 float Fc = pow(1.0 - VoH, 5.0);
 A += (1.0 - Fc) * G_Vis;
 B += Fc * G_Vis;
 }
 }
 gl_FragColor = vec4(vec2(A, B) / fSampleNumber, 0.0, 1.0);
}
`,p9=`#define SHADER_NAME prefilter
#define SAMPLE_NUMBER 1024
#define PI 3.14159265358979
uniform mat4 viewInverse : VIEWINVERSE;
uniform samplerCube environmentMap;
uniform sampler2D normalDistribution;
uniform float roughness : 0.5;
varying vec2 v_Texcoord;
varying vec3 v_WorldPosition;
@import clay.util.rgbm
vec3 importanceSampleNormal(float i, float roughness, vec3 N) {
 vec3 H = texture2D(normalDistribution, vec2(roughness, i)).rgb;
 vec3 upVector = abs(N.y) > 0.999 ? vec3(1.0, 0.0, 0.0) : vec3(0.0, 1.0, 0.0);
 vec3 tangentX = normalize(cross(N, upVector));
 vec3 tangentZ = cross(N, tangentX);
 return normalize(tangentX * H.x + N * H.y + tangentZ * H.z);
}
void main() {
 vec3 eyePos = viewInverse[3].xyz;
 vec3 V = normalize(v_WorldPosition - eyePos);
 vec3 N = V;
 vec3 prefilteredColor = vec3(0.0);
 float totalWeight = 0.0;
 float fMaxSampleNumber = float(SAMPLE_NUMBER);
 for (int i = 0; i < SAMPLE_NUMBER; i++) {
 vec3 H = importanceSampleNormal(float(i) / fMaxSampleNumber, roughness, N);
 vec3 L = reflect(-V, H);
 float NoL = clamp(dot(N, L), 0.0, 1.0);
 if (NoL > 0.0) {
 prefilteredColor += decodeHDR(textureCube(environmentMap, L)).rgb * NoL;
 totalWeight += NoL;
 }
 }
 gl_FragColor = encodeHDR(vec4(prefilteredColor / totalWeight, 1.0));
}
`;var ha={},Dc=["px","nx","py","ny","pz","nz"];ha.prefilterEnvironmentMap=function(e,t,r,n,a){(!a||!n)&&(n=ha.generateNormalDistribution(),a=ha.integrateBRDF(e,n)),r=r||{};var i=r.width||64,o=r.height||64,s=r.type||t.type,l=new _o({width:i,height:o,type:s,flipY:!1,mipmaps:[]});l.isPowerOfTwo()||console.warn("Width and height must be power of two to enable mipmap.");var u=Math.min(i,o),c=Math.log(u)/Math.log(2)+1,h=new Sr({shader:new H({vertex:H.source("clay.skybox.vertex"),fragment:p9})});h.set("normalDistribution",n),r.encodeRGBM&&h.define("fragment","RGBM_ENCODE"),r.decodeRGBM&&h.define("fragment","RGBM_DECODE");var f=new On,d;if(t.textureType==="texture2D"){var v=new _o({width:i,height:o,type:s===ie.FLOAT?ie.HALF_FLOAT:s});ca.panoramaToCubeMap(e,t,v,{encodeRGBM:r.decodeRGBM}),t=v}d=new xo({scene:f,material:h}),d.material.set("environmentMap",t);var p=new cd({texture:l});r.encodeRGBM&&(s=l.type=ie.UNSIGNED_BYTE);for(var g=new _e({width:i,height:o,type:s}),m=new Rt({depthBuffer:!1}),_=ht[s===ie.UNSIGNED_BYTE?"Uint8Array":"Float32Array"],y=0;y<c;y++){l.mipmaps[y]={pixels:{}},d.material.set("roughness",y/(c-1));for(var x=g.width,S=2*Math.atan(x/(x-.5))/Math.PI*180,T=0;T<Dc.length;T++){var b=new _(g.width*g.height*4);m.attach(g),m.bind(e);var w=p.getCamera(Dc[T]);w.fov=S,e.render(f,w),e.gl.readPixels(0,0,g.width,g.height,ie.RGBA,s,b),m.unbind(e),l.mipmaps[y].pixels[Dc[T]]=b}g.width/=2,g.height/=2,g.dirty()}return m.dispose(e),g.dispose(e),d.dispose(e),n.dispose(e),{environmentMap:l,brdfLookup:a,normalDistribution:n,maxMipmapLevel:c}};ha.integrateBRDF=function(e,t){t=t||ha.generateNormalDistribution();var r=new Rt({depthBuffer:!1}),n=new dt({fragment:v9}),a=new _e({width:512,height:256,type:ie.HALF_FLOAT,wrapS:ie.CLAMP_TO_EDGE,wrapT:ie.CLAMP_TO_EDGE,minFilter:ie.NEAREST,magFilter:ie.NEAREST,useMipmap:!1});return n.setUniform("normalDistribution",t),n.setUniform("viewportSize",[512,256]),n.attachOutput(a),n.render(e,r),r.dispose(e),a};ha.generateNormalDistribution=function(r,n){for(var r=r||256,n=n||1024,a=new _e({width:r,height:n,type:ie.FLOAT,minFilter:ie.NEAREST,magFilter:ie.NEAREST,wrapS:ie.CLAMP_TO_EDGE,wrapT:ie.CLAMP_TO_EDGE,useMipmap:!1}),i=new Float32Array(n*r*4),o=[],s=0;s<r;s++){for(var l=s/r,u=l*l,c=0;c<n;c++){var h=(c<<16|c>>>16)>>>0;h=((h&1431655765)<<1|(h&2863311530)>>>1)>>>0,h=((h&858993459)<<2|(h&3435973836)>>>2)>>>0,h=((h&252645135)<<4|(h&4042322160)>>>4)>>>0,h=(((h&16711935)<<8|(h&4278255360)>>>8)>>>0)/4294967296;var f=Math.sqrt((1-h)/(1+(u*u-1)*h));o[c]=f}for(var c=0;c<n;c++){var d=(c*r+s)*4,f=o[c],v=Math.sqrt(1-f*f),p=c/n,g=2*Math.PI*p;i[d]=v*Math.cos(g),i[d+1]=f,i[d+2]=v*Math.sin(g),i[d+3]=1}}return a.pixels=i,a};const Is=ha;var g9=Ir.extend({cubemap:null,castShadow:!1,_normalDistribution:null,_brdfLookup:null},{type:"AMBIENT_CUBEMAP_LIGHT",prefilter:function(e,t){if(!e.getGLExtension("EXT_shader_texture_lod")){console.warn("Device not support textureCubeLodEXT");return}this._brdfLookup||(this._normalDistribution=Is.generateNormalDistribution(),this._brdfLookup=Is.integrateBRDF(e,this._normalDistribution));var r=this.cubemap;if(!r.__prefiltered){var n=Is.prefilterEnvironmentMap(e,r,{encodeRGBM:!0,width:t,height:t},this._normalDistribution,this._brdfLookup);this.cubemap=n.environmentMap,this.cubemap.__prefiltered=!0,r.dispose(e)}},getBRDFLookup:function(){return this._brdfLookup},uniformTemplates:{ambientCubemapLightColor:{type:"3f",value:function(e){var t=e.color,r=e.intensity;return[t[0]*r,t[1]*r,t[2]*r]}},ambientCubemapLightCubemap:{type:"t",value:function(e){return e.cubemap}},ambientCubemapLightBRDFLookup:{type:"t",value:function(e){return e._brdfLookup}}}});const m9=g9;var y9=Ir.extend({castShadow:!1,coefficients:[]},function(){this._coefficientsTmpArr=new ht.Float32Array(9*3)},{type:"AMBIENT_SH_LIGHT",uniformTemplates:{ambientSHLightColor:{type:"3f",value:function(e){var t=e.color,r=e.intensity;return[t[0]*r,t[1]*r,t[2]*r]}},ambientSHLightCoefficients:{type:"3f",value:function(e){for(var t=e._coefficientsTmpArr,r=0;r<e.coefficients.length;r++)t[r]=e.coefficients[r];return t}}}});const _9=y9;var sx={},sa=["px","nx","py","ny","pz","nz"];function x9(e,t){var r=e[0],n=e[1],a=e[2];return t===0?1:t===1?r:t===2?n:t===3?a:t===4?r*a:t===5?n*a:t===6?r*n:t===7?3*a*a-1:r*r-n*n}var S9={px:[2,1,0,-1,-1,1],nx:[2,1,0,1,-1,-1],py:[0,2,1,1,-1,-1],ny:[0,2,1,1,1,1],pz:[0,1,2,-1,-1,-1],nz:[0,1,2,1,-1,1]};function T9(e,t,r,n){for(var a=new ht.Float32Array(27),i=O.create(),o=O.create(),s=O.create(),l=0;l<9;l++){for(var u=O.create(),c=0;c<sa.length;c++){for(var h=t[sa[c]],f=O.create(),d=0,v=0,p=S9[sa[c]],g=0;g<n;g++)for(var m=0;m<r;m++){i[0]=m/(r-1)*2-1,i[1]=g/(n-1)*2-1,i[2]=-1,O.normalize(i,i),s[0]=i[p[0]]*p[3],s[1]=i[p[1]]*p[4],s[2]=i[p[2]]*p[5],o[0]=h[v++]/255,o[1]=h[v++]/255,o[2]=h[v++]/255;var _=h[v++]/255*8.12;o[0]*=_,o[1]*=_,o[2]*=_,O.scaleAndAdd(f,f,o,x9(s,l)*-i[2]),d+=-i[2]}O.scaleAndAdd(u,u,f,1/d)}a[l*3]=u[0]/6,a[l*3+1]=u[1]/6,a[l*3+2]=u[2]/6}return a}sx.projectEnvironmentMap=function(e,t,r){r=r||{},r.lod=r.lod||0;var n,a=new On,i=64;t.textureType==="texture2D"?n=new xo({scene:a,environmentMap:t}):(i=t.image&&t.image.px?t.image.px.width:t.width,n=new xo({scene:a,environmentMap:t}));var o=Math.ceil(i/Math.pow(2,r.lod)),s=Math.ceil(i/Math.pow(2,r.lod)),l=new _e({width:o,height:s}),u=new Rt;n.material.define("fragment","RGBM_ENCODE"),r.decodeRGBM&&n.material.define("fragment","RGBM_DECODE"),n.material.set("lod",r.lod);for(var c=new cd({texture:l}),h={},f=0;f<sa.length;f++){h[sa[f]]=new Uint8Array(o*s*4);var d=c.getCamera(sa[f]);d.fov=90,u.attach(l),u.bind(e),e.render(a,d),e.gl.readPixels(0,0,o,s,ie.RGBA,ie.UNSIGNED_BYTE,h[sa[f]]),u.unbind(e)}return n.dispose(e),u.dispose(e),l.dispose(e),T9(e,h,o,s)};const b9=sx;var w9={firstNotNull:function(){for(var e=0,t=arguments.length;e<t;e++)if(arguments[e]!=null)return arguments[e]},queryDataIndex:function(e,t){if(t.dataIndexInside!=null)return t.dataIndexInside;if(t.dataIndex!=null)return te(t.dataIndex)?K(t.dataIndex,function(r){return e.indexOfRawIndex(r)}):e.indexOfRawIndex(t.dataIndex);if(t.name!=null)return te(t.name)?K(t.name,function(r){return e.indexOfName(r)}):e.indexOfName(t.name)}};const Se=w9;var A9=Me.extend({dynamic:!1,widthSegments:40,heightSegments:20,phiStart:0,phiLength:Math.PI*2,thetaStart:0,thetaLength:Math.PI,radius:1},function(){this.build()},{build:function(){var e=this.heightSegments,t=this.widthSegments,r=this.attributes.position,n=this.attributes.texcoord0,a=this.attributes.normal,i=(t+1)*(e+1);r.init(i),n.init(i),a.init(i);var o=i>65535?Uint32Array:Uint16Array,s=this.indices=new o(t*e*6),l,u,c,h,f,d,v,y=this.radius,p=this.phiStart,g=this.phiLength,m=this.thetaStart,_=this.thetaLength,y=this.radius,x=[],S=[],T=0,b=1/y;for(v=0;v<=e;v++)for(d=0;d<=t;d++)h=d/t,f=v/e,l=-y*Math.cos(p+h*g)*Math.sin(m+f*_),u=y*Math.cos(m+f*_),c=y*Math.sin(p+h*g)*Math.sin(m+f*_),x[0]=l,x[1]=u,x[2]=c,S[0]=h,S[1]=f,r.set(T,x),n.set(T,S),x[0]*=b,x[1]*=b,x[2]*=b,a.set(T,x),T++;var w,A,E,C,M=t+1,P=0;for(v=0;v<e;v++)for(d=0;d<t;d++)A=v*M+d,w=v*M+d+1,C=(v+1)*M+d+1,E=(v+1)*M+d,s[P++]=w,s[P++]=A,s[P++]=C,s[P++]=A,s[P++]=E,s[P++]=C;this.boundingBox=new $t,this.boundingBox.max.set(y,y,y),this.boundingBox.min.set(-y,-y,-y)}});const E9=A9;var C9=Ir.extend({castShadow:!1},{type:"AMBIENT_LIGHT",uniformTemplates:{ambientLightColor:{type:"3f",value:function(e){var t=e.color,r=e.intensity;return[t[0]*r,t[1]*r,t[2]*r]}}}});const L9=C9;var D9=Ir.extend({shadowBias:.001,shadowSlopeScale:2,shadowCascade:1,cascadeSplitLogFactor:.2},{type:"DIRECTIONAL_LIGHT",uniformTemplates:{directionalLightDirection:{type:"3f",value:function(e){return e.__dir=e.__dir||new X,e.__dir.copy(e.worldTransform.z).normalize().negate().array}},directionalLightColor:{type:"3f",value:function(e){var t=e.color,r=e.intensity;return[t[0]*r,t[1]*r,t[2]*r]}}},clone:function(){var e=Ir.prototype.clone.call(this);return e.shadowBias=this.shadowBias,e.shadowSlopeScale=this.shadowSlopeScale,e}});const M9=D9;var P9=Ir.extend({range:100,castShadow:!1},{type:"POINT_LIGHT",uniformTemplates:{pointLightPosition:{type:"3f",value:function(e){return e.getWorldPosition().array}},pointLightRange:{type:"1f",value:function(e){return e.range}},pointLightColor:{type:"3f",value:function(e){var t=e.color,r=e.intensity;return[t[0]*r,t[1]*r,t[2]*r]}}},clone:function(){var e=Ir.prototype.clone.call(this);return e.range=this.range,e}});const I9=P9;var R9=Ir.extend({range:20,umbraAngle:30,penumbraAngle:45,falloffFactor:2,shadowBias:.001,shadowSlopeScale:2},{type:"SPOT_LIGHT",uniformTemplates:{spotLightPosition:{type:"3f",value:function(e){return e.getWorldPosition().array}},spotLightRange:{type:"1f",value:function(e){return e.range}},spotLightUmbraAngleCosine:{type:"1f",value:function(e){return Math.cos(e.umbraAngle*Math.PI/180)}},spotLightPenumbraAngleCosine:{type:"1f",value:function(e){return Math.cos(e.penumbraAngle*Math.PI/180)}},spotLightFalloffFactor:{type:"1f",value:function(e){return e.falloffFactor}},spotLightDirection:{type:"3f",value:function(e){return e.__dir=e.__dir||new X,e.__dir.copy(e.worldTransform.z).negate().array}},spotLightColor:{type:"3f",value:function(e){var t=e.color,r=e.intensity;return[t[0]*r,t[1]*r,t[2]*r]}}},clone:function(){var e=Ir.prototype.clone.call(this);return e.range=this.range,e.umbraAngle=this.umbraAngle,e.penumbraAngle=this.penumbraAngle,e.falloffFactor=this.falloffFactor,e.shadowBias=this.shadowBias,e.shadowSlopeScale=this.shadowSlopeScale,e}});const N9=R9;var Le=function(e,t,r,n){e=e||0,t=t||0,r=r||0,n=n||0,this.array=Y.fromValues(e,t,r,n),this._dirty=!0};Le.prototype={constructor:Le,add:function(e){return Y.add(this.array,this.array,e.array),this._dirty=!0,this},set:function(e,t,r,n){return this.array[0]=e,this.array[1]=t,this.array[2]=r,this.array[3]=n,this._dirty=!0,this},setArray:function(e){return this.array[0]=e[0],this.array[1]=e[1],this.array[2]=e[2],this.array[3]=e[3],this._dirty=!0,this},clone:function(){return new Le(this.x,this.y,this.z,this.w)},copy:function(e){return Y.copy(this.array,e.array),this._dirty=!0,this},dist:function(e){return Y.dist(this.array,e.array)},distance:function(e){return Y.distance(this.array,e.array)},div:function(e){return Y.div(this.array,this.array,e.array),this._dirty=!0,this},divide:function(e){return Y.divide(this.array,this.array,e.array),this._dirty=!0,this},dot:function(e){return Y.dot(this.array,e.array)},len:function(){return Y.len(this.array)},length:function(){return Y.length(this.array)},lerp:function(e,t,r){return Y.lerp(this.array,e.array,t.array,r),this._dirty=!0,this},min:function(e){return Y.min(this.array,this.array,e.array),this._dirty=!0,this},max:function(e){return Y.max(this.array,this.array,e.array),this._dirty=!0,this},mul:function(e){return Y.mul(this.array,this.array,e.array),this._dirty=!0,this},multiply:function(e){return Y.multiply(this.array,this.array,e.array),this._dirty=!0,this},negate:function(){return Y.negate(this.array,this.array),this._dirty=!0,this},normalize:function(){return Y.normalize(this.array,this.array),this._dirty=!0,this},random:function(e){return Y.random(this.array,e),this._dirty=!0,this},scale:function(e){return Y.scale(this.array,this.array,e),this._dirty=!0,this},scaleAndAdd:function(e,t){return Y.scaleAndAdd(this.array,this.array,e.array,t),this._dirty=!0,this},sqrDist:function(e){return Y.sqrDist(this.array,e.array)},squaredDistance:function(e){return Y.squaredDistance(this.array,e.array)},sqrLen:function(){return Y.sqrLen(this.array)},squaredLength:function(){return Y.squaredLength(this.array)},sub:function(e){return Y.sub(this.array,this.array,e.array),this._dirty=!0,this},subtract:function(e){return Y.subtract(this.array,this.array,e.array),this._dirty=!0,this},transformMat4:function(e){return Y.transformMat4(this.array,this.array,e.array),this._dirty=!0,this},transformQuat:function(e){return Y.transformQuat(this.array,this.array,e.array),this._dirty=!0,this},toString:function(){return"["+Array.prototype.join.call(this.array,",")+"]"},toArray:function(){return Array.prototype.slice.call(this.array)}};var Bi=Object.defineProperty;if(Bi){var gs=Le.prototype;Bi(gs,"x",{get:function(){return this.array[0]},set:function(e){this.array[0]=e,this._dirty=!0}}),Bi(gs,"y",{get:function(){return this.array[1]},set:function(e){this.array[1]=e,this._dirty=!0}}),Bi(gs,"z",{get:function(){return this.array[2]},set:function(e){this.array[2]=e,this._dirty=!0}}),Bi(gs,"w",{get:function(){return this.array[3]},set:function(e){this.array[3]=e,this._dirty=!0}})}Le.add=function(e,t,r){return Y.add(e.array,t.array,r.array),e._dirty=!0,e};Le.set=function(e,t,r,n,a){Y.set(e.array,t,r,n,a),e._dirty=!0};Le.copy=function(e,t){return Y.copy(e.array,t.array),e._dirty=!0,e};Le.dist=function(e,t){return Y.distance(e.array,t.array)};Le.distance=Le.dist;Le.div=function(e,t,r){return Y.divide(e.array,t.array,r.array),e._dirty=!0,e};Le.divide=Le.div;Le.dot=function(e,t){return Y.dot(e.array,t.array)};Le.len=function(e){return Y.length(e.array)};Le.lerp=function(e,t,r,n){return Y.lerp(e.array,t.array,r.array,n),e._dirty=!0,e};Le.min=function(e,t,r){return Y.min(e.array,t.array,r.array),e._dirty=!0,e};Le.max=function(e,t,r){return Y.max(e.array,t.array,r.array),e._dirty=!0,e};Le.mul=function(e,t,r){return Y.multiply(e.array,t.array,r.array),e._dirty=!0,e};Le.multiply=Le.mul;Le.negate=function(e,t){return Y.negate(e.array,t.array),e._dirty=!0,e};Le.normalize=function(e,t){return Y.normalize(e.array,t.array),e._dirty=!0,e};Le.random=function(e,t){return Y.random(e.array,t),e._dirty=!0,e};Le.scale=function(e,t,r){return Y.scale(e.array,t.array,r),e._dirty=!0,e};Le.scaleAndAdd=function(e,t,r,n){return Y.scaleAndAdd(e.array,t.array,r.array,n),e._dirty=!0,e};Le.sqrDist=function(e,t){return Y.sqrDist(e.array,t.array)};Le.squaredDistance=Le.sqrDist;Le.sqrLen=function(e){return Y.sqrLen(e.array)};Le.squaredLength=Le.sqrLen;Le.sub=function(e,t,r){return Y.subtract(e.array,t.array,r.array),e._dirty=!0,e};Le.subtract=Le.sub;Le.transformMat4=function(e,t,r){return Y.transformMat4(e.array,t.array,r.array),e._dirty=!0,e};Le.transformQuat=function(e,t,r){return Y.transformQuat(e.array,t.array,r.array),e._dirty=!0,e};const O9=Le;var Ut={};Ut.create=function(){var e=new Bt(4);return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e};Ut.clone=function(e){var t=new Bt(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t};Ut.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e};Ut.identity=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e};Ut.transpose=function(e,t){if(e===t){var r=t[1];e[1]=t[2],e[2]=r}else e[0]=t[0],e[1]=t[2],e[2]=t[1],e[3]=t[3];return e};Ut.invert=function(e,t){var r=t[0],n=t[1],a=t[2],i=t[3],o=r*i-a*n;return o?(o=1/o,e[0]=i*o,e[1]=-n*o,e[2]=-a*o,e[3]=r*o,e):null};Ut.adjoint=function(e,t){var r=t[0];return e[0]=t[3],e[1]=-t[1],e[2]=-t[2],e[3]=r,e};Ut.determinant=function(e){return e[0]*e[3]-e[2]*e[1]};Ut.multiply=function(e,t,r){var n=t[0],a=t[1],i=t[2],o=t[3],s=r[0],l=r[1],u=r[2],c=r[3];return e[0]=n*s+i*l,e[1]=a*s+o*l,e[2]=n*u+i*c,e[3]=a*u+o*c,e};Ut.mul=Ut.multiply;Ut.rotate=function(e,t,r){var n=t[0],a=t[1],i=t[2],o=t[3],s=Math.sin(r),l=Math.cos(r);return e[0]=n*l+i*s,e[1]=a*l+o*s,e[2]=n*-s+i*l,e[3]=a*-s+o*l,e};Ut.scale=function(e,t,r){var n=t[0],a=t[1],i=t[2],o=t[3],s=r[0],l=r[1];return e[0]=n*s,e[1]=a*s,e[2]=i*l,e[3]=o*l,e};Ut.frob=function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2))};Ut.LDU=function(e,t,r,n){return e[2]=n[2]/n[0],r[0]=n[0],r[1]=n[1],r[3]=n[3]-e[2]*r[1],[e,t,r]};const tt=Ut;var Zt=function(){this.array=tt.create(),this._dirty=!0};Zt.prototype={constructor:Zt,setArray:function(e){for(var t=0;t<this.array.length;t++)this.array[t]=e[t];return this._dirty=!0,this},clone:function(){return new Zt().copy(this)},copy:function(e){return tt.copy(this.array,e.array),this._dirty=!0,this},adjoint:function(){return tt.adjoint(this.array,this.array),this._dirty=!0,this},determinant:function(){return tt.determinant(this.array)},identity:function(){return tt.identity(this.array),this._dirty=!0,this},invert:function(){return tt.invert(this.array,this.array),this._dirty=!0,this},mul:function(e){return tt.mul(this.array,this.array,e.array),this._dirty=!0,this},mulLeft:function(e){return tt.mul(this.array,e.array,this.array),this._dirty=!0,this},multiply:function(e){return tt.multiply(this.array,this.array,e.array),this._dirty=!0,this},multiplyLeft:function(e){return tt.multiply(this.array,e.array,this.array),this._dirty=!0,this},rotate:function(e){return tt.rotate(this.array,this.array,e),this._dirty=!0,this},scale:function(e){return tt.scale(this.array,this.array,e.array),this._dirty=!0,this},transpose:function(){return tt.transpose(this.array,this.array),this._dirty=!0,this},toString:function(){return"["+Array.prototype.join.call(this.array,",")+"]"},toArray:function(){return Array.prototype.slice.call(this.array)}};Zt.adjoint=function(e,t){return tt.adjoint(e.array,t.array),e._dirty=!0,e};Zt.copy=function(e,t){return tt.copy(e.array,t.array),e._dirty=!0,e};Zt.determinant=function(e){return tt.determinant(e.array)};Zt.identity=function(e){return tt.identity(e.array),e._dirty=!0,e};Zt.invert=function(e,t){return tt.invert(e.array,t.array),e._dirty=!0,e};Zt.mul=function(e,t,r){return tt.mul(e.array,t.array,r.array),e._dirty=!0,e};Zt.multiply=Zt.mul;Zt.rotate=function(e,t,r){return tt.rotate(e.array,t.array,r),e._dirty=!0,e};Zt.scale=function(e,t,r){return tt.scale(e.array,t.array,r.array),e._dirty=!0,e};Zt.transpose=function(e,t){return tt.transpose(e.array,t.array),e._dirty=!0,e};const B9=Zt;var ir={};ir.create=function(){var e=new Bt(6);return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e};ir.clone=function(e){var t=new Bt(6);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t};ir.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e};ir.identity=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e};ir.invert=function(e,t){var r=t[0],n=t[1],a=t[2],i=t[3],o=t[4],s=t[5],l=r*i-n*a;return l?(l=1/l,e[0]=i*l,e[1]=-n*l,e[2]=-a*l,e[3]=r*l,e[4]=(a*s-i*o)*l,e[5]=(n*o-r*s)*l,e):null};ir.determinant=function(e){return e[0]*e[3]-e[1]*e[2]};ir.multiply=function(e,t,r){var n=t[0],a=t[1],i=t[2],o=t[3],s=t[4],l=t[5],u=r[0],c=r[1],h=r[2],f=r[3],d=r[4],v=r[5];return e[0]=n*u+i*c,e[1]=a*u+o*c,e[2]=n*h+i*f,e[3]=a*h+o*f,e[4]=n*d+i*v+s,e[5]=a*d+o*v+l,e};ir.mul=ir.multiply;ir.rotate=function(e,t,r){var n=t[0],a=t[1],i=t[2],o=t[3],s=t[4],l=t[5],u=Math.sin(r),c=Math.cos(r);return e[0]=n*c+i*u,e[1]=a*c+o*u,e[2]=n*-u+i*c,e[3]=a*-u+o*c,e[4]=s,e[5]=l,e};ir.scale=function(e,t,r){var n=t[0],a=t[1],i=t[2],o=t[3],s=t[4],l=t[5],u=r[0],c=r[1];return e[0]=n*u,e[1]=a*u,e[2]=i*c,e[3]=o*c,e[4]=s,e[5]=l,e};ir.translate=function(e,t,r){var n=t[0],a=t[1],i=t[2],o=t[3],s=t[4],l=t[5],u=r[0],c=r[1];return e[0]=n,e[1]=a,e[2]=i,e[3]=o,e[4]=n*u+i*c+s,e[5]=a*u+o*c+l,e};ir.frob=function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2)+Math.pow(e[4],2)+Math.pow(e[5],2)+1)};const ut=ir;var nr=function(){this.array=ut.create(),this._dirty=!0};nr.prototype={constructor:nr,setArray:function(e){for(var t=0;t<this.array.length;t++)this.array[t]=e[t];return this._dirty=!0,this},clone:function(){return new nr().copy(this)},copy:function(e){return ut.copy(this.array,e.array),this._dirty=!0,this},determinant:function(){return ut.determinant(this.array)},identity:function(){return ut.identity(this.array),this._dirty=!0,this},invert:function(){return ut.invert(this.array,this.array),this._dirty=!0,this},mul:function(e){return ut.mul(this.array,this.array,e.array),this._dirty=!0,this},mulLeft:function(e){return ut.mul(this.array,e.array,this.array),this._dirty=!0,this},multiply:function(e){return ut.multiply(this.array,this.array,e.array),this._dirty=!0,this},multiplyLeft:function(e){return ut.multiply(this.array,e.array,this.array),this._dirty=!0,this},rotate:function(e){return ut.rotate(this.array,this.array,e),this._dirty=!0,this},scale:function(e){return ut.scale(this.array,this.array,e.array),this._dirty=!0,this},translate:function(e){return ut.translate(this.array,this.array,e.array),this._dirty=!0,this},toString:function(){return"["+Array.prototype.join.call(this.array,",")+"]"},toArray:function(){return Array.prototype.slice.call(this.array)}};nr.copy=function(e,t){return ut.copy(e.array,t.array),e._dirty=!0,e};nr.determinant=function(e){return ut.determinant(e.array)};nr.identity=function(e){return ut.identity(e.array),e._dirty=!0,e};nr.invert=function(e,t){return ut.invert(e.array,t.array),e._dirty=!0,e};nr.mul=function(e,t,r){return ut.mul(e.array,t.array,r.array),e._dirty=!0,e};nr.multiply=nr.mul;nr.rotate=function(e,t,r){return ut.rotate(e.array,t.array,r),e._dirty=!0,e};nr.scale=function(e,t,r){return ut.scale(e.array,t.array,r.array),e._dirty=!0,e};nr.translate=function(e,t,r){return ut.translate(e.array,t.array,r.array),e._dirty=!0,e};const F9=nr;var yt=function(){this.array=Ae.create(),this._dirty=!0};yt.prototype={constructor:yt,setArray:function(e){for(var t=0;t<this.array.length;t++)this.array[t]=e[t];return this._dirty=!0,this},adjoint:function(){return Ae.adjoint(this.array,this.array),this._dirty=!0,this},clone:function(){return new yt().copy(this)},copy:function(e){return Ae.copy(this.array,e.array),this._dirty=!0,this},determinant:function(){return Ae.determinant(this.array)},fromMat2d:function(e){return Ae.fromMat2d(this.array,e.array),this._dirty=!0,this},fromMat4:function(e){return Ae.fromMat4(this.array,e.array),this._dirty=!0,this},fromQuat:function(e){return Ae.fromQuat(this.array,e.array),this._dirty=!0,this},identity:function(){return Ae.identity(this.array),this._dirty=!0,this},invert:function(){return Ae.invert(this.array,this.array),this._dirty=!0,this},mul:function(e){return Ae.mul(this.array,this.array,e.array),this._dirty=!0,this},mulLeft:function(e){return Ae.mul(this.array,e.array,this.array),this._dirty=!0,this},multiply:function(e){return Ae.multiply(this.array,this.array,e.array),this._dirty=!0,this},multiplyLeft:function(e){return Ae.multiply(this.array,e.array,this.array),this._dirty=!0,this},rotate:function(e){return Ae.rotate(this.array,this.array,e),this._dirty=!0,this},scale:function(e){return Ae.scale(this.array,this.array,e.array),this._dirty=!0,this},translate:function(e){return Ae.translate(this.array,this.array,e.array),this._dirty=!0,this},normalFromMat4:function(e){return Ae.normalFromMat4(this.array,e.array),this._dirty=!0,this},transpose:function(){return Ae.transpose(this.array,this.array),this._dirty=!0,this},toString:function(){return"["+Array.prototype.join.call(this.array,",")+"]"},toArray:function(){return Array.prototype.slice.call(this.array)}};yt.adjoint=function(e,t){return Ae.adjoint(e.array,t.array),e._dirty=!0,e};yt.copy=function(e,t){return Ae.copy(e.array,t.array),e._dirty=!0,e};yt.determinant=function(e){return Ae.determinant(e.array)};yt.identity=function(e){return Ae.identity(e.array),e._dirty=!0,e};yt.invert=function(e,t){return Ae.invert(e.array,t.array),e};yt.mul=function(e,t,r){return Ae.mul(e.array,t.array,r.array),e._dirty=!0,e};yt.multiply=yt.mul;yt.fromMat2d=function(e,t){return Ae.fromMat2d(e.array,t.array),e._dirty=!0,e};yt.fromMat4=function(e,t){return Ae.fromMat4(e.array,t.array),e._dirty=!0,e};yt.fromQuat=function(e,t){return Ae.fromQuat(e.array,t.array),e._dirty=!0,e};yt.normalFromMat4=function(e,t){return Ae.normalFromMat4(e.array,t.array),e._dirty=!0,e};yt.rotate=function(e,t,r){return Ae.rotate(e.array,t.array,r),e._dirty=!0,e};yt.scale=function(e,t,r){return Ae.scale(e.array,t.array,r.array),e._dirty=!0,e};yt.transpose=function(e,t){return Ae.transpose(e.array,t.array),e._dirty=!0,e};yt.translate=function(e,t,r){return Ae.translate(e.array,t.array,r.array),e._dirty=!0,e};const z9=yt;var G9={_animators:null,getAnimators:function(){return this._animators=this._animators||[],this._animators},animate:function(e,t){this._animators=this._animators||[];var r=this,n;if(e){for(var a=e.split("."),i=r,o=0,s=a.length;o<s;o++)i&&(i=i[a[o]]);i&&(n=i)}else n=r;if(n==null)throw new Error("Target "+e+" not exists");var l=this._animators,u=new C3(n,t),c=this;return u.during(function(){c.__zr&&c.__zr.refresh()}).done(function(){var h=l.indexOf(u);h>=0&&l.splice(h,1)}),l.push(u),this.__zr&&this.__zr.animation.addAnimator(u),u},stopAnimation:function(e){this._animators=this._animators||[];for(var t=this._animators,r=t.length,n=0;n<r;n++)t[n].stop(e);return t.length=0,this},addAnimatorsToZr:function(e){if(this._animators)for(var t=0;t<this._animators.length;t++)e.animation.addAnimator(this._animators[t])},removeAnimatorsFromZr:function(e){if(this._animators)for(var t=0;t<this._animators.length;t++)e.animation.removeAnimator(this._animators[t])}};const V9=G9,lx=`
@export clay.util.rand
highp float rand(vec2 uv) {
 const highp float a = 12.9898, b = 78.233, c = 43758.5453;
 highp float dt = dot(uv.xy, vec2(a,b)), sn = mod(dt, 3.141592653589793);
 return fract(sin(sn) * c);
}
@end
@export clay.util.calculate_attenuation
uniform float attenuationFactor : 5.0;
float lightAttenuation(float dist, float range)
{
 float attenuation = 1.0;
 attenuation = dist*dist/(range*range+1.0);
 float att_s = attenuationFactor;
 attenuation = 1.0/(attenuation*att_s+1.0);
 att_s = 1.0/(att_s+1.0);
 attenuation = attenuation - att_s;
 attenuation /= 1.0 - att_s;
 return clamp(attenuation, 0.0, 1.0);
}
@end
@export clay.util.edge_factor
#ifdef SUPPORT_STANDARD_DERIVATIVES
float edgeFactor(float width)
{
 vec3 d = fwidth(v_Barycentric);
 vec3 a3 = smoothstep(vec3(0.0), d * width, v_Barycentric);
 return min(min(a3.x, a3.y), a3.z);
}
#else
float edgeFactor(float width)
{
 return 1.0;
}
#endif
@end
@export clay.util.encode_float
vec4 encodeFloat(const in float depth)
{
 const vec4 bitShifts = vec4(256.0*256.0*256.0, 256.0*256.0, 256.0, 1.0);
 const vec4 bit_mask = vec4(0.0, 1.0/256.0, 1.0/256.0, 1.0/256.0);
 vec4 res = fract(depth * bitShifts);
 res -= res.xxyz * bit_mask;
 return res;
}
@end
@export clay.util.decode_float
float decodeFloat(const in vec4 color)
{
 const vec4 bitShifts = vec4(1.0/(256.0*256.0*256.0), 1.0/(256.0*256.0), 1.0/256.0, 1.0);
 return dot(color, bitShifts);
}
@end
@export clay.util.float
@import clay.util.encode_float
@import clay.util.decode_float
@end
@export clay.util.rgbm_decode
vec3 RGBMDecode(vec4 rgbm, float range) {
 return range * rgbm.rgb * rgbm.a;
}
@end
@export clay.util.rgbm_encode
vec4 RGBMEncode(vec3 color, float range) {
 if (dot(color, color) == 0.0) {
 return vec4(0.0);
 }
 vec4 rgbm;
 color /= range;
 rgbm.a = clamp(max(max(color.r, color.g), max(color.b, 1e-6)), 0.0, 1.0);
 rgbm.a = ceil(rgbm.a * 255.0) / 255.0;
 rgbm.rgb = color / rgbm.a;
 return rgbm;
}
@end
@export clay.util.rgbm
@import clay.util.rgbm_decode
@import clay.util.rgbm_encode
vec4 decodeHDR(vec4 color)
{
#if defined(RGBM_DECODE) || defined(RGBM)
 return vec4(RGBMDecode(color, 8.12), 1.0);
#else
 return color;
#endif
}
vec4 encodeHDR(vec4 color)
{
#if defined(RGBM_ENCODE) || defined(RGBM)
 return RGBMEncode(color.xyz, 8.12);
#else
 return color;
#endif
}
@end
@export clay.util.srgb
vec4 sRGBToLinear(in vec4 value) {
 return vec4(mix(pow(value.rgb * 0.9478672986 + vec3(0.0521327014), vec3(2.4)), value.rgb * 0.0773993808, vec3(lessThanEqual(value.rgb, vec3(0.04045)))), value.w);
}
vec4 linearTosRGB(in vec4 value) {
 return vec4(mix(pow(value.rgb, vec3(0.41666)) * 1.055 - vec3(0.055), value.rgb * 12.92, vec3(lessThanEqual(value.rgb, vec3(0.0031308)))), value.w);
}
@end
@export clay.chunk.skinning_header
#ifdef SKINNING
attribute vec3 weight : WEIGHT;
attribute vec4 joint : JOINT;
#ifdef USE_SKIN_MATRICES_TEXTURE
uniform sampler2D skinMatricesTexture : ignore;
uniform float skinMatricesTextureSize: ignore;
mat4 getSkinMatrix(sampler2D tex, float idx) {
 float j = idx * 4.0;
 float x = mod(j, skinMatricesTextureSize);
 float y = floor(j / skinMatricesTextureSize) + 0.5;
 vec2 scale = vec2(skinMatricesTextureSize);
 return mat4(
 texture2D(tex, vec2(x + 0.5, y) / scale),
 texture2D(tex, vec2(x + 1.5, y) / scale),
 texture2D(tex, vec2(x + 2.5, y) / scale),
 texture2D(tex, vec2(x + 3.5, y) / scale)
 );
}
mat4 getSkinMatrix(float idx) {
 return getSkinMatrix(skinMatricesTexture, idx);
}
#else
uniform mat4 skinMatrix[JOINT_COUNT] : SKIN_MATRIX;
mat4 getSkinMatrix(float idx) {
 return skinMatrix[int(idx)];
}
#endif
#endif
@end
@export clay.chunk.skin_matrix
mat4 skinMatrixWS = getSkinMatrix(joint.x) * weight.x;
if (weight.y > 1e-4)
{
 skinMatrixWS += getSkinMatrix(joint.y) * weight.y;
}
if (weight.z > 1e-4)
{
 skinMatrixWS += getSkinMatrix(joint.z) * weight.z;
}
float weightW = 1.0-weight.x-weight.y-weight.z;
if (weightW > 1e-4)
{
 skinMatrixWS += getSkinMatrix(joint.w) * weightW;
}
@end
@export clay.chunk.instancing_header
#ifdef INSTANCING
attribute vec4 instanceMat1;
attribute vec4 instanceMat2;
attribute vec4 instanceMat3;
#endif
@end
@export clay.chunk.instancing_matrix
mat4 instanceMat = mat4(
 vec4(instanceMat1.xyz, 0.0),
 vec4(instanceMat2.xyz, 0.0),
 vec4(instanceMat3.xyz, 0.0),
 vec4(instanceMat1.w, instanceMat2.w, instanceMat3.w, 1.0)
);
@end
@export clay.util.parallax_correct
vec3 parallaxCorrect(in vec3 dir, in vec3 pos, in vec3 boxMin, in vec3 boxMax) {
 vec3 first = (boxMax - pos) / dir;
 vec3 second = (boxMin - pos) / dir;
 vec3 further = max(first, second);
 float dist = min(further.x, min(further.y, further.z));
 vec3 fixedPos = pos + dir * dist;
 vec3 boxCenter = (boxMax + boxMin) * 0.5;
 return normalize(fixedPos - boxCenter);
}
@end
@export clay.util.clamp_sample
vec4 clampSample(const in sampler2D texture, const in vec2 coord)
{
#ifdef STEREO
 float eye = step(0.5, coord.x) * 0.5;
 vec2 coordClamped = clamp(coord, vec2(eye, 0.0), vec2(0.5 + eye, 1.0));
#else
 vec2 coordClamped = clamp(coord, vec2(0.0), vec2(1.0));
#endif
 return texture2D(texture, coordClamped);
}
@end
@export clay.util.ACES
vec3 ACESToneMapping(vec3 color)
{
 const float A = 2.51;
 const float B = 0.03;
 const float C = 2.43;
 const float D = 0.59;
 const float E = 0.14;
 return (color * (A * color + B)) / (color * (C * color + D) + E);
}
@end`,U9=`
@export ecgl.common.transformUniforms
uniform mat4 worldViewProjection : WORLDVIEWPROJECTION;
uniform mat4 worldInverseTranspose : WORLDINVERSETRANSPOSE;
uniform mat4 world : WORLD;
@end

@export ecgl.common.attributes
attribute vec3 position : POSITION;
attribute vec2 texcoord : TEXCOORD_0;
attribute vec3 normal : NORMAL;
@end

@export ecgl.common.uv.header
uniform vec2 uvRepeat : [1.0, 1.0];
uniform vec2 uvOffset : [0.0, 0.0];
uniform vec2 detailUvRepeat : [1.0, 1.0];
uniform vec2 detailUvOffset : [0.0, 0.0];

varying vec2 v_Texcoord;
varying vec2 v_DetailTexcoord;
@end

@export ecgl.common.uv.main
v_Texcoord = texcoord * uvRepeat + uvOffset;
v_DetailTexcoord = texcoord * detailUvRepeat + detailUvOffset;
@end

@export ecgl.common.uv.fragmentHeader
varying vec2 v_Texcoord;
varying vec2 v_DetailTexcoord;
@end


@export ecgl.common.albedo.main

 vec4 albedoTexel = vec4(1.0);
#ifdef DIFFUSEMAP_ENABLED
 albedoTexel = texture2D(diffuseMap, v_Texcoord);
 #ifdef SRGB_DECODE
 albedoTexel = sRGBToLinear(albedoTexel);
 #endif
#endif

#ifdef DETAILMAP_ENABLED
 vec4 detailTexel = texture2D(detailMap, v_DetailTexcoord);
 #ifdef SRGB_DECODE
 detailTexel = sRGBToLinear(detailTexel);
 #endif
 albedoTexel.rgb = mix(albedoTexel.rgb, detailTexel.rgb, detailTexel.a);
 albedoTexel.a = detailTexel.a + (1.0 - detailTexel.a) * albedoTexel.a;
#endif

@end

@export ecgl.common.wireframe.vertexHeader

#ifdef WIREFRAME_QUAD
attribute vec4 barycentric;
varying vec4 v_Barycentric;
#elif defined(WIREFRAME_TRIANGLE)
attribute vec3 barycentric;
varying vec3 v_Barycentric;
#endif

@end

@export ecgl.common.wireframe.vertexMain

#if defined(WIREFRAME_QUAD) || defined(WIREFRAME_TRIANGLE)
 v_Barycentric = barycentric;
#endif

@end


@export ecgl.common.wireframe.fragmentHeader

uniform float wireframeLineWidth : 1;
uniform vec4 wireframeLineColor: [0, 0, 0, 0.5];

#ifdef WIREFRAME_QUAD
varying vec4 v_Barycentric;
float edgeFactor () {
 vec4 d = fwidth(v_Barycentric);
 vec4 a4 = smoothstep(vec4(0.0), d * wireframeLineWidth, v_Barycentric);
 return min(min(min(a4.x, a4.y), a4.z), a4.w);
}
#elif defined(WIREFRAME_TRIANGLE)
varying vec3 v_Barycentric;
float edgeFactor () {
 vec3 d = fwidth(v_Barycentric);
 vec3 a3 = smoothstep(vec3(0.0), d * wireframeLineWidth, v_Barycentric);
 return min(min(a3.x, a3.y), a3.z);
}
#endif

@end


@export ecgl.common.wireframe.fragmentMain

#if defined(WIREFRAME_QUAD) || defined(WIREFRAME_TRIANGLE)
 if (wireframeLineWidth > 0.) {
 vec4 lineColor = wireframeLineColor;
#ifdef SRGB_DECODE
 lineColor = sRGBToLinear(lineColor);
#endif

 gl_FragColor.rgb = mix(gl_FragColor.rgb, lineColor.rgb, (1.0 - edgeFactor()) * lineColor.a);
 }
#endif
@end




@export ecgl.common.bumpMap.header

#ifdef BUMPMAP_ENABLED
uniform sampler2D bumpMap;
uniform float bumpScale : 1.0;


vec3 bumpNormal(vec3 surfPos, vec3 surfNormal, vec3 baseNormal)
{
 vec2 dSTdx = dFdx(v_Texcoord);
 vec2 dSTdy = dFdy(v_Texcoord);

 float Hll = bumpScale * texture2D(bumpMap, v_Texcoord).x;
 float dHx = bumpScale * texture2D(bumpMap, v_Texcoord + dSTdx).x - Hll;
 float dHy = bumpScale * texture2D(bumpMap, v_Texcoord + dSTdy).x - Hll;

 vec3 vSigmaX = dFdx(surfPos);
 vec3 vSigmaY = dFdy(surfPos);
 vec3 vN = surfNormal;

 vec3 R1 = cross(vSigmaY, vN);
 vec3 R2 = cross(vN, vSigmaX);

 float fDet = dot(vSigmaX, R1);

 vec3 vGrad = sign(fDet) * (dHx * R1 + dHy * R2);
 return normalize(abs(fDet) * baseNormal - vGrad);

}
#endif

@end

@export ecgl.common.normalMap.vertexHeader

#ifdef NORMALMAP_ENABLED
attribute vec4 tangent : TANGENT;
varying vec3 v_Tangent;
varying vec3 v_Bitangent;
#endif

@end

@export ecgl.common.normalMap.vertexMain

#ifdef NORMALMAP_ENABLED
 if (dot(tangent, tangent) > 0.0) {
 v_Tangent = normalize((worldInverseTranspose * vec4(tangent.xyz, 0.0)).xyz);
 v_Bitangent = normalize(cross(v_Normal, v_Tangent) * tangent.w);
 }
#endif

@end


@export ecgl.common.normalMap.fragmentHeader

#ifdef NORMALMAP_ENABLED
uniform sampler2D normalMap;
varying vec3 v_Tangent;
varying vec3 v_Bitangent;
#endif

@end

@export ecgl.common.normalMap.fragmentMain
#ifdef NORMALMAP_ENABLED
 if (dot(v_Tangent, v_Tangent) > 0.0) {
 vec3 normalTexel = texture2D(normalMap, v_DetailTexcoord).xyz;
 if (dot(normalTexel, normalTexel) > 0.0) { N = normalTexel * 2.0 - 1.0;
 mat3 tbn = mat3(v_Tangent, v_Bitangent, v_Normal);
 N = normalize(tbn * N);
 }
 }
#endif
@end



@export ecgl.common.vertexAnimation.header

#ifdef VERTEX_ANIMATION
attribute vec3 prevPosition;
attribute vec3 prevNormal;
uniform float percent;
#endif

@end

@export ecgl.common.vertexAnimation.main

#ifdef VERTEX_ANIMATION
 vec3 pos = mix(prevPosition, position, percent);
 vec3 norm = mix(prevNormal, normal, percent);
#else
 vec3 pos = position;
 vec3 norm = normal;
#endif

@end


@export ecgl.common.ssaoMap.header
#ifdef SSAOMAP_ENABLED
uniform sampler2D ssaoMap;
uniform vec4 viewport : VIEWPORT;
#endif
@end

@export ecgl.common.ssaoMap.main
 float ao = 1.0;
#ifdef SSAOMAP_ENABLED
 ao = texture2D(ssaoMap, (gl_FragCoord.xy - viewport.xy) / viewport.zw).r;
#endif
@end




@export ecgl.common.diffuseLayer.header

#if (LAYER_DIFFUSEMAP_COUNT > 0)
uniform float layerDiffuseIntensity[LAYER_DIFFUSEMAP_COUNT];
uniform sampler2D layerDiffuseMap[LAYER_DIFFUSEMAP_COUNT];
#endif

@end

@export ecgl.common.emissiveLayer.header

#if (LAYER_EMISSIVEMAP_COUNT > 0)
uniform float layerEmissionIntensity[LAYER_EMISSIVEMAP_COUNT];
uniform sampler2D layerEmissiveMap[LAYER_EMISSIVEMAP_COUNT];
#endif

@end

@export ecgl.common.layers.header
@import ecgl.common.diffuseLayer.header
@import ecgl.common.emissiveLayer.header
@end

@export ecgl.common.diffuseLayer.main

#if (LAYER_DIFFUSEMAP_COUNT > 0)
 for (int _idx_ = 0; _idx_ < LAYER_DIFFUSEMAP_COUNT; _idx_++) {{
 float intensity = layerDiffuseIntensity[_idx_];
 vec4 texel2 = texture2D(layerDiffuseMap[_idx_], v_Texcoord);
 #ifdef SRGB_DECODE
 texel2 = sRGBToLinear(texel2);
 #endif
 albedoTexel.rgb = mix(albedoTexel.rgb, texel2.rgb * intensity, texel2.a);
 albedoTexel.a = texel2.a + (1.0 - texel2.a) * albedoTexel.a;
 }}
#endif

@end

@export ecgl.common.emissiveLayer.main

#if (LAYER_EMISSIVEMAP_COUNT > 0)
 for (int _idx_ = 0; _idx_ < LAYER_EMISSIVEMAP_COUNT; _idx_++)
 {{
 vec4 texel2 = texture2D(layerEmissiveMap[_idx_], v_Texcoord) * layerEmissionIntensity[_idx_];
 #ifdef SRGB_DECODE
 texel2 = sRGBToLinear(texel2);
 #endif
 float intensity = layerEmissionIntensity[_idx_];
 gl_FragColor.rgb += texel2.rgb * texel2.a * intensity;
 }}
#endif

@end
`,k9=`@export ecgl.color.vertex

uniform mat4 worldViewProjection : WORLDVIEWPROJECTION;

@import ecgl.common.uv.header

attribute vec2 texcoord : TEXCOORD_0;
attribute vec3 position: POSITION;

@import ecgl.common.wireframe.vertexHeader

#ifdef VERTEX_COLOR
attribute vec4 a_Color : COLOR;
varying vec4 v_Color;
#endif

#ifdef VERTEX_ANIMATION
attribute vec3 prevPosition;
uniform float percent : 1.0;
#endif

#ifdef ATMOSPHERE_ENABLED
attribute vec3 normal: NORMAL;
uniform mat4 worldInverseTranspose : WORLDINVERSETRANSPOSE;
varying vec3 v_Normal;
#endif

void main()
{
#ifdef VERTEX_ANIMATION
 vec3 pos = mix(prevPosition, position, percent);
#else
 vec3 pos = position;
#endif

 gl_Position = worldViewProjection * vec4(pos, 1.0);

 @import ecgl.common.uv.main

#ifdef VERTEX_COLOR
 v_Color = a_Color;
#endif

#ifdef ATMOSPHERE_ENABLED
 v_Normal = normalize((worldInverseTranspose * vec4(normal, 0.0)).xyz);
#endif

 @import ecgl.common.wireframe.vertexMain

}

@end

@export ecgl.color.fragment

#define LAYER_DIFFUSEMAP_COUNT 0
#define LAYER_EMISSIVEMAP_COUNT 0

uniform sampler2D diffuseMap;
uniform sampler2D detailMap;

uniform vec4 color : [1.0, 1.0, 1.0, 1.0];

#ifdef ATMOSPHERE_ENABLED
uniform mat4 viewTranspose: VIEWTRANSPOSE;
uniform vec3 glowColor;
uniform float glowPower;
varying vec3 v_Normal;
#endif

#ifdef VERTEX_COLOR
varying vec4 v_Color;
#endif

@import ecgl.common.layers.header

@import ecgl.common.uv.fragmentHeader

@import ecgl.common.wireframe.fragmentHeader

@import clay.util.srgb

void main()
{
#ifdef SRGB_DECODE
 gl_FragColor = sRGBToLinear(color);
#else
 gl_FragColor = color;
#endif

#ifdef VERTEX_COLOR
 gl_FragColor *= v_Color;
#endif

 @import ecgl.common.albedo.main

 @import ecgl.common.diffuseLayer.main

 gl_FragColor *= albedoTexel;

#ifdef ATMOSPHERE_ENABLED
 float atmoIntensity = pow(1.0 - dot(v_Normal, (viewTranspose * vec4(0.0, 0.0, 1.0, 0.0)).xyz), glowPower);
 gl_FragColor.rgb += glowColor * atmoIntensity;
#endif

 @import ecgl.common.emissiveLayer.main

 @import ecgl.common.wireframe.fragmentMain

}
@end`,H9=`/**
 * http: */

@export ecgl.lambert.vertex

@import ecgl.common.transformUniforms

@import ecgl.common.uv.header


@import ecgl.common.attributes

@import ecgl.common.wireframe.vertexHeader

#ifdef VERTEX_COLOR
attribute vec4 a_Color : COLOR;
varying vec4 v_Color;
#endif


@import ecgl.common.vertexAnimation.header


varying vec3 v_Normal;
varying vec3 v_WorldPosition;

void main()
{
 @import ecgl.common.uv.main

 @import ecgl.common.vertexAnimation.main


 gl_Position = worldViewProjection * vec4(pos, 1.0);

 v_Normal = normalize((worldInverseTranspose * vec4(norm, 0.0)).xyz);
 v_WorldPosition = (world * vec4(pos, 1.0)).xyz;

#ifdef VERTEX_COLOR
 v_Color = a_Color;
#endif

 @import ecgl.common.wireframe.vertexMain
}

@end


@export ecgl.lambert.fragment

#define LAYER_DIFFUSEMAP_COUNT 0
#define LAYER_EMISSIVEMAP_COUNT 0

#define NORMAL_UP_AXIS 1
#define NORMAL_FRONT_AXIS 2

@import ecgl.common.uv.fragmentHeader

varying vec3 v_Normal;
varying vec3 v_WorldPosition;

uniform sampler2D diffuseMap;
uniform sampler2D detailMap;

@import ecgl.common.layers.header

uniform float emissionIntensity: 1.0;

uniform vec4 color : [1.0, 1.0, 1.0, 1.0];

uniform mat4 viewInverse : VIEWINVERSE;

#ifdef ATMOSPHERE_ENABLED
uniform mat4 viewTranspose: VIEWTRANSPOSE;
uniform vec3 glowColor;
uniform float glowPower;
#endif

#ifdef AMBIENT_LIGHT_COUNT
@import clay.header.ambient_light
#endif
#ifdef AMBIENT_SH_LIGHT_COUNT
@import clay.header.ambient_sh_light
#endif

#ifdef DIRECTIONAL_LIGHT_COUNT
@import clay.header.directional_light
#endif

#ifdef VERTEX_COLOR
varying vec4 v_Color;
#endif


@import ecgl.common.ssaoMap.header

@import ecgl.common.bumpMap.header

@import clay.util.srgb

@import ecgl.common.wireframe.fragmentHeader

@import clay.plugin.compute_shadow_map

void main()
{
#ifdef SRGB_DECODE
 gl_FragColor = sRGBToLinear(color);
#else
 gl_FragColor = color;
#endif

#ifdef VERTEX_COLOR
 #ifdef SRGB_DECODE
 gl_FragColor *= sRGBToLinear(v_Color);
 #else
 gl_FragColor *= v_Color;
 #endif
#endif

 @import ecgl.common.albedo.main

 @import ecgl.common.diffuseLayer.main

 gl_FragColor *= albedoTexel;

 vec3 N = v_Normal;
#ifdef DOUBLE_SIDED
 vec3 eyePos = viewInverse[3].xyz;
 vec3 V = normalize(eyePos - v_WorldPosition);

 if (dot(N, V) < 0.0) {
 N = -N;
 }
#endif

 float ambientFactor = 1.0;

#ifdef BUMPMAP_ENABLED
 N = bumpNormal(v_WorldPosition, v_Normal, N);
 ambientFactor = dot(v_Normal, N);
#endif

 vec3 N2 = vec3(N.x, N[NORMAL_UP_AXIS], N[NORMAL_FRONT_AXIS]);

 vec3 diffuseColor = vec3(0.0, 0.0, 0.0);

 @import ecgl.common.ssaoMap.main

#ifdef AMBIENT_LIGHT_COUNT
 for(int i = 0; i < AMBIENT_LIGHT_COUNT; i++)
 {
 diffuseColor += ambientLightColor[i] * ambientFactor * ao;
 }
#endif
#ifdef AMBIENT_SH_LIGHT_COUNT
 for(int _idx_ = 0; _idx_ < AMBIENT_SH_LIGHT_COUNT; _idx_++)
 {{
 diffuseColor += calcAmbientSHLight(_idx_, N2) * ambientSHLightColor[_idx_] * ao;
 }}
#endif
#ifdef DIRECTIONAL_LIGHT_COUNT
#if defined(DIRECTIONAL_LIGHT_SHADOWMAP_COUNT)
 float shadowContribsDir[DIRECTIONAL_LIGHT_COUNT];
 if(shadowEnabled)
 {
 computeShadowOfDirectionalLights(v_WorldPosition, shadowContribsDir);
 }
#endif
 for(int i = 0; i < DIRECTIONAL_LIGHT_COUNT; i++)
 {
 vec3 lightDirection = -directionalLightDirection[i];
 vec3 lightColor = directionalLightColor[i];

 float shadowContrib = 1.0;
#if defined(DIRECTIONAL_LIGHT_SHADOWMAP_COUNT)
 if (shadowEnabled)
 {
 shadowContrib = shadowContribsDir[i];
 }
#endif

 float ndl = dot(N, normalize(lightDirection)) * shadowContrib;

 diffuseColor += lightColor * clamp(ndl, 0.0, 1.0);
 }
#endif

 gl_FragColor.rgb *= diffuseColor;

#ifdef ATMOSPHERE_ENABLED
 float atmoIntensity = pow(1.0 - dot(v_Normal, (viewTranspose * vec4(0.0, 0.0, 1.0, 0.0)).xyz), glowPower);
 gl_FragColor.rgb += glowColor * atmoIntensity;
#endif

 @import ecgl.common.emissiveLayer.main

 @import ecgl.common.wireframe.fragmentMain
}

@end`,W9=`@export ecgl.realistic.vertex

@import ecgl.common.transformUniforms

@import ecgl.common.uv.header

@import ecgl.common.attributes


@import ecgl.common.wireframe.vertexHeader

#ifdef VERTEX_COLOR
attribute vec4 a_Color : COLOR;
varying vec4 v_Color;
#endif

#ifdef NORMALMAP_ENABLED
attribute vec4 tangent : TANGENT;
varying vec3 v_Tangent;
varying vec3 v_Bitangent;
#endif

@import ecgl.common.vertexAnimation.header

varying vec3 v_Normal;
varying vec3 v_WorldPosition;

void main()
{

 @import ecgl.common.uv.main

 @import ecgl.common.vertexAnimation.main

 gl_Position = worldViewProjection * vec4(pos, 1.0);

 v_Normal = normalize((worldInverseTranspose * vec4(norm, 0.0)).xyz);
 v_WorldPosition = (world * vec4(pos, 1.0)).xyz;

#ifdef VERTEX_COLOR
 v_Color = a_Color;
#endif

#ifdef NORMALMAP_ENABLED
 v_Tangent = normalize((worldInverseTranspose * vec4(tangent.xyz, 0.0)).xyz);
 v_Bitangent = normalize(cross(v_Normal, v_Tangent) * tangent.w);
#endif

 @import ecgl.common.wireframe.vertexMain

}

@end



@export ecgl.realistic.fragment

#define LAYER_DIFFUSEMAP_COUNT 0
#define LAYER_EMISSIVEMAP_COUNT 0
#define PI 3.14159265358979
#define ROUGHNESS_CHANEL 0
#define METALNESS_CHANEL 1

#define NORMAL_UP_AXIS 1
#define NORMAL_FRONT_AXIS 2

#ifdef VERTEX_COLOR
varying vec4 v_Color;
#endif

@import ecgl.common.uv.fragmentHeader

varying vec3 v_Normal;
varying vec3 v_WorldPosition;

uniform sampler2D diffuseMap;

uniform sampler2D detailMap;
uniform sampler2D metalnessMap;
uniform sampler2D roughnessMap;

@import ecgl.common.layers.header

uniform float emissionIntensity: 1.0;

uniform vec4 color : [1.0, 1.0, 1.0, 1.0];

uniform float metalness : 0.0;
uniform float roughness : 0.5;

uniform mat4 viewInverse : VIEWINVERSE;

#ifdef ATMOSPHERE_ENABLED
uniform mat4 viewTranspose: VIEWTRANSPOSE;
uniform vec3 glowColor;
uniform float glowPower;
#endif

#ifdef AMBIENT_LIGHT_COUNT
@import clay.header.ambient_light
#endif

#ifdef AMBIENT_SH_LIGHT_COUNT
@import clay.header.ambient_sh_light
#endif

#ifdef AMBIENT_CUBEMAP_LIGHT_COUNT
@import clay.header.ambient_cubemap_light
#endif

#ifdef DIRECTIONAL_LIGHT_COUNT
@import clay.header.directional_light
#endif

@import ecgl.common.normalMap.fragmentHeader

@import ecgl.common.ssaoMap.header

@import ecgl.common.bumpMap.header

@import clay.util.srgb

@import clay.util.rgbm

@import ecgl.common.wireframe.fragmentHeader

@import clay.plugin.compute_shadow_map

vec3 F_Schlick(float ndv, vec3 spec) {
 return spec + (1.0 - spec) * pow(1.0 - ndv, 5.0);
}

float D_Phong(float g, float ndh) {
 float a = pow(8192.0, g);
 return (a + 2.0) / 8.0 * pow(ndh, a);
}

void main()
{
 vec4 albedoColor = color;

 vec3 eyePos = viewInverse[3].xyz;
 vec3 V = normalize(eyePos - v_WorldPosition);
#ifdef VERTEX_COLOR
 #ifdef SRGB_DECODE
 albedoColor *= sRGBToLinear(v_Color);
 #else
 albedoColor *= v_Color;
 #endif
#endif

 @import ecgl.common.albedo.main

 @import ecgl.common.diffuseLayer.main

 albedoColor *= albedoTexel;

 float m = metalness;

#ifdef METALNESSMAP_ENABLED
 float m2 = texture2D(metalnessMap, v_DetailTexcoord)[METALNESS_CHANEL];
 m = clamp(m2 + (m - 0.5) * 2.0, 0.0, 1.0);
#endif

 vec3 baseColor = albedoColor.rgb;
 albedoColor.rgb = baseColor * (1.0 - m);
 vec3 specFactor = mix(vec3(0.04), baseColor, m);

 float g = 1.0 - roughness;

#ifdef ROUGHNESSMAP_ENABLED
 float g2 = 1.0 - texture2D(roughnessMap, v_DetailTexcoord)[ROUGHNESS_CHANEL];
 g = clamp(g2 + (g - 0.5) * 2.0, 0.0, 1.0);
#endif

 vec3 N = v_Normal;

#ifdef DOUBLE_SIDED
 if (dot(N, V) < 0.0) {
 N = -N;
 }
#endif

 float ambientFactor = 1.0;

#ifdef BUMPMAP_ENABLED
 N = bumpNormal(v_WorldPosition, v_Normal, N);
 ambientFactor = dot(v_Normal, N);
#endif

@import ecgl.common.normalMap.fragmentMain

 vec3 N2 = vec3(N.x, N[NORMAL_UP_AXIS], N[NORMAL_FRONT_AXIS]);

 vec3 diffuseTerm = vec3(0.0);
 vec3 specularTerm = vec3(0.0);

 float ndv = clamp(dot(N, V), 0.0, 1.0);
 vec3 fresnelTerm = F_Schlick(ndv, specFactor);

 @import ecgl.common.ssaoMap.main

#ifdef AMBIENT_LIGHT_COUNT
 for(int _idx_ = 0; _idx_ < AMBIENT_LIGHT_COUNT; _idx_++)
 {{
 diffuseTerm += ambientLightColor[_idx_] * ambientFactor * ao;
 }}
#endif

#ifdef AMBIENT_SH_LIGHT_COUNT
 for(int _idx_ = 0; _idx_ < AMBIENT_SH_LIGHT_COUNT; _idx_++)
 {{
 diffuseTerm += calcAmbientSHLight(_idx_, N2) * ambientSHLightColor[_idx_] * ao;
 }}
#endif

#ifdef DIRECTIONAL_LIGHT_COUNT
#if defined(DIRECTIONAL_LIGHT_SHADOWMAP_COUNT)
 float shadowContribsDir[DIRECTIONAL_LIGHT_COUNT];
 if(shadowEnabled)
 {
 computeShadowOfDirectionalLights(v_WorldPosition, shadowContribsDir);
 }
#endif
 for(int _idx_ = 0; _idx_ < DIRECTIONAL_LIGHT_COUNT; _idx_++)
 {{
 vec3 L = -directionalLightDirection[_idx_];
 vec3 lc = directionalLightColor[_idx_];

 vec3 H = normalize(L + V);
 float ndl = clamp(dot(N, normalize(L)), 0.0, 1.0);
 float ndh = clamp(dot(N, H), 0.0, 1.0);

 float shadowContrib = 1.0;
#if defined(DIRECTIONAL_LIGHT_SHADOWMAP_COUNT)
 if (shadowEnabled)
 {
 shadowContrib = shadowContribsDir[_idx_];
 }
#endif

 vec3 li = lc * ndl * shadowContrib;

 diffuseTerm += li;
 specularTerm += li * fresnelTerm * D_Phong(g, ndh);
 }}
#endif


#ifdef AMBIENT_CUBEMAP_LIGHT_COUNT
 vec3 L = reflect(-V, N);
 L = vec3(L.x, L[NORMAL_UP_AXIS], L[NORMAL_FRONT_AXIS]);
 float rough2 = clamp(1.0 - g, 0.0, 1.0);
 float bias2 = rough2 * 5.0;
 vec2 brdfParam2 = texture2D(ambientCubemapLightBRDFLookup[0], vec2(rough2, ndv)).xy;
 vec3 envWeight2 = specFactor * brdfParam2.x + brdfParam2.y;
 vec3 envTexel2;
 for(int _idx_ = 0; _idx_ < AMBIENT_CUBEMAP_LIGHT_COUNT; _idx_++)
 {{
 envTexel2 = RGBMDecode(textureCubeLodEXT(ambientCubemapLightCubemap[_idx_], L, bias2), 8.12);
 specularTerm += ambientCubemapLightColor[_idx_] * envTexel2 * envWeight2 * ao;
 }}
#endif

 gl_FragColor.rgb = albedoColor.rgb * diffuseTerm + specularTerm;
 gl_FragColor.a = albedoColor.a;

#ifdef ATMOSPHERE_ENABLED
 float atmoIntensity = pow(1.0 - dot(v_Normal, (viewTranspose * vec4(0.0, 0.0, 1.0, 0.0)).xyz), glowPower);
 gl_FragColor.rgb += glowColor * atmoIntensity;
#endif

#ifdef SRGB_ENCODE
 gl_FragColor = linearTosRGB(gl_FragColor);
#endif

 @import ecgl.common.emissiveLayer.main

 @import ecgl.common.wireframe.fragmentMain
}

@end`,$9=`@export ecgl.hatching.vertex

@import ecgl.realistic.vertex

@end


@export ecgl.hatching.fragment

#define NORMAL_UP_AXIS 1
#define NORMAL_FRONT_AXIS 2

@import ecgl.common.uv.fragmentHeader

varying vec3 v_Normal;
varying vec3 v_WorldPosition;

uniform vec4 color : [0.0, 0.0, 0.0, 1.0];
uniform vec4 paperColor : [1.0, 1.0, 1.0, 1.0];

uniform mat4 viewInverse : VIEWINVERSE;

#ifdef AMBIENT_LIGHT_COUNT
@import clay.header.ambient_light
#endif
#ifdef AMBIENT_SH_LIGHT_COUNT
@import clay.header.ambient_sh_light
#endif

#ifdef DIRECTIONAL_LIGHT_COUNT
@import clay.header.directional_light
#endif

#ifdef VERTEX_COLOR
varying vec4 v_Color;
#endif


@import ecgl.common.ssaoMap.header

@import ecgl.common.bumpMap.header

@import clay.util.srgb

@import ecgl.common.wireframe.fragmentHeader

@import clay.plugin.compute_shadow_map

uniform sampler2D hatch1;
uniform sampler2D hatch2;
uniform sampler2D hatch3;
uniform sampler2D hatch4;
uniform sampler2D hatch5;
uniform sampler2D hatch6;

float shade(in float tone) {
 vec4 c = vec4(1. ,1., 1., 1.);
 float step = 1. / 6.;
 vec2 uv = v_DetailTexcoord;
 if (tone <= step / 2.0) {
 c = mix(vec4(0.), texture2D(hatch6, uv), 12. * tone);
 }
 else if (tone <= step) {
 c = mix(texture2D(hatch6, uv), texture2D(hatch5, uv), 6. * tone);
 }
 if(tone > step && tone <= 2. * step){
 c = mix(texture2D(hatch5, uv), texture2D(hatch4, uv) , 6. * (tone - step));
 }
 if(tone > 2. * step && tone <= 3. * step){
 c = mix(texture2D(hatch4, uv), texture2D(hatch3, uv), 6. * (tone - 2. * step));
 }
 if(tone > 3. * step && tone <= 4. * step){
 c = mix(texture2D(hatch3, uv), texture2D(hatch2, uv), 6. * (tone - 3. * step));
 }
 if(tone > 4. * step && tone <= 5. * step){
 c = mix(texture2D(hatch2, uv), texture2D(hatch1, uv), 6. * (tone - 4. * step));
 }
 if(tone > 5. * step){
 c = mix(texture2D(hatch1, uv), vec4(1.), 6. * (tone - 5. * step));
 }

 return c.r;
}

const vec3 w = vec3(0.2125, 0.7154, 0.0721);

void main()
{
#ifdef SRGB_DECODE
 vec4 inkColor = sRGBToLinear(color);
#else
 vec4 inkColor = color;
#endif

#ifdef VERTEX_COLOR
 #ifdef SRGB_DECODE
 inkColor *= sRGBToLinear(v_Color);
 #else
 inkColor *= v_Color;
 #endif
#endif

 vec3 N = v_Normal;
#ifdef DOUBLE_SIDED
 vec3 eyePos = viewInverse[3].xyz;
 vec3 V = normalize(eyePos - v_WorldPosition);

 if (dot(N, V) < 0.0) {
 N = -N;
 }
#endif

 float tone = 0.0;

 float ambientFactor = 1.0;

#ifdef BUMPMAP_ENABLED
 N = bumpNormal(v_WorldPosition, v_Normal, N);
 ambientFactor = dot(v_Normal, N);
#endif

 vec3 N2 = vec3(N.x, N[NORMAL_UP_AXIS], N[NORMAL_FRONT_AXIS]);

 @import ecgl.common.ssaoMap.main

#ifdef AMBIENT_LIGHT_COUNT
 for(int i = 0; i < AMBIENT_LIGHT_COUNT; i++)
 {
 tone += dot(ambientLightColor[i], w) * ambientFactor * ao;
 }
#endif
#ifdef AMBIENT_SH_LIGHT_COUNT
 for(int _idx_ = 0; _idx_ < AMBIENT_SH_LIGHT_COUNT; _idx_++)
 {{
 tone += dot(calcAmbientSHLight(_idx_, N2) * ambientSHLightColor[_idx_], w) * ao;
 }}
#endif
#ifdef DIRECTIONAL_LIGHT_COUNT
#if defined(DIRECTIONAL_LIGHT_SHADOWMAP_COUNT)
 float shadowContribsDir[DIRECTIONAL_LIGHT_COUNT];
 if(shadowEnabled)
 {
 computeShadowOfDirectionalLights(v_WorldPosition, shadowContribsDir);
 }
#endif
 for(int i = 0; i < DIRECTIONAL_LIGHT_COUNT; i++)
 {
 vec3 lightDirection = -directionalLightDirection[i];
 float lightTone = dot(directionalLightColor[i], w);

 float shadowContrib = 1.0;
#if defined(DIRECTIONAL_LIGHT_SHADOWMAP_COUNT)
 if (shadowEnabled)
 {
 shadowContrib = shadowContribsDir[i];
 }
#endif

 float ndl = dot(N, normalize(lightDirection)) * shadowContrib;

 tone += lightTone * clamp(ndl, 0.0, 1.0);
 }
#endif

 gl_FragColor = mix(inkColor, paperColor, shade(clamp(tone, 0.0, 1.0)));
 }
@end
`,X9=`@export ecgl.sm.depth.vertex

uniform mat4 worldViewProjection : WORLDVIEWPROJECTION;

attribute vec3 position : POSITION;
attribute vec2 texcoord : TEXCOORD_0;

#ifdef VERTEX_ANIMATION
attribute vec3 prevPosition;
uniform float percent : 1.0;
#endif

varying vec4 v_ViewPosition;
varying vec2 v_Texcoord;

void main(){

#ifdef VERTEX_ANIMATION
 vec3 pos = mix(prevPosition, position, percent);
#else
 vec3 pos = position;
#endif

 v_ViewPosition = worldViewProjection * vec4(pos, 1.0);
 gl_Position = v_ViewPosition;

 v_Texcoord = texcoord;

}
@end



@export ecgl.sm.depth.fragment

@import clay.sm.depth.fragment

@end`;Object.assign(kr.prototype,V9);H.import(lx);H.import(K_);H.import(U9);H.import(k9);H.import(H9);H.import(W9);H.import($9);H.import(X9);function j9(e){return!e||e==="none"}function ux(e){return e instanceof HTMLCanvasElement||e instanceof HTMLImageElement||e instanceof Image}function Z9(e){return e.getZr&&e.setOption}var Y9=On.prototype.addToScene,q9=On.prototype.removeFromScene;On.prototype.addToScene=function(e){if(Y9.call(this,e),this.__zr){var t=this.__zr;e.traverse(function(r){r.__zr=t,r.addAnimatorsToZr&&r.addAnimatorsToZr(t)})}};On.prototype.removeFromScene=function(e){q9.call(this,e),e.traverse(function(t){var r=t.__zr;t.__zr=null,r&&t.removeAnimatorsFromZr&&t.removeAnimatorsFromZr(r)})};Sr.prototype.setTextureImage=function(e,t,r,n){if(this.shader){var a=r.getZr(),i=this,o;return i.autoUpdateTextureStatus=!1,i.disableTexture(e),j9(t)||(o=he.loadTexture(t,r,n,function(s){i.enableTexture(e),a&&a.refresh()}),i.set(e,o)),o}};var he={};he.Renderer=ro;he.Node=kr;he.Mesh=oa;he.Shader=H;he.Material=Sr;he.Texture=ie;he.Texture2D=_e;he.Geometry=Me;he.SphereGeometry=E9;he.PlaneGeometry=Yl;he.CubeGeometry=ox;he.AmbientLight=L9;he.DirectionalLight=M9;he.PointLight=I9;he.SpotLight=N9;he.PerspectiveCamera=bt;he.OrthographicCamera=ni;he.Vector2=lr;he.Vector3=X;he.Vector4=O9;he.Quaternion=J_;he.Matrix2=B9;he.Matrix2d=F9;he.Matrix3=z9;he.Matrix4=ne;he.Plane=nx;he.Ray=ol;he.BoundingBox=$t;he.Frustum=ld;var ms=null;function K9(){return ms!==null||(ms=ca.createBlank("rgba(255,255,255,0)").image),ms}function S1(e){return Math.pow(2,Math.round(Math.log(e)/Math.LN2))}function T1(e){if((e.wrapS===ie.REPEAT||e.wrapT===ie.REPEAT)&&e.image){var t=S1(e.width),r=S1(e.height);if(t!==e.width||r!==e.height){var n=document.createElement("canvas");n.width=t,n.height=r;var a=n.getContext("2d");a.drawImage(e.image,0,0,t,r),e.image=n}}}he.loadTexture=function(e,t,r,n){typeof r=="function"&&(n=r,r={}),r=r||{};for(var a=Object.keys(r).sort(),i="",o=0;o<a.length;o++)i+=a[o]+"_"+r[a[o]]+"_";var s=t.__textureCache=t.__textureCache||new L3(20);if(Z9(e)){var l=e.__textureid__,u=s.get(i+l);if(u)u.texture.surface.setECharts(e),n&&n(u.texture);else{var c=new l9(e);c.onupdate=function(){t.getZr().refresh()},u={texture:c.getTexture()};for(var o=0;o<a.length;o++)u.texture[a[o]]=r[a[o]];l=e.__textureid__||"__ecgl_ec__"+u.texture.__uid__,e.__textureid__=l,s.put(i+l,u),n&&n(u.texture)}return u.texture}else if(ux(e)){var l=e.__textureid__,u=s.get(i+l);if(!u){u={texture:new he.Texture2D({image:e})};for(var o=0;o<a.length;o++)u.texture[a[o]]=r[a[o]];l=e.__textureid__||"__ecgl_image__"+u.texture.__uid__,e.__textureid__=l,s.put(i+l,u),T1(u.texture),n&&n(u.texture)}return u.texture}else{var u=s.get(i+e);if(u)u.callbacks?u.callbacks.push(n):n&&n(u.texture);else if(e.match(/.hdr$|^data:application\/octet-stream/)){u={callbacks:[n]};var h=ca.loadTexture(e,{exposure:r.exposure,fileType:"hdr"},function(){h.dirty(),u.callbacks.forEach(function(v){v&&v(h)}),u.callbacks=null});u.texture=h,s.put(i+e,u)}else{for(var h=new he.Texture2D({image:new Image}),o=0;o<a.length;o++)h[a[o]]=r[a[o]];u={texture:h,callbacks:[n]};var f=h.image;f.onload=function(){h.image=f,T1(h),h.dirty(),u.callbacks.forEach(function(p){p&&p(h)}),u.callbacks=null},f.crossOrigin="Anonymous",f.src=e,h.image=K9(),s.put(i+e,u)}return u.texture}};he.createAmbientCubemap=function(e,t,r,n){e=e||{};var a=e.texture,i=Se.firstNotNull(e.exposure,1),o=new m9({intensity:Se.firstNotNull(e.specularIntensity,1)}),s=new _9({intensity:Se.firstNotNull(e.diffuseIntensity,1),coefficients:[.844,.712,.691,-.037,.083,.167,.343,.288,.299,-.041,-.021,-.009,-.003,-.041,-.064,-.011,-.007,-.004,-.031,.034,.081,-.06,-.049,-.06,.046,.056,.05]});return o.cubemap=he.loadTexture(a,r,{exposure:i},function(){o.cubemap.flipY=!1,o.prefilter(t,32),s.coefficients=b9.projectEnvironmentMap(t,o.cubemap,{lod:1}),n&&n()}),{specular:o,diffuse:s}};he.createBlankTexture=ca.createBlank;he.isImage=ux;he.additiveBlend=function(e){e.blendEquation(e.FUNC_ADD),e.blendFunc(e.SRC_ALPHA,e.ONE)};he.parseColor=function(e,t){return e instanceof Array?(t||(t=[]),t[0]=e[0],t[1]=e[1],t[2]=e[2],e.length>3?t[3]=e[3]:t[3]=1,t):(t=Um(e||"#000",t)||[0,0,0,0],t[0]/=255,t[1]/=255,t[2]/=255,t)};he.directionFromAlphaBeta=function(e,t){var r=e/180*Math.PI+Math.PI/2,n=-t/180*Math.PI+Math.PI/2,a=[],i=Math.sin(r);return a[0]=i*Math.cos(n),a[1]=-Math.cos(r),a[2]=i*Math.sin(n),a};he.getShadowResolution=function(e){var t=1024;switch(e){case"low":t=512;break;case"medium":break;case"high":t=2048;break;case"ultra":t=4096;break}return t};he.COMMON_SHADERS=["lambert","color","realistic","hatching","shadow"];he.createShader=function(e){e==="ecgl.shadow"&&(e="ecgl.displayShadow");var t=H.source(e+".vertex"),r=H.source(e+".fragment");t||console.error("Vertex shader of '%s' not exits",e),r||console.error("Fragment shader of '%s' not exits",e);var n=new H(t,r);return n.name=e,n};he.createMaterial=function(e,t){t instanceof Array||(t=[t]);var r=he.createShader(e),n=new Sr({shader:r});return t.forEach(function(a){typeof a=="string"&&n.define(a)}),n};he.setMaterialFromModel=function(e,t,r,n){t.autoUpdateTextureStatus=!1;var a=r.getModel(e+"Material"),i=a.get("detailTexture"),o=Se.firstNotNull(a.get("textureTiling"),1),s=Se.firstNotNull(a.get("textureOffset"),0);typeof o=="number"&&(o=[o,o]),typeof s=="number"&&(s=[s,s]);var l=o[0]>1||o[1]>1?he.Texture.REPEAT:he.Texture.CLAMP_TO_EDGE,u={anisotropic:8,wrapS:l,wrapT:l};if(e==="realistic"){var c=a.get("roughness"),h=a.get("metalness");h!=null?isNaN(h)&&(t.setTextureImage("metalnessMap",h,n,u),h=Se.firstNotNull(a.get("metalnessAdjust"),.5)):h=0,c!=null?isNaN(c)&&(t.setTextureImage("roughnessMap",c,n,u),c=Se.firstNotNull(a.get("roughnessAdjust"),.5)):c=.5;var f=a.get("normalTexture");t.setTextureImage("detailMap",i,n,u),t.setTextureImage("normalMap",f,n,u),t.set({roughness:c,metalness:h,detailUvRepeat:o,detailUvOffset:s})}else if(e==="lambert")t.setTextureImage("detailMap",i,n,u),t.set({detailUvRepeat:o,detailUvOffset:s});else if(e==="color")t.setTextureImage("detailMap",i,n,u),t.set({detailUvRepeat:o,detailUvOffset:s});else if(e==="hatching"){var d=a.get("hatchingTextures")||[];d.length<6;for(var v=0;v<6;v++)t.setTextureImage("hatch"+(v+1),d[v],n,{anisotropic:8,wrapS:he.Texture.REPEAT,wrapT:he.Texture.REPEAT});t.set({detailUvRepeat:o,detailUvOffset:s})}};he.updateVertexAnimation=function(e,t,r,n){var a=n.get("animation"),i=n.get("animationDurationUpdate"),o=n.get("animationEasingUpdate"),s=r.shadowDepthMaterial;if(a&&t&&i>0&&t.geometry.vertexCount===r.geometry.vertexCount){r.material.define("vertex","VERTEX_ANIMATION"),r.ignorePreZ=!0,s&&s.define("vertex","VERTEX_ANIMATION");for(var l=0;l<e.length;l++)r.geometry.attributes[e[l][0]].value=t.geometry.attributes[e[l][1]].value;r.geometry.dirty(),r.__percent=0,r.material.set("percent",0),r.stopAnimation(),r.animate().when(i,{__percent:1}).during(function(){r.material.set("percent",r.__percent),s&&s.set("percent",r.__percent)}).done(function(){r.ignorePreZ=!1,r.material.undefine("vertex","VERTEX_ANIMATION"),s&&s.undefine("vertex","VERTEX_ANIMATION")}).start(o)}else r.material.undefine("vertex","VERTEX_ANIMATION"),s&&s.undefine("vertex","VERTEX_ANIMATION")};const D=he;var ke=function(e,t){this.id=e,this.zr=t;try{this.renderer=new ro({clearBit:0,devicePixelRatio:t.painter.dpr,preserveDrawingBuffer:!0,premultipliedAlpha:!0}),this.renderer.resize(t.painter.getWidth(),t.painter.getHeight())}catch(n){this.renderer=null,this.dom=document.createElement("div"),this.dom.style.cssText="position:absolute; left: 0; top: 0; right: 0; bottom: 0;",this.dom.className="ecgl-nowebgl",this.dom.innerHTML="Sorry, your browser does not support WebGL",console.error(n);return}this.onglobalout=this.onglobalout.bind(this),t.on("globalout",this.onglobalout),this.dom=this.renderer.canvas;var r=this.dom.style;r.position="absolute",r.left="0",r.top="0",this.views=[],this._picking=new mI({renderer:this.renderer}),this._viewsToDispose=[],this._accumulatingId=0,this._zrEventProxy=new Et({shape:{x:-1,y:-1,width:2,height:2},__isGLToZRProxy:!0}),this._backgroundColor=null,this._disposed=!1};ke.prototype.setUnpainted=function(){};ke.prototype.addView=function(e){if(e.layer!==this){var t=this._viewsToDispose.indexOf(e);t>=0&&this._viewsToDispose.splice(t,1),this.views.push(e),e.layer=this;var r=this.zr;e.scene.traverse(function(n){n.__zr=r,n.addAnimatorsToZr&&n.addAnimatorsToZr(r)})}};function cx(e){var t=e.__zr;e.__zr=null,t&&e.removeAnimatorsFromZr&&e.removeAnimatorsFromZr(t)}ke.prototype.removeView=function(e){if(e.layer===this){var t=this.views.indexOf(e);t>=0&&(this.views.splice(t,1),e.scene.traverse(cx,this),e.layer=null,this._viewsToDispose.push(e))}};ke.prototype.removeViewsAll=function(){this.views.forEach(function(e){e.scene.traverse(cx,this),e.layer=null,this._viewsToDispose.push(e)},this),this.views.length=0};ke.prototype.resize=function(e,t){var r=this.renderer;r.resize(e,t)};ke.prototype.clear=function(){var e=this.renderer.gl,t=this._backgroundColor||[0,0,0,0];e.clearColor(t[0],t[1],t[2],t[3]),e.depthMask(!0),e.colorMask(!0,!0,!0,!0),e.clear(e.DEPTH_BUFFER_BIT|e.COLOR_BUFFER_BIT)};ke.prototype.clearDepth=function(){var e=this.renderer.gl;e.clear(e.DEPTH_BUFFER_BIT)};ke.prototype.clearColor=function(){var e=this.renderer.gl;e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT)};ke.prototype.needsRefresh=function(){this.zr.refresh()};ke.prototype.refresh=function(e){this._backgroundColor=e?D.parseColor(e):[0,0,0,0],this.renderer.clearColor=this._backgroundColor;for(var t=0;t<this.views.length;t++)this.views[t].prepareRender(this.renderer);this._doRender(!1),this._trackAndClean();for(var t=0;t<this._viewsToDispose.length;t++)this._viewsToDispose[t].dispose(this.renderer);this._viewsToDispose.length=0,this._startAccumulating()};ke.prototype.renderToCanvas=function(e){this._startAccumulating(!0),e.drawImage(this.dom,0,0,e.canvas.width,e.canvas.height)};ke.prototype._doRender=function(e){this.clear(),this.renderer.saveViewport();for(var t=0;t<this.views.length;t++)this.views[t].render(this.renderer,e);this.renderer.restoreViewport()};ke.prototype._stopAccumulating=function(){this._accumulatingId=0,clearTimeout(this._accumulatingTimeout)};var J9=1;ke.prototype._startAccumulating=function(e){var t=this;this._stopAccumulating();for(var r=!1,n=0;n<this.views.length;n++)r=this.views[n].needsAccumulate()||r;if(!r)return;function a(i){if(!(!t._accumulatingId||i!==t._accumulatingId)){for(var o=!0,s=0;s<t.views.length;s++)o=t.views[s].isAccumulateFinished()&&r;o||(t._doRender(!0),e?a(i):nh(function(){a(i)}))}}this._accumulatingId=J9++,e?a(t._accumulatingId):this._accumulatingTimeout=setTimeout(function(){a(t._accumulatingId)},50)};ke.prototype._trackAndClean=function(){var e=[],t=[];this._textureList&&(ll(this._textureList),ll(this._geometriesList));for(var r=0;r<this.views.length;r++)Q9(this.views[r].scene,e,t);this._textureList&&(ul(this.renderer,this._textureList),ul(this.renderer,this._geometriesList)),this._textureList=e,this._geometriesList=t};function ll(e){for(var t=0;t<e.length;t++)e[t].__used__=0}function ul(e,t){for(var r=0;r<t.length;r++)t[r].__used__||t[r].dispose(e)}function ys(e,t){e.__used__=e.__used__||0,e.__used__++,e.__used__===1&&t.push(e)}function Q9(e,t,r){var n,a;e.traverse(function(o){if(o.isRenderable()){var s=o.geometry,l=o.material;if(l!==n)for(var u=l.getTextureUniforms(),c=0;c<u.length;c++){var h=u[c],f=l.uniforms[h].value;if(f){if(f instanceof ie)ys(f,t);else if(f instanceof Array)for(var d=0;d<f.length;d++)f[d]instanceof ie&&ys(f[d],t)}}s!==a&&ys(s,r),n=l,a=s}});for(var i=0;i<e.lights.length;i++)e.lights[i].cubemap&&ys(e.lights[i].cubemap,t)}ke.prototype.dispose=function(){this._disposed||(this._stopAccumulating(),this._textureList&&(ll(this._textureList),ll(this._geometriesList),ul(this.renderer,this._textureList),ul(this.renderer,this._geometriesList)),this.zr.off("globalout",this.onglobalout),this._disposed=!0)};ke.prototype.onmousedown=function(e){if(!(e.target&&e.target.__isGLToZRProxy)){e=e.event;var t=this.pickObject(e.offsetX,e.offsetY);t&&(this._dispatchEvent("mousedown",e,t),this._dispatchDataEvent("mousedown",e,t)),this._downX=e.offsetX,this._downY=e.offsetY}};ke.prototype.onmousemove=function(e){if(!(e.target&&e.target.__isGLToZRProxy)){e=e.event;var t=this.pickObject(e.offsetX,e.offsetY),r=t&&t.target,n=this._hovered;this._hovered=t,n&&r!==n.target&&(n.relatedTarget=r,this._dispatchEvent("mouseout",e,n),this.zr.setCursorStyle("default")),this._dispatchEvent("mousemove",e,t),t&&(this.zr.setCursorStyle("pointer"),(!n||r!==n.target)&&this._dispatchEvent("mouseover",e,t)),this._dispatchDataEvent("mousemove",e,t)}};ke.prototype.onmouseup=function(e){if(!(e.target&&e.target.__isGLToZRProxy)){e=e.event;var t=this.pickObject(e.offsetX,e.offsetY);t&&(this._dispatchEvent("mouseup",e,t),this._dispatchDataEvent("mouseup",e,t)),this._upX=e.offsetX,this._upY=e.offsetY}};ke.prototype.onclick=ke.prototype.dblclick=function(e){if(!(e.target&&e.target.__isGLToZRProxy)){var t=this._upX-this._downX,r=this._upY-this._downY;if(!(Math.sqrt(t*t+r*r)>20)){e=e.event;var n=this.pickObject(e.offsetX,e.offsetY);n&&(this._dispatchEvent(e.type,e,n),this._dispatchDataEvent(e.type,e,n));var a=this._clickToSetFocusPoint(e);if(a){var i=a.view.setDOFFocusOnPoint(a.distance);i&&this.zr.refresh()}}}};ke.prototype._clickToSetFocusPoint=function(e){for(var t=this.renderer,r=t.viewport,n=this.views.length-1;n>=0;n--){var a=this.views[n];if(a.hasDOF()&&a.containPoint(e.offsetX,e.offsetY)){this._picking.scene=a.scene,this._picking.camera=a.camera,t.viewport=a.viewport;var i=this._picking.pick(e.offsetX,e.offsetY,!0);if(i)return i.view=a,i}}t.viewport=r};ke.prototype.onglobalout=function(e){var t=this._hovered;t&&this._dispatchEvent("mouseout",e,{target:t.target})};ke.prototype.pickObject=function(e,t){for(var r=[],n=this.renderer,a=n.viewport,i=0;i<this.views.length;i++){var o=this.views[i];o.containPoint(e,t)&&(this._picking.scene=o.scene,this._picking.camera=o.camera,n.viewport=o.viewport,this._picking.pickAll(e,t,r))}return n.viewport=a,r.sort(function(s,l){return s.distance-l.distance}),r[0]};ke.prototype._dispatchEvent=function(e,t,r){r||(r={});var n=r.target;for(r.cancelBubble=!1,r.event=t,r.type=e,r.offsetX=t.offsetX,r.offsetY=t.offsetY;n&&(n.trigger(e,r),n=n.getParent(),!r.cancelBubble););this._dispatchToView(e,r)};ke.prototype._dispatchDataEvent=function(e,t,r){var n=r&&r.target,a=n&&n.dataIndex,i=n&&n.seriesIndex,o=n&&n.eventData,s=!1,l=this._zrEventProxy;l.x=t.offsetX,l.y=t.offsetY,l.update();var u={target:l};const c=et(l);e==="mousemove"&&(a!=null?a!==this._lastDataIndex&&(parseInt(this._lastDataIndex,10)>=0&&(c.dataIndex=this._lastDataIndex,c.seriesIndex=this._lastSeriesIndex,this.zr.handler.dispatchToElement(u,"mouseout",t)),s=!0):o!=null&&o!==this._lastEventData&&(this._lastEventData!=null&&(c.eventData=this._lastEventData,this.zr.handler.dispatchToElement(u,"mouseout",t)),s=!0),this._lastEventData=o,this._lastDataIndex=a,this._lastSeriesIndex=i),c.eventData=o,c.dataIndex=a,c.seriesIndex=i,(o!=null||parseInt(a,10)>=0&&parseInt(i,10)>=0)&&(this.zr.handler.dispatchToElement(u,e,t),s&&this.zr.handler.dispatchToElement(u,"mouseover",t))};ke.prototype._dispatchToView=function(e,t){for(var r=0;r<this.views.length;r++)this.views[r].containPoint(t.offsetX,t.offsetY)&&this.views[r].trigger(e,t)};Object.assign(ke.prototype,ad);const hx=ke;var e6=["bar3D","line3D","map3D","scatter3D","surface","lines3D","scatterGL","scatter3D"];function qi(e,t){if(e&&e[t]&&(e[t].normal||e[t].emphasis)){var r=e[t].normal,n=e[t].emphasis;r&&(e[t]=r),n&&(e.emphasis=e.emphasis||{},e.emphasis[t]=n)}}function t6(e){qi(e,"itemStyle"),qi(e,"lineStyle"),qi(e,"areaStyle"),qi(e,"label")}function _s(e){e&&(e instanceof Array||(e=[e]),R(e,function(t){if(t.axisLabel){var r=t.axisLabel;Object.assign(r,r.textStyle),r.textStyle=null}}))}function r6(e){R(e.series,function(t){pt(e6,t.type)>=0&&(t6(t),t.coordinateSystem==="mapbox"&&(t.coordinateSystem="mapbox3D",e.mapbox3D=e.mapbox))}),_s(e.xAxis3D),_s(e.yAxis3D),_s(e.zAxis3D),_s(e.grid3D),qi(e.geo3D)}function fx(e){this._layers={},this._zr=e}fx.prototype.update=function(e,t){var r=this,n=t.getZr();if(!n.getWidth()||!n.getHeight()){console.warn("Dom has no width or height");return}function a(s){n.setSleepAfterStill(0);var l;s.coordinateSystem&&s.coordinateSystem.model,l=s.get("zlevel");var u=r._layers,c=u[l];if(!c){if(c=u[l]=new hx("gl-"+l,n),n.painter.isSingleCanvas()){c.virtual=!0;var h=new un({z:1e4,style:{image:c.renderer.canvas},silent:!0});c.__hostImage=h,n.add(h)}n.painter.insertLayer(l,c)}return c.__hostImage&&c.__hostImage.setStyle({width:c.renderer.getWidth(),height:c.renderer.getHeight()}),c}function i(s,l){s&&s.traverse(function(u){u.isRenderable&&u.isRenderable()&&(u.ignorePicking=u.$ignorePicking!=null?u.$ignorePicking:l)})}for(var o in this._layers)this._layers[o].removeViewsAll();e.eachComponent(function(s,l){if(s!=="series"){var u=t.getViewOfComponentModel(l),c=l.coordinateSystem;if(u.__ecgl__){var h;if(c){if(!c.viewGL){console.error("Can't find viewGL in coordinateSystem of component "+l.id);return}h=c.viewGL}else{if(!l.viewGL){console.error("Can't find viewGL of component "+l.id);return}h=c.viewGL}var h=c.viewGL,f=a(l);f.addView(h),u.afterRender&&u.afterRender(l,e,t,f),i(u.groupGL,l.get("silent"))}}}),e.eachSeries(function(s){var l=t.getViewOfSeriesModel(s),u=s.coordinateSystem;if(l.__ecgl__){if(u&&!u.viewGL&&!l.viewGL){console.error("Can't find viewGL of series "+l.id);return}var c=u&&u.viewGL||l.viewGL,h=a(s);h.addView(c),l.afterRender&&l.afterRender(s,e,t,h),i(l.groupGL,s.get("silent"))}})};D3(function(e){var t=e.getZr(),r=t.painter.dispose;t.painter.dispose=function(){typeof this.eachOtherLayer=="function"&&this.eachOtherLayer(function(n){n instanceof hx&&n.dispose()}),r.call(this)},t.painter.getRenderedCanvas=function(n){if(n=n||{},this._singleCanvas)return this._layers[0].dom;var a=document.createElement("canvas"),i=n.pixelRatio||this.dpr;a.width=this.getWidth()*i,a.height=this.getHeight()*i;var o=a.getContext("2d");o.dpr=i,o.clearRect(0,0,a.width,a.height),n.backgroundColor&&(o.fillStyle=n.backgroundColor,o.fillRect(0,0,a.width,a.height));var s=this.storage.getDisplayList(!0),l={},u,c=this;function h(p,g){var m=c._zlevelList;p==null&&(p=-1/0);for(var _,y=0;y<m.length;y++){var x=m[y],S=c._layers[x];if(!S.__builtin__&&x>p&&x<g){_=S;break}}_&&_.renderToCanvas&&(o.save(),_.renderToCanvas(o),o.restore())}for(var f={ctx:o},d=0;d<s.length;d++){var v=s[d];v.zlevel!==u&&(h(u,v.zlevel),u=v.zlevel),this._doPaintEl(v,f,!0,null,l)}return h(u,1/0),a}});M3(function(e,t){var r=t.getZr(),n=r.__egl=r.__egl||new fx(r);n.update(e,t)});P3(r6);const ql={defaultOption:{viewControl:{projection:"perspective",autoRotate:!1,autoRotateDirection:"cw",autoRotateSpeed:10,autoRotateAfterStill:3,damping:.8,rotateSensitivity:1,zoomSensitivity:1,panSensitivity:1,panMouseButton:"middle",rotateMouseButton:"left",distance:150,minDistance:40,maxDistance:400,orthographicSize:150,maxOrthographicSize:400,minOrthographicSize:20,center:[0,0,0],alpha:0,beta:0,minAlpha:-90,maxAlpha:90}},setView:function(e){e=e||{},this.option.viewControl=this.option.viewControl||{},e.alpha!=null&&(this.option.viewControl.alpha=e.alpha),e.beta!=null&&(this.option.viewControl.beta=e.beta),e.distance!=null&&(this.option.viewControl.distance=e.distance),e.center!=null&&(this.option.viewControl.center=e.center)}},fi={defaultOption:{postEffect:{enable:!1,bloom:{enable:!0,intensity:.1},depthOfField:{enable:!1,focalRange:20,focalDistance:50,blurRadius:10,fstop:2.8,quality:"medium"},screenSpaceAmbientOcclusion:{enable:!1,radius:2,quality:"medium",intensity:1},screenSpaceReflection:{enable:!1,quality:"medium",maxRoughness:.8},colorCorrection:{enable:!0,exposure:0,brightness:0,contrast:1,saturation:1,lookupTexture:""},edge:{enable:!1},FXAA:{enable:!1}},temporalSuperSampling:{enable:"auto"}}},di={defaultOption:{light:{main:{shadow:!1,shadowQuality:"high",color:"#fff",intensity:1,alpha:0,beta:0},ambient:{color:"#fff",intensity:.2},ambientCubemap:{texture:null,exposure:1,diffuseIntensity:.5,specularIntensity:.5}}}};var Kl=Ot.extend({type:"grid3D",dependencies:["xAxis3D","yAxis3D","zAxis3D"],defaultOption:{show:!0,zlevel:-10,left:0,top:0,width:"100%",height:"100%",environment:"auto",boxWidth:100,boxHeight:100,boxDepth:100,axisPointer:{show:!0,lineStyle:{color:"rgba(0, 0, 0, 0.8)",width:1},label:{show:!0,formatter:null,margin:8,textStyle:{fontSize:14,color:"#fff",backgroundColor:"rgba(0,0,0,0.5)",padding:3,borderRadius:3}}},axisLine:{show:!0,lineStyle:{color:"#333",width:2,type:"solid"}},axisTick:{show:!0,inside:!1,length:3,lineStyle:{width:1}},axisLabel:{show:!0,inside:!1,rotate:0,margin:8,textStyle:{fontSize:12}},splitLine:{show:!0,lineStyle:{color:["#ccc"],width:1,type:"solid"}},splitArea:{show:!1,areaStyle:{color:["rgba(250,250,250,0.3)","rgba(200,200,200,0.3)"]}},light:{main:{alpha:30,beta:40},ambient:{intensity:.4}},viewControl:{alpha:20,beta:40,autoRotate:!1,distance:200,minDistance:40,maxDistance:400}}});fe(Kl.prototype,ql);fe(Kl.prototype,fi);fe(Kl.prototype,di);const n6=Kl;var Fi=Se.firstNotNull,b1={left:0,middle:1,right:2};function w1(e){return e instanceof Array||(e=[e,e]),e}var dx=qt.extend(function(){return{zr:null,viewGL:null,_center:new X,minDistance:.5,maxDistance:1.5,maxOrthographicSize:300,minOrthographicSize:30,minAlpha:-90,maxAlpha:90,minBeta:-1/0,maxBeta:1/0,autoRotateAfterStill:0,autoRotateDirection:"cw",autoRotateSpeed:60,damping:.8,rotateSensitivity:1,zoomSensitivity:1,panSensitivity:1,panMouseButton:"middle",rotateMouseButton:"left",_mode:"rotate",_camera:null,_needsUpdate:!1,_rotating:!1,_phi:0,_theta:0,_mouseX:0,_mouseY:0,_rotateVelocity:new lr,_panVelocity:new lr,_distance:500,_zoomSpeed:0,_stillTimeout:0,_animators:[]}},function(){["_mouseDownHandler","_mouseWheelHandler","_mouseMoveHandler","_mouseUpHandler","_pinchHandler","_contextMenuHandler","_update"].forEach(function(e){this[e]=this[e].bind(this)},this)},{init:function(){var e=this.zr;e&&(e.on("mousedown",this._mouseDownHandler),e.on("globalout",this._mouseUpHandler),e.on("mousewheel",this._mouseWheelHandler),e.on("pinch",this._pinchHandler),e.animation.on("frame",this._update),e.dom.addEventListener("contextmenu",this._contextMenuHandler))},dispose:function(){var e=this.zr;e&&(e.off("mousedown",this._mouseDownHandler),e.off("mousemove",this._mouseMoveHandler),e.off("mouseup",this._mouseUpHandler),e.off("mousewheel",this._mouseWheelHandler),e.off("pinch",this._pinchHandler),e.off("globalout",this._mouseUpHandler),e.dom.removeEventListener("contextmenu",this._contextMenuHandler),e.animation.off("frame",this._update)),this.stopAllAnimation()},getDistance:function(){return this._distance},setDistance:function(e){this._distance=e,this._needsUpdate=!0},getOrthographicSize:function(){return this._orthoSize},setOrthographicSize:function(e){this._orthoSize=e,this._needsUpdate=!0},getAlpha:function(){return this._theta/Math.PI*180},getBeta:function(){return-this._phi/Math.PI*180},getCenter:function(){return this._center.toArray()},setAlpha:function(e){e=Math.max(Math.min(this.maxAlpha,e),this.minAlpha),this._theta=e/180*Math.PI,this._needsUpdate=!0},setBeta:function(e){e=Math.max(Math.min(this.maxBeta,e),this.minBeta),this._phi=-e/180*Math.PI,this._needsUpdate=!0},setCenter:function(e){this._center.setArray(e)},setViewGL:function(e){this.viewGL=e},getCamera:function(){return this.viewGL.camera},setFromViewControlModel:function(e,t){t=t||{};var r=t.baseDistance||0,n=t.baseOrthoSize||1,a=e.get("projection");a!=="perspective"&&a!=="orthographic"&&a!=="isometric"&&(a="perspective"),this._projection=a,this.viewGL.setProjection(a);var i=e.get("distance")+r,o=e.get("orthographicSize")+n;[["damping",.8],["autoRotate",!1],["autoRotateAfterStill",3],["autoRotateDirection","cw"],["autoRotateSpeed",10],["minDistance",30],["maxDistance",400],["minOrthographicSize",30],["maxOrthographicSize",300],["minAlpha",-90],["maxAlpha",90],["minBeta",-1/0],["maxBeta",1/0],["rotateSensitivity",1],["zoomSensitivity",1],["panSensitivity",1],["panMouseButton","left"],["rotateMouseButton","middle"]].forEach(function(f){this[f[0]]=Fi(e.get(f[0]),f[1])},this),this.minDistance+=r,this.maxDistance+=r,this.minOrthographicSize+=n,this.maxOrthographicSize+=n;var s=e.ecModel,l={};["animation","animationDurationUpdate","animationEasingUpdate"].forEach(function(f){l[f]=Fi(e.get(f),s&&s.get(f))});var u=Fi(t.alpha,e.get("alpha"))||0,c=Fi(t.beta,e.get("beta"))||0,h=Fi(t.center,e.get("center"))||[0,0,0];l.animation&&l.animationDurationUpdate>0&&this._notFirst?this.animateTo({alpha:u,beta:c,center:h,distance:i,orthographicSize:o,easing:l.animationEasingUpdate,duration:l.animationDurationUpdate}):(this.setDistance(i),this.setAlpha(u),this.setBeta(c),this.setCenter(h),this.setOrthographicSize(o)),this._notFirst=!0,this._validateProperties()},_validateProperties:function(){},animateTo:function(e){var t=this.zr,r=this,n={},a={};return e.distance!=null&&(n.distance=this.getDistance(),a.distance=e.distance),e.orthographicSize!=null&&(n.orthographicSize=this.getOrthographicSize(),a.orthographicSize=e.orthographicSize),e.alpha!=null&&(n.alpha=this.getAlpha(),a.alpha=e.alpha),e.beta!=null&&(n.beta=this.getBeta(),a.beta=e.beta),e.center!=null&&(n.center=this.getCenter(),a.center=e.center),this._addAnimator(t.animation.animate(n).when(e.duration||1e3,a).during(function(){n.alpha!=null&&r.setAlpha(n.alpha),n.beta!=null&&r.setBeta(n.beta),n.distance!=null&&r.setDistance(n.distance),n.center!=null&&r.setCenter(n.center),n.orthographicSize!=null&&r.setOrthographicSize(n.orthographicSize),r._needsUpdate=!0})).start(e.easing||"linear")},stopAllAnimation:function(){for(var e=0;e<this._animators.length;e++)this._animators[e].stop();this._animators.length=0},update:function(){this._needsUpdate=!0,this._update(20)},_isAnimating:function(){return this._animators.length>0},_update:function(e){if(this._rotating){var t=(this.autoRotateDirection==="cw"?1:-1)*this.autoRotateSpeed/180*Math.PI;this._phi-=t*e/1e3,this._needsUpdate=!0}else this._rotateVelocity.len()>0&&(this._needsUpdate=!0);(Math.abs(this._zoomSpeed)>.1||this._panVelocity.len()>0)&&(this._needsUpdate=!0),this._needsUpdate&&(e=Math.min(e,50),this._updateDistanceOrSize(e),this._updatePan(e),this._updateRotate(e),this._updateTransform(),this.getCamera().update(),this.zr&&this.zr.refresh(),this.trigger("update"),this._needsUpdate=!1)},_updateRotate:function(e){var t=this._rotateVelocity;this._phi=t.y*e/20+this._phi,this._theta=t.x*e/20+this._theta,this.setAlpha(this.getAlpha()),this.setBeta(this.getBeta()),this._vectorDamping(t,Math.pow(this.damping,e/16))},_updateDistanceOrSize:function(e){this._projection==="perspective"?this._setDistance(this._distance+this._zoomSpeed*e/20):this._setOrthoSize(this._orthoSize+this._zoomSpeed*e/20),this._zoomSpeed*=Math.pow(this.damping,e/16)},_setDistance:function(e){this._distance=Math.max(Math.min(e,this.maxDistance),this.minDistance)},_setOrthoSize:function(e){this._orthoSize=Math.max(Math.min(e,this.maxOrthographicSize),this.minOrthographicSize);var t=this.getCamera(),r=this._orthoSize,n=r/this.viewGL.viewport.height*this.viewGL.viewport.width;t.left=-n/2,t.right=n/2,t.top=r/2,t.bottom=-r/2},_updatePan:function(e){var t=this._panVelocity,r=this._distance,n=this.getCamera(),a=n.worldTransform.y,i=n.worldTransform.x;this._center.scaleAndAdd(i,-t.x*r/200).scaleAndAdd(a,-t.y*r/200),this._vectorDamping(t,0)},_updateTransform:function(){var e=this.getCamera(),t=new X,r=this._theta+Math.PI/2,n=this._phi+Math.PI/2,a=Math.sin(r);t.x=a*Math.cos(n),t.y=-Math.cos(r),t.z=a*Math.sin(n),e.position.copy(this._center).scaleAndAdd(t,this._distance),e.rotation.identity().rotateY(-this._phi).rotateX(-this._theta)},_startCountingStill:function(){clearTimeout(this._stillTimeout);var e=this.autoRotateAfterStill,t=this;!isNaN(e)&&e>0&&(this._stillTimeout=setTimeout(function(){t._rotating=!0},e*1e3))},_vectorDamping:function(e,t){var r=e.len();r=r*t,r<1e-4&&(r=0),e.normalize().scale(r)},_decomposeTransform:function(){if(this.getCamera()){this.getCamera().updateWorldTransform();var e=this.getCamera().worldTransform.z,t=Math.asin(e.y),r=Math.atan2(e.x,e.z);this._theta=t,this._phi=-r,this.setBeta(this.getBeta()),this.setAlpha(this.getAlpha()),this.getCamera().aspect?this._setDistance(this.getCamera().position.dist(this._center)):this._setOrthoSize(this.getCamera().top-this.getCamera().bottom)}},_mouseDownHandler:function(e){if(!e.target&&!this._isAnimating()){var t=e.offsetX,r=e.offsetY;this.viewGL&&!this.viewGL.containPoint(t,r)||(this.zr.on("mousemove",this._mouseMoveHandler),this.zr.on("mouseup",this._mouseUpHandler),e.event.targetTouches?e.event.targetTouches.length===1&&(this._mode="rotate"):e.event.button===b1[this.rotateMouseButton]?this._mode="rotate":e.event.button===b1[this.panMouseButton]?this._mode="pan":this._mode="",this._rotateVelocity.set(0,0),this._rotating=!1,this.autoRotate&&this._startCountingStill(),this._mouseX=e.offsetX,this._mouseY=e.offsetY)}},_mouseMoveHandler:function(e){if(!(e.target&&e.target.__isGLToZRProxy)&&!this._isAnimating()){var t=w1(this.panSensitivity),r=w1(this.rotateSensitivity);this._mode==="rotate"?(this._rotateVelocity.y=(e.offsetX-this._mouseX)/this.zr.getHeight()*2*r[0],this._rotateVelocity.x=(e.offsetY-this._mouseY)/this.zr.getWidth()*2*r[1]):this._mode==="pan"&&(this._panVelocity.x=(e.offsetX-this._mouseX)/this.zr.getWidth()*t[0]*400,this._panVelocity.y=(-e.offsetY+this._mouseY)/this.zr.getHeight()*t[1]*400),this._mouseX=e.offsetX,this._mouseY=e.offsetY,e.event.preventDefault()}},_mouseWheelHandler:function(e){if(!this._isAnimating()){var t=e.event.wheelDelta||-e.event.detail;this._zoomHandler(e,t)}},_pinchHandler:function(e){this._isAnimating()||(this._zoomHandler(e,e.pinchScale>1?1:-1),this._mode="")},_zoomHandler:function(e,t){if(t!==0){var r=e.offsetX,n=e.offsetY;if(!(this.viewGL&&!this.viewGL.containPoint(r,n))){var a;this._projection==="perspective"?a=Math.max(Math.max(Math.min(this._distance-this.minDistance,this.maxDistance-this._distance))/20,.5):a=Math.max(Math.max(Math.min(this._orthoSize-this.minOrthographicSize,this.maxOrthographicSize-this._orthoSize))/20,.5),this._zoomSpeed=(t>0?-1:1)*a*this.zoomSensitivity,this._rotating=!1,this.autoRotate&&this._mode==="rotate"&&this._startCountingStill(),e.event.preventDefault()}}},_mouseUpHandler:function(){this.zr.off("mousemove",this._mouseMoveHandler),this.zr.off("mouseup",this._mouseUpHandler)},_isRightMouseButtonUsed:function(){return this.rotateMouseButton==="right"||this.panMouseButton==="right"},_contextMenuHandler:function(e){this._isRightMouseButtonUsed()&&e.preventDefault()},_addAnimator:function(e){var t=this._animators;return t.push(e),e.done(function(){var r=t.indexOf(e);r>=0&&t.splice(r,1)}),e}});Object.defineProperty(dx.prototype,"autoRotate",{get:function(e){return this._autoRotate},set:function(e){this._autoRotate=e,this._rotating=e}});const Jl=dx,Go={convertToDynamicArray:function(e){e&&this.resetOffset();var t=this.attributes;for(var r in t)e||!t[r].value?t[r].value=[]:t[r].value=Array.prototype.slice.call(t[r].value);e||!this.indices?this.indices=[]:this.indices=Array.prototype.slice.call(this.indices)},convertToTypedArray:function(){var e=this.attributes;for(var t in e)e[t].value&&e[t].value.length>0?e[t].value=new Float32Array(e[t].value):e[t].value=null;this.indices&&this.indices.length>0&&(this.indices=this.vertexCount>65535?new Uint32Array(this.indices):new Uint16Array(this.indices)),this.dirty()}},lt={vec2:se,vec3:O,vec4:Y,mat2:tt,mat2d:ut,mat3:Ae,mat4:$,quat:ve};var Mc=lt.vec3,A1=[[0,0],[1,1]],vx=Me.extend(function(){return{segmentScale:1,dynamic:!0,useNativeLine:!0,attributes:{position:new Me.Attribute("position","float",3,"POSITION"),positionPrev:new Me.Attribute("positionPrev","float",3),positionNext:new Me.Attribute("positionNext","float",3),prevPositionPrev:new Me.Attribute("prevPositionPrev","float",3),prevPosition:new Me.Attribute("prevPosition","float",3),prevPositionNext:new Me.Attribute("prevPositionNext","float",3),offset:new Me.Attribute("offset","float",1),color:new Me.Attribute("color","float",4,"COLOR")}}},{resetOffset:function(){this._vertexOffset=0,this._triangleOffset=0,this._itemVertexOffsets=[]},setVertexCount:function(e){var t=this.attributes;this.vertexCount!==e&&(t.position.init(e),t.color.init(e),this.useNativeLine||(t.positionPrev.init(e),t.positionNext.init(e),t.offset.init(e)),e>65535?this.indices instanceof Uint16Array&&(this.indices=new Uint32Array(this.indices)):this.indices instanceof Uint32Array&&(this.indices=new Uint16Array(this.indices)))},setTriangleCount:function(e){this.triangleCount!==e&&(e===0?this.indices=null:this.indices=this.vertexCount>65535?new Uint32Array(e*3):new Uint16Array(e*3))},_getCubicCurveApproxStep:function(e,t,r,n){var a=Mc.dist(e,t)+Mc.dist(r,t)+Mc.dist(n,r),i=1/(a+1)*this.segmentScale;return i},getCubicCurveVertexCount:function(e,t,r,n){var a=this._getCubicCurveApproxStep(e,t,r,n),i=Math.ceil(1/a);return this.useNativeLine?i*2:i*2+2},getCubicCurveTriangleCount:function(e,t,r,n){var a=this._getCubicCurveApproxStep(e,t,r,n),i=Math.ceil(1/a);return this.useNativeLine?0:i*2},getLineVertexCount:function(){return this.getPolylineVertexCount(A1)},getLineTriangleCount:function(){return this.getPolylineTriangleCount(A1)},getPolylineVertexCount:function(e){var t;if(typeof e=="number")t=e;else{var r=typeof e[0]!="number";t=r?e.length:e.length/3}return this.useNativeLine?(t-1)*2:(t-1)*2+2},getPolylineTriangleCount:function(e){var t;if(typeof e=="number")t=e;else{var r=typeof e[0]!="number";t=r?e.length:e.length/3}return this.useNativeLine?0:Math.max(t-1,0)*2},addCubicCurve:function(e,t,r,n,a,i){i==null&&(i=1);for(var o=e[0],s=e[1],l=e[2],u=t[0],c=t[1],h=t[2],f=r[0],d=r[1],v=r[2],p=n[0],g=n[1],m=n[2],_=this._getCubicCurveApproxStep(e,t,r,n),y=_*_,x=y*_,S=3*_,T=3*y,b=6*y,w=6*x,A=o-u*2+f,E=s-c*2+d,C=l-h*2+v,M=(u-f)*3-o+p,P=(c-d)*3-s+g,L=(h-v)*3-l+m,I=o,N=s,F=l,B=(u-o)*S+A*T+M*x,k=(c-s)*S+E*T+P*x,z=(h-l)*S+C*T+L*x,W=A*b+M*w,J=E*b+P*w,re=C*b+L*w,Q=M*w,q=P*w,Ee=L*w,ae=0,j=0,pe=Math.ceil(1/_),de=new Float32Array((pe+1)*3),de=[],ge=0,j=0;j<pe+1;j++)de[ge++]=I,de[ge++]=N,de[ge++]=F,I+=B,N+=k,F+=z,B+=W,k+=J,z+=re,W+=Q,J+=q,re+=Ee,ae+=_,ae>1&&(I=B>0?Math.min(I,p):Math.max(I,p),N=k>0?Math.min(N,g):Math.max(N,g),F=z>0?Math.min(F,m):Math.max(F,m));return this.addPolyline(de,a,i)},addLine:function(e,t,r,n){return this.addPolyline([e,t],r,n)},addPolyline:function(e,t,r,n,a){if(e.length){var i=typeof e[0]!="number";if(a==null&&(a=i?e.length:e.length/3),!(a<2)){n==null&&(n=0),r==null&&(r=1),this._itemVertexOffsets.push(this._vertexOffset);var i=typeof e[0]!="number",o=i?typeof t[0]!="number":t.length/4===a,s=this.attributes.position,l=this.attributes.positionPrev,u=this.attributes.positionNext,c=this.attributes.color,h=this.attributes.offset,f=this.indices,d=this._vertexOffset,v,p;r=Math.max(r,.01);for(var g=n;g<a;g++){if(i)v=e[g],o?p=t[g]:p=t;else{var m=g*3;if(v=v||[],v[0]=e[m],v[1]=e[m+1],v[2]=e[m+2],o){var _=g*4;p=p||[],p[0]=t[_],p[1]=t[_+1],p[2]=t[_+2],p[3]=t[_+3]}else p=t}if(this.useNativeLine?g>1&&(s.copy(d,d-1),c.copy(d,d-1),d++):(g<a-1&&(l.set(d+2,v),l.set(d+3,v)),g>0&&(u.set(d-2,v),u.set(d-1,v)),s.set(d,v),s.set(d+1,v),c.set(d,p),c.set(d+1,p),h.set(d,r/2),h.set(d+1,-r/2),d+=2),this.useNativeLine)c.set(d,p),s.set(d,v),d++;else if(g>0){var y=this._triangleOffset*3,f=this.indices;f[y]=d-4,f[y+1]=d-3,f[y+2]=d-2,f[y+3]=d-3,f[y+4]=d-1,f[y+5]=d-2,this._triangleOffset+=2}}if(!this.useNativeLine){var x=this._vertexOffset,S=this._vertexOffset+a*2;l.copy(x,x+2),l.copy(x+1,x+3),u.copy(S-1,S-3),u.copy(S-2,S-4)}return this._vertexOffset=d,this._vertexOffset}}},setItemColor:function(e,t){for(var r=this._itemVertexOffsets[e],n=e<this._itemVertexOffsets.length-1?this._itemVertexOffsets[e+1]:this._vertexOffset,a=r;a<n;a++)this.attributes.color.set(a,t);this.dirty("color")},currentTriangleOffset:function(){return this._triangleOffset},currentVertexOffset:function(){return this._vertexOffset}});Te(vx.prototype,Go);const Sa=vx;function cl(e,t,r,n,a,i,o){this._zr=e,this._x=0,this._y=0,this._rowHeight=0,this.width=n,this.height=a,this.offsetX=t,this.offsetY=r,this.dpr=o,this.gap=i}cl.prototype={constructor:cl,clear:function(){this._x=0,this._y=0,this._rowHeight=0},add:function(e,t,r){var n=e.getBoundingRect();t==null&&(t=n.width),r==null&&(r=n.height),t*=this.dpr,r*=this.dpr,this._fitElement(e,t,r);var a=this._x,i=this._y,o=this.width*this.dpr,s=this.height*this.dpr,l=this.gap;if(a+t+l>o&&(a=this._x=0,i+=this._rowHeight+l,this._y=i,this._rowHeight=0),this._x+=t+l,this._rowHeight=Math.max(this._rowHeight,r),i+r+l>s)return null;e.x+=this.offsetX*this.dpr+a,e.y+=this.offsetY*this.dpr+i,this._zr.add(e);var u=[this.offsetX/this.width,this.offsetY/this.height],c=[[a/o+u[0],i/s+u[1]],[(a+t)/o+u[0],(i+r)/s+u[1]]];return c},_fitElement:function(e,t,r){var n=e.getBoundingRect(),a=t/n.width,i=r/n.height;e.x=-n.x*a,e.y=-n.y*i,e.scaleX=a,e.scaleY=i,e.update()}};function hl(e){e=e||{},e.width=e.width||512,e.height=e.height||512,e.devicePixelRatio=e.devicePixelRatio||1,e.gap=e.gap==null?2:e.gap;var t=document.createElement("canvas");t.width=e.width*e.devicePixelRatio,t.height=e.height*e.devicePixelRatio,this._canvas=t,this._texture=new _e({image:t,flipY:!1});var r=this;this._zr=I3(t);var n=this._zr.refreshImmediately;this._zr.refreshImmediately=function(){n.call(this),r._texture.dirty(),r.onupdate&&r.onupdate()},this._dpr=e.devicePixelRatio,this._coords={},this.onupdate=e.onupdate,this._gap=e.gap,this._textureAtlasNodes=[new cl(this._zr,0,0,e.width,e.height,this._gap,this._dpr)],this._nodeWidth=e.width,this._nodeHeight=e.height,this._currentNodeIdx=0}hl.prototype={clear:function(){for(var e=0;e<this._textureAtlasNodes.length;e++)this._textureAtlasNodes[e].clear();this._currentNodeIdx=0,this._zr.clear(),this._coords={}},getWidth:function(){return this._width},getHeight:function(){return this._height},getTexture:function(){return this._texture},getDevicePixelRatio:function(){return this._dpr},getZr:function(){return this._zr},_getCurrentNode:function(){return this._textureAtlasNodes[this._currentNodeIdx]},_expand:function(){if(this._currentNodeIdx++,this._textureAtlasNodes[this._currentNodeIdx])return this._textureAtlasNodes[this._currentNodeIdx];var e=4096/this._dpr,t=this._textureAtlasNodes,r=t.length,n=r*this._nodeWidth%e,a=Math.floor(r*this._nodeWidth/e)*this._nodeHeight;if(!(a>=e)){var i=(n+this._nodeWidth)*this._dpr,o=(a+this._nodeHeight)*this._dpr;try{this._zr.resize({width:i,height:o})}catch{this._canvas.width=i,this._canvas.height=o}var s=new cl(this._zr,n,a,this._nodeWidth,this._nodeHeight,this._gap,this._dpr);return this._textureAtlasNodes.push(s),s}},add:function(e,t,r){if(this._coords[e.id])return this._coords[e.id];var n=this._getCurrentNode().add(e,t,r);if(!n){var a=this._expand();if(!a)return;n=a.add(e,t,r)}return this._coords[e.id]=n,n},getCoordsScale:function(){var e=this._dpr;return[this._nodeWidth/this._canvas.width*e,this._nodeHeight/this._canvas.height*e]},getCoords:function(e){return this._coords[e]},dispose:function(){this._zr.dispose()}};function Rn(){}Rn.prototype={constructor:Rn,setScene:function(e){this._scene=e,this._skybox&&this._skybox.attachScene(this._scene)},initLight:function(e){this._lightRoot=e,this.mainLight=new D.DirectionalLight({shadowBias:.005}),this.ambientLight=new D.AmbientLight,e.add(this.mainLight),e.add(this.ambientLight)},dispose:function(){this._lightRoot&&(this._lightRoot.remove(this.mainLight),this._lightRoot.remove(this.ambientLight))},updateLight:function(e){var t=this.mainLight,r=this.ambientLight,n=e.getModel("light"),a=n.getModel("main"),i=n.getModel("ambient");t.intensity=a.get("intensity"),r.intensity=i.get("intensity"),t.color=D.parseColor(a.get("color")).slice(0,3),r.color=D.parseColor(i.get("color")).slice(0,3);var o=a.get("alpha")||0,s=a.get("beta")||0;t.position.setArray(D.directionFromAlphaBeta(o,s)),t.lookAt(D.Vector3.ZERO),t.castShadow=a.get("shadow"),t.shadowResolution=D.getShadowResolution(a.get("shadowQuality"))},updateAmbientCubemap:function(e,t,r){var n=t.getModel("light.ambientCubemap"),a=n.get("texture");if(a){this._cubemapLightsCache=this._cubemapLightsCache||{};var i=this._cubemapLightsCache[a];if(!i){var o=this;i=this._cubemapLightsCache[a]=D.createAmbientCubemap(n.option,e,r,function(){o._isSkyboxFromAmbientCubemap&&o._skybox.setEnvironmentMap(i.specular.cubemap),r.getZr().refresh()})}this._lightRoot.add(i.diffuse),this._lightRoot.add(i.specular),this._currentCubemapLights=i}else this._currentCubemapLights&&(this._lightRoot.remove(this._currentCubemapLights.diffuse),this._lightRoot.remove(this._currentCubemapLights.specular),this._currentCubemapLights=null)},updateSkybox:function(e,t,r){var n=t.get("environment"),a=this;function i(){return a._skybox=a._skybox||new xo,a._skybox}var o=i();if(n&&n!=="none")if(n==="auto")if(this._isSkyboxFromAmbientCubemap=!0,this._currentCubemapLights){var s=this._currentCubemapLights.specular.cubemap;o.setEnvironmentMap(s),this._scene&&o.attachScene(this._scene),o.material.set("lod",3)}else this._skybox&&this._skybox.detachScene();else if(typeof n=="object"&&n.colorStops||typeof n=="string"&&Um(n)){this._isSkyboxFromAmbientCubemap=!1;var l=new D.Texture2D({anisotropic:8,flipY:!1});o.setEnvironmentMap(l);var u=l.image=document.createElement("canvas");u.width=u.height=16;var c=u.getContext("2d"),h=new Et({shape:{x:0,y:0,width:16,height:16},style:{fill:n}});km(c,h),o.attachScene(this._scene)}else{this._isSkyboxFromAmbientCubemap=!1;var l=D.loadTexture(n,r,{anisotropic:8,flipY:!1});o.setEnvironmentMap(l),o.attachScene(this._scene)}else this._skybox&&this._skybox.detachScene(this._scene),this._skybox=null;var f=t.coordinateSystem;if(this._skybox)if(f&&f.viewGL&&n!=="auto"&&!(n.match&&n.match(/.hdr$/))){var d=f.viewGL.isLinearSpace()?"define":"undefine";this._skybox.material[d]("fragment","SRGB_DECODE")}else this._skybox.material.undefine("fragment","SRGB_DECODE")}};var Wn=lt.vec3,px=Me.extend(function(){return{segmentScale:1,useNativeLine:!0,attributes:{position:new Me.Attribute("position","float",3,"POSITION"),normal:new Me.Attribute("normal","float",3,"NORMAL"),color:new Me.Attribute("color","float",4,"COLOR")}}},{resetOffset:function(){this._vertexOffset=0,this._faceOffset=0},setQuadCount:function(e){var t=this.attributes,r=this.getQuadVertexCount()*e,n=this.getQuadTriangleCount()*e;this.vertexCount!==r&&(t.position.init(r),t.normal.init(r),t.color.init(r)),this.triangleCount!==n&&(this.indices=r>65535?new Uint32Array(n*3):new Uint16Array(n*3))},getQuadVertexCount:function(){return 4},getQuadTriangleCount:function(){return 2},addQuad:function(){var e=Wn.create(),t=Wn.create(),r=Wn.create(),n=[0,3,1,3,2,1];return function(a,i){var o=this.attributes.position,s=this.attributes.normal,l=this.attributes.color;Wn.sub(e,a[1],a[0]),Wn.sub(t,a[2],a[1]),Wn.cross(r,e,t),Wn.normalize(r,r);for(var u=0;u<4;u++)o.set(this._vertexOffset+u,a[u]),l.set(this._vertexOffset+u,i),s.set(this._vertexOffset+u,r);for(var c=this._faceOffset*3,u=0;u<6;u++)this.indices[c+u]=n[u]+this._vertexOffset;this._vertexOffset+=4,this._faceOffset+=2}}()});Te(px.prototype,Go);const a6=px;var Fh=Se.firstNotNull,i6={x:0,y:2,z:1};function o6(e,t,r,n){var a=[0,0,0],i=n<0?r.getExtentMin():r.getExtentMax();a[i6[r.dim]]=i,e.position.setArray(a),e.rotation.identity(),t.distance=-Math.abs(i),t.normal.set(0,0,0),r.dim==="x"?(e.rotation.rotateY(n*Math.PI/2),t.normal.x=-n):r.dim==="z"?(e.rotation.rotateX(-n*Math.PI/2),t.normal.y=-n):(n>0&&e.rotation.rotateY(Math.PI),t.normal.z=-n)}function Ql(e,t,r){this.rootNode=new D.Node;var n=new D.Mesh({geometry:new Sa({useNativeLine:!1}),material:t,castShadow:!1,ignorePicking:!0,$ignorePicking:!0,renderOrder:1}),a=new D.Mesh({geometry:new a6,material:r,castShadow:!1,culling:!1,ignorePicking:!0,$ignorePicking:!0,renderOrder:0});this.rootNode.add(a),this.rootNode.add(n),this.faceInfo=e,this.plane=new D.Plane,this.linesMesh=n,this.quadsMesh=a}Ql.prototype.update=function(e,t,r){var n=e.coordinateSystem,a=[n.getAxis(this.faceInfo[0]),n.getAxis(this.faceInfo[1])],i=this.linesMesh.geometry,o=this.quadsMesh.geometry;i.convertToDynamicArray(!0),o.convertToDynamicArray(!0),this._updateSplitLines(i,a,e,r),this._udpateSplitAreas(o,a,e,r),i.convertToTypedArray(),o.convertToTypedArray();var s=n.getAxis(this.faceInfo[2]);o6(this.rootNode,this.plane,s,this.faceInfo[3])};Ql.prototype._updateSplitLines=function(e,t,r,n){var a=n.getDevicePixelRatio();t.forEach(function(i,o){var s=i.model,l=t[1-o].getExtent();if(!i.scale.isBlank()){var u=s.getModel("splitLine",r.getModel("splitLine"));if(u.get("show")){var c=u.getModel("lineStyle"),h=c.get("color"),f=Fh(c.get("opacity"),1),d=Fh(c.get("width"),1);h=te(h)?h:[h];for(var v=i.getTicksCoords({tickModel:u}),p=0,g=0;g<v.length;g++){var m=v[g].coord,_=D.parseColor(h[p%h.length]);_[3]*=f;var y=[0,0,0],x=[0,0,0];y[o]=x[o]=m,y[1-o]=l[0],x[1-o]=l[1],e.addLine(y,x,_,d*a),p++}}}})};Ql.prototype._udpateSplitAreas=function(e,t,r,n){t.forEach(function(a,i){var o=a.model,s=t[1-i].getExtent();if(!a.scale.isBlank()){var l=o.getModel("splitArea",r.getModel("splitArea"));if(l.get("show")){var u=l.getModel("areaStyle"),c=u.get("color"),h=Fh(u.get("opacity"),1);c=te(c)?c:[c];for(var f=a.getTicksCoords({tickModel:l,clamp:!0}),d=0,v=[0,0,0],p=[0,0,0],g=0;g<f.length;g++){var m=f[g].coord,_=[0,0,0],y=[0,0,0];if(_[i]=y[i]=m,_[1-i]=s[0],y[1-i]=s[1],g===0){v=_,p=y;continue}var x=D.parseColor(c[d%c.length]);x[3]*=h,e.addQuad([v,_,y,p],x),v=_,p=y,d++}}}})};var E1=[0,1,2,0,2,3],gx=Me.extend(function(){return{attributes:{position:new Me.Attribute("position","float",3,"POSITION"),texcoord:new Me.Attribute("texcoord","float",2,"TEXCOORD_0"),offset:new Me.Attribute("offset","float",2),color:new Me.Attribute("color","float",4,"COLOR")}}},{resetOffset:function(){this._vertexOffset=0,this._faceOffset=0},setSpriteCount:function(e){this._spriteCount=e;var t=e*4,r=e*2;this.vertexCount!==t&&(this.attributes.position.init(t),this.attributes.offset.init(t),this.attributes.color.init(t)),this.triangleCount!==r&&(this.indices=t>65535?new Uint32Array(r*3):new Uint16Array(r*3))},setSpriteAlign:function(e,t,r,n,a){r==null&&(r="left"),n==null&&(n="top");var i,o,s,l;switch(a=a||0,r){case"left":i=a,s=t[0]+a;break;case"center":case"middle":i=-t[0]/2,s=t[0]/2;break;case"right":i=-t[0]-a,s=-a;break}switch(n){case"bottom":o=a,l=t[1]+a;break;case"middle":o=-t[1]/2,l=t[1]/2;break;case"top":o=-t[1]-a,l=-a;break}var u=e*4,c=this.attributes.offset;c.set(u,[i,l]),c.set(u+1,[s,l]),c.set(u+2,[s,o]),c.set(u+3,[i,o])},addSprite:function(e,t,r,n,a,i){var o=this._vertexOffset;this.setSprite(this._vertexOffset/4,e,t,r,n,a,i);for(var s=0;s<E1.length;s++)this.indices[this._faceOffset*3+s]=E1[s]+o;return this._faceOffset+=2,this._vertexOffset+=4,o/4},setSprite:function(e,t,r,n,a,i,o){for(var s=e*4,l=this.attributes,u=0;u<4;u++)l.position.set(s+u,t);var c=l.texcoord;c.set(s,[n[0][0],n[0][1]]),c.set(s+1,[n[1][0],n[0][1]]),c.set(s+2,[n[1][0],n[1][1]]),c.set(s+3,[n[0][0],n[1][1]]),this.setSpriteAlign(e,r,a,i,o)}});Te(gx.prototype,Go);const s6=gx,l6=`@export ecgl.labels.vertex

attribute vec3 position: POSITION;
attribute vec2 texcoord: TEXCOORD_0;
attribute vec2 offset;
#ifdef VERTEX_COLOR
attribute vec4 a_Color : COLOR;
varying vec4 v_Color;
#endif

uniform mat4 worldViewProjection : WORLDVIEWPROJECTION;
uniform vec4 viewport : VIEWPORT;

varying vec2 v_Texcoord;

void main()
{
 vec4 proj = worldViewProjection * vec4(position, 1.0);

 vec2 screen = (proj.xy / abs(proj.w) + 1.0) * 0.5 * viewport.zw;

 screen += offset;

 proj.xy = (screen / viewport.zw - 0.5) * 2.0 * abs(proj.w);
 gl_Position = proj;
#ifdef VERTEX_COLOR
 v_Color = a_Color;
#endif
 v_Texcoord = texcoord;
}
@end


@export ecgl.labels.fragment

uniform vec3 color : [1.0, 1.0, 1.0];
uniform float alpha : 1.0;
uniform sampler2D textureAtlas;
uniform vec2 uvScale: [1.0, 1.0];

#ifdef VERTEX_COLOR
varying vec4 v_Color;
#endif
varying float v_Miter;

varying vec2 v_Texcoord;

void main()
{
 gl_FragColor = vec4(color, alpha) * texture2D(textureAtlas, v_Texcoord * uvScale);
#ifdef VERTEX_COLOR
 gl_FragColor *= v_Color;
#endif
}

@end`;D.Shader.import(l6);const fd=D.Mesh.extend(function(){var e=new s6({dynamic:!0}),t=new D.Material({shader:D.createShader("ecgl.labels"),transparent:!0,depthMask:!1});return{geometry:e,material:t,culling:!1,castShadow:!1,ignorePicking:!0}});var $n=Se.firstNotNull,Xn={x:0,y:2,z:1};function dd(e,t){var r=new D.Mesh({geometry:new Sa({useNativeLine:!1}),material:t,castShadow:!1,ignorePicking:!0,renderOrder:2}),n=new fd;n.material.depthMask=!1;var a=new D.Node;a.add(r),a.add(n),this.rootNode=a,this.dim=e,this.linesMesh=r,this.labelsMesh=n,this.axisLineCoords=null,this.labelElements=[]}var Pc={x:"y",y:"x",z:"y"};dd.prototype.update=function(e,t,r){var n=e.coordinateSystem,a=n.getAxis(this.dim),i=this.linesMesh.geometry,o=this.labelsMesh.geometry;i.convertToDynamicArray(!0),o.convertToDynamicArray(!0);var s=a.model,l=a.getExtent(),C=r.getDevicePixelRatio(),u=s.getModel("axisLine",e.getModel("axisLine")),c=s.getModel("axisTick",e.getModel("axisTick")),h=s.getModel("axisLabel",e.getModel("axisLabel")),f=u.get("lineStyle.color");if(u.get("show")){var d=u.getModel("lineStyle"),v=[0,0,0],p=[0,0,0],g=Xn[a.dim];v[g]=l[0],p[g]=l[1],this.axisLineCoords=[v,p];var m=D.parseColor(f),_=$n(d.get("width"),1),y=$n(d.get("opacity"),1);m[3]*=y,i.addLine(v,p,m,_*C)}if(c.get("show")){var x=c.getModel("lineStyle"),S=D.parseColor($n(x.get("color"),f)),_=$n(x.get("width"),1);S[3]*=$n(x.get("opacity"),1);for(var T=a.getTicksCoords(),b=c.get("length"),w=0;w<T.length;w++){var A=T[w].coord,v=[0,0,0],p=[0,0,0],g=Xn[a.dim],E=Xn[Pc[a.dim]];v[g]=p[g]=A,p[E]=b,i.addLine(v,p,S,_*C)}}this.labelElements=[];var C=r.getDevicePixelRatio();if(h.get("show"))for(var T=a.getTicksCoords(),M=s.get("data"),P=h.get("margin"),L=a.getViewLabels(),w=0;w<L.length;w++){var I=L[w].tickValue,N=L[w].formattedLabel,F=L[w].rawLabel,A=a.dataToCoord(I),B=[0,0,0],g=Xn[a.dim],E=Xn[Pc[a.dim]];B[g]=B[g]=A,B[E]=P;var k=h;M&&M[I]&&M[I].textStyle&&(k=new Ft(M[I].textStyle,h,s.ecModel));var z=$n(k.get("color"),f),W=new rt({style:ft(k,{text:N,fill:typeof z=="function"?z(a.type==="category"?F:a.type==="value"?I+"":I,w):z,verticalAlign:"top",align:"left"})}),J=t.add(W),re=W.getBoundingRect();o.addSprite(B,[re.width*C,re.height*C],J),this.labelElements.push(W)}if(s.get("name")){var Q=s.getModel("nameTextStyle"),B=[0,0,0],g=Xn[a.dim],E=Xn[Pc[a.dim]],q=$n(Q.get("color"),f),Ee=Q.get("borderColor"),_=Q.get("borderWidth");B[g]=B[g]=(l[0]+l[1])/2,B[E]=s.get("nameGap");var W=new rt({style:ft(Q,{text:s.get("name"),fill:q,stroke:Ee,lineWidth:_})}),J=t.add(W),re=W.getBoundingRect();o.addSprite(B,[re.width*C,re.height*C],J),W.__idx=this.labelElements.length,this.nameLabelElement=W}this.labelsMesh.material.set("textureAtlas",t.getTexture()),this.labelsMesh.material.set("uvScale",t.getCoordsScale()),i.convertToTypedArray(),o.convertToTypedArray()};dd.prototype.setSpriteAlign=function(e,t,r){for(var n=r.getDevicePixelRatio(),a=this.labelsMesh.geometry,i=0;i<this.labelElements.length;i++){var o=this.labelElements[i],s=o.getBoundingRect();a.setSpriteAlign(i,[s.width*n,s.height*n],e,t)}var l=this.nameLabelElement;if(l){var s=l.getBoundingRect();a.setSpriteAlign(l.__idx,[s.width*n,s.height*n],e,t),a.dirty()}this.textAlign=e,this.textVerticalAlign=t};const eu=`@export ecgl.lines3D.vertex

uniform mat4 worldViewProjection : WORLDVIEWPROJECTION;

attribute vec3 position: POSITION;
attribute vec4 a_Color : COLOR;
varying vec4 v_Color;

void main()
{
 gl_Position = worldViewProjection * vec4(position, 1.0);
 v_Color = a_Color;
}

@end

@export ecgl.lines3D.fragment

uniform vec4 color : [1.0, 1.0, 1.0, 1.0];

varying vec4 v_Color;

@import clay.util.srgb

void main()
{
#ifdef SRGB_DECODE
 gl_FragColor = sRGBToLinear(color * v_Color);
#else
 gl_FragColor = color * v_Color;
#endif
}
@end



@export ecgl.lines3D.clipNear

vec4 clipNear(vec4 p1, vec4 p2) {
 float n = (p1.w - near) / (p1.w - p2.w);
 return vec4(mix(p1.xy, p2.xy, n), -near, near);
}

@end

@export ecgl.lines3D.expandLine
#ifdef VERTEX_ANIMATION
 vec4 prevProj = worldViewProjection * vec4(mix(prevPositionPrev, positionPrev, percent), 1.0);
 vec4 currProj = worldViewProjection * vec4(mix(prevPosition, position, percent), 1.0);
 vec4 nextProj = worldViewProjection * vec4(mix(prevPositionNext, positionNext, percent), 1.0);
#else
 vec4 prevProj = worldViewProjection * vec4(positionPrev, 1.0);
 vec4 currProj = worldViewProjection * vec4(position, 1.0);
 vec4 nextProj = worldViewProjection * vec4(positionNext, 1.0);
#endif

 if (currProj.w < 0.0) {
 if (nextProj.w > 0.0) {
 currProj = clipNear(currProj, nextProj);
 }
 else if (prevProj.w > 0.0) {
 currProj = clipNear(currProj, prevProj);
 }
 }

 vec2 prevScreen = (prevProj.xy / abs(prevProj.w) + 1.0) * 0.5 * viewport.zw;
 vec2 currScreen = (currProj.xy / abs(currProj.w) + 1.0) * 0.5 * viewport.zw;
 vec2 nextScreen = (nextProj.xy / abs(nextProj.w) + 1.0) * 0.5 * viewport.zw;

 vec2 dir;
 float len = offset;
 if (position == positionPrev) {
 dir = normalize(nextScreen - currScreen);
 }
 else if (position == positionNext) {
 dir = normalize(currScreen - prevScreen);
 }
 else {
 vec2 dirA = normalize(currScreen - prevScreen);
 vec2 dirB = normalize(nextScreen - currScreen);

 vec2 tanget = normalize(dirA + dirB);

 float miter = 1.0 / max(dot(tanget, dirA), 0.5);
 len *= miter;
 dir = tanget;
 }

 dir = vec2(-dir.y, dir.x) * len;
 currScreen += dir;

 currProj.xy = (currScreen / viewport.zw - 0.5) * 2.0 * abs(currProj.w);
@end


@export ecgl.meshLines3D.vertex

attribute vec3 position: POSITION;
attribute vec3 positionPrev;
attribute vec3 positionNext;
attribute float offset;
attribute vec4 a_Color : COLOR;

#ifdef VERTEX_ANIMATION
attribute vec3 prevPosition;
attribute vec3 prevPositionPrev;
attribute vec3 prevPositionNext;
uniform float percent : 1.0;
#endif

uniform mat4 worldViewProjection : WORLDVIEWPROJECTION;
uniform vec4 viewport : VIEWPORT;
uniform float near : NEAR;

varying vec4 v_Color;

@import ecgl.common.wireframe.vertexHeader

@import ecgl.lines3D.clipNear

void main()
{
 @import ecgl.lines3D.expandLine

 gl_Position = currProj;

 v_Color = a_Color;

 @import ecgl.common.wireframe.vertexMain
}
@end


@export ecgl.meshLines3D.fragment

uniform vec4 color : [1.0, 1.0, 1.0, 1.0];

varying vec4 v_Color;

@import ecgl.common.wireframe.fragmentHeader

@import clay.util.srgb

void main()
{
#ifdef SRGB_DECODE
 gl_FragColor = sRGBToLinear(color * v_Color);
#else
 gl_FragColor = color * v_Color;
#endif

 @import ecgl.common.wireframe.fragmentMain
}

@end`;var C1=Se.firstNotNull;D.Shader.import(eu);var jn={x:0,y:2,z:1};const u6=kt.extend({type:"grid3D",__ecgl__:!0,init:function(e,t){var r=[["y","z","x",-1,"left"],["y","z","x",1,"right"],["x","y","z",-1,"bottom"],["x","y","z",1,"top"],["x","z","y",-1,"far"],["x","z","y",1,"near"]],n=["x","y","z"],a=new D.Material({shader:D.createShader("ecgl.color"),depthMask:!1,transparent:!0}),i=new D.Material({shader:D.createShader("ecgl.meshLines3D"),depthMask:!1,transparent:!0});a.define("fragment","DOUBLE_SIDED"),a.define("both","VERTEX_COLOR"),this.groupGL=new D.Node,this._control=new Jl({zr:t.getZr()}),this._control.init(),this._faces=r.map(function(s){var l=new Ql(s,i,a);return this.groupGL.add(l.rootNode),l},this),this._axes=n.map(function(s){var l=new dd(s,i);return this.groupGL.add(l.rootNode),l},this);var o=t.getDevicePixelRatio();this._axisLabelSurface=new hl({width:256,height:256,devicePixelRatio:o}),this._axisLabelSurface.onupdate=function(){t.getZr().refresh()},this._axisPointerLineMesh=new D.Mesh({geometry:new Sa({useNativeLine:!1}),material:i,castShadow:!1,ignorePicking:!0,renderOrder:3}),this.groupGL.add(this._axisPointerLineMesh),this._axisPointerLabelsSurface=new hl({width:128,height:128,devicePixelRatio:o}),this._axisPointerLabelsMesh=new fd({ignorePicking:!0,renderOrder:4,castShadow:!1}),this._axisPointerLabelsMesh.material.set("textureAtlas",this._axisPointerLabelsSurface.getTexture()),this.groupGL.add(this._axisPointerLabelsMesh),this._lightRoot=new D.Node,this._sceneHelper=new Rn,this._sceneHelper.initLight(this._lightRoot)},render:function(e,t,r){this._model=e,this._api=r;var n=e.coordinateSystem;n.viewGL.add(this._lightRoot),e.get("show")?n.viewGL.add(this.groupGL):n.viewGL.remove(this.groupGL);var a=this._control;a.setViewGL(n.viewGL);var i=e.getModel("viewControl");a.setFromViewControlModel(i,0),this._axisLabelSurface.clear(),a.off("update"),e.get("show")&&(this._faces.forEach(function(o){o.update(e,t,r)},this),this._axes.forEach(function(o){o.update(e,this._axisLabelSurface,r)},this)),a.on("update",this._onCameraChange.bind(this,e,r),this),this._sceneHelper.setScene(n.viewGL.scene),this._sceneHelper.updateLight(e),n.viewGL.setPostEffect(e.getModel("postEffect"),r),n.viewGL.setTemporalSuperSampling(e.getModel("temporalSuperSampling")),this._initMouseHandler(e)},afterRender:function(e,t,r,n){var a=n.renderer;this._sceneHelper.updateAmbientCubemap(a,e,r),this._sceneHelper.updateSkybox(a,e,r)},showAxisPointer:function(e,t,r,n){this._doShowAxisPointer(),this._updateAxisPointer(n.value)},hideAxisPointer:function(e,t,r,n){this._doHideAxisPointer()},_initMouseHandler:function(e){var t=e.coordinateSystem,r=t.viewGL;e.get("show")&&e.get("axisPointer.show")?r.on("mousemove",this._updateAxisPointerOnMousePosition,this):r.off("mousemove",this._updateAxisPointerOnMousePosition)},_updateAxisPointerOnMousePosition:function(e){if(!e.target){for(var t=this._model,r=t.coordinateSystem,n=r.viewGL,a=n.castRay(e.offsetX,e.offsetY,new D.Ray),i,o=0;o<this._faces.length;o++){var s=this._faces[o];if(!s.rootNode.invisible){s.plane.normal.dot(n.camera.worldTransform.z)<0&&s.plane.normal.negate();var l=a.intersectPlane(s.plane);if(l){var u=r.getAxis(s.faceInfo[0]),c=r.getAxis(s.faceInfo[1]),h=jn[s.faceInfo[0]],f=jn[s.faceInfo[1]];u.contain(l.array[h])&&c.contain(l.array[f])&&(i=l)}}}if(i){var d=r.pointToData(i.array,[],!0);this._updateAxisPointer(d),this._doShowAxisPointer()}else this._doHideAxisPointer()}},_onCameraChange:function(e,t){e.get("show")&&(this._updateFaceVisibility(),this._updateAxisLinePosition());var r=this._control;t.dispatchAction({type:"grid3DChangeCamera",alpha:r.getAlpha(),beta:r.getBeta(),distance:r.getDistance(),center:r.getCenter(),from:this.uid,grid3DId:e.id})},_updateFaceVisibility:function(){var e=this._control.getCamera(),t=new D.Vector3;e.update();for(var r=0;r<this._faces.length/2;r++){for(var n=[],a=0;a<2;a++){var i=this._faces[r*2+a];i.rootNode.getWorldPosition(t),t.transformMat4(e.viewMatrix),n[a]=t.z}var o=n[0]>n[1]?0:1,s=this._faces[r*2+o],l=this._faces[r*2+1-o];s.rootNode.invisible=!0,l.rootNode.invisible=!1}},_updateAxisLinePosition:function(){var e=this._model.coordinateSystem,t=e.getAxis("x"),r=e.getAxis("y"),n=e.getAxis("z"),a=n.getExtentMax(),i=n.getExtentMin(),o=t.getExtentMin(),s=t.getExtentMax(),l=r.getExtentMax(),u=r.getExtentMin(),c=this._axes[0].rootNode,h=this._axes[1].rootNode,f=this._axes[2].rootNode,d=this._faces,v=d[4].rootNode.invisible?u:l,p=d[2].rootNode.invisible?a:i,g=d[0].rootNode.invisible?o:s,m=d[2].rootNode.invisible?a:i,_=d[0].rootNode.invisible?s:o,y=d[4].rootNode.invisible?u:l;c.rotation.identity(),h.rotation.identity(),f.rotation.identity(),d[4].rootNode.invisible&&(this._axes[0].flipped=!0,c.rotation.rotateX(Math.PI)),d[0].rootNode.invisible&&(this._axes[1].flipped=!0,h.rotation.rotateZ(Math.PI)),d[4].rootNode.invisible&&(this._axes[2].flipped=!0,f.rotation.rotateY(Math.PI)),c.position.set(0,p,v),h.position.set(g,m,0),f.position.set(_,0,y),c.update(),h.update(),f.update(),this._updateAxisLabelAlign()},_updateAxisLabelAlign:function(){var e=this._control.getCamera(),t=[new D.Vector4,new D.Vector4],r=new D.Vector4;this.groupGL.getWorldPosition(r),r.w=1,r.transformMat4(e.viewMatrix).transformMat4(e.projectionMatrix),r.x/=r.w,r.y/=r.w,this._axes.forEach(function(n){var a=n.axisLineCoords;n.labelsMesh.geometry;for(var i=0;i<t.length;i++)t[i].setArray(a[i]),t[i].w=1,t[i].transformMat4(n.rootNode.worldTransform).transformMat4(e.viewMatrix).transformMat4(e.projectionMatrix),t[i].x/=t[i].w,t[i].y/=t[i].w;var o=t[1].x-t[0].x,s=t[1].y-t[0].y,l=(t[1].x+t[0].x)/2,u=(t[1].y+t[0].y)/2,c,h;Math.abs(s/o)<.5?(c="center",h=u>r.y?"bottom":"top"):(h="middle",c=l>r.x?"left":"right"),n.setSpriteAlign(c,h,this._api)},this)},_doShowAxisPointer:function(){this._axisPointerLineMesh.invisible&&(this._axisPointerLineMesh.invisible=!1,this._axisPointerLabelsMesh.invisible=!1,this._api.getZr().refresh())},_doHideAxisPointer:function(){this._axisPointerLineMesh.invisible||(this._axisPointerLineMesh.invisible=!0,this._axisPointerLabelsMesh.invisible=!0,this._api.getZr().refresh())},_updateAxisPointer:function(e){var t=this._model.coordinateSystem,r=t.dataToPoint(e),n=this._axisPointerLineMesh,a=n.geometry,i=this._model.getModel("axisPointer"),o=this._api.getDevicePixelRatio();a.convertToDynamicArray(!0);function s(w){return Se.firstNotNull(w.model.get("axisPointer.show"),i.get("show"))}function l(w){var A=w.model.getModel("axisPointer",i),E=A.getModel("lineStyle"),C=D.parseColor(E.get("color")),M=C1(E.get("width"),1),P=C1(E.get("opacity"),1);return C[3]*=P,{color:C,lineWidth:M}}for(var u=0;u<this._faces.length;u++){var c=this._faces[u];if(!c.rootNode.invisible){for(var h=c.faceInfo,f=h[3]<0?t.getAxis(h[2]).getExtentMin():t.getAxis(h[2]).getExtentMax(),d=jn[h[2]],v=0;v<2;v++){var p=h[v],g=h[1-v],m=t.getAxis(p),_=t.getAxis(g);if(s(m)){var y=[0,0,0],x=[0,0,0],S=jn[p],T=jn[g];y[S]=x[S]=r[S],y[d]=x[d]=f,y[T]=_.getExtentMin(),x[T]=_.getExtentMax();var b=l(m);a.addLine(y,x,b.color,b.lineWidth*o)}}if(s(t.getAxis(h[2]))){var y=r.slice(),x=r.slice();x[d]=f;var b=l(t.getAxis(h[2]));a.addLine(y,x,b.color,b.lineWidth*o)}}}a.convertToTypedArray(),this._updateAxisPointerLabelsMesh(e),this._api.getZr().refresh()},_updateAxisPointerLabelsMesh:function(e){var t=this._model,r=this._axisPointerLabelsMesh,n=this._axisPointerLabelsSurface,a=t.coordinateSystem,i=t.getModel("axisPointer");r.geometry.convertToDynamicArray(!0),n.clear();var o={x:"y",y:"x",z:"y"};this._axes.forEach(function(s,l){var u=a.getAxis(s.dim),c=u.model,h=c.getModel("axisPointer",i),f=h.getModel("label"),d=h.get("lineStyle.color");if(!(!f.get("show")||!h.get("show"))){var v=e[l],p=f.get("formatter"),g=u.scale.getLabel({value:v});if(p!=null)g=p(g,e);else if(u.scale.type==="interval"||u.scale.type==="log"){var m=Hm(u.scale.getTicks()[0]);g=v.toFixed(m+2)}var _=f.get("color"),y=new rt({style:ft(f,{text:g,fill:_||d,align:"left",verticalAlign:"top"})}),x=n.add(y),S=y.getBoundingRect(),T=this._api.getDevicePixelRatio(),b=s.rootNode.position.toArray(),w=jn[o[s.dim]];b[w]+=(s.flipped?-1:1)*f.get("margin"),b[jn[s.dim]]=u.dataToCoord(e[l]),r.geometry.addSprite(b,[S.width*T,S.height*T],x,s.textAlign,s.textVerticalAlign)}},this),n.getZr().refreshImmediately(),r.material.set("uvScale",n.getCoordsScale()),r.geometry.convertToTypedArray()},dispose:function(){this.groupGL.removeAll(),this._control.dispose(),this._axisLabelSurface.dispose(),this._axisPointerLabelsSurface.dispose()}});function So(e){Wm.call(this,e),this.type="cartesian3D",this.dimensions=["x","y","z"],this.size=[0,0,0]}So.prototype={constructor:So,model:null,containPoint:function(e){return this.getAxis("x").contain(e[0])&&this.getAxis("y").contain(e[2])&&this.getAxis("z").contain(e[1])},containData:function(e){return this.getAxis("x").containData(e[0])&&this.getAxis("y").containData(e[1])&&this.getAxis("z").containData(e[2])},dataToPoint:function(e,t,r){return t=t||[],t[0]=this.getAxis("x").dataToCoord(e[0],r),t[2]=this.getAxis("y").dataToCoord(e[1],r),t[1]=this.getAxis("z").dataToCoord(e[2],r),t},pointToData:function(e,t,r){return t=t||[],t[0]=this.getAxis("x").coordToData(e[0],r),t[1]=this.getAxis("y").coordToData(e[2],r),t[2]=this.getAxis("z").coordToData(e[1],r),t}};$m(So,Wm);function fl(e,t,r){or.call(this,e,t,r)}fl.prototype={constructor:fl,getExtentMin:function(){var e=this._extent;return Math.min(e[0],e[1])},getExtentMax:function(){var e=this._extent;return Math.max(e[0],e[1])},calculateCategoryInterval:function(){return Math.floor(this.scale.count()/8)}};$m(fl,or);var zh=function(){this._pool={},this._allocatedTextures=[]};zh.prototype={constructor:zh,get:function(e){var t=L1(e);this._pool.hasOwnProperty(t)||(this._pool[t]=[]);var r=this._pool[t];if(!r.length){var n=new _e(e);return this._allocatedTextures.push(n),n}return r.pop()},put:function(e){var t=L1(e);this._pool.hasOwnProperty(t)||(this._pool[t]=[]);var r=this._pool[t];r.push(e)},clear:function(e){for(var t=0;t<this._allocatedTextures.length;t++)this._allocatedTextures[t].dispose(e);this._pool={},this._allocatedTextures=[]}};var mx={width:512,height:512,type:G.UNSIGNED_BYTE,format:G.RGBA,wrapS:G.CLAMP_TO_EDGE,wrapT:G.CLAMP_TO_EDGE,minFilter:G.LINEAR_MIPMAP_LINEAR,magFilter:G.LINEAR,useMipmap:!0,anisotropic:1,flipY:!0,unpackAlignment:4,premultiplyAlpha:!1},Ic=Object.keys(mx);function L1(e){Pt.defaultsWithPropList(e,mx,Ic),c6(e);for(var t="",r=0;r<Ic.length;r++){var n=Ic[r],a=e[n].toString();t+=a}return t}function c6(e){var t=h6(e.width,e.height);e.format===G.DEPTH_COMPONENT&&(e.useMipmap=!1),(!t||!e.useMipmap)&&(e.minFilter==G.NEAREST_MIPMAP_NEAREST||e.minFilter==G.NEAREST_MIPMAP_LINEAR?e.minFilter=G.NEAREST:(e.minFilter==G.LINEAR_MIPMAP_LINEAR||e.minFilter==G.LINEAR_MIPMAP_NEAREST)&&(e.minFilter=G.LINEAR)),t||(e.wrapS=G.CLAMP_TO_EDGE,e.wrapT=G.CLAMP_TO_EDGE)}function h6(e,t){return(e&e-1)===0&&(t&t-1)===0}const yx=zh,f6=`@export clay.sm.depth.vertex
uniform mat4 worldViewProjection : WORLDVIEWPROJECTION;
attribute vec3 position : POSITION;
attribute vec2 texcoord : TEXCOORD_0;
uniform vec2 uvRepeat = vec2(1.0, 1.0);
uniform vec2 uvOffset = vec2(0.0, 0.0);
@import clay.chunk.skinning_header
@import clay.chunk.instancing_header
varying vec4 v_ViewPosition;
varying vec2 v_Texcoord;
void main(){
 vec4 P = vec4(position, 1.0);
#ifdef SKINNING
 @import clay.chunk.skin_matrix
 P = skinMatrixWS * P;
#endif
#ifdef INSTANCING
 @import clay.chunk.instancing_matrix
 P = instanceMat * P;
#endif
 v_ViewPosition = worldViewProjection * P;
 gl_Position = v_ViewPosition;
 v_Texcoord = texcoord * uvRepeat + uvOffset;
}
@end
@export clay.sm.depth.fragment
varying vec4 v_ViewPosition;
varying vec2 v_Texcoord;
uniform float bias : 0.001;
uniform float slopeScale : 1.0;
uniform sampler2D alphaMap;
uniform float alphaCutoff: 0.0;
@import clay.util.encode_float
void main(){
 float depth = v_ViewPosition.z / v_ViewPosition.w;
 if (alphaCutoff > 0.0) {
 if (texture2D(alphaMap, v_Texcoord).a <= alphaCutoff) {
 discard;
 }
 }
#ifdef USE_VSM
 depth = depth * 0.5 + 0.5;
 float moment1 = depth;
 float moment2 = depth * depth;
 #ifdef SUPPORT_STANDARD_DERIVATIVES
 float dx = dFdx(depth);
 float dy = dFdy(depth);
 moment2 += 0.25*(dx*dx+dy*dy);
 #endif
 gl_FragColor = vec4(moment1, moment2, 0.0, 1.0);
#else
 #ifdef SUPPORT_STANDARD_DERIVATIVES
 float dx = dFdx(depth);
 float dy = dFdy(depth);
 depth += sqrt(dx*dx + dy*dy) * slopeScale + bias;
 #else
 depth += bias;
 #endif
 gl_FragColor = encodeFloat(depth * 0.5 + 0.5);
#endif
}
@end
@export clay.sm.debug_depth
uniform sampler2D depthMap;
varying vec2 v_Texcoord;
@import clay.util.decode_float
void main() {
 vec4 tex = texture2D(depthMap, v_Texcoord);
#ifdef USE_VSM
 gl_FragColor = vec4(tex.rgb, 1.0);
#else
 float depth = decodeFloat(tex);
 gl_FragColor = vec4(depth, depth, depth, 1.0);
#endif
}
@end
@export clay.sm.distance.vertex
uniform mat4 worldViewProjection : WORLDVIEWPROJECTION;
uniform mat4 world : WORLD;
attribute vec3 position : POSITION;
@import clay.chunk.skinning_header
varying vec3 v_WorldPosition;
void main (){
 vec4 P = vec4(position, 1.0);
#ifdef SKINNING
 @import clay.chunk.skin_matrix
 P = skinMatrixWS * P;
#endif
#ifdef INSTANCING
 @import clay.chunk.instancing_matrix
 P = instanceMat * P;
#endif
 gl_Position = worldViewProjection * P;
 v_WorldPosition = (world * P).xyz;
}
@end
@export clay.sm.distance.fragment
uniform vec3 lightPosition;
uniform float range : 100;
varying vec3 v_WorldPosition;
@import clay.util.encode_float
void main(){
 float dist = distance(lightPosition, v_WorldPosition);
#ifdef USE_VSM
 gl_FragColor = vec4(dist, dist * dist, 0.0, 0.0);
#else
 dist = dist / range;
 gl_FragColor = encodeFloat(dist);
#endif
}
@end
@export clay.plugin.shadow_map_common
@import clay.util.decode_float
float tapShadowMap(sampler2D map, vec2 uv, float z){
 vec4 tex = texture2D(map, uv);
 return step(z, decodeFloat(tex) * 2.0 - 1.0);
}
float pcf(sampler2D map, vec2 uv, float z, float textureSize, vec2 scale) {
 float shadowContrib = tapShadowMap(map, uv, z);
 vec2 offset = vec2(1.0 / textureSize) * scale;
#ifdef PCF_KERNEL_SIZE
 for (int _idx_ = 0; _idx_ < PCF_KERNEL_SIZE; _idx_++) {{
 shadowContrib += tapShadowMap(map, uv + offset * pcfKernel[_idx_], z);
 }}
 return shadowContrib / float(PCF_KERNEL_SIZE + 1);
#else
 shadowContrib += tapShadowMap(map, uv+vec2(offset.x, 0.0), z);
 shadowContrib += tapShadowMap(map, uv+vec2(offset.x, offset.y), z);
 shadowContrib += tapShadowMap(map, uv+vec2(-offset.x, offset.y), z);
 shadowContrib += tapShadowMap(map, uv+vec2(0.0, offset.y), z);
 shadowContrib += tapShadowMap(map, uv+vec2(-offset.x, 0.0), z);
 shadowContrib += tapShadowMap(map, uv+vec2(-offset.x, -offset.y), z);
 shadowContrib += tapShadowMap(map, uv+vec2(offset.x, -offset.y), z);
 shadowContrib += tapShadowMap(map, uv+vec2(0.0, -offset.y), z);
 return shadowContrib / 9.0;
#endif
}
float pcf(sampler2D map, vec2 uv, float z, float textureSize) {
 return pcf(map, uv, z, textureSize, vec2(1.0));
}
float chebyshevUpperBound(vec2 moments, float z){
 float p = 0.0;
 z = z * 0.5 + 0.5;
 if (z <= moments.x) {
 p = 1.0;
 }
 float variance = moments.y - moments.x * moments.x;
 variance = max(variance, 0.0000001);
 float mD = moments.x - z;
 float pMax = variance / (variance + mD * mD);
 pMax = clamp((pMax-0.4)/(1.0-0.4), 0.0, 1.0);
 return max(p, pMax);
}
float computeShadowContrib(
 sampler2D map, mat4 lightVPM, vec3 position, float textureSize, vec2 scale, vec2 offset
) {
 vec4 posInLightSpace = lightVPM * vec4(position, 1.0);
 posInLightSpace.xyz /= posInLightSpace.w;
 float z = posInLightSpace.z;
 if(all(greaterThan(posInLightSpace.xyz, vec3(-0.99, -0.99, -1.0))) &&
 all(lessThan(posInLightSpace.xyz, vec3(0.99, 0.99, 1.0)))){
 vec2 uv = (posInLightSpace.xy+1.0) / 2.0;
 #ifdef USE_VSM
 vec2 moments = texture2D(map, uv * scale + offset).xy;
 return chebyshevUpperBound(moments, z);
 #else
 return pcf(map, uv * scale + offset, z, textureSize, scale);
 #endif
 }
 return 1.0;
}
float computeShadowContrib(sampler2D map, mat4 lightVPM, vec3 position, float textureSize) {
 return computeShadowContrib(map, lightVPM, position, textureSize, vec2(1.0), vec2(0.0));
}
float computeShadowContribOmni(samplerCube map, vec3 direction, float range)
{
 float dist = length(direction);
 vec4 shadowTex = textureCube(map, direction);
#ifdef USE_VSM
 vec2 moments = shadowTex.xy;
 float variance = moments.y - moments.x * moments.x;
 float mD = moments.x - dist;
 float p = variance / (variance + mD * mD);
 if(moments.x + 0.001 < dist){
 return clamp(p, 0.0, 1.0);
 }else{
 return 1.0;
 }
#else
 return step(dist, (decodeFloat(shadowTex) + 0.0002) * range);
#endif
}
@end
@export clay.plugin.compute_shadow_map
#if defined(SPOT_LIGHT_SHADOWMAP_COUNT) || defined(DIRECTIONAL_LIGHT_SHADOWMAP_COUNT) || defined(POINT_LIGHT_SHADOWMAP_COUNT)
#ifdef SPOT_LIGHT_SHADOWMAP_COUNT
uniform sampler2D spotLightShadowMaps[SPOT_LIGHT_SHADOWMAP_COUNT]:unconfigurable;
uniform mat4 spotLightMatrices[SPOT_LIGHT_SHADOWMAP_COUNT]:unconfigurable;
uniform float spotLightShadowMapSizes[SPOT_LIGHT_SHADOWMAP_COUNT]:unconfigurable;
#endif
#ifdef DIRECTIONAL_LIGHT_SHADOWMAP_COUNT
#if defined(SHADOW_CASCADE)
uniform sampler2D directionalLightShadowMaps[1]:unconfigurable;
uniform mat4 directionalLightMatrices[SHADOW_CASCADE]:unconfigurable;
uniform float directionalLightShadowMapSizes[1]:unconfigurable;
uniform float shadowCascadeClipsNear[SHADOW_CASCADE]:unconfigurable;
uniform float shadowCascadeClipsFar[SHADOW_CASCADE]:unconfigurable;
#else
uniform sampler2D directionalLightShadowMaps[DIRECTIONAL_LIGHT_SHADOWMAP_COUNT]:unconfigurable;
uniform mat4 directionalLightMatrices[DIRECTIONAL_LIGHT_SHADOWMAP_COUNT]:unconfigurable;
uniform float directionalLightShadowMapSizes[DIRECTIONAL_LIGHT_SHADOWMAP_COUNT]:unconfigurable;
#endif
#endif
#ifdef POINT_LIGHT_SHADOWMAP_COUNT
uniform samplerCube pointLightShadowMaps[POINT_LIGHT_SHADOWMAP_COUNT]:unconfigurable;
#endif
uniform bool shadowEnabled : true;
#ifdef PCF_KERNEL_SIZE
uniform vec2 pcfKernel[PCF_KERNEL_SIZE];
#endif
@import clay.plugin.shadow_map_common
#if defined(SPOT_LIGHT_SHADOWMAP_COUNT)
void computeShadowOfSpotLights(vec3 position, inout float shadowContribs[SPOT_LIGHT_COUNT] ) {
 float shadowContrib;
 for(int _idx_ = 0; _idx_ < SPOT_LIGHT_SHADOWMAP_COUNT; _idx_++) {{
 shadowContrib = computeShadowContrib(
 spotLightShadowMaps[_idx_], spotLightMatrices[_idx_], position,
 spotLightShadowMapSizes[_idx_]
 );
 shadowContribs[_idx_] = shadowContrib;
 }}
 for(int _idx_ = SPOT_LIGHT_SHADOWMAP_COUNT; _idx_ < SPOT_LIGHT_COUNT; _idx_++){{
 shadowContribs[_idx_] = 1.0;
 }}
}
#endif
#if defined(DIRECTIONAL_LIGHT_SHADOWMAP_COUNT)
#ifdef SHADOW_CASCADE
void computeShadowOfDirectionalLights(vec3 position, inout float shadowContribs[DIRECTIONAL_LIGHT_COUNT]){
 float depth = (2.0 * gl_FragCoord.z - gl_DepthRange.near - gl_DepthRange.far)
 / (gl_DepthRange.far - gl_DepthRange.near);
 float shadowContrib;
 shadowContribs[0] = 1.0;
 for (int _idx_ = 0; _idx_ < SHADOW_CASCADE; _idx_++) {{
 if (
 depth >= shadowCascadeClipsNear[_idx_] &&
 depth <= shadowCascadeClipsFar[_idx_]
 ) {
 shadowContrib = computeShadowContrib(
 directionalLightShadowMaps[0], directionalLightMatrices[_idx_], position,
 directionalLightShadowMapSizes[0],
 vec2(1.0 / float(SHADOW_CASCADE), 1.0),
 vec2(float(_idx_) / float(SHADOW_CASCADE), 0.0)
 );
 shadowContribs[0] = shadowContrib;
 }
 }}
 for(int _idx_ = DIRECTIONAL_LIGHT_SHADOWMAP_COUNT; _idx_ < DIRECTIONAL_LIGHT_COUNT; _idx_++) {{
 shadowContribs[_idx_] = 1.0;
 }}
}
#else
void computeShadowOfDirectionalLights(vec3 position, inout float shadowContribs[DIRECTIONAL_LIGHT_COUNT]){
 float shadowContrib;
 for(int _idx_ = 0; _idx_ < DIRECTIONAL_LIGHT_SHADOWMAP_COUNT; _idx_++) {{
 shadowContrib = computeShadowContrib(
 directionalLightShadowMaps[_idx_], directionalLightMatrices[_idx_], position,
 directionalLightShadowMapSizes[_idx_]
 );
 shadowContribs[_idx_] = shadowContrib;
 }}
 for(int _idx_ = DIRECTIONAL_LIGHT_SHADOWMAP_COUNT; _idx_ < DIRECTIONAL_LIGHT_COUNT; _idx_++) {{
 shadowContribs[_idx_] = 1.0;
 }}
}
#endif
#endif
#if defined(POINT_LIGHT_SHADOWMAP_COUNT)
void computeShadowOfPointLights(vec3 position, inout float shadowContribs[POINT_LIGHT_COUNT] ){
 vec3 lightPosition;
 vec3 direction;
 for(int _idx_ = 0; _idx_ < POINT_LIGHT_SHADOWMAP_COUNT; _idx_++) {{
 lightPosition = pointLightPosition[_idx_];
 direction = position - lightPosition;
 shadowContribs[_idx_] = computeShadowContribOmni(pointLightShadowMaps[_idx_], direction, pointLightRange[_idx_]);
 }}
 for(int _idx_ = POINT_LIGHT_SHADOWMAP_COUNT; _idx_ < POINT_LIGHT_COUNT; _idx_++) {{
 shadowContribs[_idx_] = 1.0;
 }}
}
#endif
#endif
@end`;var pn=["px","nx","py","ny","pz","nz"];H.import(f6);function Rc(e,t,r){if(r==="alphaMap")return e.material.get("diffuseMap");if(r==="alphaCutoff"){if(e.material.isDefined("fragment","ALPHA_TEST")&&e.material.get("diffuseMap")){var n=e.material.get("alphaCutoff");return n||0}return 0}else return r==="uvRepeat"?e.material.get("uvRepeat"):r==="uvOffset"?e.material.get("uvOffset"):t.get(r)}function D1(e,t){var r=e.material,n=t.material;return r.get("diffuseMap")!==n.get("diffuseMap")||(r.get("alphaCutoff")||0)!==(n.get("alphaCutoff")||0)}var zr=qt.extend(function(){return{softShadow:zr.PCF,shadowBlur:1,lightFrustumBias:"auto",kernelPCF:new Float32Array([1,0,1,1,-1,1,0,1,-1,0,-1,-1,1,-1,0,-1]),precision:"highp",_lastRenderNotCastShadow:!1,_frameBuffer:new Rt,_textures:{},_shadowMapNumber:{POINT_LIGHT:0,DIRECTIONAL_LIGHT:0,SPOT_LIGHT:0},_depthMaterials:{},_distanceMaterials:{},_receivers:[],_lightsCastShadow:[],_lightCameras:{},_lightMaterials:{},_texturePool:new yx}},function(){this._gaussianPassH=new dt({fragment:H.source("clay.compositor.gaussian_blur")}),this._gaussianPassV=new dt({fragment:H.source("clay.compositor.gaussian_blur")}),this._gaussianPassH.setUniform("blurSize",this.shadowBlur),this._gaussianPassH.setUniform("blurDir",0),this._gaussianPassV.setUniform("blurSize",this.shadowBlur),this._gaussianPassV.setUniform("blurDir",1),this._outputDepthPass=new dt({fragment:H.source("clay.sm.debug_depth")})},{render:function(e,t,r,n){r||(r=t.getMainCamera()),this.trigger("beforerender",this,e,t,r),this._renderShadowPass(e,t,r,n),this.trigger("afterrender",this,e,t,r)},renderDebug:function(e,t){e.saveClear();var r=e.viewport,n=0,a=0,i=t||r.width/4,o=i;this.softShadow===zr.VSM?this._outputDepthPass.material.define("fragment","USE_VSM"):this._outputDepthPass.material.undefine("fragment","USE_VSM");for(var s in this._textures){var l=this._textures[s];e.setViewport(n,a,i*l.width/l.height,o),this._outputDepthPass.setUniform("depthMap",l),this._outputDepthPass.render(e),n+=i*l.width/l.height}e.setViewport(r),e.restoreClear()},_updateReceivers:function(e,t){if(t.receiveShadow?(this._receivers.push(t),t.material.set("shadowEnabled",1),t.material.set("pcfKernel",this.kernelPCF)):t.material.set("shadowEnabled",0),this.softShadow===zr.VSM)t.material.define("fragment","USE_VSM"),t.material.undefine("fragment","PCF_KERNEL_SIZE");else{t.material.undefine("fragment","USE_VSM");var r=this.kernelPCF;r&&r.length?t.material.define("fragment","PCF_KERNEL_SIZE",r.length/2):t.material.undefine("fragment","PCF_KERNEL_SIZE")}},_update:function(e,t){var r=this;t.traverse(function(i){i.isRenderable()&&r._updateReceivers(e,i)});for(var n=0;n<t.lights.length;n++){var a=t.lights[n];a.castShadow&&!a.invisible&&this._lightsCastShadow.push(a)}},_renderShadowPass:function(e,t,r,n){for(var a in this._shadowMapNumber)this._shadowMapNumber[a]=0;this._lightsCastShadow.length=0,this._receivers.length=0;var i=e.gl;if(n||t.update(),r&&r.update(),t.updateLights(),this._update(e,t),!this._lightsCastShadow.length&&this._lastRenderNotCastShadow)return;this._lastRenderNotCastShadow=this._lightsCastShadow===0,i.enable(i.DEPTH_TEST),i.depthMask(!0),i.disable(i.BLEND),i.clearColor(1,1,1,1);for(var o=[],s=[],l=[],u=[],c=[],h=[],f,d=0;d<this._lightsCastShadow.length;d++){var v=this._lightsCastShadow[d];if(v.type==="DIRECTIONAL_LIGHT"){if(f){console.warn("Only one direectional light supported with shadow cascade");continue}if(v.shadowCascade>4){console.warn("Support at most 4 cascade");continue}v.shadowCascade>1&&(f=v),this.renderDirectionalLightShadow(e,t,r,v,c,u,l)}else v.type==="SPOT_LIGHT"?this.renderSpotLightShadow(e,t,v,s,o):v.type==="POINT_LIGHT"&&this.renderPointLightShadow(e,t,v,h);this._shadowMapNumber[v.type]++}for(var p in this._shadowMapNumber)for(var g=this._shadowMapNumber[p],m=p+"_SHADOWMAP_COUNT",d=0;d<this._receivers.length;d++){var _=this._receivers[d],y=_.material;y.fragmentDefines[m]!==g&&(g>0?y.define("fragment",m,g):y.isDefined("fragment",m)&&y.undefine("fragment",m))}for(var d=0;d<this._receivers.length;d++){var _=this._receivers[d],y=_.material;f?y.define("fragment","SHADOW_CASCADE",f.shadowCascade):y.undefine("fragment","SHADOW_CASCADE")}var x=t.shadowUniforms;function S(E){return E.height}if(l.length>0){var T=l.map(S);if(x.directionalLightShadowMaps={value:l,type:"tv"},x.directionalLightMatrices={value:u,type:"m4v"},x.directionalLightShadowMapSizes={value:T,type:"1fv"},f){var b=c.slice(),w=c.slice();b.pop(),w.shift(),b.reverse(),w.reverse(),u.reverse(),x.shadowCascadeClipsNear={value:b,type:"1fv"},x.shadowCascadeClipsFar={value:w,type:"1fv"}}}if(o.length>0){var A=o.map(S),x=t.shadowUniforms;x.spotLightShadowMaps={value:o,type:"tv"},x.spotLightMatrices={value:s,type:"m4v"},x.spotLightShadowMapSizes={value:A,type:"1fv"}}h.length>0&&(x.pointLightShadowMaps={value:h,type:"tv"})},renderDirectionalLightShadow:function(){var e=new ld,t=new ne,r=new $t,n=new ne,a=new ne,i=new ne,o=new ne;return function(s,l,u,c,h,f,d){var v=this._getDepthMaterial(c),p={getMaterial:function(re){return re.shadowDepthMaterial||v},isMaterialChanged:D1,getUniform:Rc,ifRender:function(re){return re.castShadow},sortCompare:ro.opaqueSortCompare};if(!l.viewBoundingBoxLastFrame.isFinite()){var g=l.getBoundingBox();l.viewBoundingBoxLastFrame.copy(g).applyTransform(u.viewMatrix)}var m=Math.min(-l.viewBoundingBoxLastFrame.min.z,u.far),_=Math.max(-l.viewBoundingBoxLastFrame.max.z,u.near),y=this._getDirectionalLightCamera(c,l,u),x=i.array;o.copy(y.projectionMatrix),$.invert(a.array,y.worldTransform.array),$.multiply(a.array,a.array,u.worldTransform.array),$.multiply(x,o.array,a.array);for(var S=[],T=u instanceof bt,b=(u.near+u.far)/(u.near-u.far),w=2*u.near*u.far/(u.near-u.far),A=0;A<=c.shadowCascade;A++){var E=_*Math.pow(m/_,A/c.shadowCascade),C=_+(m-_)*A/c.shadowCascade,M=E*c.cascadeSplitLogFactor+C*(1-c.cascadeSplitLogFactor);S.push(M),h.push(-(-M*b+w)/-M)}var P=this._getTexture(c,c.shadowCascade);d.push(P);var L=s.viewport,I=s.gl;this._frameBuffer.attach(P),this._frameBuffer.bind(s),I.clear(I.COLOR_BUFFER_BIT|I.DEPTH_BUFFER_BIT);for(var A=0;A<c.shadowCascade;A++){var N=S[A],F=S[A+1];T?$.perspective(t.array,u.fov/180*Math.PI,u.aspect,N,F):$.ortho(t.array,u.left,u.right,u.bottom,u.top,N,F),e.setFromProjection(t),e.getTransformedBoundingBox(r,a),r.applyProjection(o);var B=r.min.array,k=r.max.array;B[0]=Math.max(B[0],-1),B[1]=Math.max(B[1],-1),k[0]=Math.min(k[0],1),k[1]=Math.min(k[1],1),n.ortho(B[0],k[0],B[1],k[1],1,-1),y.projectionMatrix.multiplyLeft(n);var z=c.shadowResolution||512;s.setViewport((c.shadowCascade-A-1)*z,0,z,z,1);var W=l.updateRenderList(y);s.renderPass(W.opaque,y,p),this.softShadow===zr.VSM&&this._gaussianFilter(s,P,P.width);var J=new ne;J.copy(y.viewMatrix).multiplyLeft(y.projectionMatrix),f.push(J.array),y.projectionMatrix.copy(o)}this._frameBuffer.unbind(s),s.setViewport(L)}}(),renderSpotLightShadow:function(e,t,r,n,a){var i=this._getTexture(r),o=this._getSpotLightCamera(r),s=e.gl;this._frameBuffer.attach(i),this._frameBuffer.bind(e),s.clear(s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT);var l=this._getDepthMaterial(r),u={getMaterial:function(f){return f.shadowDepthMaterial||l},isMaterialChanged:D1,getUniform:Rc,ifRender:function(f){return f.castShadow},sortCompare:ro.opaqueSortCompare},c=t.updateRenderList(o);e.renderPass(c.opaque,o,u),this._frameBuffer.unbind(e),this.softShadow===zr.VSM&&this._gaussianFilter(e,i,i.width);var h=new ne;h.copy(o.worldTransform).invert().multiplyLeft(o.projectionMatrix),a.push(i),n.push(h.array)},renderPointLightShadow:function(e,t,r,n){var a=this._getTexture(r),i=e.gl;n.push(a);var o=this._getDepthMaterial(r),s={getMaterial:function(_){return _.shadowDepthMaterial||o},getUniform:Rc,sortCompare:ro.opaqueSortCompare},l={px:[],py:[],pz:[],nx:[],ny:[],nz:[]},u=new $t,c=r.getWorldPosition().array,h=new $t,f=r.range;h.min.setArray(c),h.max.setArray(c);var d=new X(f,f,f);h.max.add(d),h.min.sub(d);var v={px:!1,py:!1,pz:!1,nx:!1,ny:!1,nz:!1};t.traverse(function(_){if(_.isRenderable()&&_.castShadow){var y=_.geometry;if(!y.boundingBox){for(var x=0;x<pn.length;x++)l[pn[x]].push(_);return}if(u.transformFrom(y.boundingBox,_.worldTransform),!u.intersectBoundingBox(h))return;u.updateVertices();for(var x=0;x<pn.length;x++)v[pn[x]]=!1;for(var x=0;x<8;x++){var S=u.vertices[x],T=S[0]-c[0],b=S[1]-c[1],w=S[2]-c[2],A=Math.abs(T),E=Math.abs(b),C=Math.abs(w);A>E?A>C?v[T>0?"px":"nx"]=!0:v[w>0?"pz":"nz"]=!0:E>C?v[b>0?"py":"ny"]=!0:v[w>0?"pz":"nz"]=!0}for(var x=0;x<pn.length;x++)v[pn[x]]&&l[pn[x]].push(_)}});for(var p=0;p<6;p++){var g=pn[p],m=this._getPointLightCamera(r,g);this._frameBuffer.attach(a,i.COLOR_ATTACHMENT0,i.TEXTURE_CUBE_MAP_POSITIVE_X+p),this._frameBuffer.bind(e),i.clear(i.COLOR_BUFFER_BIT|i.DEPTH_BUFFER_BIT),e.renderPass(l[g],m,s)}this._frameBuffer.unbind(e)},_getDepthMaterial:function(e){var t=this._lightMaterials[e.__uid__],r=e.type==="POINT_LIGHT";if(!t){var n=r?"clay.sm.distance.":"clay.sm.depth.";t=new Sr({precision:this.precision,shader:new H(H.source(n+"vertex"),H.source(n+"fragment"))}),this._lightMaterials[e.__uid__]=t}return e.shadowSlopeScale!=null&&t.setUniform("slopeScale",e.shadowSlopeScale),e.shadowBias!=null&&t.setUniform("bias",e.shadowBias),this.softShadow===zr.VSM?t.define("fragment","USE_VSM"):t.undefine("fragment","USE_VSM"),r&&(t.set("lightPosition",e.getWorldPosition().array),t.set("range",e.range)),t},_gaussianFilter:function(e,t,r){var n={width:r,height:r,type:ie.FLOAT},a=this._texturePool.get(n);this._frameBuffer.attach(a),this._frameBuffer.bind(e),this._gaussianPassH.setUniform("texture",t),this._gaussianPassH.setUniform("textureWidth",r),this._gaussianPassH.render(e),this._frameBuffer.attach(t),this._gaussianPassV.setUniform("texture",a),this._gaussianPassV.setUniform("textureHeight",r),this._gaussianPassV.render(e),this._frameBuffer.unbind(e),this._texturePool.put(a)},_getTexture:function(e,t){var r=e.__uid__,n=this._textures[r],a=e.shadowResolution||512;return t=t||1,n||(e.type==="POINT_LIGHT"?n=new _o:n=new _e,n.width=a*t,n.height=a,this.softShadow===zr.VSM?(n.type=ie.FLOAT,n.anisotropic=4):(n.minFilter=G.NEAREST,n.magFilter=G.NEAREST,n.useMipmap=!1),this._textures[r]=n),n},_getPointLightCamera:function(e,t){this._lightCameras.point||(this._lightCameras.point={px:new bt,nx:new bt,py:new bt,ny:new bt,pz:new bt,nz:new bt});var r=this._lightCameras.point[t];switch(r.far=e.range,r.fov=90,r.position.set(0,0,0),t){case"px":r.lookAt(X.POSITIVE_X,X.NEGATIVE_Y);break;case"nx":r.lookAt(X.NEGATIVE_X,X.NEGATIVE_Y);break;case"py":r.lookAt(X.POSITIVE_Y,X.POSITIVE_Z);break;case"ny":r.lookAt(X.NEGATIVE_Y,X.NEGATIVE_Z);break;case"pz":r.lookAt(X.POSITIVE_Z,X.NEGATIVE_Y);break;case"nz":r.lookAt(X.NEGATIVE_Z,X.NEGATIVE_Y);break}return e.getWorldPosition(r.position),r.update(),r},_getDirectionalLightCamera:function(){var e=new ne,t=new $t,r=new $t;return function(n,a,i){this._lightCameras.directional||(this._lightCameras.directional=new ni);var o=this._lightCameras.directional;t.copy(a.viewBoundingBoxLastFrame),t.intersection(i.frustum.boundingBox),o.position.copy(t.min).add(t.max).scale(.5).transformMat4(i.worldTransform),o.rotation.copy(n.rotation),o.scale.copy(n.scale),o.updateWorldTransform(),ne.invert(e,o.worldTransform),ne.multiply(e,e,i.worldTransform),r.copy(t).applyTransform(e);var s=r.min.array,l=r.max.array;return o.position.set((s[0]+l[0])/2,(s[1]+l[1])/2,l[2]).transformMat4(o.worldTransform),o.near=0,o.far=-s[2]+l[2],isNaN(this.lightFrustumBias)?o.far*=4:o.far+=this.lightFrustumBias,o.left=s[0],o.right=l[0],o.top=l[1],o.bottom=s[1],o.update(!0),o}}(),_getSpotLightCamera:function(e){this._lightCameras.spot||(this._lightCameras.spot=new bt);var t=this._lightCameras.spot;return t.fov=e.penumbraAngle*2,t.far=e.range,t.worldTransform.copy(e.worldTransform),t.updateProjectionMatrix(),$.invert(t.viewMatrix.array,t.worldTransform.array),t},dispose:function(e){var t=e.gl||e;this._frameBuffer&&this._frameBuffer.dispose(t);for(var r in this._textures)this._textures[r].dispose(t);this._texturePool.clear(e.gl),this._depthMaterials={},this._distanceMaterials={},this._textures={},this._lightCameras={},this._shadowMapNumber={POINT_LIGHT:0,DIRECTIONAL_LIGHT:0,SPOT_LIGHT:0},this._meshMaterials={};for(var n=0;n<this._receivers.length;n++){var a=this._receivers[n];if(a.material){var i=a.material;i.undefine("fragment","POINT_LIGHT_SHADOW_COUNT"),i.undefine("fragment","DIRECTIONAL_LIGHT_SHADOW_COUNT"),i.undefine("fragment","AMBIENT_LIGHT_SHADOW_COUNT"),i.set("shadowEnabled",0)}}this._receivers=[],this._lightsCastShadow=[]}});zr.VSM=1;zr.PCF=2;const d6=zr;var v6=qt.extend(function(){return{name:"",inputLinks:{},outputLinks:{},_prevOutputTextures:{},_outputTextures:{},_outputReferences:{},_rendering:!1,_rendered:!1,_compositor:null}},{updateParameter:function(e,t){var r=this.outputs[e],n=r.parameters,a=r._parametersCopy;if(a||(a=r._parametersCopy={}),n)for(var i in n)i!=="width"&&i!=="height"&&(a[i]=n[i]);var o,s;return n.width instanceof Function?o=n.width.call(this,t):o=n.width,n.height instanceof Function?s=n.height.call(this,t):s=n.height,(a.width!==o||a.height!==s)&&this._outputTextures[e]&&this._outputTextures[e].dispose(t.gl),a.width=o,a.height=s,a},setParameter:function(e,t){},getParameter:function(e){},setParameters:function(e){for(var t in e)this.setParameter(t,e[t])},render:function(){},getOutput:function(e,t){if(t==null)return t=e,this._outputTextures[t];var r=this.outputs[t];if(r)return this._rendered?r.outputLastFrame?this._prevOutputTextures[t]:this._outputTextures[t]:this._rendering?(this._prevOutputTextures[t]||(this._prevOutputTextures[t]=this._compositor.allocateTexture(r.parameters||{})),this._prevOutputTextures[t]):(this.render(e),this._outputTextures[t])},removeReference:function(e){if(this._outputReferences[e]--,this._outputReferences[e]===0){var t=this.outputs[e];t.keepLastFrame?(this._prevOutputTextures[e]&&this._compositor.releaseTexture(this._prevOutputTextures[e]),this._prevOutputTextures[e]=this._outputTextures[e]):this._compositor.releaseTexture(this._outputTextures[e])}},link:function(e,t,r){this.inputLinks[e]={node:t,pin:r},t.outputLinks[r]||(t.outputLinks[r]=[]),t.outputLinks[r].push({node:this,pin:e}),this.pass.material.enableTexture(e)},clear:function(){this.inputLinks={},this.outputLinks={}},updateReference:function(e){if(!this._rendering){this._rendering=!0;for(var t in this.inputLinks){var r=this.inputLinks[t];r.node.updateReference(r.pin)}this._rendering=!1}e&&this._outputReferences[e]++},beforeFrame:function(){this._rendered=!1;for(var e in this.outputLinks)this._outputReferences[e]=0},afterFrame:function(){for(var e in this.outputLinks)if(this._outputReferences[e]>0){var t=this.outputs[e];t.keepLastFrame?(this._prevOutputTextures[e]&&this._compositor.releaseTexture(this._prevOutputTextures[e]),this._prevOutputTextures[e]=this._outputTextures[e]):this._compositor.releaseTexture(this._outputTextures[e])}}});const To=v6;var p6=qt.extend(function(){return{nodes:[]}},{dirty:function(){this._dirty=!0},addNode:function(e){this.nodes.indexOf(e)>=0||(this.nodes.push(e),this._dirty=!0)},removeNode:function(e){typeof e=="string"&&(e=this.getNodeByName(e));var t=this.nodes.indexOf(e);t>=0&&(this.nodes.splice(t,1),this._dirty=!0)},getNodeByName:function(e){for(var t=0;t<this.nodes.length;t++)if(this.nodes[t].name===e)return this.nodes[t]},update:function(){for(var e=0;e<this.nodes.length;e++)this.nodes[e].clear();for(var e=0;e<this.nodes.length;e++){var t=this.nodes[e];if(t.inputs){for(var r in t.inputs)if(t.inputs[r]){if(t.pass&&!t.pass.material.isUniformEnabled(r)){console.warn("Pin "+t.name+"."+r+" not used.");continue}var n=t.inputs[r],a=this.findPin(n);a?t.link(r,a.node,a.pin):console.warn(typeof n=="string"?"Node "+n+" not exist":"Pin of "+n.node+"."+n.pin+" not exist")}}}},findPin:function(e){var t;if((typeof e=="string"||e instanceof To)&&(e={node:e}),typeof e.node=="string")for(var r=0;r<this.nodes.length;r++){var n=this.nodes[r];n.name===e.node&&(t=n)}else t=e.node;if(t){var a=e.pin;if(a||t.outputs&&(a=Object.keys(t.outputs)[0]),t.outputs[a])return{node:t,pin:a}}}});const M1=p6;var g6=M1.extend(function(){return{_outputs:[],_texturePool:new yx,_frameBuffer:new Rt({depthBuffer:!1})}},{addNode:function(e){M1.prototype.addNode.call(this,e),e._compositor=this},render:function(e,t){if(this._dirty){this.update(),this._dirty=!1,this._outputs.length=0;for(var r=0;r<this.nodes.length;r++)this.nodes[r].outputs||this._outputs.push(this.nodes[r])}for(var r=0;r<this.nodes.length;r++)this.nodes[r].beforeFrame();for(var r=0;r<this._outputs.length;r++)this._outputs[r].updateReference();for(var r=0;r<this._outputs.length;r++)this._outputs[r].render(e,t);for(var r=0;r<this.nodes.length;r++)this.nodes[r].afterFrame()},allocateTexture:function(e){return this._texturePool.get(e)},releaseTexture:function(e){this._texturePool.put(e)},getFrameBuffer:function(){return this._frameBuffer},dispose:function(e){this._texturePool.clear(e)}});const m6=g6;var y6=To.extend({name:"scene",scene:null,camera:null,autoUpdateScene:!0,preZ:!1},function(){this.frameBuffer=new Rt},{render:function(e){this._rendering=!0;var t=e.gl;this.trigger("beforerender");var r;if(!this.outputs)r=e.render(this.scene,this.camera,!this.autoUpdateScene,this.preZ);else{var n=this.frameBuffer;for(var a in this.outputs){var i=this.updateParameter(a,e),o=this.outputs[a],s=this._compositor.allocateTexture(i);this._outputTextures[a]=s;var l=o.attachment||t.COLOR_ATTACHMENT0;typeof l=="string"&&(l=t[l]),n.attach(s,l)}n.bind(e);var u=e.getGLExtension("EXT_draw_buffers");if(u){var c=[];for(var l in this.outputs)l=parseInt(l),l>=t.COLOR_ATTACHMENT0&&l<=t.COLOR_ATTACHMENT0+8&&c.push(l);u.drawBuffersEXT(c)}e.saveClear(),e.clearBit=G.DEPTH_BUFFER_BIT|G.COLOR_BUFFER_BIT,r=e.render(this.scene,this.camera,!this.autoUpdateScene,this.preZ),e.restoreClear(),n.unbind(e)}this.trigger("afterrender",r),this._rendering=!1,this._rendered=!0}});const _6=y6;var x6=To.extend(function(){return{texture:null,outputs:{color:{}}}},function(){},{getOutput:function(e,t){return this.texture},beforeFrame:function(){},afterFrame:function(){}});const S6=x6;var T6=To.extend(function(){return{name:"",inputs:{},outputs:null,shader:"",inputLinks:{},outputLinks:{},pass:null,_prevOutputTextures:{},_outputTextures:{},_outputReferences:{},_rendering:!1,_rendered:!1,_compositor:null}},function(){var e=new dt({fragment:this.shader});this.pass=e},{render:function(e,t){this.trigger("beforerender",e),this._rendering=!0;var r=e.gl;for(var n in this.inputLinks){var a=this.inputLinks[n],i=a.node.getOutput(e,a.pin);this.pass.setUniform(n,i)}if(!this.outputs)this.pass.outputs=null,this._compositor.getFrameBuffer().unbind(e),this.pass.render(e,t);else{this.pass.outputs={};var o={};for(var s in this.outputs){var l=this.updateParameter(s,e);isNaN(l.width)&&this.updateParameter(s,e);var u=this.outputs[s],c=this._compositor.allocateTexture(l);this._outputTextures[s]=c;var h=u.attachment||r.COLOR_ATTACHMENT0;typeof h=="string"&&(h=r[h]),o[h]=c}this._compositor.getFrameBuffer().bind(e);for(var h in o)this._compositor.getFrameBuffer().attach(o[h],h);this.pass.render(e),this._compositor.getFrameBuffer().updateMipmap(e)}for(var n in this.inputLinks){var a=this.inputLinks[n];a.node.removeReference(a.pin)}this._rendering=!1,this._rendered=!0,this.trigger("afterrender",e)},updateParameter:function(e,t){var r=this.outputs[e],n=r.parameters,a=r._parametersCopy;if(a||(a=r._parametersCopy={}),n)for(var i in n)i!=="width"&&i!=="height"&&(a[i]=n[i]);var o,s;return typeof n.width=="function"?o=n.width.call(this,t):o=n.width,typeof n.height=="function"?s=n.height.call(this,t):s=n.height,o=Math.ceil(o),s=Math.ceil(s),(a.width!==o||a.height!==s)&&this._outputTextures[e]&&this._outputTextures[e].dispose(t),a.width=o,a.height=s,a},setParameter:function(e,t){this.pass.setUniform(e,t)},getParameter:function(e){return this.pass.getUniform(e)},setParameters:function(e){for(var t in e)this.setParameter(t,e[t])},define:function(e,t){this.pass.material.define("fragment",e,t)},undefine:function(e){this.pass.material.undefine("fragment",e)},removeReference:function(e){if(this._outputReferences[e]--,this._outputReferences[e]===0){var t=this.outputs[e];t.keepLastFrame?(this._prevOutputTextures[e]&&this._compositor.releaseTexture(this._prevOutputTextures[e]),this._prevOutputTextures[e]=this._outputTextures[e]):this._compositor.releaseTexture(this._outputTextures[e])}},clear:function(){To.prototype.clear.call(this),this.pass.material.disableTexturesAll()}});const b6=T6,w6=`@export clay.compositor.coloradjust
varying vec2 v_Texcoord;
uniform sampler2D texture;
uniform float brightness : 0.0;
uniform float contrast : 1.0;
uniform float exposure : 0.0;
uniform float gamma : 1.0;
uniform float saturation : 1.0;
const vec3 w = vec3(0.2125, 0.7154, 0.0721);
void main()
{
 vec4 tex = texture2D( texture, v_Texcoord);
 vec3 color = clamp(tex.rgb + vec3(brightness), 0.0, 1.0);
 color = clamp( (color-vec3(0.5))*contrast+vec3(0.5), 0.0, 1.0);
 color = clamp( color * pow(2.0, exposure), 0.0, 1.0);
 color = clamp( pow(color, vec3(gamma)), 0.0, 1.0);
 float luminance = dot( color, w );
 color = mix(vec3(luminance), color, saturation);
 gl_FragColor = vec4(color, tex.a);
}
@end
@export clay.compositor.brightness
varying vec2 v_Texcoord;
uniform sampler2D texture;
uniform float brightness : 0.0;
void main()
{
 vec4 tex = texture2D( texture, v_Texcoord);
 vec3 color = tex.rgb + vec3(brightness);
 gl_FragColor = vec4(color, tex.a);
}
@end
@export clay.compositor.contrast
varying vec2 v_Texcoord;
uniform sampler2D texture;
uniform float contrast : 1.0;
void main()
{
 vec4 tex = texture2D( texture, v_Texcoord);
 vec3 color = (tex.rgb-vec3(0.5))*contrast+vec3(0.5);
 gl_FragColor = vec4(color, tex.a);
}
@end
@export clay.compositor.exposure
varying vec2 v_Texcoord;
uniform sampler2D texture;
uniform float exposure : 0.0;
void main()
{
 vec4 tex = texture2D(texture, v_Texcoord);
 vec3 color = tex.rgb * pow(2.0, exposure);
 gl_FragColor = vec4(color, tex.a);
}
@end
@export clay.compositor.gamma
varying vec2 v_Texcoord;
uniform sampler2D texture;
uniform float gamma : 1.0;
void main()
{
 vec4 tex = texture2D(texture, v_Texcoord);
 vec3 color = pow(tex.rgb, vec3(gamma));
 gl_FragColor = vec4(color, tex.a);
}
@end
@export clay.compositor.saturation
varying vec2 v_Texcoord;
uniform sampler2D texture;
uniform float saturation : 1.0;
const vec3 w = vec3(0.2125, 0.7154, 0.0721);
void main()
{
 vec4 tex = texture2D(texture, v_Texcoord);
 vec3 color = tex.rgb;
 float luminance = dot(color, w);
 color = mix(vec3(luminance), color, saturation);
 gl_FragColor = vec4(color, tex.a);
}
@end`,_x=`@export clay.compositor.kernel.gaussian_9
float gaussianKernel[9];
gaussianKernel[0] = 0.07;
gaussianKernel[1] = 0.09;
gaussianKernel[2] = 0.12;
gaussianKernel[3] = 0.14;
gaussianKernel[4] = 0.16;
gaussianKernel[5] = 0.14;
gaussianKernel[6] = 0.12;
gaussianKernel[7] = 0.09;
gaussianKernel[8] = 0.07;
@end
@export clay.compositor.kernel.gaussian_13
float gaussianKernel[13];
gaussianKernel[0] = 0.02;
gaussianKernel[1] = 0.03;
gaussianKernel[2] = 0.06;
gaussianKernel[3] = 0.08;
gaussianKernel[4] = 0.11;
gaussianKernel[5] = 0.13;
gaussianKernel[6] = 0.14;
gaussianKernel[7] = 0.13;
gaussianKernel[8] = 0.11;
gaussianKernel[9] = 0.08;
gaussianKernel[10] = 0.06;
gaussianKernel[11] = 0.03;
gaussianKernel[12] = 0.02;
@end
@export clay.compositor.gaussian_blur
#define SHADER_NAME gaussian_blur
uniform sampler2D texture;varying vec2 v_Texcoord;
uniform float blurSize : 2.0;
uniform vec2 textureSize : [512.0, 512.0];
uniform float blurDir : 0.0;
@import clay.util.rgbm
@import clay.util.clamp_sample
void main (void)
{
 @import clay.compositor.kernel.gaussian_9
 vec2 off = blurSize / textureSize;
 off *= vec2(1.0 - blurDir, blurDir);
 vec4 sum = vec4(0.0);
 float weightAll = 0.0;
 for (int i = 0; i < 9; i++) {
 float w = gaussianKernel[i];
 vec4 texel = decodeHDR(clampSample(texture, v_Texcoord + float(i - 4) * off));
 sum += texel * w;
 weightAll += w;
 }
 gl_FragColor = encodeHDR(sum / max(weightAll, 0.01));
}
@end
`,A6=`@export clay.compositor.hdr.log_lum
varying vec2 v_Texcoord;
uniform sampler2D texture;
const vec3 w = vec3(0.2125, 0.7154, 0.0721);
@import clay.util.rgbm
void main()
{
 vec4 tex = decodeHDR(texture2D(texture, v_Texcoord));
 float luminance = dot(tex.rgb, w);
 luminance = log(luminance + 0.001);
 gl_FragColor = encodeHDR(vec4(vec3(luminance), 1.0));
}
@end
@export clay.compositor.hdr.lum_adaption
varying vec2 v_Texcoord;
uniform sampler2D adaptedLum;
uniform sampler2D currentLum;
uniform float frameTime : 0.02;
@import clay.util.rgbm
void main()
{
 float fAdaptedLum = decodeHDR(texture2D(adaptedLum, vec2(0.5, 0.5))).r;
 float fCurrentLum = exp(encodeHDR(texture2D(currentLum, vec2(0.5, 0.5))).r);
 fAdaptedLum += (fCurrentLum - fAdaptedLum) * (1.0 - pow(0.98, 30.0 * frameTime));
 gl_FragColor = encodeHDR(vec4(vec3(fAdaptedLum), 1.0));
}
@end
@export clay.compositor.lum
varying vec2 v_Texcoord;
uniform sampler2D texture;
const vec3 w = vec3(0.2125, 0.7154, 0.0721);
void main()
{
 vec4 tex = texture2D( texture, v_Texcoord );
 float luminance = dot(tex.rgb, w);
 gl_FragColor = vec4(vec3(luminance), 1.0);
}
@end`,xx=`
@export clay.compositor.lut
varying vec2 v_Texcoord;
uniform sampler2D texture;
uniform sampler2D lookup;
void main()
{
 vec4 tex = texture2D(texture, v_Texcoord);
 float blueColor = tex.b * 63.0;
 vec2 quad1;
 quad1.y = floor(floor(blueColor) / 8.0);
 quad1.x = floor(blueColor) - (quad1.y * 8.0);
 vec2 quad2;
 quad2.y = floor(ceil(blueColor) / 8.0);
 quad2.x = ceil(blueColor) - (quad2.y * 8.0);
 vec2 texPos1;
 texPos1.x = (quad1.x * 0.125) + 0.5/512.0 + ((0.125 - 1.0/512.0) * tex.r);
 texPos1.y = (quad1.y * 0.125) + 0.5/512.0 + ((0.125 - 1.0/512.0) * tex.g);
 vec2 texPos2;
 texPos2.x = (quad2.x * 0.125) + 0.5/512.0 + ((0.125 - 1.0/512.0) * tex.r);
 texPos2.y = (quad2.y * 0.125) + 0.5/512.0 + ((0.125 - 1.0/512.0) * tex.g);
 vec4 newColor1 = texture2D(lookup, texPos1);
 vec4 newColor2 = texture2D(lookup, texPos2);
 vec4 newColor = mix(newColor1, newColor2, fract(blueColor));
 gl_FragColor = vec4(newColor.rgb, tex.w);
}
@end`,E6=`@export clay.compositor.vignette
#define OUTPUT_ALPHA
varying vec2 v_Texcoord;
uniform sampler2D texture;
uniform float darkness: 1;
uniform float offset: 1;
@import clay.util.rgbm
void main()
{
 vec4 texel = decodeHDR(texture2D(texture, v_Texcoord));
 gl_FragColor.rgb = texel.rgb;
 vec2 uv = (v_Texcoord - vec2(0.5)) * vec2(offset);
 gl_FragColor = encodeHDR(vec4(mix(texel.rgb, vec3(1.0 - darkness), dot(uv, uv)), texel.a));
}
@end`,Sx=`@export clay.compositor.output
#define OUTPUT_ALPHA
varying vec2 v_Texcoord;
uniform sampler2D texture;
@import clay.util.rgbm
void main()
{
 vec4 tex = decodeHDR(texture2D(texture, v_Texcoord));
 gl_FragColor.rgb = tex.rgb;
#ifdef OUTPUT_ALPHA
 gl_FragColor.a = tex.a;
#else
 gl_FragColor.a = 1.0;
#endif
 gl_FragColor = encodeHDR(gl_FragColor);
#ifdef PREMULTIPLY_ALPHA
 gl_FragColor.rgb *= gl_FragColor.a;
#endif
}
@end`,Tx=`@export clay.compositor.bright
uniform sampler2D texture;
uniform float threshold : 1;
uniform float scale : 1.0;
uniform vec2 textureSize: [512, 512];
varying vec2 v_Texcoord;
const vec3 lumWeight = vec3(0.2125, 0.7154, 0.0721);
@import clay.util.rgbm
vec4 median(vec4 a, vec4 b, vec4 c)
{
 return a + b + c - min(min(a, b), c) - max(max(a, b), c);
}
void main()
{
 vec4 texel = decodeHDR(texture2D(texture, v_Texcoord));
#ifdef ANTI_FLICKER
 vec3 d = 1.0 / textureSize.xyx * vec3(1.0, 1.0, 0.0);
 vec4 s1 = decodeHDR(texture2D(texture, v_Texcoord - d.xz));
 vec4 s2 = decodeHDR(texture2D(texture, v_Texcoord + d.xz));
 vec4 s3 = decodeHDR(texture2D(texture, v_Texcoord - d.zy));
 vec4 s4 = decodeHDR(texture2D(texture, v_Texcoord + d.zy));
 texel = median(median(texel, s1, s2), s3, s4);
#endif
 float lum = dot(texel.rgb , lumWeight);
 vec4 color;
 if (lum > threshold && texel.a > 0.0)
 {
 color = vec4(texel.rgb * scale, texel.a * scale);
 }
 else
 {
 color = vec4(0.0);
 }
 gl_FragColor = encodeHDR(color);
}
@end
`,bx=`@export clay.compositor.downsample
uniform sampler2D texture;
uniform vec2 textureSize : [512, 512];
varying vec2 v_Texcoord;
@import clay.util.rgbm
float brightness(vec3 c)
{
 return max(max(c.r, c.g), c.b);
}
@import clay.util.clamp_sample
void main()
{
 vec4 d = vec4(-1.0, -1.0, 1.0, 1.0) / textureSize.xyxy;
#ifdef ANTI_FLICKER
 vec3 s1 = decodeHDR(clampSample(texture, v_Texcoord + d.xy)).rgb;
 vec3 s2 = decodeHDR(clampSample(texture, v_Texcoord + d.zy)).rgb;
 vec3 s3 = decodeHDR(clampSample(texture, v_Texcoord + d.xw)).rgb;
 vec3 s4 = decodeHDR(clampSample(texture, v_Texcoord + d.zw)).rgb;
 float s1w = 1.0 / (brightness(s1) + 1.0);
 float s2w = 1.0 / (brightness(s2) + 1.0);
 float s3w = 1.0 / (brightness(s3) + 1.0);
 float s4w = 1.0 / (brightness(s4) + 1.0);
 float oneDivideSum = 1.0 / (s1w + s2w + s3w + s4w);
 vec4 color = vec4(
 (s1 * s1w + s2 * s2w + s3 * s3w + s4 * s4w) * oneDivideSum,
 1.0
 );
#else
 vec4 color = decodeHDR(clampSample(texture, v_Texcoord + d.xy));
 color += decodeHDR(clampSample(texture, v_Texcoord + d.zy));
 color += decodeHDR(clampSample(texture, v_Texcoord + d.xw));
 color += decodeHDR(clampSample(texture, v_Texcoord + d.zw));
 color *= 0.25;
#endif
 gl_FragColor = encodeHDR(color);
}
@end`,wx=`
@export clay.compositor.upsample
#define HIGH_QUALITY
uniform sampler2D texture;
uniform vec2 textureSize : [512, 512];
uniform float sampleScale: 0.5;
varying vec2 v_Texcoord;
@import clay.util.rgbm
@import clay.util.clamp_sample
void main()
{
#ifdef HIGH_QUALITY
 vec4 d = vec4(1.0, 1.0, -1.0, 0.0) / textureSize.xyxy * sampleScale;
 vec4 s;
 s = decodeHDR(clampSample(texture, v_Texcoord - d.xy));
 s += decodeHDR(clampSample(texture, v_Texcoord - d.wy)) * 2.0;
 s += decodeHDR(clampSample(texture, v_Texcoord - d.zy));
 s += decodeHDR(clampSample(texture, v_Texcoord + d.zw)) * 2.0;
 s += decodeHDR(clampSample(texture, v_Texcoord )) * 4.0;
 s += decodeHDR(clampSample(texture, v_Texcoord + d.xw)) * 2.0;
 s += decodeHDR(clampSample(texture, v_Texcoord + d.zy));
 s += decodeHDR(clampSample(texture, v_Texcoord + d.wy)) * 2.0;
 s += decodeHDR(clampSample(texture, v_Texcoord + d.xy));
 gl_FragColor = encodeHDR(s / 16.0);
#else
 vec4 d = vec4(-1.0, -1.0, +1.0, +1.0) / textureSize.xyxy;
 vec4 s;
 s = decodeHDR(clampSample(texture, v_Texcoord + d.xy));
 s += decodeHDR(clampSample(texture, v_Texcoord + d.zy));
 s += decodeHDR(clampSample(texture, v_Texcoord + d.xw));
 s += decodeHDR(clampSample(texture, v_Texcoord + d.zw));
 gl_FragColor = encodeHDR(s / 4.0);
#endif
}
@end`,Ax=`@export clay.compositor.hdr.composite
#define TONEMAPPING
uniform sampler2D texture;
#ifdef BLOOM_ENABLED
uniform sampler2D bloom;
#endif
#ifdef LENSFLARE_ENABLED
uniform sampler2D lensflare;
uniform sampler2D lensdirt;
#endif
#ifdef LUM_ENABLED
uniform sampler2D lum;
#endif
#ifdef LUT_ENABLED
uniform sampler2D lut;
#endif
#ifdef COLOR_CORRECTION
uniform float brightness : 0.0;
uniform float contrast : 1.0;
uniform float saturation : 1.0;
#endif
#ifdef VIGNETTE
uniform float vignetteDarkness: 1.0;
uniform float vignetteOffset: 1.0;
#endif
uniform float exposure : 1.0;
uniform float bloomIntensity : 0.25;
uniform float lensflareIntensity : 1;
varying vec2 v_Texcoord;
@import clay.util.srgb
vec3 ACESToneMapping(vec3 color)
{
 const float A = 2.51;
 const float B = 0.03;
 const float C = 2.43;
 const float D = 0.59;
 const float E = 0.14;
 return (color * (A * color + B)) / (color * (C * color + D) + E);
}
float eyeAdaption(float fLum)
{
 return mix(0.2, fLum, 0.5);
}
#ifdef LUT_ENABLED
vec3 lutTransform(vec3 color) {
 float blueColor = color.b * 63.0;
 vec2 quad1;
 quad1.y = floor(floor(blueColor) / 8.0);
 quad1.x = floor(blueColor) - (quad1.y * 8.0);
 vec2 quad2;
 quad2.y = floor(ceil(blueColor) / 8.0);
 quad2.x = ceil(blueColor) - (quad2.y * 8.0);
 vec2 texPos1;
 texPos1.x = (quad1.x * 0.125) + 0.5/512.0 + ((0.125 - 1.0/512.0) * color.r);
 texPos1.y = (quad1.y * 0.125) + 0.5/512.0 + ((0.125 - 1.0/512.0) * color.g);
 vec2 texPos2;
 texPos2.x = (quad2.x * 0.125) + 0.5/512.0 + ((0.125 - 1.0/512.0) * color.r);
 texPos2.y = (quad2.y * 0.125) + 0.5/512.0 + ((0.125 - 1.0/512.0) * color.g);
 vec4 newColor1 = texture2D(lut, texPos1);
 vec4 newColor2 = texture2D(lut, texPos2);
 vec4 newColor = mix(newColor1, newColor2, fract(blueColor));
 return newColor.rgb;
}
#endif
@import clay.util.rgbm
void main()
{
 vec4 texel = vec4(0.0);
 vec4 originalTexel = vec4(0.0);
#ifdef TEXTURE_ENABLED
 texel = decodeHDR(texture2D(texture, v_Texcoord));
 originalTexel = texel;
#endif
#ifdef BLOOM_ENABLED
 vec4 bloomTexel = decodeHDR(texture2D(bloom, v_Texcoord));
 texel.rgb += bloomTexel.rgb * bloomIntensity;
 texel.a += bloomTexel.a * bloomIntensity;
#endif
#ifdef LENSFLARE_ENABLED
 texel += decodeHDR(texture2D(lensflare, v_Texcoord)) * texture2D(lensdirt, v_Texcoord) * lensflareIntensity;
#endif
 texel.a = min(texel.a, 1.0);
#ifdef LUM_ENABLED
 float fLum = texture2D(lum, vec2(0.5, 0.5)).r;
 float adaptedLumDest = 3.0 / (max(0.1, 1.0 + 10.0*eyeAdaption(fLum)));
 float exposureBias = adaptedLumDest * exposure;
#else
 float exposureBias = exposure;
#endif
#ifdef TONEMAPPING
 texel.rgb *= exposureBias;
 texel.rgb = ACESToneMapping(texel.rgb);
#endif
 texel = linearTosRGB(texel);
#ifdef LUT_ENABLED
 texel.rgb = lutTransform(clamp(texel.rgb,vec3(0.0),vec3(1.0)));
#endif
#ifdef COLOR_CORRECTION
 texel.rgb = clamp(texel.rgb + vec3(brightness), 0.0, 1.0);
 texel.rgb = clamp((texel.rgb - vec3(0.5))*contrast+vec3(0.5), 0.0, 1.0);
 float lum = dot(texel.rgb, vec3(0.2125, 0.7154, 0.0721));
 texel.rgb = mix(vec3(lum), texel.rgb, saturation);
#endif
#ifdef VIGNETTE
 vec2 uv = (v_Texcoord - vec2(0.5)) * vec2(vignetteOffset);
 texel.rgb = mix(texel.rgb, vec3(1.0 - vignetteDarkness), dot(uv, uv));
#endif
 gl_FragColor = encodeHDR(texel);
#ifdef DEBUG
 #if DEBUG == 1
 gl_FragColor = encodeHDR(decodeHDR(texture2D(texture, v_Texcoord)));
 #elif DEBUG == 2
 gl_FragColor = encodeHDR(decodeHDR(texture2D(bloom, v_Texcoord)) * bloomIntensity);
 #elif DEBUG == 3
 gl_FragColor = encodeHDR(decodeHDR(texture2D(lensflare, v_Texcoord) * lensflareIntensity));
 #endif
#endif
 if (originalTexel.a <= 0.01 && gl_FragColor.a > 1e-5) {
 gl_FragColor.a = dot(gl_FragColor.rgb, vec3(0.2125, 0.7154, 0.0721));
 }
#ifdef PREMULTIPLY_ALPHA
 gl_FragColor.rgb *= gl_FragColor.a;
#endif
}
@end`,C6=`@export clay.compositor.lensflare
#define SAMPLE_NUMBER 8
uniform sampler2D texture;
uniform sampler2D lenscolor;
uniform vec2 textureSize : [512, 512];
uniform float dispersal : 0.3;
uniform float haloWidth : 0.4;
uniform float distortion : 1.0;
varying vec2 v_Texcoord;
@import clay.util.rgbm
vec4 textureDistorted(
 in vec2 texcoord,
 in vec2 direction,
 in vec3 distortion
) {
 return vec4(
 decodeHDR(texture2D(texture, texcoord + direction * distortion.r)).r,
 decodeHDR(texture2D(texture, texcoord + direction * distortion.g)).g,
 decodeHDR(texture2D(texture, texcoord + direction * distortion.b)).b,
 1.0
 );
}
void main()
{
 vec2 texcoord = -v_Texcoord + vec2(1.0); vec2 textureOffset = 1.0 / textureSize;
 vec2 ghostVec = (vec2(0.5) - texcoord) * dispersal;
 vec2 haloVec = normalize(ghostVec) * haloWidth;
 vec3 distortion = vec3(-textureOffset.x * distortion, 0.0, textureOffset.x * distortion);
 vec4 result = vec4(0.0);
 for (int i = 0; i < SAMPLE_NUMBER; i++)
 {
 vec2 offset = fract(texcoord + ghostVec * float(i));
 float weight = length(vec2(0.5) - offset) / length(vec2(0.5));
 weight = pow(1.0 - weight, 10.0);
 result += textureDistorted(offset, normalize(ghostVec), distortion) * weight;
 }
 result *= texture2D(lenscolor, vec2(length(vec2(0.5) - texcoord)) / length(vec2(0.5)));
 float weight = length(vec2(0.5) - fract(texcoord + haloVec)) / length(vec2(0.5));
 weight = pow(1.0 - weight, 10.0);
 vec2 offset = fract(texcoord + haloVec);
 result += textureDistorted(offset, normalize(ghostVec), distortion) * weight;
 gl_FragColor = result;
}
@end`,Ex=`@export clay.compositor.blend
#define SHADER_NAME blend
#ifdef TEXTURE1_ENABLED
uniform sampler2D texture1;
uniform float weight1 : 1.0;
#endif
#ifdef TEXTURE2_ENABLED
uniform sampler2D texture2;
uniform float weight2 : 1.0;
#endif
#ifdef TEXTURE3_ENABLED
uniform sampler2D texture3;
uniform float weight3 : 1.0;
#endif
#ifdef TEXTURE4_ENABLED
uniform sampler2D texture4;
uniform float weight4 : 1.0;
#endif
#ifdef TEXTURE5_ENABLED
uniform sampler2D texture5;
uniform float weight5 : 1.0;
#endif
#ifdef TEXTURE6_ENABLED
uniform sampler2D texture6;
uniform float weight6 : 1.0;
#endif
varying vec2 v_Texcoord;
@import clay.util.rgbm
void main()
{
 vec4 tex = vec4(0.0);
#ifdef TEXTURE1_ENABLED
 tex += decodeHDR(texture2D(texture1, v_Texcoord)) * weight1;
#endif
#ifdef TEXTURE2_ENABLED
 tex += decodeHDR(texture2D(texture2, v_Texcoord)) * weight2;
#endif
#ifdef TEXTURE3_ENABLED
 tex += decodeHDR(texture2D(texture3, v_Texcoord)) * weight3;
#endif
#ifdef TEXTURE4_ENABLED
 tex += decodeHDR(texture2D(texture4, v_Texcoord)) * weight4;
#endif
#ifdef TEXTURE5_ENABLED
 tex += decodeHDR(texture2D(texture5, v_Texcoord)) * weight5;
#endif
#ifdef TEXTURE6_ENABLED
 tex += decodeHDR(texture2D(texture6, v_Texcoord)) * weight6;
#endif
 gl_FragColor = encodeHDR(tex);
}
@end`,Cx=`@export clay.compositor.fxaa
uniform sampler2D texture;
uniform vec4 viewport : VIEWPORT;
varying vec2 v_Texcoord;
#define FXAA_REDUCE_MIN (1.0/128.0)
#define FXAA_REDUCE_MUL (1.0/8.0)
#define FXAA_SPAN_MAX 8.0
@import clay.util.rgbm
void main()
{
 vec2 resolution = 1.0 / viewport.zw;
 vec3 rgbNW = decodeHDR( texture2D( texture, ( gl_FragCoord.xy + vec2( -1.0, -1.0 ) ) * resolution ) ).xyz;
 vec3 rgbNE = decodeHDR( texture2D( texture, ( gl_FragCoord.xy + vec2( 1.0, -1.0 ) ) * resolution ) ).xyz;
 vec3 rgbSW = decodeHDR( texture2D( texture, ( gl_FragCoord.xy + vec2( -1.0, 1.0 ) ) * resolution ) ).xyz;
 vec3 rgbSE = decodeHDR( texture2D( texture, ( gl_FragCoord.xy + vec2( 1.0, 1.0 ) ) * resolution ) ).xyz;
 vec4 rgbaM = decodeHDR( texture2D( texture, gl_FragCoord.xy * resolution ) );
 vec3 rgbM = rgbaM.xyz;
 float opacity = rgbaM.w;
 vec3 luma = vec3( 0.299, 0.587, 0.114 );
 float lumaNW = dot( rgbNW, luma );
 float lumaNE = dot( rgbNE, luma );
 float lumaSW = dot( rgbSW, luma );
 float lumaSE = dot( rgbSE, luma );
 float lumaM = dot( rgbM, luma );
 float lumaMin = min( lumaM, min( min( lumaNW, lumaNE ), min( lumaSW, lumaSE ) ) );
 float lumaMax = max( lumaM, max( max( lumaNW, lumaNE) , max( lumaSW, lumaSE ) ) );
 vec2 dir;
 dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));
 dir.y = ((lumaNW + lumaSW) - (lumaNE + lumaSE));
 float dirReduce = max( ( lumaNW + lumaNE + lumaSW + lumaSE ) * ( 0.25 * FXAA_REDUCE_MUL ), FXAA_REDUCE_MIN );
 float rcpDirMin = 1.0 / ( min( abs( dir.x ), abs( dir.y ) ) + dirReduce );
 dir = min( vec2( FXAA_SPAN_MAX, FXAA_SPAN_MAX),
 max( vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),
 dir * rcpDirMin)) * resolution;
 vec3 rgbA = decodeHDR( texture2D( texture, gl_FragCoord.xy * resolution + dir * ( 1.0 / 3.0 - 0.5 ) ) ).xyz;
 rgbA += decodeHDR( texture2D( texture, gl_FragCoord.xy * resolution + dir * ( 2.0 / 3.0 - 0.5 ) ) ).xyz;
 rgbA *= 0.5;
 vec3 rgbB = decodeHDR( texture2D( texture, gl_FragCoord.xy * resolution + dir * -0.5 ) ).xyz;
 rgbB += decodeHDR( texture2D( texture, gl_FragCoord.xy * resolution + dir * 0.5 ) ).xyz;
 rgbB *= 0.25;
 rgbB += rgbA * 0.5;
 float lumaB = dot( rgbB, luma );
 if ( ( lumaB < lumaMin ) || ( lumaB > lumaMax ) )
 {
 gl_FragColor = vec4( rgbA, opacity );
 }
 else {
 gl_FragColor = vec4( rgbB, opacity );
 }
}
@end`;function L6(e){e.import(w6),e.import(_x),e.import(A6),e.import(xx),e.import(E6),e.import(Sx),e.import(Tx),e.import(bx),e.import(wx),e.import(Ax),e.import(C6),e.import(Ex),e.import(Cx)}L6(H);var D6=/^#source\((.*?)\)/;function M6(e,t){var r=new m6;t=t||{};var n={textures:{},parameters:{}},a=function(s,l){for(var u=0;u<e.nodes.length;u++){var c=e.nodes[u],h=P6(c,n,t);h&&r.addNode(h)}};for(var i in e.parameters){var o=e.parameters[i];n.parameters[i]=vd(o)}return N6(e,n,t,function(s){n.textures=s,a()}),r}function P6(e,t,r){var n=e.type||"filter",a,i,o;if(n==="filter"){var s=e.shader.trim(),l=D6.exec(s);if(l?a=H.source(l[1].trim()):s.charAt(0)==="#"&&(a=t.shaders[s.substr(1)]),a||(a=s),!a)return}if(e.inputs){i={};for(var u in e.inputs)typeof e.inputs[u]=="string"?i[u]=e.inputs[u]:i[u]={node:e.inputs[u].node,pin:e.inputs[u].pin}}if(e.outputs){o={};for(var u in e.outputs){var c=e.outputs[u];o[u]={},c.attachment!=null&&(o[u].attachment=c.attachment),c.keepLastFrame!=null&&(o[u].keepLastFrame=c.keepLastFrame),c.outputLastFrame!=null&&(o[u].outputLastFrame=c.outputLastFrame),c.parameters&&(o[u].parameters=vd(c.parameters))}}var h;if(n==="scene"?h=new _6({name:e.name,scene:r.scene,camera:r.camera,outputs:o}):n==="texture"?h=new S6({name:e.name,outputs:o}):h=new b6({name:e.name,shader:a,inputs:i,outputs:o}),h){if(e.parameters)for(var u in e.parameters){var f=e.parameters[u];typeof f=="string"?(f=f.trim(),f.charAt(0)==="#"?f=t.textures[f.substr(1)]:h.on("beforerender",O6(u,Lx(f)))):typeof f=="function"&&h.on("beforerender",f),h.setParameter(u,f)}if(e.defines&&h.pass)for(var u in e.defines){var f=e.defines[u];h.pass.material.define("fragment",u,f)}}return h}function I6(e,t){return e}function R6(e,t){return t}function vd(e){var t={};if(!e)return t;["type","minFilter","magFilter","wrapS","wrapT","flipY","useMipmap"].forEach(function(n){var a=e[n];a!=null&&(typeof a=="string"&&(a=ie[a]),t[n]=a)});var r=e.scale||1;return["width","height"].forEach(function(n){if(e[n]!=null){var a=e[n];typeof a=="string"?(a=a.trim(),t[n]=B6(n,Lx(a),r)):t[n]=a}}),t.width||(t.width=I6),t.height||(t.height=R6),e.useMipmap!=null&&(t.useMipmap=e.useMipmap),t}function N6(e,t,r,n){if(!e.textures){n({});return}var a={},i=0,o=!1,s=r.textureRootPath;Pt.each(e.textures,function(l,u){var c,h=l.path,f=vd(l.parameters);if(Array.isArray(h)&&h.length===6)s&&(h=h.map(function(d){return Pt.relative2absolute(d,s)})),c=new _o(f);else if(typeof h=="string")s&&(h=Pt.relative2absolute(h,s)),c=new _e(f);else return;c.load(h),i++,c.once("success",function(){a[u]=c,i--,i===0&&(n(a),o=!0)})}),i===0&&!o&&n(a)}function O6(e,t){return function(r){var n=r.getDevicePixelRatio(),a=r.getWidth(),i=r.getHeight(),o=t(a,i,n);this.setParameter(e,o)}}function B6(e,t,r){return r=r||1,function(n){var a=n.getDevicePixelRatio(),i=n.getWidth()*r,o=n.getHeight()*r;return t(i,o,a)}}function Lx(e){var t=/^expr\((.*)\)$/.exec(e);if(t)try{var r=new Function("width","height","dpr","return "+t[1]);return r(1,1),r}catch{throw new Error("Invalid expression.")}}function ai(e,t){for(var r=0,n=1/t,a=e;a>0;)r=r+n*(a%t),a=Math.floor(a/t),n=n/t;return r}const F6=`@export ecgl.ssao.estimate

uniform sampler2D depthTex;

uniform sampler2D normalTex;

uniform sampler2D noiseTex;

uniform vec2 depthTexSize;

uniform vec2 noiseTexSize;

uniform mat4 projection;

uniform mat4 projectionInv;

uniform mat4 viewInverseTranspose;

uniform vec3 kernel[KERNEL_SIZE];

uniform float radius : 1;

uniform float power : 1;

uniform float bias: 1e-2;

uniform float intensity: 1.0;

varying vec2 v_Texcoord;

float ssaoEstimator(in vec3 originPos, in mat3 kernelBasis) {
 float occlusion = 0.0;

 for (int i = 0; i < KERNEL_SIZE; i++) {
 vec3 samplePos = kernel[i];
#ifdef NORMALTEX_ENABLED
 samplePos = kernelBasis * samplePos;
#endif
 samplePos = samplePos * radius + originPos;

 vec4 texCoord = projection * vec4(samplePos, 1.0);
 texCoord.xy /= texCoord.w;

 vec4 depthTexel = texture2D(depthTex, texCoord.xy * 0.5 + 0.5);

 float sampleDepth = depthTexel.r * 2.0 - 1.0;
 if (projection[3][3] == 0.0) {
 sampleDepth = projection[3][2] / (sampleDepth * projection[2][3] - projection[2][2]);
 }
 else {
 sampleDepth = (sampleDepth - projection[3][2]) / projection[2][2];
 }
 
 float rangeCheck = smoothstep(0.0, 1.0, radius / abs(originPos.z - sampleDepth));
 occlusion += rangeCheck * step(samplePos.z, sampleDepth - bias);
 }
#ifdef NORMALTEX_ENABLED
 occlusion = 1.0 - occlusion / float(KERNEL_SIZE);
#else
 occlusion = 1.0 - clamp((occlusion / float(KERNEL_SIZE) - 0.6) * 2.5, 0.0, 1.0);
#endif
 return pow(occlusion, power);
}

void main()
{

 vec4 depthTexel = texture2D(depthTex, v_Texcoord);

#ifdef NORMALTEX_ENABLED
 vec4 tex = texture2D(normalTex, v_Texcoord);
 if (dot(tex.rgb, tex.rgb) == 0.0) {
 gl_FragColor = vec4(1.0);
 return;
 }
 vec3 N = tex.rgb * 2.0 - 1.0;
 N = (viewInverseTranspose * vec4(N, 0.0)).xyz;

 vec2 noiseTexCoord = depthTexSize / vec2(noiseTexSize) * v_Texcoord;
 vec3 rvec = texture2D(noiseTex, noiseTexCoord).rgb * 2.0 - 1.0;
 vec3 T = normalize(rvec - N * dot(rvec, N));
 vec3 BT = normalize(cross(N, T));
 mat3 kernelBasis = mat3(T, BT, N);
#else
 if (depthTexel.r > 0.99999) {
 gl_FragColor = vec4(1.0);
 return;
 }
 mat3 kernelBasis;
#endif

 float z = depthTexel.r * 2.0 - 1.0;

 vec4 projectedPos = vec4(v_Texcoord * 2.0 - 1.0, z, 1.0);
 vec4 p4 = projectionInv * projectedPos;

 vec3 position = p4.xyz / p4.w;

 float ao = ssaoEstimator(position, kernelBasis);
 ao = clamp(1.0 - (1.0 - ao) * intensity, 0.0, 1.0);
 gl_FragColor = vec4(vec3(ao), 1.0);
}

@end


@export ecgl.ssao.blur
#define SHADER_NAME SSAO_BLUR

uniform sampler2D ssaoTexture;

#ifdef NORMALTEX_ENABLED
uniform sampler2D normalTex;
#endif

varying vec2 v_Texcoord;

uniform vec2 textureSize;
uniform float blurSize : 1.0;

uniform int direction: 0.0;

#ifdef DEPTHTEX_ENABLED
uniform sampler2D depthTex;
uniform mat4 projection;
uniform float depthRange : 0.5;

float getLinearDepth(vec2 coord)
{
 float depth = texture2D(depthTex, coord).r * 2.0 - 1.0;
 return projection[3][2] / (depth * projection[2][3] - projection[2][2]);
}
#endif

void main()
{
 float kernel[5];
 kernel[0] = 0.122581;
 kernel[1] = 0.233062;
 kernel[2] = 0.288713;
 kernel[3] = 0.233062;
 kernel[4] = 0.122581;

 vec2 off = vec2(0.0);
 if (direction == 0) {
 off[0] = blurSize / textureSize.x;
 }
 else {
 off[1] = blurSize / textureSize.y;
 }

 vec2 coord = v_Texcoord;

 float sum = 0.0;
 float weightAll = 0.0;

#ifdef NORMALTEX_ENABLED
 vec3 centerNormal = texture2D(normalTex, v_Texcoord).rgb * 2.0 - 1.0;
#endif
#if defined(DEPTHTEX_ENABLED)
 float centerDepth = getLinearDepth(v_Texcoord);
#endif

 for (int i = 0; i < 5; i++) {
 vec2 coord = clamp(v_Texcoord + vec2(float(i) - 2.0) * off, vec2(0.0), vec2(1.0));

 float w = kernel[i];
#ifdef NORMALTEX_ENABLED
 vec3 normal = texture2D(normalTex, coord).rgb * 2.0 - 1.0;
 w *= clamp(dot(normal, centerNormal), 0.0, 1.0);
#endif
#ifdef DEPTHTEX_ENABLED
 float d = getLinearDepth(coord);
 w *= (1.0 - smoothstep(abs(centerDepth - d) / depthRange, 0.0, 1.0));
#endif

 weightAll += w;
 sum += texture2D(ssaoTexture, coord).r * w;
 }

 gl_FragColor = vec4(vec3(sum / weightAll), 1.0);
}

@end
`;H.import(F6);function Dx(e){for(var t=new Uint8Array(e*e*4),r=0,n=new X,a=0;a<e;a++)for(var i=0;i<e;i++)n.set(Math.random()*2-1,Math.random()*2-1,0).normalize(),t[r++]=(n.x*.5+.5)*255,t[r++]=(n.y*.5+.5)*255,t[r++]=0,t[r++]=255;return t}function P1(e){return new _e({pixels:Dx(e),wrapS:ie.REPEAT,wrapT:ie.REPEAT,width:e,height:e})}function z6(e,t,r){var n=new Float32Array(e*3);t=t||0;for(var a=0;a<e;a++){var i=ai(a+t,2)*(r?1:2)*Math.PI,o=ai(a+t,3)*Math.PI,s=Math.random(),l=Math.cos(i)*Math.sin(o)*s,u=Math.cos(o)*s,c=Math.sin(i)*Math.sin(o)*s;n[a*3]=l,n[a*3+1]=u,n[a*3+2]=c}return n}function cn(e){e=e||{},this._ssaoPass=new dt({fragment:H.source("ecgl.ssao.estimate")}),this._blurPass=new dt({fragment:H.source("ecgl.ssao.blur")}),this._framebuffer=new Rt({depthBuffer:!1}),this._ssaoTexture=new _e,this._blurTexture=new _e,this._blurTexture2=new _e,this._depthTex=e.depthTexture,this._normalTex=e.normalTexture,this.setNoiseSize(4),this.setKernelSize(e.kernelSize||12),e.radius!=null&&this.setParameter("radius",e.radius),e.power!=null&&this.setParameter("power",e.power),this._normalTex||(this._ssaoPass.material.disableTexture("normalTex"),this._blurPass.material.disableTexture("normalTex")),this._depthTex||this._blurPass.material.disableTexture("depthTex"),this._blurPass.material.setUniform("normalTex",this._normalTex),this._blurPass.material.setUniform("depthTex",this._depthTex)}cn.prototype.setDepthTexture=function(e){this._depthTex=e};cn.prototype.setNormalTexture=function(e){this._normalTex=e,this._ssaoPass.material[e?"enableTexture":"disableTexture"]("normalTex"),this.setKernelSize(this._kernelSize)};cn.prototype.update=function(e,t,r){var n=e.getWidth(),a=e.getHeight(),i=this._ssaoPass,o=this._blurPass;i.setUniform("kernel",this._kernels[r%this._kernels.length]),i.setUniform("depthTex",this._depthTex),this._normalTex!=null&&i.setUniform("normalTex",this._normalTex),i.setUniform("depthTexSize",[this._depthTex.width,this._depthTex.height]);var s=new ne;ne.transpose(s,t.worldTransform),i.setUniform("projection",t.projectionMatrix.array),i.setUniform("projectionInv",t.invProjectionMatrix.array),i.setUniform("viewInverseTranspose",s.array);var l=this._ssaoTexture,u=this._blurTexture,c=this._blurTexture2;l.width=n/2,l.height=a/2,u.width=n,u.height=a,c.width=n,c.height=a,this._framebuffer.attach(l),this._framebuffer.bind(e),e.gl.clearColor(1,1,1,1),e.gl.clear(e.gl.COLOR_BUFFER_BIT),i.render(e),o.setUniform("textureSize",[n/2,a/2]),o.setUniform("projection",t.projectionMatrix.array),this._framebuffer.attach(u),o.setUniform("direction",0),o.setUniform("ssaoTexture",l),o.render(e),this._framebuffer.attach(c),o.setUniform("textureSize",[n,a]),o.setUniform("direction",1),o.setUniform("ssaoTexture",u),o.render(e),this._framebuffer.unbind(e);var h=e.clearColor;e.gl.clearColor(h[0],h[1],h[2],h[3])};cn.prototype.getTargetTexture=function(){return this._blurTexture2};cn.prototype.setParameter=function(e,t){e==="noiseTexSize"?this.setNoiseSize(t):e==="kernelSize"?this.setKernelSize(t):e==="intensity"?this._ssaoPass.material.set("intensity",t):this._ssaoPass.setUniform(e,t)};cn.prototype.setKernelSize=function(e){this._kernelSize=e,this._ssaoPass.material.define("fragment","KERNEL_SIZE",e),this._kernels=this._kernels||[];for(var t=0;t<30;t++)this._kernels[t]=z6(e,t*e,!!this._normalTex)};cn.prototype.setNoiseSize=function(e){var t=this._ssaoPass.getUniform("noiseTex");t?(t.data=Dx(e),t.width=t.height=e,t.dirty()):(t=P1(e),this._ssaoPass.setUniform("noiseTex",P1(e))),this._ssaoPass.setUniform("noiseTexSize",[e,e])};cn.prototype.dispose=function(e){this._blurTexture.dispose(e),this._ssaoTexture.dispose(e),this._blurTexture2.dispose(e)};const G6=`@export ecgl.ssr.main

#define SHADER_NAME SSR
#define MAX_ITERATION 20;
#define SAMPLE_PER_FRAME 5;
#define TOTAL_SAMPLES 128;

uniform sampler2D sourceTexture;
uniform sampler2D gBufferTexture1;
uniform sampler2D gBufferTexture2;
uniform sampler2D gBufferTexture3;
uniform samplerCube specularCubemap;
uniform float specularIntensity: 1;

uniform mat4 projection;
uniform mat4 projectionInv;
uniform mat4 toViewSpace;
uniform mat4 toWorldSpace;

uniform float maxRayDistance: 200;

uniform float pixelStride: 16;
uniform float pixelStrideZCutoff: 50; 
uniform float screenEdgeFadeStart: 0.9; 
uniform float eyeFadeStart : 0.2; uniform float eyeFadeEnd: 0.8; 
uniform float minGlossiness: 0.2; uniform float zThicknessThreshold: 1;

uniform float nearZ;
uniform vec2 viewportSize : VIEWPORT_SIZE;

uniform float jitterOffset: 0;

varying vec2 v_Texcoord;

#ifdef DEPTH_DECODE
@import clay.util.decode_float
#endif

#ifdef PHYSICALLY_CORRECT
uniform sampler2D normalDistribution;
uniform float sampleOffset: 0;
uniform vec2 normalDistributionSize;

vec3 transformNormal(vec3 H, vec3 N) {
 vec3 upVector = N.y > 0.999 ? vec3(1.0, 0.0, 0.0) : vec3(0.0, 1.0, 0.0);
 vec3 tangentX = normalize(cross(N, upVector));
 vec3 tangentZ = cross(N, tangentX);
 return normalize(tangentX * H.x + N * H.y + tangentZ * H.z);
}
vec3 importanceSampleNormalGGX(float i, float roughness, vec3 N) {
 float p = fract((i + sampleOffset) / float(TOTAL_SAMPLES));
 vec3 H = texture2D(normalDistribution,vec2(roughness, p)).rgb;
 return transformNormal(H, N);
}
float G_Smith(float g, float ndv, float ndl) {
 float roughness = 1.0 - g;
 float k = roughness * roughness / 2.0;
 float G1V = ndv / (ndv * (1.0 - k) + k);
 float G1L = ndl / (ndl * (1.0 - k) + k);
 return G1L * G1V;
}
vec3 F_Schlick(float ndv, vec3 spec) {
 return spec + (1.0 - spec) * pow(1.0 - ndv, 5.0);
}
#endif

float fetchDepth(sampler2D depthTexture, vec2 uv)
{
 vec4 depthTexel = texture2D(depthTexture, uv);
 return depthTexel.r * 2.0 - 1.0;
}

float linearDepth(float depth)
{
 if (projection[3][3] == 0.0) {
 return projection[3][2] / (depth * projection[2][3] - projection[2][2]);
 }
 else {
 return (depth - projection[3][2]) / projection[2][2];
 }
}

bool rayIntersectDepth(float rayZNear, float rayZFar, vec2 hitPixel)
{
 if (rayZFar > rayZNear)
 {
 float t = rayZFar; rayZFar = rayZNear; rayZNear = t;
 }
 float cameraZ = linearDepth(fetchDepth(gBufferTexture2, hitPixel));
 return rayZFar <= cameraZ && rayZNear >= cameraZ - zThicknessThreshold;
}


bool traceScreenSpaceRay(
 vec3 rayOrigin, vec3 rayDir, float jitter,
 out vec2 hitPixel, out vec3 hitPoint, out float iterationCount
)
{
 float rayLength = ((rayOrigin.z + rayDir.z * maxRayDistance) > -nearZ)
 ? (-nearZ - rayOrigin.z) / rayDir.z : maxRayDistance;

 vec3 rayEnd = rayOrigin + rayDir * rayLength;

 vec4 H0 = projection * vec4(rayOrigin, 1.0);
 vec4 H1 = projection * vec4(rayEnd, 1.0);

 float k0 = 1.0 / H0.w, k1 = 1.0 / H1.w;

 vec3 Q0 = rayOrigin * k0, Q1 = rayEnd * k1;

 vec2 P0 = (H0.xy * k0 * 0.5 + 0.5) * viewportSize;
 vec2 P1 = (H1.xy * k1 * 0.5 + 0.5) * viewportSize;

 P1 += dot(P1 - P0, P1 - P0) < 0.0001 ? 0.01 : 0.0;
 vec2 delta = P1 - P0;

 bool permute = false;
 if (abs(delta.x) < abs(delta.y)) {
 permute = true;
 delta = delta.yx;
 P0 = P0.yx;
 P1 = P1.yx;
 }
 float stepDir = sign(delta.x);
 float invdx = stepDir / delta.x;

 vec3 dQ = (Q1 - Q0) * invdx;
 float dk = (k1 - k0) * invdx;

 vec2 dP = vec2(stepDir, delta.y * invdx);

 float strideScaler = 1.0 - min(1.0, -rayOrigin.z / pixelStrideZCutoff);
 float pixStride = 1.0 + strideScaler * pixelStride;

 dP *= pixStride; dQ *= pixStride; dk *= pixStride;

 vec4 pqk = vec4(P0, Q0.z, k0);
 vec4 dPQK = vec4(dP, dQ.z, dk);

 pqk += dPQK * jitter;
 float rayZFar = (dPQK.z * 0.5 + pqk.z) / (dPQK.w * 0.5 + pqk.w);
 float rayZNear;

 bool intersect = false;

 vec2 texelSize = 1.0 / viewportSize;

 iterationCount = 0.0;

 for (int i = 0; i < MAX_ITERATION; i++)
 {
 pqk += dPQK;

 rayZNear = rayZFar;
 rayZFar = (dPQK.z * 0.5 + pqk.z) / (dPQK.w * 0.5 + pqk.w);

 hitPixel = permute ? pqk.yx : pqk.xy;
 hitPixel *= texelSize;

 intersect = rayIntersectDepth(rayZNear, rayZFar, hitPixel);

 iterationCount += 1.0;

 dPQK *= 1.2;

 if (intersect) {
 break;
 }
 }

 Q0.xy += dQ.xy * iterationCount;
 Q0.z = pqk.z;
 hitPoint = Q0 / pqk.w;

 return intersect;
}

float calculateAlpha(
 float iterationCount, float reflectivity,
 vec2 hitPixel, vec3 hitPoint, float dist, vec3 rayDir
)
{
 float alpha = clamp(reflectivity, 0.0, 1.0);
 alpha *= 1.0 - (iterationCount / float(MAX_ITERATION));
 vec2 hitPixelNDC = hitPixel * 2.0 - 1.0;
 float maxDimension = min(1.0, max(abs(hitPixelNDC.x), abs(hitPixelNDC.y)));
 alpha *= 1.0 - max(0.0, maxDimension - screenEdgeFadeStart) / (1.0 - screenEdgeFadeStart);

 float _eyeFadeStart = eyeFadeStart;
 float _eyeFadeEnd = eyeFadeEnd;
 if (_eyeFadeStart > _eyeFadeEnd) {
 float tmp = _eyeFadeEnd;
 _eyeFadeEnd = _eyeFadeStart;
 _eyeFadeStart = tmp;
 }

 float eyeDir = clamp(rayDir.z, _eyeFadeStart, _eyeFadeEnd);
 alpha *= 1.0 - (eyeDir - _eyeFadeStart) / (_eyeFadeEnd - _eyeFadeStart);

 alpha *= 1.0 - clamp(dist / maxRayDistance, 0.0, 1.0);

 return alpha;
}

@import clay.util.rand

@import clay.util.rgbm

void main()
{
 vec4 normalAndGloss = texture2D(gBufferTexture1, v_Texcoord);

 if (dot(normalAndGloss.rgb, vec3(1.0)) == 0.0) {
 discard;
 }

 float g = normalAndGloss.a;
#if !defined(PHYSICALLY_CORRECT)
 if (g <= minGlossiness) {
 discard;
 }
#endif

 float reflectivity = (g - minGlossiness) / (1.0 - minGlossiness);

 vec3 N = normalize(normalAndGloss.rgb * 2.0 - 1.0);
 N = normalize((toViewSpace * vec4(N, 0.0)).xyz);

 vec4 projectedPos = vec4(v_Texcoord * 2.0 - 1.0, fetchDepth(gBufferTexture2, v_Texcoord), 1.0);
 vec4 pos = projectionInv * projectedPos;
 vec3 rayOrigin = pos.xyz / pos.w;
 vec3 V = -normalize(rayOrigin);

 float ndv = clamp(dot(N, V), 0.0, 1.0);
 float iterationCount;
 float jitter = rand(fract(v_Texcoord + jitterOffset));

#ifdef PHYSICALLY_CORRECT
 vec4 color = vec4(vec3(0.0), 1.0);
 vec4 albedoMetalness = texture2D(gBufferTexture3, v_Texcoord);
 vec3 albedo = albedoMetalness.rgb;
 float m = albedoMetalness.a;
 vec3 diffuseColor = albedo * (1.0 - m);
 vec3 spec = mix(vec3(0.04), albedo, m);

 float jitter2 = rand(fract(v_Texcoord)) * float(TOTAL_SAMPLES);

 for (int i = 0; i < SAMPLE_PER_FRAME; i++) {
 vec3 H = importanceSampleNormalGGX(float(i) + jitter2, 1.0 - g, N);
 vec3 rayDir = normalize(reflect(-V, H));
#else
 vec3 rayDir = normalize(reflect(-V, N));
#endif
 vec2 hitPixel;
 vec3 hitPoint;

 bool intersect = traceScreenSpaceRay(rayOrigin, rayDir, jitter, hitPixel, hitPoint, iterationCount);

 float dist = distance(rayOrigin, hitPoint);

 vec3 hitNormal = texture2D(gBufferTexture1, hitPixel).rgb * 2.0 - 1.0;
 hitNormal = normalize((toViewSpace * vec4(hitNormal, 0.0)).xyz);
#ifdef PHYSICALLY_CORRECT
 float ndl = clamp(dot(N, rayDir), 0.0, 1.0);
 float vdh = clamp(dot(V, H), 0.0, 1.0);
 float ndh = clamp(dot(N, H), 0.0, 1.0);
 vec3 litTexel = vec3(0.0);
 if (dot(hitNormal, rayDir) < 0.0 && intersect) {
 litTexel = texture2D(sourceTexture, hitPixel).rgb;
 litTexel *= pow(clamp(1.0 - dist / 200.0, 0.0, 1.0), 3.0);

 }
 else {
 #ifdef SPECULARCUBEMAP_ENABLED
 vec3 rayDirW = normalize(toWorldSpace * vec4(rayDir, 0.0)).rgb;
 litTexel = RGBMDecode(textureCubeLodEXT(specularCubemap, rayDirW, 0.0), 8.12).rgb * specularIntensity;
#endif
 }
 color.rgb += ndl * litTexel * (
 F_Schlick(ndl, spec) * G_Smith(g, ndv, ndl) * vdh / (ndh * ndv + 0.001)
 );
 }
 color.rgb /= float(SAMPLE_PER_FRAME);
#else
 #if !defined(SPECULARCUBEMAP_ENABLED)
 if (dot(hitNormal, rayDir) >= 0.0) {
 discard;
 }
 if (!intersect) {
 discard;
 }
#endif
 float alpha = clamp(calculateAlpha(iterationCount, reflectivity, hitPixel, hitPoint, dist, rayDir), 0.0, 1.0);
 vec4 color = texture2D(sourceTexture, hitPixel);
 color.rgb *= alpha;

#ifdef SPECULARCUBEMAP_ENABLED
 vec3 rayDirW = normalize(toWorldSpace * vec4(rayDir, 0.0)).rgb;
 alpha = alpha * (intersect ? 1.0 : 0.0);
 float bias = (1.0 -g) * 5.0;
 color.rgb += (1.0 - alpha)
 * RGBMDecode(textureCubeLodEXT(specularCubemap, rayDirW, bias), 8.12).rgb
 * specularIntensity;
#endif

#endif

 gl_FragColor = encodeHDR(color);
}
@end

@export ecgl.ssr.blur

uniform sampler2D texture;
uniform sampler2D gBufferTexture1;
uniform sampler2D gBufferTexture2;
uniform mat4 projection;
uniform float depthRange : 0.05;

varying vec2 v_Texcoord;

uniform vec2 textureSize;
uniform float blurSize : 1.0;

#ifdef BLEND
 #ifdef SSAOTEX_ENABLED
uniform sampler2D ssaoTex;
 #endif
uniform sampler2D sourceTexture;
#endif

float getLinearDepth(vec2 coord)
{
 float depth = texture2D(gBufferTexture2, coord).r * 2.0 - 1.0;
 return projection[3][2] / (depth * projection[2][3] - projection[2][2]);
}

@import clay.util.rgbm


void main()
{
 @import clay.compositor.kernel.gaussian_9

 vec4 centerNTexel = texture2D(gBufferTexture1, v_Texcoord);
 float g = centerNTexel.a;
 float maxBlurSize = clamp(1.0 - g, 0.0, 1.0) * blurSize;
#ifdef VERTICAL
 vec2 off = vec2(0.0, maxBlurSize / textureSize.y);
#else
 vec2 off = vec2(maxBlurSize / textureSize.x, 0.0);
#endif

 vec2 coord = v_Texcoord;

 vec4 sum = vec4(0.0);
 float weightAll = 0.0;

 vec3 cN = centerNTexel.rgb * 2.0 - 1.0;
 float cD = getLinearDepth(v_Texcoord);
 for (int i = 0; i < 9; i++) {
 vec2 coord = clamp((float(i) - 4.0) * off + v_Texcoord, vec2(0.0), vec2(1.0));
 float w = gaussianKernel[i]
 * clamp(dot(cN, texture2D(gBufferTexture1, coord).rgb * 2.0 - 1.0), 0.0, 1.0);
 float d = getLinearDepth(coord);
 w *= (1.0 - smoothstep(abs(cD - d) / depthRange, 0.0, 1.0));

 weightAll += w;
 sum += decodeHDR(texture2D(texture, coord)) * w;
 }

#ifdef BLEND
 float aoFactor = 1.0;
 #ifdef SSAOTEX_ENABLED
 aoFactor = texture2D(ssaoTex, v_Texcoord).r;
 #endif
 gl_FragColor = encodeHDR(
 sum / weightAll * aoFactor + decodeHDR(texture2D(sourceTexture, v_Texcoord))
 );
#else
 gl_FragColor = encodeHDR(sum / weightAll);
#endif
}

@end`;H.import(G6);function hn(e){e=e||{},this._ssrPass=new dt({fragment:H.source("ecgl.ssr.main"),clearColor:[0,0,0,0]}),this._blurPass1=new dt({fragment:H.source("ecgl.ssr.blur"),clearColor:[0,0,0,0]}),this._blurPass2=new dt({fragment:H.source("ecgl.ssr.blur"),clearColor:[0,0,0,0]}),this._blendPass=new dt({fragment:H.source("clay.compositor.blend")}),this._blendPass.material.disableTexturesAll(),this._blendPass.material.enableTexture(["texture1","texture2"]),this._ssrPass.setUniform("gBufferTexture1",e.normalTexture),this._ssrPass.setUniform("gBufferTexture2",e.depthTexture),this._blurPass1.setUniform("gBufferTexture1",e.normalTexture),this._blurPass1.setUniform("gBufferTexture2",e.depthTexture),this._blurPass2.setUniform("gBufferTexture1",e.normalTexture),this._blurPass2.setUniform("gBufferTexture2",e.depthTexture),this._blurPass2.material.define("fragment","VERTICAL"),this._blurPass2.material.define("fragment","BLEND"),this._ssrTexture=new _e({type:ie.HALF_FLOAT}),this._texture2=new _e({type:ie.HALF_FLOAT}),this._texture3=new _e({type:ie.HALF_FLOAT}),this._prevTexture=new _e({type:ie.HALF_FLOAT}),this._currentTexture=new _e({type:ie.HALF_FLOAT}),this._frameBuffer=new Rt({depthBuffer:!1}),this._normalDistribution=null,this._totalSamples=256,this._samplePerFrame=4,this._ssrPass.material.define("fragment","SAMPLE_PER_FRAME",this._samplePerFrame),this._ssrPass.material.define("fragment","TOTAL_SAMPLES",this._totalSamples),this._downScale=1}hn.prototype.setAmbientCubemap=function(e,t){this._ssrPass.material.set("specularCubemap",e),this._ssrPass.material.set("specularIntensity",t);var r=e&&t;this._ssrPass.material[r?"enableTexture":"disableTexture"]("specularCubemap")};hn.prototype.update=function(e,t,r,n){var a=e.getWidth(),i=e.getHeight(),o=this._ssrTexture,s=this._texture2,l=this._texture3;o.width=this._prevTexture.width=this._currentTexture.width=a/this._downScale,o.height=this._prevTexture.height=this._currentTexture.height=i/this._downScale,s.width=l.width=a,s.height=l.height=i;var u=this._frameBuffer,c=this._ssrPass,h=this._blurPass1,f=this._blurPass2,d=this._blendPass,v=new ne,p=new ne;ne.transpose(v,t.worldTransform),ne.transpose(p,t.viewMatrix),c.setUniform("sourceTexture",r),c.setUniform("projection",t.projectionMatrix.array),c.setUniform("projectionInv",t.invProjectionMatrix.array),c.setUniform("toViewSpace",v.array),c.setUniform("toWorldSpace",p.array),c.setUniform("nearZ",t.near);var g=n/this._totalSamples*this._samplePerFrame;if(c.setUniform("jitterOffset",g),c.setUniform("sampleOffset",n*this._samplePerFrame),h.setUniform("textureSize",[o.width,o.height]),f.setUniform("textureSize",[a,i]),f.setUniform("sourceTexture",r),h.setUniform("projection",t.projectionMatrix.array),f.setUniform("projection",t.projectionMatrix.array),u.attach(o),u.bind(e),c.render(e),this._physicallyCorrect&&(u.attach(this._currentTexture),d.setUniform("texture1",this._prevTexture),d.setUniform("texture2",o),d.material.set({weight1:n>=1?.95:0,weight2:n>=1?.05:1}),d.render(e)),u.attach(s),h.setUniform("texture",this._physicallyCorrect?this._currentTexture:o),h.render(e),u.attach(l),f.setUniform("texture",s),f.render(e),u.unbind(e),this._physicallyCorrect){var m=this._prevTexture;this._prevTexture=this._currentTexture,this._currentTexture=m}};hn.prototype.getTargetTexture=function(){return this._texture3};hn.prototype.setParameter=function(e,t){e==="maxIteration"?this._ssrPass.material.define("fragment","MAX_ITERATION",t):this._ssrPass.setUniform(e,t)};hn.prototype.setPhysicallyCorrect=function(e){e?(this._normalDistribution||(this._normalDistribution=Is.generateNormalDistribution(64,this._totalSamples)),this._ssrPass.material.define("fragment","PHYSICALLY_CORRECT"),this._ssrPass.material.set("normalDistribution",this._normalDistribution),this._ssrPass.material.set("normalDistributionSize",[64,this._totalSamples])):this._ssrPass.material.undefine("fragment","PHYSICALLY_CORRECT"),this._physicallyCorrect=e};hn.prototype.setSSAOTexture=function(e){var t=this._blurPass2;e?(t.material.enableTexture("ssaoTex"),t.material.set("ssaoTex",e)):t.material.disableTexture("ssaoTex")};hn.prototype.isFinished=function(e){return this._physicallyCorrect?e>this._totalSamples/this._samplePerFrame:!0};hn.prototype.dispose=function(e){this._ssrTexture.dispose(e),this._texture2.dispose(e),this._texture3.dispose(e),this._prevTexture.dispose(e),this._currentTexture.dispose(e),this._frameBuffer.dispose(e)};const I1=[0,0,-.321585265978,-.154972575841,.458126042375,.188473391593,.842080129861,.527766490688,.147304551086,-.659453822776,-.331943915203,-.940619700594,.0479226680259,.54812163202,.701581552186,-.709825561388,-.295436780218,.940589268233,-.901489676764,.237713156085,.973570876096,-.109899459384,-.866792314779,-.451805525005,.330975007087,.800048655954,-.344275183665,.381779221166,-.386139432542,-.437418421534,-.576478634965,-.0148463392551,.385798197415,-.262426961053,-.666302061145,.682427250835,-.628010632582,-.732836215494,.10163141741,-.987658134403,.711995289051,-.320024291314,.0296005138058,.950296523438,.0130612307608,-.351024443122,-.879596633704,-.10478487883,.435712737232,.504254490347,.779203817497,.206477676721,.388264289969,-.896736162545,-.153106280781,-.629203242522,-.245517550697,.657969239148,.126830499058,.26862328493,-.634888119007,-.302301223431,.617074219636,.779817204925],V6=`@export ecgl.normal.vertex

@import ecgl.common.transformUniforms

@import ecgl.common.uv.header

@import ecgl.common.attributes

varying vec3 v_Normal;
varying vec3 v_WorldPosition;

@import ecgl.common.normalMap.vertexHeader

@import ecgl.common.vertexAnimation.header

void main()
{

 @import ecgl.common.vertexAnimation.main

 @import ecgl.common.uv.main

 v_Normal = normalize((worldInverseTranspose * vec4(normal, 0.0)).xyz);
 v_WorldPosition = (world * vec4(pos, 1.0)).xyz;

 @import ecgl.common.normalMap.vertexMain

 gl_Position = worldViewProjection * vec4(pos, 1.0);

}


@end


@export ecgl.normal.fragment

#define ROUGHNESS_CHANEL 0

uniform bool useBumpMap;
uniform bool useRoughnessMap;
uniform bool doubleSide;
uniform float roughness;

@import ecgl.common.uv.fragmentHeader

varying vec3 v_Normal;
varying vec3 v_WorldPosition;

uniform mat4 viewInverse : VIEWINVERSE;

@import ecgl.common.normalMap.fragmentHeader
@import ecgl.common.bumpMap.header

uniform sampler2D roughnessMap;

void main()
{
 vec3 N = v_Normal;
 
 bool flipNormal = false;
 if (doubleSide) {
 vec3 eyePos = viewInverse[3].xyz;
 vec3 V = normalize(eyePos - v_WorldPosition);

 if (dot(N, V) < 0.0) {
 flipNormal = true;
 }
 }

 @import ecgl.common.normalMap.fragmentMain

 if (useBumpMap) {
 N = bumpNormal(v_WorldPosition, v_Normal, N);
 }

 float g = 1.0 - roughness;

 if (useRoughnessMap) {
 float g2 = 1.0 - texture2D(roughnessMap, v_DetailTexcoord)[ROUGHNESS_CHANEL];
 g = clamp(g2 + (g - 0.5) * 2.0, 0.0, 1.0);
 }

 if (flipNormal) {
 N = -N;
 }

 gl_FragColor.rgb = (N.xyz + 1.0) * 0.5;
 gl_FragColor.a = g;
}
@end`;H.import(V6);function Nc(e,t,r,n,a){var i=e.gl;t.setUniform(i,"1i",r,a),i.activeTexture(i.TEXTURE0+a),n.isRenderable()?n.bind(e):n.unbind(e)}function U6(e,t,r,n,a){var i,o,s,l,u=e.gl;return function(c,h,f){if(!(l&&l.material===c.material)){var d=c.material,v=c.__program,p=d.get("roughness");p==null&&(p=1);var g=d.get("normalMap")||t,m=d.get("roughnessMap"),_=d.get("bumpMap"),y=d.get("uvRepeat"),x=d.get("uvOffset"),S=d.get("detailUvRepeat"),T=d.get("detailUvOffset"),b=!!_&&d.isTextureEnabled("bumpMap"),w=!!m&&d.isTextureEnabled("roughnessMap"),A=d.isDefined("fragment","DOUBLE_SIDED");_=_||r,m=m||n,f!==h?(h.set("normalMap",g),h.set("bumpMap",_),h.set("roughnessMap",m),h.set("useBumpMap",b),h.set("useRoughnessMap",w),h.set("doubleSide",A),y!=null&&h.set("uvRepeat",y),x!=null&&h.set("uvOffset",x),S!=null&&h.set("detailUvRepeat",S),T!=null&&h.set("detailUvOffset",T),h.set("roughness",p)):(v.setUniform(u,"1f","roughness",p),i!==g&&Nc(e,v,"normalMap",g,0),o!==_&&_&&Nc(e,v,"bumpMap",_,1),s!==m&&m&&Nc(e,v,"roughnessMap",m,2),y!=null&&v.setUniform(u,"2f","uvRepeat",y),x!=null&&v.setUniform(u,"2f","uvOffset",x),S!=null&&v.setUniform(u,"2f","detailUvRepeat",S),T!=null&&v.setUniform(u,"2f","detailUvOffset",T),v.setUniform(u,"1i","useBumpMap",+b),v.setUniform(u,"1i","useRoughnessMap",+w),v.setUniform(u,"1i","doubleSide",+A)),i=g,o=_,s=m,l=c}}}function vi(e){this._depthTex=new _e({format:ie.DEPTH_COMPONENT,type:ie.UNSIGNED_INT}),this._normalTex=new _e({type:ie.HALF_FLOAT}),this._framebuffer=new Rt,this._framebuffer.attach(this._normalTex),this._framebuffer.attach(this._depthTex,Rt.DEPTH_ATTACHMENT),this._normalMaterial=new Sr({shader:new H(H.source("ecgl.normal.vertex"),H.source("ecgl.normal.fragment"))}),this._normalMaterial.enableTexture(["normalMap","bumpMap","roughnessMap"]),this._defaultNormalMap=ca.createBlank("#000"),this._defaultBumpMap=ca.createBlank("#000"),this._defaultRoughessMap=ca.createBlank("#000"),this._debugPass=new dt({fragment:H.source("clay.compositor.output")}),this._debugPass.setUniform("texture",this._normalTex),this._debugPass.material.undefine("fragment","OUTPUT_ALPHA")}vi.prototype.getDepthTexture=function(){return this._depthTex};vi.prototype.getNormalTexture=function(){return this._normalTex};vi.prototype.update=function(e,t,r){var n=e.getWidth(),a=e.getHeight(),i=this._depthTex,o=this._normalTex,s=this._normalMaterial;i.width=n,i.height=a,o.width=n,o.height=a;var l=t.getRenderList(r).opaque;this._framebuffer.bind(e),e.gl.clearColor(0,0,0,0),e.gl.clear(e.gl.COLOR_BUFFER_BIT|e.gl.DEPTH_BUFFER_BIT),e.gl.disable(e.gl.BLEND),e.renderPass(l,r,{getMaterial:function(){return s},ifRender:function(u){return u.renderNormal},beforeRender:U6(e,this._defaultNormalMap,this._defaultBumpMap,this._defaultRoughessMap,this._normalMaterial),sort:e.opaqueSortCompare}),this._framebuffer.unbind(e)};vi.prototype.renderDebug=function(e){this._debugPass.render(e)};vi.prototype.dispose=function(e){this._depthTex.dispose(e),this._normalTex.dispose(e)};function Vo(e){e=e||{},this._edgePass=new dt({fragment:H.source("ecgl.edge")}),this._edgePass.setUniform("normalTexture",e.normalTexture),this._edgePass.setUniform("depthTexture",e.depthTexture),this._targetTexture=new _e({type:ie.HALF_FLOAT}),this._frameBuffer=new Rt,this._frameBuffer.attach(this._targetTexture)}Vo.prototype.update=function(e,t,r,n){var a=e.getWidth(),i=e.getHeight(),o=this._targetTexture;o.width=a,o.height=i;var s=this._frameBuffer;s.bind(e),this._edgePass.setUniform("projectionInv",t.invProjectionMatrix.array),this._edgePass.setUniform("textureSize",[a,i]),this._edgePass.setUniform("texture",r),this._edgePass.render(e),s.unbind(e)};Vo.prototype.getTargetTexture=function(){return this._targetTexture};Vo.prototype.setParameter=function(e,t){this._edgePass.setUniform(e,t)};Vo.prototype.dispose=function(e){this._targetTexture.dispose(e),this._frameBuffer.dispose(e)};const k6={type:"compositor",nodes:[{name:"source",type:"texture",outputs:{color:{}}},{name:"source_half",shader:"#source(clay.compositor.downsample)",inputs:{texture:"source"},outputs:{color:{parameters:{width:"expr(width * 1.0 / 2)",height:"expr(height * 1.0 / 2)",type:"HALF_FLOAT"}}},parameters:{textureSize:"expr( [width * 1.0, height * 1.0] )"}},{name:"bright",shader:"#source(clay.compositor.bright)",inputs:{texture:"source_half"},outputs:{color:{parameters:{width:"expr(width * 1.0 / 2)",height:"expr(height * 1.0 / 2)",type:"HALF_FLOAT"}}},parameters:{threshold:2,scale:4,textureSize:"expr([width * 1.0 / 2, height / 2])"}},{name:"bright_downsample_4",shader:"#source(clay.compositor.downsample)",inputs:{texture:"bright"},outputs:{color:{parameters:{width:"expr(width * 1.0 / 4)",height:"expr(height * 1.0 / 4)",type:"HALF_FLOAT"}}},parameters:{textureSize:"expr( [width * 1.0 / 2, height / 2] )"}},{name:"bright_downsample_8",shader:"#source(clay.compositor.downsample)",inputs:{texture:"bright_downsample_4"},outputs:{color:{parameters:{width:"expr(width * 1.0 / 8)",height:"expr(height * 1.0 / 8)",type:"HALF_FLOAT"}}},parameters:{textureSize:"expr( [width * 1.0 / 4, height / 4] )"}},{name:"bright_downsample_16",shader:"#source(clay.compositor.downsample)",inputs:{texture:"bright_downsample_8"},outputs:{color:{parameters:{width:"expr(width * 1.0 / 16)",height:"expr(height * 1.0 / 16)",type:"HALF_FLOAT"}}},parameters:{textureSize:"expr( [width * 1.0 / 8, height / 8] )"}},{name:"bright_downsample_32",shader:"#source(clay.compositor.downsample)",inputs:{texture:"bright_downsample_16"},outputs:{color:{parameters:{width:"expr(width * 1.0 / 32)",height:"expr(height * 1.0 / 32)",type:"HALF_FLOAT"}}},parameters:{textureSize:"expr( [width * 1.0 / 16, height / 16] )"}},{name:"bright_upsample_16_blur_h",shader:"#source(clay.compositor.gaussian_blur)",inputs:{texture:"bright_downsample_32"},outputs:{color:{parameters:{width:"expr(width * 1.0 / 16)",height:"expr(height * 1.0 / 16)",type:"HALF_FLOAT"}}},parameters:{blurSize:1,blurDir:0,textureSize:"expr( [width * 1.0 / 32, height / 32] )"}},{name:"bright_upsample_16_blur_v",shader:"#source(clay.compositor.gaussian_blur)",inputs:{texture:"bright_upsample_16_blur_h"},outputs:{color:{parameters:{width:"expr(width * 1.0 / 16)",height:"expr(height * 1.0 / 16)",type:"HALF_FLOAT"}}},parameters:{blurSize:1,blurDir:1,textureSize:"expr( [width * 1.0 / 16, height * 1.0 / 16] )"}},{name:"bright_upsample_8_blur_h",shader:"#source(clay.compositor.gaussian_blur)",inputs:{texture:"bright_downsample_16"},outputs:{color:{parameters:{width:"expr(width * 1.0 / 8)",height:"expr(height * 1.0 / 8)",type:"HALF_FLOAT"}}},parameters:{blurSize:1,blurDir:0,textureSize:"expr( [width * 1.0 / 16, height * 1.0 / 16] )"}},{name:"bright_upsample_8_blur_v",shader:"#source(clay.compositor.gaussian_blur)",inputs:{texture:"bright_upsample_8_blur_h"},outputs:{color:{parameters:{width:"expr(width * 1.0 / 8)",height:"expr(height * 1.0 / 8)",type:"HALF_FLOAT"}}},parameters:{blurSize:1,blurDir:1,textureSize:"expr( [width * 1.0 / 8, height * 1.0 / 8] )"}},{name:"bright_upsample_8_blend",shader:"#source(clay.compositor.blend)",inputs:{texture1:"bright_upsample_8_blur_v",texture2:"bright_upsample_16_blur_v"},outputs:{color:{parameters:{width:"expr(width * 1.0 / 8)",height:"expr(height * 1.0 / 8)",type:"HALF_FLOAT"}}},parameters:{weight1:.3,weight2:.7}},{name:"bright_upsample_4_blur_h",shader:"#source(clay.compositor.gaussian_blur)",inputs:{texture:"bright_downsample_8"},outputs:{color:{parameters:{width:"expr(width * 1.0 / 4)",height:"expr(height * 1.0 / 4)",type:"HALF_FLOAT"}}},parameters:{blurSize:1,blurDir:0,textureSize:"expr( [width * 1.0 / 8, height * 1.0 / 8] )"}},{name:"bright_upsample_4_blur_v",shader:"#source(clay.compositor.gaussian_blur)",inputs:{texture:"bright_upsample_4_blur_h"},outputs:{color:{parameters:{width:"expr(width * 1.0 / 4)",height:"expr(height * 1.0 / 4)",type:"HALF_FLOAT"}}},parameters:{blurSize:1,blurDir:1,textureSize:"expr( [width * 1.0 / 4, height * 1.0 / 4] )"}},{name:"bright_upsample_4_blend",shader:"#source(clay.compositor.blend)",inputs:{texture1:"bright_upsample_4_blur_v",texture2:"bright_upsample_8_blend"},outputs:{color:{parameters:{width:"expr(width * 1.0 / 4)",height:"expr(height * 1.0 / 4)",type:"HALF_FLOAT"}}},parameters:{weight1:.3,weight2:.7}},{name:"bright_upsample_2_blur_h",shader:"#source(clay.compositor.gaussian_blur)",inputs:{texture:"bright_downsample_4"},outputs:{color:{parameters:{width:"expr(width * 1.0 / 2)",height:"expr(height * 1.0 / 2)",type:"HALF_FLOAT"}}},parameters:{blurSize:1,blurDir:0,textureSize:"expr( [width * 1.0 / 4, height * 1.0 / 4] )"}},{name:"bright_upsample_2_blur_v",shader:"#source(clay.compositor.gaussian_blur)",inputs:{texture:"bright_upsample_2_blur_h"},outputs:{color:{parameters:{width:"expr(width * 1.0 / 2)",height:"expr(height * 1.0 / 2)",type:"HALF_FLOAT"}}},parameters:{blurSize:1,blurDir:1,textureSize:"expr( [width * 1.0 / 2, height * 1.0 / 2] )"}},{name:"bright_upsample_2_blend",shader:"#source(clay.compositor.blend)",inputs:{texture1:"bright_upsample_2_blur_v",texture2:"bright_upsample_4_blend"},outputs:{color:{parameters:{width:"expr(width * 1.0 / 2)",height:"expr(height * 1.0 / 2)",type:"HALF_FLOAT"}}},parameters:{weight1:.3,weight2:.7}},{name:"bright_upsample_full_blur_h",shader:"#source(clay.compositor.gaussian_blur)",inputs:{texture:"bright"},outputs:{color:{parameters:{width:"expr(width * 1.0)",height:"expr(height * 1.0)",type:"HALF_FLOAT"}}},parameters:{blurSize:1,blurDir:0,textureSize:"expr( [width * 1.0 / 2, height * 1.0 / 2] )"}},{name:"bright_upsample_full_blur_v",shader:"#source(clay.compositor.gaussian_blur)",inputs:{texture:"bright_upsample_full_blur_h"},outputs:{color:{parameters:{width:"expr(width * 1.0)",height:"expr(height * 1.0)",type:"HALF_FLOAT"}}},parameters:{blurSize:1,blurDir:1,textureSize:"expr( [width * 1.0, height * 1.0] )"}},{name:"bloom_composite",shader:"#source(clay.compositor.blend)",inputs:{texture1:"bright_upsample_full_blur_v",texture2:"bright_upsample_2_blend"},outputs:{color:{parameters:{width:"expr(width * 1.0)",height:"expr(height * 1.0)",type:"HALF_FLOAT"}}},parameters:{weight1:.3,weight2:.7}},{name:"coc",shader:"#source(ecgl.dof.coc)",outputs:{color:{parameters:{minFilter:"NEAREST",magFilter:"NEAREST",width:"expr(width * 1.0)",height:"expr(height * 1.0)"}}},parameters:{focalDist:50,focalRange:30}},{name:"dof_far_blur",shader:"#source(ecgl.dof.diskBlur)",inputs:{texture:"source",coc:"coc"},outputs:{color:{parameters:{width:"expr(width * 1.0)",height:"expr(height * 1.0)",type:"HALF_FLOAT"}}},parameters:{textureSize:"expr( [width * 1.0, height * 1.0] )"}},{name:"dof_near_blur",shader:"#source(ecgl.dof.diskBlur)",inputs:{texture:"source",coc:"coc"},outputs:{color:{parameters:{width:"expr(width * 1.0)",height:"expr(height * 1.0)",type:"HALF_FLOAT"}}},parameters:{textureSize:"expr( [width * 1.0, height * 1.0] )"},defines:{BLUR_NEARFIELD:null}},{name:"dof_coc_blur",shader:"#source(ecgl.dof.diskBlur)",inputs:{texture:"coc"},outputs:{color:{parameters:{minFilter:"NEAREST",magFilter:"NEAREST",width:"expr(width * 1.0)",height:"expr(height * 1.0)"}}},parameters:{textureSize:"expr( [width * 1.0, height * 1.0] )"},defines:{BLUR_COC:null}},{name:"dof_composite",shader:"#source(ecgl.dof.composite)",inputs:{original:"source",blurred:"dof_far_blur",nearfield:"dof_near_blur",coc:"coc",nearcoc:"dof_coc_blur"},outputs:{color:{parameters:{width:"expr(width * 1.0)",height:"expr(height * 1.0)",type:"HALF_FLOAT"}}}},{name:"composite",shader:"#source(clay.compositor.hdr.composite)",inputs:{texture:"source",bloom:"bloom_composite"},outputs:{color:{parameters:{width:"expr(width * 1.0)",height:"expr(height * 1.0)"}}},defines:{}},{name:"FXAA",shader:"#source(clay.compositor.fxaa)",inputs:{texture:"composite"}}]},H6=`@export ecgl.dof.coc

uniform sampler2D depth;

uniform float zNear: 0.1;
uniform float zFar: 2000;

uniform float focalDistance: 3;
uniform float focalRange: 1;
uniform float focalLength: 30;
uniform float fstop: 2.8;

varying vec2 v_Texcoord;

@import clay.util.encode_float

void main()
{
 float z = texture2D(depth, v_Texcoord).r * 2.0 - 1.0;

 float dist = 2.0 * zNear * zFar / (zFar + zNear - z * (zFar - zNear));

 float aperture = focalLength / fstop;

 float coc;

 float uppper = focalDistance + focalRange;
 float lower = focalDistance - focalRange;
 if (dist <= uppper && dist >= lower) {
 coc = 0.5;
 }
 else {
 float focalAdjusted = dist > uppper ? uppper : lower;

 coc = abs(aperture * (focalLength * (dist - focalAdjusted)) / (dist * (focalAdjusted - focalLength)));
 coc = clamp(coc, 0.0, 2.0) / 2.00001;

 if (dist < lower) {
 coc = -coc;
 }
 coc = coc * 0.5 + 0.5;
 }

 gl_FragColor = encodeFloat(coc);
}
@end


@export ecgl.dof.composite

#define DEBUG 0

uniform sampler2D original;
uniform sampler2D blurred;
uniform sampler2D nearfield;
uniform sampler2D coc;
uniform sampler2D nearcoc;
varying vec2 v_Texcoord;

@import clay.util.rgbm
@import clay.util.float

void main()
{
 vec4 blurredColor = texture2D(blurred, v_Texcoord);
 vec4 originalColor = texture2D(original, v_Texcoord);

 float fCoc = decodeFloat(texture2D(coc, v_Texcoord));

 fCoc = abs(fCoc * 2.0 - 1.0);

 float weight = smoothstep(0.0, 1.0, fCoc);
 
#ifdef NEARFIELD_ENABLED
 vec4 nearfieldColor = texture2D(nearfield, v_Texcoord);
 float fNearCoc = decodeFloat(texture2D(nearcoc, v_Texcoord));
 fNearCoc = abs(fNearCoc * 2.0 - 1.0);

 gl_FragColor = encodeHDR(
 mix(
 nearfieldColor, mix(originalColor, blurredColor, weight),
 pow(1.0 - fNearCoc, 4.0)
 )
 );
#else
 gl_FragColor = encodeHDR(mix(originalColor, blurredColor, weight));
#endif

}

@end



@export ecgl.dof.diskBlur

#define POISSON_KERNEL_SIZE 16;

uniform sampler2D texture;
uniform sampler2D coc;
varying vec2 v_Texcoord;

uniform float blurRadius : 10.0;
uniform vec2 textureSize : [512.0, 512.0];

uniform vec2 poissonKernel[POISSON_KERNEL_SIZE];

uniform float percent;

float nrand(const in vec2 n) {
 return fract(sin(dot(n.xy ,vec2(12.9898,78.233))) * 43758.5453);
}

@import clay.util.rgbm
@import clay.util.float


void main()
{
 vec2 offset = blurRadius / textureSize;

 float rnd = 6.28318 * nrand(v_Texcoord + 0.07 * percent );
 float cosa = cos(rnd);
 float sina = sin(rnd);
 vec4 basis = vec4(cosa, -sina, sina, cosa);

#if !defined(BLUR_NEARFIELD) && !defined(BLUR_COC)
 offset *= abs(decodeFloat(texture2D(coc, v_Texcoord)) * 2.0 - 1.0);
#endif

#ifdef BLUR_COC
 float cocSum = 0.0;
#else
 vec4 color = vec4(0.0);
#endif


 float weightSum = 0.0;

 for (int i = 0; i < POISSON_KERNEL_SIZE; i++) {
 vec2 ofs = poissonKernel[i];

 ofs = vec2(dot(ofs, basis.xy), dot(ofs, basis.zw));

 vec2 uv = v_Texcoord + ofs * offset;
 vec4 texel = texture2D(texture, uv);

 float w = 1.0;
#ifdef BLUR_COC
 float fCoc = decodeFloat(texel) * 2.0 - 1.0;
 cocSum += clamp(fCoc, -1.0, 0.0) * w;
#else
 texel = texel;
 #if !defined(BLUR_NEARFIELD)
 float fCoc = decodeFloat(texture2D(coc, uv)) * 2.0 - 1.0;
 w *= abs(fCoc);
 #endif
 texel.rgb *= texel.a;
 color += texel * w;
#endif

 weightSum += w;
 }

#ifdef BLUR_COC
 gl_FragColor = encodeFloat(clamp(cocSum / weightSum, -1.0, 0.0) * 0.5 + 0.5);
#else
 color /= weightSum;
 color.rgb /= (color.a + 0.0001);
 gl_FragColor = color;
#endif
}

@end`,W6=`@export ecgl.edge

uniform sampler2D texture;

uniform sampler2D normalTexture;
uniform sampler2D depthTexture;

uniform mat4 projectionInv;

uniform vec2 textureSize;

uniform vec4 edgeColor: [0,0,0,0.8];

varying vec2 v_Texcoord;

vec3 packColor(vec2 coord) {
 float z = texture2D(depthTexture, coord).r * 2.0 - 1.0;
 vec4 p = vec4(v_Texcoord * 2.0 - 1.0, z, 1.0);
 vec4 p4 = projectionInv * p;

 return vec3(
 texture2D(normalTexture, coord).rg,
 -p4.z / p4.w / 5.0
 );
}

void main() {
 vec2 cc = v_Texcoord;
 vec3 center = packColor(cc);

 float size = clamp(1.0 - (center.z - 10.0) / 100.0, 0.0, 1.0) * 0.5;
 float dx = size / textureSize.x;
 float dy = size / textureSize.y;

 vec2 coord;
 vec3 topLeft = packColor(cc+vec2(-dx, -dy));
 vec3 top = packColor(cc+vec2(0.0, -dy));
 vec3 topRight = packColor(cc+vec2(dx, -dy));
 vec3 left = packColor(cc+vec2(-dx, 0.0));
 vec3 right = packColor(cc+vec2(dx, 0.0));
 vec3 bottomLeft = packColor(cc+vec2(-dx, dy));
 vec3 bottom = packColor(cc+vec2(0.0, dy));
 vec3 bottomRight = packColor(cc+vec2(dx, dy));

 vec3 v = -topLeft-2.0*top-topRight+bottomLeft+2.0*bottom+bottomRight;
 vec3 h = -bottomLeft-2.0*left-topLeft+bottomRight+2.0*right+topRight;

 float edge = sqrt(dot(h, h) + dot(v, v));

 edge = smoothstep(0.8, 1.0, edge);

 gl_FragColor = mix(texture2D(texture, v_Texcoord), vec4(edgeColor.rgb, 1.0), edgeColor.a * edge);
}
@end`;H.import(_x);H.import(xx);H.import(Sx);H.import(Tx);H.import(bx);H.import(wx);H.import(Ax);H.import(Ex);H.import(Cx);H.import(H6);H.import(W6);function Mx(e,t){return{color:{parameters:{width:e,height:t}}}}var pd=["composite","FXAA"];function we(){this._width,this._height,this._dpr,this._sourceTexture=new _e({type:ie.HALF_FLOAT}),this._depthTexture=new _e({format:ie.DEPTH_COMPONENT,type:ie.UNSIGNED_INT}),this._framebuffer=new Rt,this._framebuffer.attach(this._sourceTexture),this._framebuffer.attach(this._depthTexture,Rt.DEPTH_ATTACHMENT),this._normalPass=new vi,this._compositor=M6(k6);var e=this._compositor.getNodeByName("source");e.texture=this._sourceTexture;var t=this._compositor.getNodeByName("coc");this._sourceNode=e,this._cocNode=t,this._compositeNode=this._compositor.getNodeByName("composite"),this._fxaaNode=this._compositor.getNodeByName("FXAA"),this._dofBlurNodes=["dof_far_blur","dof_near_blur","dof_coc_blur"].map(function(n){return this._compositor.getNodeByName(n)},this),this._dofBlurKernel=0,this._dofBlurKernelSize=new Float32Array(0),this._finalNodesChain=pd.map(function(n){return this._compositor.getNodeByName(n)},this);var r={normalTexture:this._normalPass.getNormalTexture(),depthTexture:this._normalPass.getDepthTexture()};this._ssaoPass=new cn(r),this._ssrPass=new hn(r),this._edgePass=new Vo(r)}we.prototype.resize=function(n,a,r){r=r||1;var n=n*r,a=a*r,i=this._sourceTexture,o=this._depthTexture;i.width=n,i.height=a,o.width=n,o.height=a;var s={getWidth:function(){return n},getHeight:function(){return a},getDevicePixelRatio:function(){return r}};function l(u,c){if(typeof u[c]=="function"){var h=u[c].__original||u[c];u[c]=function(f){return h.call(this,s)},u[c].__original=h}}this._compositor.nodes.forEach(function(u){for(var c in u.outputs){var h=u.outputs[c].parameters;h&&(l(h,"width"),l(h,"height"))}for(var f in u.parameters)l(u.parameters,f)}),this._width=n,this._height=a,this._dpr=r};we.prototype.getWidth=function(){return this._width};we.prototype.getHeight=function(){return this._height};we.prototype._ifRenderNormalPass=function(){return this._enableSSAO||this._enableEdge||this._enableSSR};we.prototype._getPrevNode=function(e){for(var t=pd.indexOf(e.name)-1,r=this._finalNodesChain[t];r&&!this._compositor.getNodeByName(r.name);)t-=1,r=this._finalNodesChain[t];return r};we.prototype._getNextNode=function(e){for(var t=pd.indexOf(e.name)+1,r=this._finalNodesChain[t];r&&!this._compositor.getNodeByName(r.name);)t+=1,r=this._finalNodesChain[t];return r};we.prototype._addChainNode=function(e){var t=this._getPrevNode(e),r=this._getNextNode(e);t&&(e.inputs.texture=t.name,r?(e.outputs=Mx(this.getWidth.bind(this),this.getHeight.bind(this)),r.inputs.texture=e.name):e.outputs=null,this._compositor.addNode(e))};we.prototype._removeChainNode=function(e){var t=this._getPrevNode(e),r=this._getNextNode(e);t&&(r?(t.outputs=Mx(this.getWidth.bind(this),this.getHeight.bind(this)),r.inputs.texture=t.name):t.outputs=null,this._compositor.removeNode(e))};we.prototype.updateNormal=function(e,t,r,n){this._ifRenderNormalPass()&&this._normalPass.update(e,t,r)};we.prototype.updateSSAO=function(e,t,r,n){this._ssaoPass.update(e,r,n)};we.prototype.enableSSAO=function(){this._enableSSAO=!0};we.prototype.disableSSAO=function(){this._enableSSAO=!1};we.prototype.enableSSR=function(){this._enableSSR=!0};we.prototype.disableSSR=function(){this._enableSSR=!1};we.prototype.getSSAOTexture=function(){return this._ssaoPass.getTargetTexture()};we.prototype.getSourceFrameBuffer=function(){return this._framebuffer};we.prototype.getSourceTexture=function(){return this._sourceTexture};we.prototype.disableFXAA=function(){this._removeChainNode(this._fxaaNode)};we.prototype.enableFXAA=function(){this._addChainNode(this._fxaaNode)};we.prototype.enableBloom=function(){this._compositeNode.inputs.bloom="bloom_composite",this._compositor.dirty()};we.prototype.disableBloom=function(){this._compositeNode.inputs.bloom=null,this._compositor.dirty()};we.prototype.enableDOF=function(){this._compositeNode.inputs.texture="dof_composite",this._compositor.dirty()};we.prototype.disableDOF=function(){this._compositeNode.inputs.texture="source",this._compositor.dirty()};we.prototype.enableColorCorrection=function(){this._compositeNode.define("COLOR_CORRECTION"),this._enableColorCorrection=!0};we.prototype.disableColorCorrection=function(){this._compositeNode.undefine("COLOR_CORRECTION"),this._enableColorCorrection=!1};we.prototype.enableEdge=function(){this._enableEdge=!0};we.prototype.disableEdge=function(){this._enableEdge=!1};we.prototype.setBloomIntensity=function(e){this._compositeNode.setParameter("bloomIntensity",e)};we.prototype.setSSAOParameter=function(e,t){switch(e){case"quality":var r={low:6,medium:12,high:32,ultra:62}[t]||12;this._ssaoPass.setParameter("kernelSize",r);break;case"radius":this._ssaoPass.setParameter(e,t),this._ssaoPass.setParameter("bias",t/200);break;case"intensity":this._ssaoPass.setParameter(e,t);break}};we.prototype.setDOFParameter=function(e,t){switch(e){case"focalDistance":case"focalRange":case"fstop":this._cocNode.setParameter(e,t);break;case"blurRadius":for(var r=0;r<this._dofBlurNodes.length;r++)this._dofBlurNodes[r].setParameter("blurRadius",t);break;case"quality":var n={low:4,medium:8,high:16,ultra:32}[t]||8;this._dofBlurKernelSize=n;for(var r=0;r<this._dofBlurNodes.length;r++)this._dofBlurNodes[r].pass.material.define("POISSON_KERNEL_SIZE",n);this._dofBlurKernel=new Float32Array(n*2);break}};we.prototype.setSSRParameter=function(e,t){if(t!=null)switch(e){case"quality":var r={low:10,medium:15,high:30,ultra:80}[t]||20,n={low:32,medium:16,high:8,ultra:4}[t]||16;this._ssrPass.setParameter("maxIteration",r),this._ssrPass.setParameter("pixelStride",n);break;case"maxRoughness":this._ssrPass.setParameter("minGlossiness",Math.max(Math.min(1-t,1),0));break;case"physical":this.setPhysicallyCorrectSSR(t);break;default:console.warn("Unkown SSR parameter "+e)}};we.prototype.setPhysicallyCorrectSSR=function(e){this._ssrPass.setPhysicallyCorrect(e)};we.prototype.setEdgeColor=function(e){var t=D.parseColor(e);this._edgePass.setParameter("edgeColor",t)};we.prototype.setExposure=function(e){this._compositeNode.setParameter("exposure",Math.pow(2,e))};we.prototype.setColorLookupTexture=function(e,t){this._compositeNode.pass.material.setTextureImage("lut",this._enableColorCorrection?e:"none",t,{minFilter:D.Texture.NEAREST,magFilter:D.Texture.NEAREST,flipY:!1})};we.prototype.setColorCorrection=function(e,t){this._compositeNode.setParameter(e,t)};we.prototype.isSSREnabled=function(){return this._enableSSR};we.prototype.composite=function(e,t,r,n,a){var i=this._sourceTexture,o=i;this._enableEdge&&(this._edgePass.update(e,r,i,a),i=o=this._edgePass.getTargetTexture()),this._enableSSR&&(this._ssrPass.update(e,r,i,a),o=this._ssrPass.getTargetTexture(),this._ssrPass.setSSAOTexture(this._enableSSAO?this._ssaoPass.getTargetTexture():null)),this._sourceNode.texture=o,this._cocNode.setParameter("depth",this._depthTexture);for(var s=this._dofBlurKernel,l=this._dofBlurKernelSize,u=Math.floor(I1.length/2/l),c=a%u,h=0;h<l*2;h++)s[h]=I1[h+c*l*2];for(var h=0;h<this._dofBlurNodes.length;h++)this._dofBlurNodes[h].setParameter("percent",a/30),this._dofBlurNodes[h].setParameter("poissonKernel",s);this._cocNode.setParameter("zNear",r.near),this._cocNode.setParameter("zFar",r.far),this._compositor.render(e,n)};we.prototype.dispose=function(e){this._sourceTexture.dispose(e),this._depthTexture.dispose(e),this._framebuffer.dispose(e),this._compositor.dispose(e),this._normalPass.dispose(e),this._ssaoPass.dispose(e)};function Gh(e){for(var t=[],r=0;r<30;r++)t.push([ai(r,2),ai(r,3)]);this._haltonSequence=t,this._frame=0,this._sourceTex=new _e,this._sourceFb=new Rt,this._sourceFb.attach(this._sourceTex),this._prevFrameTex=new _e,this._outputTex=new _e;var n=this._blendPass=new dt({fragment:H.source("clay.compositor.blend")});n.material.disableTexturesAll(),n.material.enableTexture(["texture1","texture2"]),this._blendFb=new Rt({depthBuffer:!1}),this._outputPass=new dt({fragment:H.source("clay.compositor.output"),blendWithPrevious:!0}),this._outputPass.material.define("fragment","OUTPUT_ALPHA"),this._outputPass.material.blend=function(a){a.blendEquationSeparate(a.FUNC_ADD,a.FUNC_ADD),a.blendFuncSeparate(a.ONE,a.ONE_MINUS_SRC_ALPHA,a.ONE,a.ONE_MINUS_SRC_ALPHA)}}Gh.prototype={constructor:Gh,jitterProjection:function(e,t){var r=e.viewport,n=r.devicePixelRatio||e.getDevicePixelRatio(),a=r.width*n,i=r.height*n,o=this._haltonSequence[this._frame%this._haltonSequence.length],s=new ne;s.array[12]=(o[0]*2-1)/a,s.array[13]=(o[1]*2-1)/i,ne.mul(t.projectionMatrix,s,t.projectionMatrix),ne.invert(t.invProjectionMatrix,t.projectionMatrix)},resetFrame:function(){this._frame=0},getFrame:function(){return this._frame},getSourceFrameBuffer:function(){return this._sourceFb},getOutputTexture:function(){return this._outputTex},resize:function(e,t){this._prevFrameTex.width=e,this._prevFrameTex.height=t,this._outputTex.width=e,this._outputTex.height=t,this._sourceTex.width=e,this._sourceTex.height=t,this._prevFrameTex.dirty(),this._outputTex.dirty(),this._sourceTex.dirty()},isFinished:function(){return this._frame>=this._haltonSequence.length},render:function(e,t,r){var n=this._blendPass;this._frame===0?(n.setUniform("weight1",0),n.setUniform("weight2",1)):(n.setUniform("weight1",.9),n.setUniform("weight2",.1)),n.setUniform("texture1",this._prevFrameTex),n.setUniform("texture2",t||this._sourceTex),this._blendFb.attach(this._outputTex),this._blendFb.bind(e),n.render(e),this._blendFb.unbind(e),r||(this._outputPass.setUniform("texture",this._outputTex),this._outputPass.render(e));var a=this._prevFrameTex;this._prevFrameTex=this._outputTex,this._outputTex=a,this._frame++},dispose:function(e){this._sourceFb.dispose(e),this._blendFb.dispose(e),this._prevFrameTex.dispose(e),this._outputTex.dispose(e),this._sourceTex.dispose(e),this._outputPass.dispose(e),this._blendPass.dispose(e)}};function Oe(e){e=e||"perspective",this.layer=null,this.scene=new On,this.rootNode=this.scene,this.viewport={x:0,y:0,width:0,height:0},this.setProjection(e),this._compositor=new we,this._temporalSS=new Gh,this._shadowMapPass=new d6;for(var t=[],r=0,n=0;n<30;n++){for(var a=[],i=0;i<6;i++)a.push(ai(r,2)*4-2),a.push(ai(r,3)*4-2),r++;t.push(a)}this._pcfKernels=t,this.scene.on("beforerender",function(o,s,l){this.needsTemporalSS()&&this._temporalSS.jitterProjection(o,l)},this)}Oe.prototype.setProjection=function(e){var t=this.camera;t&&t.update(),e==="perspective"?this.camera instanceof bt||(this.camera=new bt,t&&this.camera.setLocalTransform(t.localTransform)):this.camera instanceof ni||(this.camera=new ni,t&&this.camera.setLocalTransform(t.localTransform)),this.camera.near=.1,this.camera.far=2e3};Oe.prototype.setViewport=function(e,t,r,n,a){this.camera instanceof bt&&(this.camera.aspect=r/n),a=a||1,this.viewport.x=e,this.viewport.y=t,this.viewport.width=r,this.viewport.height=n,this.viewport.devicePixelRatio=a,this._compositor.resize(r*a,n*a),this._temporalSS.resize(r*a,n*a)};Oe.prototype.containPoint=function(e,t){var r=this.viewport,n=this.layer.renderer.getHeight();return t=n-t,e>=r.x&&t>=r.y&&e<=r.x+r.width&&t<=r.y+r.height};var R1=new lr;Oe.prototype.castRay=function(e,t,r){var n=this.layer.renderer,a=n.viewport;return n.viewport=this.viewport,n.screenToNDC(e,t,R1),this.camera.castRay(R1,r),n.viewport=a,r};Oe.prototype.prepareRender=function(){this.scene.update(),this.camera.update(),this.scene.updateLights();var e=this.scene.updateRenderList(this.camera);this._needsSortProgressively=!1;for(var t=0;t<e.transparent.length;t++){var r=e.transparent[t],n=r.geometry;n.needsSortVerticesProgressively&&n.needsSortVerticesProgressively()&&(this._needsSortProgressively=!0),n.needsSortTrianglesProgressively&&n.needsSortTrianglesProgressively()&&(this._needsSortProgressively=!0)}this._frame=0,this._temporalSS.resetFrame()};Oe.prototype.render=function(e,t){this._doRender(e,t,this._frame),this._frame++};Oe.prototype.needsAccumulate=function(){return this.needsTemporalSS()||this._needsSortProgressively};Oe.prototype.needsTemporalSS=function(){var e=this._enableTemporalSS;return e==="auto"&&(e=this._enablePostEffect),e};Oe.prototype.hasDOF=function(){return this._enableDOF};Oe.prototype.isAccumulateFinished=function(){return this.needsTemporalSS()?this._temporalSS.isFinished():this._frame>30};Oe.prototype._doRender=function(e,t,r){var n=this.scene,a=this.camera;r=r||0,this._updateTransparent(e,n,a,r),t||(this._shadowMapPass.kernelPCF=this._pcfKernels[0],this._shadowMapPass.render(e,n,a,!0)),this._updateShadowPCFKernel(r);var i=e.clearColor;if(e.gl.clearColor(i[0],i[1],i[2],i[3]),this._enablePostEffect&&(this.needsTemporalSS()&&this._temporalSS.jitterProjection(e,a),this._compositor.updateNormal(e,n,a,this._temporalSS.getFrame())),this._updateSSAO(e,n,a,this._temporalSS.getFrame()),this._enablePostEffect){var o=this._compositor.getSourceFrameBuffer();o.bind(e),e.gl.clear(e.gl.DEPTH_BUFFER_BIT|e.gl.COLOR_BUFFER_BIT),e.render(n,a,!0,!0),o.unbind(e),this.needsTemporalSS()&&t?(this._compositor.composite(e,n,a,this._temporalSS.getSourceFrameBuffer(),this._temporalSS.getFrame()),e.setViewport(this.viewport),this._temporalSS.render(e)):(e.setViewport(this.viewport),this._compositor.composite(e,n,a,null,0))}else if(this.needsTemporalSS()&&t){var o=this._temporalSS.getSourceFrameBuffer();o.bind(e),e.saveClear(),e.clearBit=e.gl.DEPTH_BUFFER_BIT|e.gl.COLOR_BUFFER_BIT,e.render(n,a,!0,!0),e.restoreClear(),o.unbind(e),e.setViewport(this.viewport),this._temporalSS.render(e)}else e.setViewport(this.viewport),e.render(n,a,!0,!0)};Oe.prototype._updateTransparent=function(e,t,r,n){for(var a=new X,i=new ne,o=r.getWorldPosition(),s=t.getRenderList(r).transparent,l=0;l<s.length;l++){var u=s[l],c=u.geometry;ne.invert(i,u.worldTransform),X.transformMat4(a,o,i),c.needsSortTriangles&&c.needsSortTriangles()&&c.doSortTriangles(a,n),c.needsSortVertices&&c.needsSortVertices()&&c.doSortVertices(a,n)}};Oe.prototype._updateSSAO=function(e,t,r){var n=this._enableSSAO&&this._enablePostEffect;n&&this._compositor.updateSSAO(e,t,r,this._temporalSS.getFrame());for(var a=t.getRenderList(r),i=0;i<a.opaque.length;i++){var o=a.opaque[i];o.renderNormal&&o.material[n?"enableTexture":"disableTexture"]("ssaoMap"),n&&o.material.set("ssaoMap",this._compositor.getSSAOTexture())}};Oe.prototype._updateShadowPCFKernel=function(e){for(var t=this._pcfKernels[e%this._pcfKernels.length],r=this.scene.getRenderList(this.camera),n=r.opaque,a=0;a<n.length;a++)n[a].receiveShadow&&(n[a].material.set("pcfKernel",t),n[a].material.define("fragment","PCF_KERNEL_SIZE",t.length/2))};Oe.prototype.dispose=function(e){this._compositor.dispose(e.gl),this._temporalSS.dispose(e.gl),this._shadowMapPass.dispose(e)};Oe.prototype.setPostEffect=function(e,t){var r=this._compositor;this._enablePostEffect=e.get("enable");var n=e.getModel("bloom"),a=e.getModel("edge"),i=e.getModel("DOF",e.getModel("depthOfField")),o=e.getModel("SSAO",e.getModel("screenSpaceAmbientOcclusion")),s=e.getModel("SSR",e.getModel("screenSpaceReflection")),l=e.getModel("FXAA"),u=e.getModel("colorCorrection");n.get("enable")?r.enableBloom():r.disableBloom(),i.get("enable")?r.enableDOF():r.disableDOF(),s.get("enable")?r.enableSSR():r.disableSSR(),u.get("enable")?r.enableColorCorrection():r.disableColorCorrection(),a.get("enable")?r.enableEdge():r.disableEdge(),l.get("enable")?r.enableFXAA():r.disableFXAA(),this._enableDOF=i.get("enable"),this._enableSSAO=o.get("enable"),this._enableSSAO?r.enableSSAO():r.disableSSAO(),r.setBloomIntensity(n.get("intensity")),r.setEdgeColor(a.get("color")),r.setColorLookupTexture(u.get("lookupTexture"),t),r.setExposure(u.get("exposure")),["radius","quality","intensity"].forEach(function(c){r.setSSAOParameter(c,o.get(c))}),["quality","maxRoughness","physical"].forEach(function(c){r.setSSRParameter(c,s.get(c))}),["quality","focalDistance","focalRange","blurRadius","fstop"].forEach(function(c){r.setDOFParameter(c,i.get(c))}),["brightness","contrast","saturation"].forEach(function(c){r.setColorCorrection(c,u.get(c))})};Oe.prototype.setDOFFocusOnPoint=function(e){if(this._enablePostEffect)return e>this.camera.far||e<this.camera.near?void 0:(this._compositor.setDOFParameter("focalDistance",e),!0)};Oe.prototype.setTemporalSuperSampling=function(e){this._enableTemporalSS=e.get("enable")};Oe.prototype.isLinearSpace=function(){return this._enablePostEffect};Oe.prototype.setRootNode=function(e){if(this.rootNode!==e){for(var t=this.rootNode.children(),r=0;r<t.length;r++)e.add(t[r]);e!==this.scene&&this.scene.add(e),this.rootNode=e}};Oe.prototype.add=function(e){this.rootNode.add(e)};Oe.prototype.remove=function(e){this.rootNode.remove(e)};Oe.prototype.removeAll=function(e){this.rootNode.removeAll(e)};Object.assign(Oe.prototype,ad);function $6(e,t){var r=e.getBoxLayoutParams(),n=sr(r,{width:t.getWidth(),height:t.getHeight()});n.y=t.getHeight()-n.y-n.height,this.viewGL.setViewport(n.x,n.y,n.width,n.height,t.getDevicePixelRatio());var a=e.get("boxWidth"),i=e.get("boxHeight"),o=e.get("boxDepth");this.getAxis("x").setExtent(-a/2,a/2),this.getAxis("y").setExtent(o/2,-o/2),this.getAxis("z").setExtent(-i/2,i/2),this.size=[a,i,o]}function X6(e,t){var r={};function n(a,i){r[a]=r[a]||[1/0,-1/0],r[a][0]=Math.min(i[0],r[a][0]),r[a][1]=Math.max(i[1],r[a][1])}e.eachSeries(function(a){if(a.coordinateSystem===this){var i=a.getData();["x","y","z"].forEach(function(o){i.mapDimensionsAll(o,!0).forEach(function(s){n(o,i.getDataExtent(s,!0))})})}},this),["xAxis3D","yAxis3D","zAxis3D"].forEach(function(a){e.eachComponent(a,function(i){var o=a.charAt(0),s=i.getReferringComponents("grid3D").models[0],l=s.coordinateSystem;if(l===this){var u=l.getAxis(o);if(!u){var c=mf(r[o]||[1/0,-1/0],i);u=new fl(o,c),u.type=i.get("type");var h=u.type==="category";u.onBand=h&&i.get("boundaryGap"),u.inverse=i.get("inverse"),i.axis=u,u.model=i,u.getLabelModel=function(){return i.getModel("axisLabel",s.getModel("axisLabel"))},u.getTickModel=function(){return i.getModel("axisTick",s.getModel("axisTick"))},l.addAxis(u)}}},this)},this),this.resize(this.model,t)}var j6={dimensions:So.prototype.dimensions,create:function(e,t){var r=[];e.eachComponent("grid3D",function(i){i.__viewGL=i.__viewGL||new Oe;var o=new So;o.model=i,o.viewGL=i.__viewGL,i.coordinateSystem=o,r.push(o),o.resize=$6,o.update=X6});var n=["xAxis3D","yAxis3D","zAxis3D"];function a(i,o){return n.map(function(s){var l=i.getReferringComponents(s).models[0];return l==null&&(l=o.getComponent(s)),l})}return e.eachSeries(function(i){if(i.get("coordinateSystem")==="cartesian3D"){var o=i.getReferringComponents("grid3D").models[0];if(o==null){var s=a(i,e),o=s[0].getCoordSysModel();s.forEach(function(c){c.getCoordSysModel()})}var l=o.coordinateSystem;i.coordinateSystem=l}}),r}};const Z6=j6;var Px=Ot.extend({type:"cartesian3DAxis",axis:null,getCoordSysModel:function(){return this.ecModel.queryComponents({mainType:"grid3D",index:this.option.gridIndex,id:this.option.gridId})[0]}});W3(Px);const Y6=Px;var Ix={show:!0,grid3DIndex:0,inverse:!1,name:"",nameLocation:"middle",nameTextStyle:{fontSize:16},nameGap:20,axisPointer:{},axisLine:{},axisTick:{},axisLabel:{},splitArea:{}},q6=fe({boundaryGap:!0,axisTick:{alignWithLabel:!1,interval:"auto"},axisLabel:{interval:"auto"},axisPointer:{label:{show:!1}}},Ix),gd=fe({boundaryGap:[0,0],splitNumber:5,axisPointer:{label:{}}},Ix),K6=Te({scale:!0,min:"dataMin",max:"dataMax"},gd),Rx=Te({logBase:10},gd);Rx.scale=!0;const J6={categoryAxis3D:q6,valueAxis3D:gd,timeAxis3D:K6,logAxis3D:Rx};var Q6=["value","category","time","log"];function eR(e,t,r,n,a){Q6.forEach(function(i){var o=r.extend({type:t+"Axis3D."+i,__ordinalMeta:null,mergeDefaultAndTheme:function(s,l){var u=l.getTheme();fe(s,u.get(i+"Axis3D")),fe(s,this.getDefaultOption()),s.type=n(t,s)},optionUpdated:function(){var s=this.option;s.type==="category"&&(this.__ordinalMeta=R3.createByAxisModel(this))},getCategories:function(){if(this.option.type==="category")return this.__ordinalMeta.categories},getOrdinalMeta:function(){return this.__ordinalMeta},defaultOption:fe(vt(J6[i+"Axis3D"]),a||{},!0)});e.registerComponentModel(o)}),e.registerSubTypeDefaulter(t+"Axis3D",Ge(n,t))}function tR(e,t){return t.type||(t.data?"category":"value")}function rR(e){e.registerComponentModel(n6),e.registerComponentView(u6),e.registerCoordinateSystem("grid3D",Z6),["x","y","z"].forEach(function(t){eR(e,t,Y6,tR,{name:t.toUpperCase()});const r=e.ComponentView.extend({type:t+"Axis3D"});e.registerComponentView(r)}),e.registerAction({type:"grid3DChangeCamera",event:"grid3dcamerachanged",update:"series:updateCamera"},function(t,r){r.eachComponent({mainType:"grid3D",query:t},function(n){n.setView(t)})}),e.registerAction({type:"grid3DShowAxisPointer",event:"grid3dshowaxispointer",update:"grid3D:showAxisPointer"},function(t,r){}),e.registerAction({type:"grid3DHideAxisPointer",event:"grid3dhideaxispointer",update:"grid3D:hideAxisPointer"},function(t,r){})}oe(rR);const pi={defaultOption:{shading:null,realisticMaterial:{textureTiling:1,textureOffset:0,detailTexture:null},lambertMaterial:{textureTiling:1,textureOffset:0,detailTexture:null},colorMaterial:{textureTiling:1,textureOffset:0,detailTexture:null},hatchingMaterial:{textureTiling:1,textureOffset:0,paperColor:"#fff"}}},Nx={getFilledRegions:function(e,t){var r=(e||[]).slice(),n;if(typeof t=="string"?(t=ah(t),n=t&&t.geoJson):t&&t.features&&(n=t),!n)return[];for(var a={},i=n.features,o=0;o<r.length;o++)a[r[o].name]=r[o];for(var o=0;o<i.length;o++){var s=i[o].properties.name;a[s]||r.push({name:s})}return r},defaultOption:{show:!0,zlevel:-10,map:"",left:0,top:0,width:"100%",height:"100%",boxWidth:100,boxHeight:10,boxDepth:"auto",regionHeight:3,environment:"auto",groundPlane:{show:!1,color:"#aaa"},shading:"lambert",light:{main:{alpha:40,beta:30}},viewControl:{alpha:40,beta:0,distance:100,orthographicSize:60,minAlpha:5,minBeta:-80,maxBeta:80},label:{show:!1,distance:2,textStyle:{fontSize:20,color:"#000",backgroundColor:"rgba(255,255,255,0.7)",padding:3,borderRadius:4}},itemStyle:{color:"#fff",borderWidth:0,borderColor:"#333"},emphasis:{itemStyle:{color:"#639fc0"},label:{show:!0}}}};var gi=Ot.extend({type:"geo3D",layoutMode:"box",coordinateSystem:null,optionUpdated:function(){var e=this.option;e.regions=this.getFilledRegions(e.regions,e.map);var t=Fo(e.data||[],{coordDimensions:["value"],encodeDefine:this.get("encode"),dimensionsDefine:this.get("dimensions")}),r=new it(t,this);r.initData(e.regions);var n={};r.each(function(a){var i=r.getName(a),o=r.getItemModel(a);n[i]=o}),this._regionModelMap=n,this._data=r},getData:function(){return this._data},getRegionModel:function(e){var t=this.getData().getName(e);return this._regionModelMap[t]||new Ft(null,this)},getRegionPolygonCoords:function(e){var t=this.getData().getName(e),r=this.coordinateSystem.getRegion(t);return r?r.geometries:[]},getFormattedLabel:function(e,t){var r=this._data.getName(e),n=this.getRegionModel(e),a=n.get(t==="normal"?["label","formatter"]:["emphasis","label","formatter"]);a==null&&(a=n.get(["label","formatter"]));var i={name:r};if(typeof a=="function")return i.status=t,a(i);if(typeof a=="string"){var o=i.seriesName;return a.replace("{a}",o??"")}else return r},defaultOption:{regions:[]}});fe(gi.prototype,Nx);fe(gi.prototype,ql);fe(gi.prototype,fi);fe(gi.prototype,di);fe(gi.prototype,pi);const nR=gi;function Ox(e,t,r){r=r||2;var n=t&&t.length,a=n?t[0]*r:e.length,i=Bx(e,0,a,r,!0),o=[];if(!i)return o;var s,l,u,c,h,f,d;if(n&&(i=lR(e,t,i,r)),e.length>80*r){s=u=e[0],l=c=e[1];for(var v=r;v<a;v+=r)h=e[v],f=e[v+1],h<s&&(s=h),f<l&&(l=f),h>u&&(u=h),f>c&&(c=f);d=Math.max(u-s,c-l)}return wo(i,o,r,s,l,d),o}function Bx(e,t,r,n,a){var i,o;if(a===kh(e,t,r,n)>0)for(i=t;i<r;i+=n)o=N1(i,e[i],e[i+1],o);else for(i=r-n;i>=t;i-=n)o=N1(i,e[i],e[i+1],o);return o&&la(o,o.next)&&(Eo(o),o=o.next),o}function bo(e,t){if(!e)return e;t||(t=e);var r=e,n;do if(n=!1,!r.steiner&&(la(r,r.next)||Xt(r.prev,r,r.next)===0)){if(Eo(r),r=t=r.prev,r===r.next)return null;n=!0}else r=r.next;while(n||r!==t);return t}function wo(e,t,r,n,a,i,o){if(e){!o&&i&&fR(e,n,a,i);for(var s=e,l,u;e.prev!==e.next;){if(l=e.prev,u=e.next,i?iR(e,n,a,i):aR(e)){t.push(l.i/r),t.push(e.i/r),t.push(u.i/r),Eo(e),e=u.next,s=u.next;continue}if(e=u,e===s){o?o===1?(e=oR(e,t,r),wo(e,t,r,n,a,i,2)):o===2&&sR(e,t,r,n,a,i):wo(bo(e),t,r,n,a,i,1);break}}}}function aR(e){var t=e.prev,r=e,n=e.next;if(Xt(t,r,n)>=0)return!1;for(var a=e.next.next;a!==e.prev;){if(dl(t.x,t.y,r.x,r.y,n.x,n.y,a.x,a.y)&&Xt(a.prev,a,a.next)>=0)return!1;a=a.next}return!0}function iR(e,t,r,n){var a=e.prev,i=e,o=e.next;if(Xt(a,i,o)>=0)return!1;for(var s=a.x<i.x?a.x<o.x?a.x:o.x:i.x<o.x?i.x:o.x,l=a.y<i.y?a.y<o.y?a.y:o.y:i.y<o.y?i.y:o.y,u=a.x>i.x?a.x>o.x?a.x:o.x:i.x>o.x?i.x:o.x,c=a.y>i.y?a.y>o.y?a.y:o.y:i.y>o.y?i.y:o.y,h=Vh(s,l,t,r,n),f=Vh(u,c,t,r,n),d=e.nextZ;d&&d.z<=f;){if(d!==e.prev&&d!==e.next&&dl(a.x,a.y,i.x,i.y,o.x,o.y,d.x,d.y)&&Xt(d.prev,d,d.next)>=0)return!1;d=d.nextZ}for(d=e.prevZ;d&&d.z>=h;){if(d!==e.prev&&d!==e.next&&dl(a.x,a.y,i.x,i.y,o.x,o.y,d.x,d.y)&&Xt(d.prev,d,d.next)>=0)return!1;d=d.prevZ}return!0}function oR(e,t,r){var n=e;do{var a=n.prev,i=n.next.next;!la(a,i)&&Fx(a,n,n.next,i)&&Ao(a,i)&&Ao(i,a)&&(t.push(a.i/r),t.push(n.i/r),t.push(i.i/r),Eo(n),Eo(n.next),n=e=i),n=n.next}while(n!==e);return n}function sR(e,t,r,n,a,i){var o=e;do{for(var s=o.next.next;s!==o.prev;){if(o.i!==s.i&&pR(o,s)){var l=zx(o,s);o=bo(o,o.next),l=bo(l,l.next),wo(o,t,r,n,a,i),wo(l,t,r,n,a,i);return}s=s.next}o=o.next}while(o!==e)}function lR(e,t,r,n){var a=[],i,o,s,l,u;for(i=0,o=t.length;i<o;i++)s=t[i]*n,l=i<o-1?t[i+1]*n:e.length,u=Bx(e,s,l,n,!1),u===u.next&&(u.steiner=!0),a.push(vR(u));for(a.sort(uR),i=0;i<a.length;i++)cR(a[i],r),r=bo(r,r.next);return r}function uR(e,t){return e.x-t.x}function cR(e,t){if(t=hR(e,t),t){var r=zx(t,e);bo(r,r.next)}}function hR(e,t){var r=t,n=e.x,a=e.y,i=-1/0,o;do{if(a<=r.y&&a>=r.next.y&&r.next.y!==r.y){var s=r.x+(a-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(s<=n&&s>i){if(i=s,s===n){if(a===r.y)return r;if(a===r.next.y)return r.next}o=r.x<r.next.x?r:r.next}}r=r.next}while(r!==t);if(!o)return null;if(n===i)return o.prev;var l=o,u=o.x,c=o.y,h=1/0,f;for(r=o.next;r!==l;)n>=r.x&&r.x>=u&&n!==r.x&&dl(a<c?n:i,a,u,c,a<c?i:n,a,r.x,r.y)&&(f=Math.abs(a-r.y)/(n-r.x),(f<h||f===h&&r.x>o.x)&&Ao(r,e)&&(o=r,h=f)),r=r.next;return o}function fR(e,t,r,n){var a=e;do a.z===null&&(a.z=Vh(a.x,a.y,t,r,n)),a.prevZ=a.prev,a.nextZ=a.next,a=a.next;while(a!==e);a.prevZ.nextZ=null,a.prevZ=null,dR(a)}function dR(e){var t,r,n,a,i,o,s,l,u=1;do{for(r=e,e=null,i=null,o=0;r;){for(o++,n=r,s=0,t=0;t<u&&(s++,n=n.nextZ,!!n);t++);for(l=u;s>0||l>0&&n;)s!==0&&(l===0||!n||r.z<=n.z)?(a=r,r=r.nextZ,s--):(a=n,n=n.nextZ,l--),i?i.nextZ=a:e=a,a.prevZ=i,i=a;r=n}i.nextZ=null,u*=2}while(o>1);return e}function Vh(e,t,r,n,a){return e=32767*(e-r)/a,t=32767*(t-n)/a,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e|t<<1}function vR(e){var t=e,r=e;do t.x<r.x&&(r=t),t=t.next;while(t!==e);return r}function dl(e,t,r,n,a,i,o,s){return(a-o)*(t-s)-(e-o)*(i-s)>=0&&(e-o)*(n-s)-(r-o)*(t-s)>=0&&(r-o)*(i-s)-(a-o)*(n-s)>=0}function pR(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!gR(e,t)&&Ao(e,t)&&Ao(t,e)&&mR(e,t)}function Xt(e,t,r){return(t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y)}function la(e,t){return e.x===t.x&&e.y===t.y}function Fx(e,t,r,n){return la(e,t)&&la(r,n)||la(e,n)&&la(r,t)?!0:Xt(e,t,r)>0!=Xt(e,t,n)>0&&Xt(r,n,e)>0!=Xt(r,n,t)>0}function gR(e,t){var r=e;do{if(r.i!==e.i&&r.next.i!==e.i&&r.i!==t.i&&r.next.i!==t.i&&Fx(r,r.next,e,t))return!0;r=r.next}while(r!==e);return!1}function Ao(e,t){return Xt(e.prev,e,e.next)<0?Xt(e,t,e.next)>=0&&Xt(e,e.prev,t)>=0:Xt(e,t,e.prev)<0||Xt(e,e.next,t)<0}function mR(e,t){var r=e,n=!1,a=(e.x+t.x)/2,i=(e.y+t.y)/2;do r.y>i!=r.next.y>i&&r.next.y!==r.y&&a<(r.next.x-r.x)*(i-r.y)/(r.next.y-r.y)+r.x&&(n=!n),r=r.next;while(r!==e);return n}function zx(e,t){var r=new Uh(e.i,e.x,e.y),n=new Uh(t.i,t.x,t.y),a=e.next,i=t.prev;return e.next=t,t.prev=e,r.next=a,a.prev=r,n.next=r,r.prev=n,i.next=n,n.prev=i,n}function N1(e,t,r,n){var a=new Uh(e,t,r);return n?(a.next=n.next,a.prev=n,n.next.prev=a,n.next=a):(a.prev=a,a.next=a),a}function Eo(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function Uh(e,t,r){this.i=e,this.x=t,this.y=r,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}Ox.deviation=function(e,t,r,n){var a=t&&t.length,i=a?t[0]*r:e.length,o=Math.abs(kh(e,0,i,r));if(a)for(var s=0,l=t.length;s<l;s++){var u=t[s]*r,c=s<l-1?t[s+1]*r:e.length;o-=Math.abs(kh(e,u,c,r))}var h=0;for(s=0;s<n.length;s+=3){var f=n[s]*r,d=n[s+1]*r,v=n[s+2]*r;h+=Math.abs((e[f]-e[v])*(e[d+1]-e[f+1])-(e[f]-e[d])*(e[v+1]-e[f+1]))}return o===0&&h===0?0:Math.abs((h-o)/o)};function kh(e,t,r,n){for(var a=0,i=t,o=r-n;i<r;i+=n)a+=(e[o]-e[i])*(e[i+1]+e[o+1]),o=i;return a}function Oc(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function Gx(e,t,r,n,a){var i=r,o=e[t];Oc(e,t,n);for(var s=r;s<n;s++)a(e[s],o)<0&&(Oc(e,s,i),i++);return Oc(e,n,i),i}function vl(e,t,r,n){if(r<n){var a=Math.floor((r+n)/2),i=Gx(e,a,r,n,t);vl(e,t,r,i-1),vl(e,t,i+1,n)}}function ii(){this._parts=[]}ii.prototype.step=function(e,t,r){var n=e.length;if(r===0){this._parts=[],this._sorted=!1;var a=Math.floor(n/2);this._parts.push({pivot:a,left:0,right:n-1}),this._currentSortPartIdx=0}if(!this._sorted){var i=this._parts;if(i.length===0)return this._sorted=!0,!0;if(i.length<512){for(var o=0;o<i.length;o++)i[o].pivot=Gx(e,i[o].pivot,i[o].left,i[o].right,t);for(var s=[],o=0;o<i.length;o++){var l=i[o].left,u=i[o].pivot-1;u>l&&s.push({pivot:Math.floor((u+l)/2),left:l,right:u});var l=i[o].pivot+1,u=i[o].right;u>l&&s.push({pivot:Math.floor((u+l)/2),left:l,right:u})}i=this._parts=s}else for(var o=0;o<Math.floor(i.length/10);o++){var c=i.length-1-this._currentSortPartIdx;if(vl(e,t,i[c].left,i[c].right),this._currentSortPartIdx++,this._currentSortPartIdx===i.length)return this._sorted=!0,!0}return!1}};ii.sort=vl;var Za=lt.vec3,O1=Za.create(),B1=Za.create(),F1=Za.create();const md={needsSortTriangles:function(){return this.indices&&this.sortTriangles},needsSortTrianglesProgressively:function(){return this.needsSortTriangles()&&this.triangleCount>=2e4},doSortTriangles:function(e,t){var r=this.indices;if(t===0){var n=this.attributes.position,e=e.array;(!this._triangleZList||this._triangleZList.length!==this.triangleCount)&&(this._triangleZList=new Float32Array(this.triangleCount),this._sortedTriangleIndices=new Uint32Array(this.triangleCount),this._indicesTmp=new r.constructor(r.length),this._triangleZListTmp=new Float32Array(this.triangleCount));for(var a=0,i,o=0;o<r.length;){n.get(r[o++],O1),n.get(r[o++],B1),n.get(r[o++],F1);var s=Za.sqrDist(O1,e),l=Za.sqrDist(B1,e),u=Za.sqrDist(F1,e),c=Math.min(s,l);c=Math.min(c,u),o===3?(i=c,c=0):c=c-i,this._triangleZList[a++]=c}}for(var h=this._sortedTriangleIndices,o=0;o<h.length;o++)h[o]=o;if(this.triangleCount<2e4)t===0&&this._simpleSort(!0);else for(var o=0;o<3;o++)this._progressiveQuickSort(t*3+o);for(var f=this._indicesTmp,d=this._triangleZListTmp,v=this._triangleZList,o=0;o<this.triangleCount;o++){var p=h[o]*3,g=o*3;f[g++]=r[p++],f[g++]=r[p++],f[g]=r[p],d[o]=v[h[o]]}var m=this._indicesTmp;this._indicesTmp=this.indices,this.indices=m;var m=this._triangleZListTmp;this._triangleZListTmp=this._triangleZList,this._triangleZList=m,this.dirtyIndices()},_simpleSort:function(e){var t=this._triangleZList,r=this._sortedTriangleIndices;function n(a,i){return t[i]-t[a]}e?Array.prototype.sort.call(r,n):ii.sort(r,n,0,r.length-1)},_progressiveQuickSort:function(e){var t=this._triangleZList,r=this._sortedTriangleIndices;this._quickSort=this._quickSort||new ii,this._quickSort.step(r,function(n,a){return t[a]-t[n]},e)}};function yR(e){const t=e.getVisual("style");if(t){const r=e.getVisual("drawType");return t[r]}}function _R(e){return e.getVisual("style").opacity}function Ct(e,t){const r=e.getItemVisual(t,"style");if(r){const n=e.getVisual("drawType");return r[n]}}function At(e,t){const r=e.getItemVisual(t,"style");return r&&r.opacity}var Vx=1,Ux=2;function fn(e,t,r){this._labelsMesh=new fd,this._labelTextureSurface=new hl({width:512,height:512,devicePixelRatio:r.getDevicePixelRatio(),onupdate:function(){r.getZr().refresh()}}),this._api=r,this._labelsMesh.material.set("textureAtlas",this._labelTextureSurface.getTexture())}fn.prototype.getLabelPosition=function(e,t,r){return[0,0,0]};fn.prototype.getLabelDistance=function(e,t,r){return 0};fn.prototype.getMesh=function(){return this._labelsMesh};fn.prototype.updateData=function(e,t,r){t==null&&(t=0),r==null&&(r=e.count()),(!this._labelsVisibilitiesBits||this._labelsVisibilitiesBits.length!==r-t)&&(this._labelsVisibilitiesBits=new Uint8Array(r-t));for(var n=["label","show"],a=["emphasis","label","show"],i=t;i<r;i++){var o=e.getItemModel(i),s=o.get(n),l=o.get(a);l==null&&(l=s);var u=(s?Vx:0)|(l?Ux:0);this._labelsVisibilitiesBits[i-t]=u}this._start=t,this._end=r,this._data=e};fn.prototype.updateLabels=function(e){if(this._data){e=e||[];for(var t=e.length>0,r={},n=0;n<e.length;n++)r[e[n]]=!0;this._labelsMesh.geometry.convertToDynamicArray(!0),this._labelTextureSurface.clear();for(var a=["label"],i=["emphasis","label"],o=this._data.hostModel,s=this._data,l=o.getModel(a),u=o.getModel(i,l),c={left:"right",right:"left",top:"center",bottom:"center"},h={left:"middle",right:"middle",top:"bottom",bottom:"top"},f=this._start;f<this._end;f++){var d=!1;t&&r[f]&&(d=!0);var v=this._labelsVisibilitiesBits[f-this._start]&(d?Ux:Vx);if(v){var p=s.getItemModel(f),g=p.getModel(d?i:a,d?u:l),m=g.get("distance")||0,_=g.get("position"),y=this._api.getDevicePixelRatio(),x=o.getFormattedLabel(f,d?"emphasis":"normal");if(x==null||x==="")return;var S=new rt({style:ft(g,{text:x,fill:g.get("color")||Ct(s,f)||"#000",align:"left",verticalAlign:"top",opacity:Se.firstNotNull(g.get("opacity"),At(s,f),1)})}),T=S.getBoundingRect(),b=1.2;T.height*=b;var w=this._labelTextureSurface.add(S),A=c[_]||"center",E=h[_]||"bottom";this._labelsMesh.geometry.addSprite(this.getLabelPosition(f,_,m),[T.width*y,T.height*y],w,A,E,this.getLabelDistance(f,_,m)*y)}}this._labelsMesh.material.set("uvScale",this._labelTextureSurface.getCoordsScale()),this._labelTextureSurface.getZr().refreshImmediately(),this._labelsMesh.geometry.convertToTypedArray(),this._labelsMesh.geometry.dirty()}};fn.prototype.dispose=function(){this._labelTextureSurface.dispose()};var Jt=lt.vec3;D.Shader.import(eu);function oi(e){this.rootNode=new D.Node,this._triangulationResults={},this._shadersMap=D.COMMON_SHADERS.filter(function(r){return r!=="shadow"}).reduce(function(r,n){return r[n]=D.createShader("ecgl."+n),r},{}),this._linesShader=D.createShader("ecgl.meshLines3D");var t={};D.COMMON_SHADERS.forEach(function(r){t[r]=new D.Material({shader:D.createShader("ecgl."+r)})}),this._groundMaterials=t,this._groundMesh=new D.Mesh({geometry:new D.PlaneGeometry({dynamic:!0}),castShadow:!1,renderNormal:!0,$ignorePicking:!0}),this._groundMesh.rotation.rotateX(-Math.PI/2),this._labelsBuilder=new fn(512,512,e),this._labelsBuilder.getMesh().renderOrder=100,this._labelsBuilder.getMesh().material.depthTest=!1,this.rootNode.add(this._labelsBuilder.getMesh()),this._initMeshes(),this._api=e}oi.prototype={constructor:oi,extrudeY:!0,update:function(e,t,r,n,a){var i=e.getData();n==null&&(n=0),a==null&&(a=i.count()),this._startIndex=n,this._endIndex=a-1,this._triangulation(e,n,a);var o=this._getShader(e.get("shading"));this._prepareMesh(e,o,r,n,a),this.rootNode.updateWorldTransform(),this._updateRegionMesh(e,r,n,a);var s=e.coordinateSystem;s.type==="geo3D"&&this._updateGroundPlane(e,s,r);var l=this;this._labelsBuilder.updateData(i,n,a),this._labelsBuilder.getLabelPosition=function(u,c,h){var f=i.getName(u),d,v=h;if(s.type==="geo3D"){var p=s.getRegion(f);if(!p)return[NaN,NaN,NaN];d=p.getCenter();var g=s.dataToPoint([d[0],d[1],v]);return g}else var m=l._triangulationResults[u-l._startIndex],d=l.extrudeY?[(m.max[0]+m.min[0])/2,m.max[1]+v,(m.max[2]+m.min[2])/2]:[(m.max[0]+m.min[0])/2,(m.max[1]+m.min[1])/2,m.max[2]+v]},this._data=i,this._labelsBuilder.updateLabels(),this._updateDebugWireframe(e),this._lastHoverDataIndex=0},_initMeshes:function(){var e=this;function t(){var a=new D.Mesh({name:"Polygon",material:new D.Material({shader:e._shadersMap.lambert}),geometry:new D.Geometry({sortTriangles:!0,dynamic:!0}),culling:!1,ignorePicking:!0,renderNormal:!0});return Object.assign(a.geometry,md),a}var r=t(),n=new D.Mesh({material:new D.Material({shader:this._linesShader}),castShadow:!1,ignorePicking:!0,$ignorePicking:!0,geometry:new Sa({useNativeLine:!1})});this.rootNode.add(r),this.rootNode.add(n),r.material.define("both","VERTEX_COLOR"),r.material.define("fragment","DOUBLE_SIDED"),this._polygonMesh=r,this._linesMesh=n,this.rootNode.add(this._groundMesh)},_getShader:function(e){var t=this._shadersMap[e];return t||(t=this._shadersMap.lambert),t.__shading=e,t},_prepareMesh:function(e,t,r,n,a){for(var i=0,o=0,s=0,l=0,u=n;u<a;u++){var c=this._getRegionPolygonInfo(u),h=this._getRegionLinesInfo(u,e,this._linesMesh.geometry);i+=c.vertexCount,o+=c.triangleCount,s+=h.vertexCount,l+=h.triangleCount}var f=this._polygonMesh,d=f.geometry;["position","normal","texcoord0","color"].forEach(function(v){d.attributes[v].init(i)}),d.indices=i>65535?new Uint32Array(o*3):new Uint16Array(o*3),f.material.shader!==t&&f.material.attachShader(t,!0),D.setMaterialFromModel(t.__shading,f.material,e,r),s>0&&(this._linesMesh.geometry.resetOffset(),this._linesMesh.geometry.setVertexCount(s),this._linesMesh.geometry.setTriangleCount(l)),this._dataIndexOfVertex=new Uint32Array(i),this._vertexRangeOfDataIndex=new Uint32Array((a-n)*2)},_updateRegionMesh:function(e,t,r,n){for(var a=e.getData(),i=0,o=0,s=!1,T=this._polygonMesh,l=this._linesMesh,u=r;u<n;u++){var c=e.getRegionModel(u),h=c.getModel("itemStyle"),f=Se.firstNotNull(Ct(a,u),h.get("color"),"#fff"),d=Se.firstNotNull(At(a,u),h.get("opacity"),1),v=D.parseColor(f),p=D.parseColor(h.get("borderColor"));v[3]*=d,p[3]*=d;var g=v[3]<.99;T.material.set("color",[1,1,1,1]),s=s||g;for(var m=Se.firstNotNull(c.get("height",!0),e.get("regionHeight")),_=this._updatePolygonGeometry(e,T.geometry,u,m,i,o,v),y=i;y<_.vertexOffset;y++)this._dataIndexOfVertex[y]=u;this._vertexRangeOfDataIndex[(u-r)*2]=i,this._vertexRangeOfDataIndex[(u-r)*2+1]=_.vertexOffset,i=_.vertexOffset,o=_.triangleOffset;var x=h.get("borderWidth"),S=x>0;S&&(x*=t.getDevicePixelRatio(),this._updateLinesGeometry(l.geometry,e,u,m,x,e.coordinateSystem.transform)),l.invisible=!S,l.material.set({color:p})}var T=this._polygonMesh;T.material.transparent=s,T.material.depthMask=!s,T.geometry.updateBoundingBox(),T.frontFace=this.extrudeY?D.Mesh.CCW:D.Mesh.CW,T.material.get("normalMap")&&T.geometry.generateTangents(),T.seriesIndex=e.seriesIndex,T.on("mousemove",this._onmousemove,this),T.on("mouseout",this._onmouseout,this)},_updateDebugWireframe:function(e){var t=e.getModel("debug.wireframe");if(t.get("show")){var r=D.parseColor(t.get("lineStyle.color")||"rgba(0,0,0,0.5)"),n=Se.firstNotNull(t.get("lineStyle.width"),1),a=this._polygonMesh;a.geometry.generateBarycentric(),a.material.define("both","WIREFRAME_TRIANGLE"),a.material.set("wireframeLineColor",r),a.material.set("wireframeLineWidth",n)}},_onmousemove:function(e){var t=this._dataIndexOfVertex[e.triangle[0]];t==null&&(t=-1),t!==this._lastHoverDataIndex&&(this.downplay(this._lastHoverDataIndex),this.highlight(t),this._labelsBuilder.updateLabels([t])),this._lastHoverDataIndex=t,this._polygonMesh.dataIndex=t},_onmouseout:function(e){e.target&&(this.downplay(this._lastHoverDataIndex),this._lastHoverDataIndex=-1,this._polygonMesh.dataIndex=-1),this._labelsBuilder.updateLabels([])},_updateGroundPlane:function(e,t,r){var n=e.getModel("groundPlane",e);if(this._groundMesh.invisible=!n.get("show",!0),!this._groundMesh.invisible){var a=e.get("shading"),i=this._groundMaterials[a];i||(i=this._groundMaterials.lambert),D.setMaterialFromModel(a,i,n,r),i.get("normalMap")&&this._groundMesh.geometry.generateTangents(),this._groundMesh.material=i,this._groundMesh.material.set("color",D.parseColor(n.get("color"))),this._groundMesh.scale.set(t.size[0],t.size[2],1)}},_triangulation:function(e,t,r){this._triangulationResults=[];for(var n=[1/0,1/0,1/0],a=[-1/0,-1/0,-1/0],i=e.coordinateSystem,o=t;o<r;o++){for(var s=[],l=e.getRegionPolygonCoords(o),u=0;u<l.length;u++){var c=l[u].exterior,h=l[u].interiors,f=[],d=[];if(!(c.length<3)){for(var v=0,p=0;p<c.length;p++){var g=c[p];f[v++]=g[0],f[v++]=g[1]}for(var p=0;p<h.length;p++)if(!(h[p].length<3)){for(var m=f.length/2,_=0;_<h[p].length;_++){var g=h[p][_];f.push(g[0]),f.push(g[1])}d.push(m)}for(var y=Ox(f,d),x=new Float64Array(f.length/2*3),S=[],T=[1/0,1/0,1/0],b=[-1/0,-1/0,-1/0],w=0,p=0;p<f.length;)Jt.set(S,f[p++],0,f[p++]),i&&i.transform&&Jt.transformMat4(S,S,i.transform),Jt.min(T,T,S),Jt.max(b,b,S),x[w++]=S[0],x[w++]=S[1],x[w++]=S[2];Jt.min(n,n,T),Jt.max(a,a,b),s.push({points:x,indices:y,min:T,max:b})}}this._triangulationResults.push(s)}this._geoBoundingBox=[n,a]},_getRegionPolygonInfo:function(e){for(var t=this._triangulationResults[e-this._startIndex],r=0,n=0,a=0;a<t.length;a++)r+=t[a].points.length/3,n+=t[a].indices.length/3;var i=r*2+r*4,o=n*2+r*2;return{vertexCount:i,triangleCount:o}},_updatePolygonGeometry:function(e,t,r,n,a,i,o){var s=e.get("projectUVOnGround"),l=t.attributes.position,u=t.attributes.normal,c=t.attributes.texcoord0,h=t.attributes.color,f=this._triangulationResults[r-this._startIndex],d=h.value&&o,v=t.indices,p=this.extrudeY?1:2,g=this.extrudeY?2:1,m=[this.rootNode.worldTransform.x.len(),this.rootNode.worldTransform.y.len(),this.rootNode.worldTransform.z.len()],_=Jt.mul([],this._geoBoundingBox[0],m),y=Jt.mul([],this._geoBoundingBox[1],m),x=Math.max(y[0]-_[0],y[2]-_[2]);function S(j,pe,de){for(var ge=j.points,nt=ge.length,De=[],Re=[],Be=0;Be<nt;Be+=3)De[0]=ge[Be],De[p]=pe,De[g]=ge[Be+2],Re[0]=(ge[Be]*m[0]-_[0])/x,Re[1]=(ge[Be+2]*m[g]-_[2])/x,l.set(a,De),d&&h.set(a,o),c.set(a++,Re)}function T(j,pe,de){var ge=a;S(j,pe);for(var nt=j.indices.length,De=0;De<nt;De++)v[i*3+De]=j.indices[De]+ge;i+=j.indices.length/3}for(var b=this.extrudeY?[0,1,0]:[0,0,1],w=Jt.negate([],b),A=0;A<f.length;A++){var E=a,C=f[A];T(C,0),T(C,n);for(var M=C.points.length/3,P=0;P<M;P++)u.set(E+P,w),u.set(E+P+M,b);for(var L=[0,3,1,1,3,2],I=[[],[],[],[]],N=[],F=[],B=[],k=[],z=0,P=0;P<M;P++){for(var W=(P+1)%M,J=(C.points[W*3]-C.points[P*3])*m[0],re=(C.points[W*3+2]-C.points[P*3+2])*m[g],Q=Math.sqrt(J*J+re*re),q=0;q<4;q++){var Ee=q===0||q===3,ae=(Ee?P:W)*3;I[q][0]=C.points[ae],I[q][p]=q>1?n:0,I[q][g]=C.points[ae+2],l.set(a+q,I[q]),s?(k[0]=(C.points[ae]*m[0]-_[0])/x,k[1]=(C.points[ae+2]*m[g]-_[g])/x):(k[0]=(Ee?z:z+Q)/x,k[1]=(I[q][p]*m[p]-_[p])/x),c.set(a+q,k)}Jt.sub(N,I[1],I[0]),Jt.sub(F,I[3],I[0]),Jt.cross(B,N,F),Jt.normalize(B,B);for(var q=0;q<4;q++)u.set(a+q,B),d&&h.set(a+q,o);for(var q=0;q<6;q++)v[i*3+q]=L[q]+a;a+=4,i+=2,z+=Q}}return t.dirty(),{vertexOffset:a,triangleOffset:i}},_getRegionLinesInfo:function(e,t,r){var n=0,a=0,i=t.getRegionModel(e),o=i.getModel("itemStyle"),s=o.get("borderWidth");if(s>0){var l=t.getRegionPolygonCoords(e);l.forEach(function(u){var c=u.exterior,h=u.interiors;n+=r.getPolylineVertexCount(c),a+=r.getPolylineTriangleCount(c);for(var f=0;f<h.length;f++)n+=r.getPolylineVertexCount(h[f]),a+=r.getPolylineTriangleCount(h[f])},this)}return{vertexCount:n,triangleCount:a}},_updateLinesGeometry:function(e,t,r,n,a,i){function o(u){for(var c=new Float64Array(u.length*3),h=0,f=[],d=0;d<u.length;d++)f[0]=u[d][0],f[1]=n+.1,f[2]=u[d][1],i&&Jt.transformMat4(f,f,i),c[h++]=f[0],c[h++]=f[1],c[h++]=f[2];return c}var s=[1,1,1,1],l=t.getRegionPolygonCoords(r);l.forEach(function(u){var c=u.exterior,h=u.interiors;e.addPolyline(o(c),s,a);for(var f=0;f<h.length;f++)e.addPolyline(o(h[f]),s,a)})},highlight:function(e){var t=this._data;if(t){var r=t.getItemModel(e),n=r.getModel(["emphasis","itemStyle"]),a=n.get("color"),i=Se.firstNotNull(n.get("opacity"),At(t,e),1);if(a==null){var o=Ct(t,e);a=Fl(o,-.4)}i==null&&(i=At(t,e));var s=D.parseColor(a);s[3]*=i,this._setColorOfDataIndex(t,e,s)}},downplay:function(e){var t=this._data;if(t){var r=t.getItemModel(e),n=Se.firstNotNull(Ct(t,e),r.get(["itemStyle","color"]),"#fff"),a=Se.firstNotNull(At(t,e),r.get(["itemStyle","opacity"]),1),i=D.parseColor(n);i[3]*=a,this._setColorOfDataIndex(t,e,i)}},dispose:function(){this._labelsBuilder.dispose()},_setColorOfDataIndex:function(e,t,r){if(!(t<this._startIndex&&t>this._endIndex)){t-=this._startIndex;for(var n=this._vertexRangeOfDataIndex[t*2];n<this._vertexRangeOfDataIndex[t*2+1];n++)this._polygonMesh.geometry.attributes.color.set(n,r);this._polygonMesh.geometry.dirty(),this._api.getZr().refresh()}}};const xR=kt.extend({type:"geo3D",__ecgl__:!0,init:function(e,t){this._geo3DBuilder=new oi(t),this.groupGL=new D.Node,this._lightRoot=new D.Node,this._sceneHelper=new Rn(this._lightRoot),this._sceneHelper.initLight(this._lightRoot),this._control=new Jl({zr:t.getZr()}),this._control.init()},render:function(e,t,r){this.groupGL.add(this._geo3DBuilder.rootNode);var n=e.coordinateSystem;if(!(!n||!n.viewGL)){n.viewGL.add(this._lightRoot),e.get("show")?n.viewGL.add(this.groupGL):n.viewGL.remove(this.groupGL);var a=this._control;a.setViewGL(n.viewGL);var i=e.getModel("viewControl");a.setFromViewControlModel(i,0),this._sceneHelper.setScene(n.viewGL.scene),this._sceneHelper.updateLight(e),n.viewGL.setPostEffect(e.getModel("postEffect"),r),n.viewGL.setTemporalSuperSampling(e.getModel("temporalSuperSampling")),this._geo3DBuilder.update(e,t,r,0,e.getData().count());var o=n.viewGL.isLinearSpace()?"define":"undefine";this._geo3DBuilder.rootNode.traverse(function(s){s.material&&s.material[o]("fragment","SRGB_DECODE")}),a.off("update"),a.on("update",function(){r.dispatchAction({type:"geo3DChangeCamera",alpha:a.getAlpha(),beta:a.getBeta(),distance:a.getDistance(),center:a.getCenter(),from:this.uid,geo3DId:e.id})}),a.update()}},afterRender:function(e,t,r,n){var a=n.renderer;this._sceneHelper.updateAmbientCubemap(a,e,r),this._sceneHelper.updateSkybox(a,e,r)},dispose:function(){this._control.dispose(),this._geo3DBuilder.dispose()}});var SR={Russia:[100,60],"United States":[-99,38],"United States of America":[-99,38]};function TR(e,t){if(e==="world"){var r=SR[t.name];if(r){var n=[r[0],r[1]];t.setCenter(n)}}}var bR=lt.vec3,$a=lt.mat4,wR=[N3,TR];function pl(e,t,r,n,a){this.name=e,this.map=t,this.regionHeight=0,this.regions=[],this._nameCoordMap={},this.loadGeoJson(r,n,a),this.transform=$a.identity(new Float64Array(16)),this.invTransform=$a.identity(new Float64Array(16)),this.extrudeY=!0,this.altitudeAxis}pl.prototype={constructor:pl,type:"geo3D",dimensions:["lng","lat","alt"],containPoint:function(){},loadGeoJson:function(e,t,r){var n=hv||hv;try{this.regions=e?n(e):[]}catch(u){throw`Invalid geoJson format
`+u}t=t||{},r=r||{};for(var a=this.regions,i={},o=0;o<a.length;o++){var s=a[o].name;s=r[s]||s,a[o].name=s,i[s]=a[o],this.addGeoCoord(s,a[o].getCenter());var l=t[s];l&&a[o].transformTo(l.left,l.top,l.width,l.height)}this._regionsMap=i,this._geoRect=null,wR.forEach(function(u){u(this)},this)},getGeoBoundingRect:function(){if(this._geoRect)return this._geoRect;for(var e,t=this.regions,r=0;r<t.length;r++){var n=t[r].getBoundingRect();e=e||n.clone(),e.union(n)}return this._geoRect=e||new Yt(0,0,0,0)},addGeoCoord:function(e,t){this._nameCoordMap[e]=t},getRegion:function(e){return this._regionsMap[e]},getRegionByCoord:function(e){for(var t=this.regions,r=0;r<t.length;r++)if(t[r].contain(e))return t[r]},setSize:function(e,t,r){this.size=[e,t,r];var n=this.getGeoBoundingRect(),a=e/n.width,i=-r/n.height,o=-e/2-n.x*a,s=r/2-n.y*i,l=this.extrudeY?[o,0,s]:[o,s,0],u=this.extrudeY?[a,1,i]:[a,i,1],c=this.transform;$a.identity(c),$a.translate(c,c,l),$a.scale(c,c,u),$a.invert(this.invTransform,c)},dataToPoint:function(e,t){t=t||[];var r=this.extrudeY?1:2,n=this.extrudeY?2:1,a=e[2];return isNaN(a)&&(a=0),t[0]=e[0],t[n]=e[1],this.altitudeAxis?t[r]=this.altitudeAxis.dataToCoord(a):t[r]=0,t[r]+=this.regionHeight,bR.transformMat4(t,t,this.transform),t},pointToData:function(e,t){}};function AR(e,t){var r=e.getBoxLayoutParams(),n=sr(r,{width:t.getWidth(),height:t.getHeight()});n.y=t.getHeight()-n.y-n.height,this.viewGL.setViewport(n.x,n.y,n.width,n.height,t.getDevicePixelRatio());var a=this.getGeoBoundingRect(),i=a.width/a.height*(e.get("aspectScale")||.75),o=e.get("boxWidth"),s=e.get("boxDepth"),l=e.get("boxHeight");l==null&&(l=5),isNaN(o)&&isNaN(s)&&(o=100),isNaN(s)?s=o/i:isNaN(o)&&(o=s/i),this.setSize(o,l,s),this.regionHeight=e.get("regionHeight"),this.altitudeAxis&&this.altitudeAxis.setExtent(0,Math.max(l-this.regionHeight,0))}function ER(e,t){var r=[1/0,-1/0];if(e.eachSeries(function(a){if(a.coordinateSystem===this&&a.type!=="series.map3D"){var i=a.getData(),o=a.coordDimToDataDim("alt"),s=o&&o[0];if(s){var l=i.getDataExtent(s,!0);r[0]=Math.min(r[0],l[0]),r[1]=Math.max(r[1],l[1])}}},this),r&&isFinite(r[1]-r[0])){var n=mf(r,{type:"value",min:"dataMin",max:"dataMax"});this.altitudeAxis=new or("altitude",n),this.resize(this.model,t)}}var z1=0,kx={dimensions:pl.prototype.dimensions,create:function(e,t){var r=[];if(!ah)throw new Error("geo3D component depends on geo component");function n(a,i){var o=kx.createGeo3D(a);a.__viewGL=a.__viewGL||new Oe,o.viewGL=a.__viewGL,a.coordinateSystem=o,o.model=a,r.push(o),o.resize=AR,o.resize(a,t),o.update=ER}return e.eachComponent("geo3D",function(a,i){n(a)}),e.eachSeriesByType("map3D",function(a,i){var o=a.get("coordinateSystem");o==null&&(o="geo3D"),o==="geo3D"&&n(a)}),e.eachSeries(function(a){if(a.get("coordinateSystem")==="geo3D"){if(a.type==="series.map3D")return;var i=a.getReferringComponents("geo3D").models[0];if(i||(i=e.getComponent("geo3D")),!i)throw new Error('geo "'+Se.firstNotNull(a.get("geo3DIndex"),a.get("geo3DId"),0)+'" not found');a.coordinateSystem=i.coordinateSystem}}),r},createGeo3D:function(e){var t=e.get("map"),r;return typeof t=="string"?(r=t,t=ah(t)):t&&t.features&&(t={geoJson:t}),r==null&&(r="GEO_ANONYMOUS_"+z1++),new pl(r+z1++,r,t&&t.geoJson,t&&t.specialAreas,e.get("nameMap"))}};const Hx=kx;function Wx(e){e.registerComponentModel(nR),e.registerComponentView(xR),e.registerAction({type:"geo3DChangeCamera",event:"geo3dcamerachanged",update:"series:updateCamera"},function(t,r){r.eachComponent({mainType:"geo3D",query:t},function(n){n.setView(t)})}),e.registerCoordinateSystem("geo3D",Hx)}oe(Wx);function G1(e,t){e.id=e.id||e.name||t+""}var ga=Ot.extend({type:"globe",layoutMode:"box",coordinateSystem:null,init:function(){ga.superApply(this,"init",arguments),R(this.option.layers,function(e,t){fe(e,this.defaultLayerOption),G1(e,t)},this)},mergeOption:function(e){var t=this.option.layers;this.option.layers=null,ga.superApply(this,"mergeOption",arguments);function r(o){return Sm(o,function(s,l,u){return G1(l,u),s[l.id]=l,s},{})}if(t&&t.length){var n=r(e.layers),a=r(t);for(var i in n)a[i]?fe(a[i],n[i],!0):t.push(e.layers[i]);this.option.layers=t}R(this.option.layers,function(o){fe(o,this.defaultLayerOption)},this)},optionUpdated:function(){this.updateDisplacementHash()},defaultLayerOption:{show:!0,type:"overlay"},defaultOption:{show:!0,zlevel:-10,left:0,top:0,width:"100%",height:"100%",environment:"auto",baseColor:"#fff",baseTexture:"",heightTexture:"",displacementTexture:"",displacementScale:0,displacementQuality:"medium",globeRadius:100,globeOuterRadius:150,shading:"lambert",light:{main:{time:""}},atmosphere:{show:!1,offset:5,color:"#ffffff",glowPower:6,innerGlowPower:2},viewControl:{autoRotate:!0,panSensitivity:0,targetCoord:null},layers:[]},setDisplacementData:function(e,t,r){this.displacementData=e,this.displacementWidth=t,this.displacementHeight=r},getDisplacementTexture:function(){return this.get("displacementTexture")||this.get("heightTexture")},getDisplacemenScale:function(){var e=this.getDisplacementTexture(),t=this.get("displacementScale");return(!e||e==="none")&&(t=0),t},hasDisplacement:function(){return this.getDisplacemenScale()>0},_displacementChanged:!0,_displacementScale:0,updateDisplacementHash:function(){var e=this.getDisplacementTexture(),t=this.getDisplacemenScale();this._displacementChanged=this._displacementTexture!==e||this._displacementScale!==t,this._displacementTexture=e,this._displacementScale=t},isDisplacementChanged:function(){return this._displacementChanged}});fe(ga.prototype,ql);fe(ga.prototype,fi);fe(ga.prototype,di);fe(ga.prototype,pi);const CR=ga;var $x=Math.PI,Tr=Math.sin,nn=Math.cos,Xx=Math.tan,jx=Math.asin,Zx=Math.atan2,ma=$x/180,LR=1e3*60*60*24,DR=2440588,MR=2451545;function PR(e){return e.valueOf()/LR-.5+DR}function IR(e){return PR(e)-MR}var gl=ma*23.4397;function RR(e,t){return Zx(Tr(e)*nn(gl)-Xx(t)*Tr(gl),nn(e))}function NR(e,t){return jx(Tr(t)*nn(gl)+nn(t)*Tr(gl)*Tr(e))}function OR(e,t,r){return Zx(Tr(e),nn(e)*Tr(t)-Xx(r)*nn(t))}function BR(e,t,r){return jx(Tr(t)*Tr(r)+nn(t)*nn(r)*nn(e))}function FR(e,t){return ma*(280.16+360.9856235*e)-t}function zR(e){return ma*(357.5291+.98560028*e)}function GR(e){var t=ma*(1.9148*Tr(e)+.02*Tr(2*e)+3e-4*Tr(3*e)),r=ma*102.9372;return e+t+r+$x}function VR(e){var t=zR(e),r=GR(t);return{dec:NR(r,0),ra:RR(r,0)}}var Yx={};Yx.getPosition=function(e,t,r){var n=ma*-r,a=ma*t,i=IR(e),o=VR(i),s=FR(i,n)-o.ra;return{azimuth:OR(s,a,o.dec),altitude:BR(s,a,o.dec)}};const UR=Yx,kR=`@export ecgl.atmosphere.vertex
attribute vec3 position: POSITION;
attribute vec3 normal : NORMAL;
uniform mat4 worldViewProjection : WORLDVIEWPROJECTION;
uniform mat4 normalMatrix : WORLDINVERSETRANSPOSE;

varying vec3 v_Normal;

void main() {
 v_Normal = normalize((normalMatrix * vec4(normal, 0.0)).xyz);
 gl_Position = worldViewProjection * vec4(position, 1.0);
}
@end


@export ecgl.atmosphere.fragment
uniform mat4 viewTranspose: VIEWTRANSPOSE;
uniform float glowPower;
uniform vec3 glowColor;

varying vec3 v_Normal;

void main() {
 float intensity = pow(1.0 - dot(v_Normal, (viewTranspose * vec4(0.0, 0.0, 1.0, 0.0)).xyz), glowPower);
 gl_FragColor = vec4(glowColor, intensity * intensity);
}
@end`;D.Shader.import(lx);D.Shader.import(kR);const HR=kt.extend({type:"globe",__ecgl__:!0,_displacementScale:0,init:function(e,t){this.groupGL=new D.Node,this._sphereGeometry=new D.SphereGeometry({widthSegments:200,heightSegments:100,dynamic:!0}),this._overlayGeometry=new D.SphereGeometry({widthSegments:80,heightSegments:40}),this._planeGeometry=new D.PlaneGeometry,this._earthMesh=new D.Mesh({renderNormal:!0}),this._atmosphereMesh=new D.Mesh,this._atmosphereGeometry=new D.SphereGeometry({widthSegments:80,heightSegments:40}),this._atmosphereMaterial=new D.Material({shader:new D.Shader(D.Shader.source("ecgl.atmosphere.vertex"),D.Shader.source("ecgl.atmosphere.fragment")),transparent:!0}),this._atmosphereMesh.geometry=this._atmosphereGeometry,this._atmosphereMesh.material=this._atmosphereMaterial,this._atmosphereMesh.frontFace=D.Mesh.CW,this._lightRoot=new D.Node,this._sceneHelper=new Rn,this._sceneHelper.initLight(this._lightRoot),this.groupGL.add(this._atmosphereMesh),this.groupGL.add(this._earthMesh),this._control=new Jl({zr:t.getZr()}),this._control.init(),this._layerMeshes={}},render:function(e,t,r){var n=e.coordinateSystem,a=e.get("shading");n.viewGL.add(this._lightRoot),e.get("show")?n.viewGL.add(this.groupGL):n.viewGL.remove(this.groupGL),this._sceneHelper.setScene(n.viewGL.scene),n.viewGL.setPostEffect(e.getModel("postEffect"),r),n.viewGL.setTemporalSuperSampling(e.getModel("temporalSuperSampling"));var i=this._earthMesh;i.geometry=this._sphereGeometry;var o="ecgl."+a;(!i.material||i.material.shader.name!==o)&&(i.material=D.createMaterial(o)),D.setMaterialFromModel(a,i.material,e,r),["roughnessMap","metalnessMap","detailMap","normalMap"].forEach(function(h){var f=i.material.get(h);f&&(f.flipY=!1)}),i.material.set("color",D.parseColor(e.get("baseColor")));var s=n.radius*.99;if(i.scale.set(s,s,s),e.get("atmosphere.show")){i.material.define("both","ATMOSPHERE_ENABLED"),this._atmosphereMesh.invisible=!1,this._atmosphereMaterial.setUniforms({glowPower:e.get("atmosphere.glowPower")||6,glowColor:e.get("atmosphere.color")||"#ffffff"}),i.material.setUniforms({glowPower:e.get("atmosphere.innerGlowPower")||2,glowColor:e.get("atmosphere.color")||"#ffffff"});var l=e.get("atmosphere.offset")||5;this._atmosphereMesh.scale.set(s+l,s+l,s+l)}else i.material.undefine("both","ATMOSPHERE_ENABLED"),this._atmosphereMesh.invisible=!0;var u=i.material.setTextureImage("diffuseMap",e.get("baseTexture"),r,{flipY:!1,anisotropic:8});u&&u.surface&&u.surface.attachToMesh(i);var c=i.material.setTextureImage("bumpMap",e.get("heightTexture"),r,{flipY:!1,anisotropic:8});c&&c.surface&&c.surface.attachToMesh(i),i.material[e.get("postEffect.enable")?"define":"undefine"]("fragment","SRGB_DECODE"),this._updateLight(e,r),this._displaceVertices(e,r),this._updateViewControl(e,r),this._updateLayers(e,r)},afterRender:function(e,t,r,n){var a=n.renderer;this._sceneHelper.updateAmbientCubemap(a,e,r),this._sceneHelper.updateSkybox(a,e,r)},_updateLayers:function(e,t){var r=e.coordinateSystem,n=e.get("layers"),a=r.radius,i=[],o=[],s=[],l=[];R(n,function(d){var v=new Ft(d),p=v.get("type"),g=D.loadTexture(v.get("texture"),t,{flipY:!1,anisotropic:8});if(g.surface&&g.surface.attachToMesh(this._earthMesh),p==="blend"){var m=v.get("blendTo"),_=Se.firstNotNull(v.get("intensity"),1);m==="emission"?(s.push(g),l.push(_)):(i.push(g),o.push(_))}else{var y=v.get("id"),x=this._layerMeshes[y];x||(x=this._layerMeshes[y]=new D.Mesh({geometry:this._overlayGeometry,castShadow:!1,ignorePicking:!0}));var S=v.get("shading");S==="lambert"?(x.material=x.__lambertMaterial||new D.Material({autoUpdateTextureStatus:!1,shader:D.createShader("ecgl.lambert"),transparent:!0,depthMask:!1}),x.__lambertMaterial=x.material):(x.material=x.__colorMaterial||new D.Material({autoUpdateTextureStatus:!1,shader:D.createShader("ecgl.color"),transparent:!0,depthMask:!1}),x.__colorMaterial=x.material),x.material.enableTexture("diffuseMap");var T=v.get("distance"),b=a+(T??r.radius/100);x.scale.set(b,b,b),a=b;var w=this._blankTexture||(this._blankTexture=D.createBlankTexture("rgba(255, 255, 255, 0)"));x.material.set("diffuseMap",w),D.loadTexture(v.get("texture"),t,{flipY:!1,anisotropic:8},function(A){A.surface&&A.surface.attachToMesh(x),x.material.set("diffuseMap",A),t.getZr().refresh()}),v.get("show")?this.groupGL.add(x):this.groupGL.remove(x)}},this);var u=this._earthMesh.material;u.define("fragment","LAYER_DIFFUSEMAP_COUNT",i.length),u.define("fragment","LAYER_EMISSIVEMAP_COUNT",s.length),u.set("layerDiffuseMap",i),u.set("layerDiffuseIntensity",o),u.set("layerEmissiveMap",s),u.set("layerEmissionIntensity",l);var c=e.getModel("debug.wireframe");if(c.get("show")){u.define("both","WIREFRAME_TRIANGLE");var h=D.parseColor(c.get("lineStyle.color")||"rgba(0,0,0,0.5)"),f=Se.firstNotNull(c.get("lineStyle.width"),1);u.set("wireframeLineWidth",f),u.set("wireframeLineColor",h)}else u.undefine("both","WIREFRAME_TRIANGLE")},_updateViewControl:function(e,t){var r=e.coordinateSystem,n=e.getModel("viewControl");r.viewGL.camera;var a=this;function i(){return{type:"globeChangeCamera",alpha:o.getAlpha(),beta:o.getBeta(),distance:o.getDistance()-r.radius,center:o.getCenter(),from:a.uid,globeId:e.id}}var o=this._control;o.setViewGL(r.viewGL);var s=n.get("targetCoord"),l,u;s!=null&&(u=s[0]+90,l=s[1]),o.setFromViewControlModel(n,{baseDistance:r.radius,alpha:l,beta:u}),o.off("update"),o.on("update",function(){t.dispatchAction(i())})},_displaceVertices:function(e,t){var r=e.get("displacementQuality"),n=e.get("debug.wireframe.show"),a=e.coordinateSystem;if(!(!e.isDisplacementChanged()&&r===this._displacementQuality&&n===this._showDebugWireframe)){this._displacementQuality=r,this._showDebugWireframe=n;var i=this._sphereGeometry,o={low:100,medium:200,high:400,ultra:800}[r]||200,s=o/2;(i.widthSegments!==o||n)&&(i.widthSegments=o,i.heightSegments=s,i.build()),this._doDisplaceVertices(i,a),n&&i.generateBarycentric()}},_doDisplaceVertices:function(e,t){var r=e.attributes.position.value,n=e.attributes.texcoord0.value,a=e.__originalPosition;(!a||a.length!==r.length)&&(a=new Float32Array(r.length),a.set(r),e.__originalPosition=a);for(var i=t.displacementWidth,o=t.displacementHeight,s=t.displacementData,l=0;l<e.vertexCount;l++){var u=l*3,c=l*2,h=a[u+1],f=a[u+2],d=a[u+3],v=n[c++],p=n[c++],g=Math.round(v*(i-1)),m=Math.round(p*(o-1)),_=m*i+g,y=s?s[_]:0;r[u+1]=h+h*y,r[u+2]=f+f*y,r[u+3]=d+d*y}e.generateVertexNormals(),e.dirty(),e.updateBoundingBox()},_updateLight:function(e,t){var r=this._earthMesh;this._sceneHelper.updateLight(e);var n=this._sceneHelper.mainLight,a=e.get("light.main.time")||new Date,i=UR.getPosition(Mm(a),0,0),o=Math.cos(i.altitude);n.position.y=-o*Math.cos(i.azimuth),n.position.x=Math.sin(i.altitude),n.position.z=o*Math.sin(i.azimuth),n.lookAt(r.getWorldPosition())},dispose:function(e,t){this.groupGL.removeAll(),this._control.dispose()}});var WR=lt.vec3;function ml(e){this.radius=e,this.viewGL=null,this.altitudeAxis,this.displacementData=null,this.displacementWidth,this.displacementHeight}ml.prototype={constructor:ml,dimensions:["lng","lat","alt"],type:"globe",containPoint:function(){},setDisplacementData:function(e,t,r){this.displacementData=e,this.displacementWidth=t,this.displacementHeight=r},_getDisplacementScale:function(e,t){var r=(e+180)/360*(this.displacementWidth-1),n=(90-t)/180*(this.displacementHeight-1),a=Math.round(r)+Math.round(n)*this.displacementWidth;return this.displacementData[a]},dataToPoint:function(e,t){var r=e[0],n=e[1],a=e[2]||0,i=this.radius;this.displacementData&&(i*=1+this._getDisplacementScale(r,n)),this.altitudeAxis&&(i+=this.altitudeAxis.dataToCoord(a)),r=r*Math.PI/180,n=n*Math.PI/180;var o=Math.cos(n)*i;return t=t||[],t[0]=-o*Math.cos(r+Math.PI),t[1]=Math.sin(n)*i,t[2]=o*Math.sin(r+Math.PI),t},pointToData:function(e,t){var r=e[0],n=e[1],a=e[2],i=WR.len(e);r/=i,n/=i,a/=i;var o=Math.asin(n),s=Math.atan2(a,-r);s<0&&(s=Math.PI*2+s);var l=o*180/Math.PI,u=s*180/Math.PI-180;return t=t||[],t[0]=u,t[1]=l,t[2]=i-this.radius,this.altitudeAxis&&(t[2]=this.altitudeAxis.coordToData(t[2])),t}};function $R(e,t){var r=document.createElement("canvas"),n=r.getContext("2d"),a=e.width,i=e.height;r.width=a,r.height=i,n.drawImage(e,0,0,a,i);for(var o=n.getImageData(0,0,a,i).data,s=new Float32Array(o.length/4),l=0;l<o.length/4;l++){var u=o[l*4];s[l]=u/255*t}return{data:s,width:a,height:i}}function XR(e,t){var r=e.getBoxLayoutParams(),n=sr(r,{width:t.getWidth(),height:t.getHeight()});n.y=t.getHeight()-n.y-n.height,this.viewGL.setViewport(n.x,n.y,n.width,n.height,t.getDevicePixelRatio()),this.radius=e.get("globeRadius");var a=e.get("globeOuterRadius");this.altitudeAxis&&this.altitudeAxis.setExtent(0,a-this.radius)}function jR(e,t){var r=[1/0,-1/0];if(e.eachSeries(function(a){if(a.coordinateSystem===this){var i=a.getData(),o=a.coordDimToDataDim("alt"),s=o&&o[0];if(s){var l=i.getDataExtent(s,!0);r[0]=Math.min(r[0],l[0]),r[1]=Math.max(r[1],l[1])}}},this),r&&isFinite(r[1]-r[0])){var n=mf(r,{type:"value",min:"dataMin",max:"dataMax"});this.altitudeAxis=new or("altitude",n),this.resize(this.model,t)}}var ZR={dimensions:ml.prototype.dimensions,create:function(e,t){var r=[];return e.eachComponent("globe",function(n){n.__viewGL=n.__viewGL||new Oe;var a=new ml;a.viewGL=n.__viewGL,n.coordinateSystem=a,a.model=n,r.push(a),a.resize=XR,a.resize(n,t),a.update=jR}),e.eachSeries(function(n){if(n.get("coordinateSystem")==="globe"){var a=n.getReferringComponents("globe").models[0];if(a||(a=e.getComponent("globe")),!a)throw new Error('globe "'+Se.firstNotNull(n.get("globe3DIndex"),n.get("globe3DId"),0)+'" not found');var i=a.coordinateSystem;n.coordinateSystem=i}}),e.eachComponent("globe",function(n,a){var i=n.coordinateSystem,o=n.getDisplacementTexture(),s=n.getDisplacemenScale();if(n.isDisplacementChanged()){if(n.hasDisplacement()){var l=!0;D.loadTexture(o,t,function(u){var c=u.image,h=$R(c,s);n.setDisplacementData(h.data,h.width,h.height),l||t.dispatchAction({type:"globeUpdateDisplacment"})}),l=!1}else i.setDisplacementData(null,0,0);i.setDisplacementData(n.displacementData,n.displacementWidth,n.displacementHeight)}}),r}};const YR=ZR;function qR(e){e.registerComponentModel(CR),e.registerComponentView(HR),e.registerCoordinateSystem("globe",YR),e.registerAction({type:"globeChangeCamera",event:"globecamerachanged",update:"series:updateCamera"},function(t,r){r.eachComponent({mainType:"globe",query:t},function(n){n.setView(t)})}),e.registerAction({type:"globeUpdateDisplacment",event:"globedisplacementupdated",update:"update"},function(t,r){})}oe(qR);var V1=["zoom","center","pitch","bearing"],yd=Ot.extend({type:"mapbox3D",layoutMode:"box",coordinateSystem:null,defaultOption:{zlevel:-10,style:"mapbox://styles/mapbox/light-v9",center:[0,0],zoom:0,pitch:0,bearing:0,light:{main:{alpha:20,beta:30}},altitudeScale:1,boxHeight:"auto"},getMapboxCameraOption:function(){var e=this;return V1.reduce(function(t,r){return t[r]=e.get(r),t},{})},setMapboxCameraOption:function(e){e!=null&&V1.forEach(function(t){e[t]!=null&&(this.option[t]=e[t])},this)},getMapbox:function(){return this._mapbox},setMapbox:function(e){this._mapbox=e}});fe(yd.prototype,fi);fe(yd.prototype,di);const KR=yd;function Bn(e,t){if(this.id=e,this.zr=t,this.dom=document.createElement("div"),this.dom.style.cssText="position:absolute;left:0;right:0;top:0;bottom:0;",!mapboxgl)throw new Error("Mapbox GL library must be included. See https://www.mapbox.com/mapbox-gl-js/api/");this._mapbox=new mapboxgl.Map({container:this.dom}),this._initEvents()}Bn.prototype.setUnpainted=function(){};Bn.prototype.resize=function(){this._mapbox.resize()};Bn.prototype.getMapbox=function(){return this._mapbox};Bn.prototype.clear=function(){};Bn.prototype.refresh=function(){this._mapbox.resize()};var qx=["mousedown","mouseup","click","dblclick","mousemove","mousewheel","wheel","touchstart","touchend","touchmove","touchcancel"];Bn.prototype._initEvents=function(){var e=this._mapbox.getCanvasContainer();this._handlers=this._handlers||{contextmenu:function(t){return t.preventDefault(),!1}},qx.forEach(function(t){this._handlers[t]=function(r){var n={};for(var a in r)n[a]=r[a];n.bubbles=!1;var i=new r.constructor(r.type,n);e.dispatchEvent(i)},this.zr.dom.addEventListener(t,this._handlers[t])},this),this.zr.dom.addEventListener("contextmenu",this._handlers.contextmenu)};Bn.prototype.dispose=function(){qx.forEach(function(e){this.zr.dom.removeEventListener(e,this._handlers[e])},this)};const Kx=`
@export ecgl.displayShadow.vertex

@import ecgl.common.transformUniforms

@import ecgl.common.uv.header

@import ecgl.common.attributes

varying vec3 v_WorldPosition;

varying vec3 v_Normal;

void main()
{
 @import ecgl.common.uv.main
 v_Normal = normalize((worldInverseTranspose * vec4(normal, 0.0)).xyz);

 v_WorldPosition = (world * vec4(position, 1.0)).xyz;
 gl_Position = worldViewProjection * vec4(position, 1.0);
}

@end


@export ecgl.displayShadow.fragment

@import ecgl.common.uv.fragmentHeader

varying vec3 v_Normal;
varying vec3 v_WorldPosition;

uniform float roughness: 0.2;

#ifdef DIRECTIONAL_LIGHT_COUNT
@import clay.header.directional_light
#endif

@import ecgl.common.ssaoMap.header

@import clay.plugin.compute_shadow_map

void main()
{
 float shadow = 1.0;

 @import ecgl.common.ssaoMap.main

#if defined(DIRECTIONAL_LIGHT_COUNT) && defined(DIRECTIONAL_LIGHT_SHADOWMAP_COUNT)
 float shadowContribsDir[DIRECTIONAL_LIGHT_COUNT];
 if(shadowEnabled)
 {
 computeShadowOfDirectionalLights(v_WorldPosition, shadowContribsDir);
 }
 for (int i = 0; i < DIRECTIONAL_LIGHT_COUNT; i++) {
 shadow = min(shadow, shadowContribsDir[i] * 0.5 + 0.5);
 }
#endif

 shadow *= 0.5 + ao * 0.5;
 shadow = clamp(shadow, 0.0, 1.0);

 gl_FragColor = vec4(vec3(0.0), 1.0 - shadow);
}

@end`;D.Shader.import(Kx);const JR=kt.extend({type:"mapbox3D",__ecgl__:!0,init:function(e,t){var r=t.getZr();this._zrLayer=new Bn("mapbox3D",r),r.painter.insertLayer(-1e3,this._zrLayer),this._lightRoot=new D.Node,this._sceneHelper=new Rn(this._lightRoot),this._sceneHelper.initLight(this._lightRoot);var n=this._zrLayer.getMapbox(),a=this._dispatchInteractAction.bind(this,t,n);["zoom","rotate","drag","pitch","rotate","move"].forEach(function(i){n.on(i,a)}),this._groundMesh=new D.Mesh({geometry:new D.PlaneGeometry,material:new D.Material({shader:new D.Shader({vertex:D.Shader.source("ecgl.displayShadow.vertex"),fragment:D.Shader.source("ecgl.displayShadow.fragment")}),depthMask:!1}),renderOrder:-100,culling:!1,castShadow:!1,$ignorePicking:!0,renderNormal:!0})},render:function(e,t,r){var n=this._zrLayer.getMapbox(),a=e.get("style"),i=JSON.stringify(a);i!==this._oldStyleStr&&a&&n.setStyle(a),this._oldStyleStr=i,n.setCenter(e.get("center")),n.setZoom(e.get("zoom")),n.setPitch(e.get("pitch")),n.setBearing(e.get("bearing")),e.setMapbox(n);var o=e.coordinateSystem;o.viewGL.scene.add(this._lightRoot),o.viewGL.add(this._groundMesh),this._updateGroundMesh(),this._sceneHelper.setScene(o.viewGL.scene),this._sceneHelper.updateLight(e),o.viewGL.setPostEffect(e.getModel("postEffect"),r),o.viewGL.setTemporalSuperSampling(e.getModel("temporalSuperSampling")),this._mapbox3DModel=e},afterRender:function(e,t,r,n){var a=n.renderer;this._sceneHelper.updateAmbientCubemap(a,e,r),this._sceneHelper.updateSkybox(a,e,r),e.coordinateSystem.viewGL.scene.traverse(function(i){i.material&&(i.material.define("fragment","NORMAL_UP_AXIS",2),i.material.define("fragment","NORMAL_FRONT_AXIS",1))})},updateCamera:function(e,t,r,n){e.coordinateSystem.setCameraOption(n),this._updateGroundMesh(),r.getZr().refresh()},_dispatchInteractAction:function(e,t,r){e.dispatchAction({type:"mapbox3DChangeCamera",pitch:t.getPitch(),zoom:t.getZoom(),center:t.getCenter().toArray(),bearing:t.getBearing(),mapbox3DId:this._mapbox3DModel&&this._mapbox3DModel.id})},_updateGroundMesh:function(){if(this._mapbox3DModel){var e=this._mapbox3DModel.coordinateSystem,t=e.dataToPoint(e.center);this._groundMesh.position.set(t[0],t[1],-.001);var r=new D.Plane(new D.Vector3(0,0,1),0),n=e.viewGL.camera.castRay(new D.Vector2(-1,-1)),a=e.viewGL.camera.castRay(new D.Vector2(1,1)),i=n.intersectPlane(r),o=a.intersectPlane(r),s=i.dist(o)/e.viewGL.rootNode.scale.x;this._groundMesh.scale.set(s,s,1)}},dispose:function(e,t){this._zrLayer&&this._zrLayer.dispose(),t.getZr().painter.delLayer(-1e3)}});var gn=lt.mat4,zi=512,Bc=.6435011087932844,Qt=Math.PI,Fa=1/10;function si(){this.width=0,this.height=0,this.altitudeScale=1,this.boxHeight="auto",this.altitudeExtent,this.bearing=0,this.pitch=0,this.center=[0,0],this._origin,this.zoom=0,this._initialZoom,this.maxPitch=60,this.zoomOffset=0}si.prototype={constructor:si,dimensions:["lng","lat","alt"],containPoint:function(){},setCameraOption:function(e){this.bearing=e.bearing,this.pitch=e.pitch,this.center=e.center,this.zoom=e.zoom,this._origin||(this._origin=this.projectOnTileWithScale(this.center,zi)),this._initialZoom==null&&(this._initialZoom=this.zoom),this.updateTransform()},updateTransform:function(){if(this.height){var e=.5/Math.tan(Bc/2)*this.height*Fa,t=Math.max(Math.min(this.pitch,this.maxPitch),0)/180*Math.PI,r=Bc/2,n=Math.PI/2+t,a=Math.sin(r)*e/Math.sin(Math.PI-n-r),i=Math.cos(Math.PI/2-t)*a+e,o=i*1.1;this.pitch>50&&(o=1e3);var s=[];gn.perspective(s,Bc,this.width/this.height,1,o),this.viewGL.camera.projectionMatrix.setArray(s),this.viewGL.camera.decomposeProjectionMatrix();var s=gn.identity([]),l=this.dataToPoint(this.center);gn.scale(s,s,[1,-1,1]),gn.translate(s,s,[0,0,-e]),gn.rotateX(s,s,t),gn.rotateZ(s,s,-this.bearing/180*Math.PI),gn.translate(s,s,[-l[0]*this.getScale()*Fa,-l[1]*this.getScale()*Fa,0]),this.viewGL.camera.viewMatrix.array=s;var u=[];gn.invert(u,s),this.viewGL.camera.worldTransform.array=u,this.viewGL.camera.decomposeWorldTransform();var c=zi*this.getScale(),h;if(this.altitudeExtent&&!isNaN(this.boxHeight)){var f=this.altitudeExtent[1]-this.altitudeExtent[0];h=this.boxHeight/f*this.getScale()/Math.pow(2,this._initialZoom-this.zoomOffset)}else h=c/(2*Math.PI*6378e3*Math.abs(Math.cos(this.center[1]*(Math.PI/180))))*this.altitudeScale*Fa;this.viewGL.rootNode.scale.set(this.getScale()*Fa,this.getScale()*Fa,h)}},getScale:function(){return Math.pow(2,this.zoom-this.zoomOffset)},projectOnTile:function(e,t){return this.projectOnTileWithScale(e,this.getScale()*zi,t)},projectOnTileWithScale:function(e,t,r){var n=e[0],a=e[1],i=n*Qt/180,o=a*Qt/180,s=t*(i+Qt)/(2*Qt),l=t*(Qt-Math.log(Math.tan(Qt/4+o*.5)))/(2*Qt);return r=r||[],r[0]=s,r[1]=l,r},unprojectFromTile:function(e,t){return this.unprojectOnTileWithScale(e,this.getScale()*zi,t)},unprojectOnTileWithScale:function(e,t,r){var n=e[0],a=e[1],i=n/t*(2*Qt)-Qt,o=2*(Math.atan(Math.exp(Qt-a/t*(2*Qt)))-Qt/4);return r=r||[],r[0]=i*180/Qt,r[1]=o*180/Qt,r},dataToPoint:function(e,t){return t=this.projectOnTileWithScale(e,zi,t),t[0]-=this._origin[0],t[1]-=this._origin[1],t[2]=isNaN(e[2])?0:e[2],isNaN(e[2])||(t[2]=e[2],this.altitudeExtent&&(t[2]-=this.altitudeExtent[0])),t}};function Co(){si.apply(this,arguments)}Co.prototype=new si;Co.prototype.constructor=Co;Co.prototype.type="mapbox3D";function Jx(e,t,r){function n(i,o){var s=o.getWidth(),l=o.getHeight(),u=o.getDevicePixelRatio();this.viewGL.setViewport(0,0,s,l,u),this.width=s,this.height=l,this.altitudeScale=i.get("altitudeScale"),this.boxHeight=i.get("boxHeight")}function a(i,o){if(this.model.get("boxHeight")!=="auto"){var s=[1/0,-1/0];i.eachSeries(function(l){if(l.coordinateSystem===this){var u=l.getData(),c=l.coordDimToDataDim("alt")[0];if(c){var h=u.getDataExtent(c,!0);s[0]=Math.min(s[0],h[0]),s[1]=Math.max(s[1],h[1])}}},this),s&&isFinite(s[1]-s[0])&&(this.altitudeExtent=s)}}return{dimensions:t.prototype.dimensions,create:function(i,o){var s=[];return i.eachComponent(e,function(l){var u=l.__viewGL;u||(u=l.__viewGL=new Oe,u.setRootNode(new D.Node));var c=new t;c.viewGL=l.__viewGL,c.resize=n,c.resize(l,o),s.push(c),l.coordinateSystem=c,c.model=l,c.update=a}),i.eachSeries(function(l){if(l.get("coordinateSystem")===e){var u=l.getReferringComponents(e).models[0];if(u||(u=i.getComponent(e)),!u)throw new Error(e+' "'+Se.firstNotNull(l.get(e+"Index"),l.get(e+"Id"),0)+'" not found');l.coordinateSystem=u.coordinateSystem}}),r&&r(s,i,o),s}}}var QR=Jx("mapbox3D",Co,function(e){e.forEach(function(t){t.setCameraOption(t.model.getMapboxCameraOption())})});const eN=QR;function tN(e){e.registerComponentModel(KR),e.registerComponentView(JR),e.registerCoordinateSystem("mapbox3D",eN),e.registerAction({type:"mapbox3DChangeCamera",event:"mapbox3dcamerachanged",update:"mapbox3D:updateCamera"},function(t,r){r.eachComponent({mainType:"mapbox3D",query:t},function(n){n.setMapboxCameraOption(t)})})}oe(tN);var U1=["zoom","center","pitch","bearing"],_d=Ot.extend({type:"maptalks3D",layoutMode:"box",coordinateSystem:null,defaultOption:{zlevel:-10,urlTemplate:"http://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}.png",attribution:'&copy; <a href="http://osm.org">OpenStreetMap</a> contributors, &copy; <a href="https://carto.com/">CARTO</a>',center:[0,0],zoom:0,pitch:0,bearing:0,light:{main:{alpha:20,beta:30}},altitudeScale:1,boxHeight:"auto"},getMaptalksCameraOption:function(){var e=this;return U1.reduce(function(t,r){return t[r]=e.get(r),t},{})},setMaptalksCameraOption:function(e){e!=null&&U1.forEach(function(t){e[t]!=null&&(this.option[t]=e[t])},this)},getMaptalks:function(){return this._maptalks},setMaptalks:function(e){this._maptalks=e}});fe(_d.prototype,fi);fe(_d.prototype,di);const rN=_d;function Fn(e,t,r,n){if(this.id=e,this.zr=t,this.dom=document.createElement("div"),this.dom.style.cssText="position:absolute;left:0;right:0;top:0;bottom:0;",!maptalks)throw new Error("Maptalks library must be included. See https://maptalks.org");this._maptalks=new maptalks.Map(this.dom,{center:r,zoom:n,doubleClickZoom:!1,fog:!1}),this._initEvents()}Fn.prototype.setUnpainted=function(){};Fn.prototype.resize=function(){this._maptalks.checkSize()};Fn.prototype.getMaptalks=function(){return this._maptalks};Fn.prototype.clear=function(){};Fn.prototype.refresh=function(){this._maptalks.checkSize()};var Qx=["mousedown","mouseup","click","dblclick","mousemove","mousewheel","DOMMouseScroll","touchstart","touchend","touchmove","touchcancel"];Fn.prototype._initEvents=function(){var e=this.dom;this._handlers=this._handlers||{contextmenu:function(t){return t.preventDefault(),!1}},Qx.forEach(function(t){this._handlers[t]=function(r){var n={};for(var a in r)n[a]=r[a];n.bubbles=!1;var i=new r.constructor(r.type,n);t==="mousewheel"||t==="DOMMouseScroll"?e.dispatchEvent(i):e.firstElementChild.dispatchEvent(i)},this.zr.dom.addEventListener(t,this._handlers[t])},this),this.zr.dom.addEventListener("contextmenu",this._handlers.contextmenu)};Fn.prototype.dispose=function(){Qx.forEach(function(e){this.zr.dom.removeEventListener(e,this._handlers[e])},this),this._maptalks.remove()};D.Shader.import(Kx);const nN=kt.extend({type:"maptalks3D",__ecgl__:!0,init:function(e,t){this._groundMesh=new D.Mesh({geometry:new D.PlaneGeometry,material:new D.Material({shader:new D.Shader({vertex:D.Shader.source("ecgl.displayShadow.vertex"),fragment:D.Shader.source("ecgl.displayShadow.fragment")}),depthMask:!1}),renderOrder:-100,culling:!1,castShadow:!1,$ignorePicking:!0,renderNormal:!0})},_initMaptalksLayer:function(e,t){var r=t.getZr();this._zrLayer=new Fn("maptalks3D",r,e.get("center"),e.get("zoom")),r.painter.insertLayer(-1e3,this._zrLayer),this._lightRoot=new D.Node,this._sceneHelper=new Rn(this._lightRoot),this._sceneHelper.initLight(this._lightRoot);var n=this._zrLayer.getMaptalks(),a=this._dispatchInteractAction.bind(this,t,n);["zoomend","zooming","zoomstart","dragrotating","pitch","pitchend","movestart","moving","moveend","resize","touchstart","touchmove","touchend","animating"].forEach(function(i){n.on(i,a)})},render:function(e,t,r){this._zrLayer||this._initMaptalksLayer(e,r);var n=this._zrLayer.getMaptalks(),a=e.get("urlTemplate"),i=n.getBaseLayer();a!==this._oldUrlTemplate&&(i?i.setOptions({urlTemplate:a,attribution:e.get("attribution")}):(i=new maptalks.TileLayer("maptalks-echarts-gl-baselayer",{urlTemplate:a,subdomains:["a","b","c"],attribution:e.get("attribution")}),n.setBaseLayer(i))),this._oldUrlTemplate=a,n.setCenter(e.get("center")),n.setZoom(e.get("zoom"),{animation:!1}),n.setPitch(e.get("pitch")),n.setBearing(e.get("bearing")),e.setMaptalks(n);var o=e.coordinateSystem;o.viewGL.scene.add(this._lightRoot),o.viewGL.add(this._groundMesh),this._updateGroundMesh(),this._sceneHelper.setScene(o.viewGL.scene),this._sceneHelper.updateLight(e),o.viewGL.setPostEffect(e.getModel("postEffect"),r),o.viewGL.setTemporalSuperSampling(e.getModel("temporalSuperSampling")),this._maptalks3DModel=e},afterRender:function(e,t,r,n){var a=n.renderer;this._sceneHelper.updateAmbientCubemap(a,e,r),this._sceneHelper.updateSkybox(a,e,r),e.coordinateSystem.viewGL.scene.traverse(function(i){i.material&&(i.material.define("fragment","NORMAL_UP_AXIS",2),i.material.define("fragment","NORMAL_FRONT_AXIS",1))})},updateCamera:function(e,t,r,n){e.coordinateSystem.setCameraOption(n),this._updateGroundMesh(),r.getZr().refresh()},_dispatchInteractAction:function(e,t,r){e.dispatchAction({type:"maptalks3DChangeCamera",pitch:t.getPitch(),zoom:iN(t.getResolution())+1,center:t.getCenter().toArray(),bearing:t.getBearing(),maptalks3DId:this._maptalks3DModel&&this._maptalks3DModel.id})},_updateGroundMesh:function(){if(this._maptalks3DModel){var e=this._maptalks3DModel.coordinateSystem,t=e.dataToPoint(e.center);this._groundMesh.position.set(t[0],t[1],-.001);var r=new D.Plane(new D.Vector3(0,0,1),0),n=e.viewGL.camera.castRay(new D.Vector2(-1,-1)),a=e.viewGL.camera.castRay(new D.Vector2(1,1)),i=n.intersectPlane(r),o=a.intersectPlane(r),s=i.dist(o)/e.viewGL.rootNode.scale.x;this._groundMesh.scale.set(s,s,1)}},dispose:function(e,t){this._zrLayer&&this._zrLayer.dispose(),t.getZr().painter.delLayer(-1e3)}}),aN=2*6378137*Math.PI/(256*Math.pow(2,20));function iN(e){return 19-Math.log(e/aN)/Math.LN2}function Lo(){si.apply(this,arguments),this.maxPitch=85,this.zoomOffset=1}Lo.prototype=new si;Lo.prototype.constructor=Lo;Lo.prototype.type="maptalks3D";var oN=Jx("maptalks3D",Lo,function(e){e.forEach(function(t){t.setCameraOption(t.model.getMaptalksCameraOption())})});const sN=oN;function lN(e){e.registerComponentModel(rN),e.registerComponentView(nN),e.registerCoordinateSystem("maptalks3D",sN),e.registerAction({type:"maptalks3DChangeCamera",event:"maptalks3dcamerachanged",update:"maptalks3D:updateCamera"},function(t,r){r.eachComponent({mainType:"maptalks3D",query:t},function(n){n.setMaptalksCameraOption(t)})})}oe(lN);var uN=lt.vec3,cN=gf.isDimensionStacked;function hN(e){var t=e[0],r=e[1];return!(t>0&&r>0||t<0&&r<0)}function fN(e,t){var r=e.getData(),n=e.get("barSize");if(n==null){var a=t.size,i,o,s=t.getAxis("x"),l=t.getAxis("y");s.type==="category"?i=s.getBandWidth()*.7:i=Math.round(a[0]/Math.sqrt(r.count()))*.6,l.type==="category"?o=l.getBandWidth()*.7:o=Math.round(a[1]/Math.sqrt(r.count()))*.6,n=[i,o]}else te(n)||(n=[n,n]);var u=t.getAxis("z").scale.getExtent(),c=hN(u),h=["x","y","z"].map(function(v){return e.coordDimToDataDim(v)[0]}),f=cN(r,h[2]),d=f?r.getCalculationInfo("stackResultDimension"):h[2];r.each(h,function(v,p,g,m){var _=r.get(d,m),y=f?_-g:c?0:u[0],x=t.dataToPoint([v,p,y]),S=t.dataToPoint([v,p,_]),T=uN.dist(x,S),b=[0,S[1]<x[1]?-1:1,0];Math.abs(T)===0&&(T=.1);var w=[n[0],T,n[1]];r.setItemLayout(m,[x,b,w])}),r.setLayout("orient",[1,0,0])}function xd(e,t,r){for(var n=e.getDataExtent(t),a=e.getDataExtent(r),i=n[1]-n[0]||n[0],o=a[1]-a[0]||a[0],s=50,l=new Uint8Array(s*s),u=0;u<e.count();u++){var c=e.get(t,u),h=e.get(r,u),f=Math.floor((c-n[0])/i*(s-1)),d=Math.floor((h-a[0])/o*(s-1)),v=d*s+f;l[v]=l[v]||1}for(var p=0,u=0;u<l.length;u++)l[u]&&p++;return p/l.length}var k1=lt.vec3,dN=gf.isDimensionStacked;function vN(e,t){var r=e.getData(),n=e.get("minHeight")||0,a=e.get("barSize"),i=["lng","lat","alt"].map(function(u){return e.coordDimToDataDim(u)[0]});if(a==null){var o=t.radius*Math.PI,s=xd(r,i[0],i[1]);a=[o/Math.sqrt(r.count()/s),o/Math.sqrt(r.count()/s)]}else te(a)||(a=[a,a]);var l=Sd(r,i);r.each(i,function(u,c,h,f){var d=r.get(l.dimension,f),v=l.isStacked?d-h:t.altitudeAxis.scale.getExtent()[0],p=Math.max(t.altitudeAxis.dataToCoord(h),n),g=t.dataToPoint([u,c,v]),m=t.dataToPoint([u,c,d]),_=k1.sub([],m,g);k1.normalize(_,_);var y=[a[0],p,a[1]];r.setItemLayout(f,[g,_,y])}),r.setLayout("orient",X.UP.array)}function pN(e,t){var r=e.getData(),n=e.get("barSize"),a=e.get("minHeight")||0,i=["lng","lat","alt"].map(function(c){return e.coordDimToDataDim(c)[0]});if(n==null){var o=Math.min(t.size[0],t.size[2]),s=xd(r,i[0],i[1]);n=[o/Math.sqrt(r.count()/s),o/Math.sqrt(r.count()/s)]}else te(n)||(n=[n,n]);var l=[0,1,0],u=Sd(r,i);r.each(i,function(c,h,f,d){var v=r.get(u.dimension,d),p=u.isStacked?v-f:t.altitudeAxis.scale.getExtent()[0],g=Math.max(t.altitudeAxis.dataToCoord(f),a),m=t.dataToPoint([c,h,p]),_=[n[0],g,n[1]];r.setItemLayout(d,[m,l,_])}),r.setLayout("orient",[1,0,0])}function gN(e,t){var r=e.getData(),n=e.coordDimToDataDim("lng")[0],a=e.coordDimToDataDim("lat")[0],i=e.coordDimToDataDim("alt")[0],o=e.get("barSize"),s=e.get("minHeight")||0;if(o==null){var l=r.getDataExtent(n),u=r.getDataExtent(a),c=t.dataToPoint([l[0],u[0]]),h=t.dataToPoint([l[1],u[1]]),f=Math.min(Math.abs(c[0]-h[0]),Math.abs(c[1]-h[1]))||1,d=xd(r,n,a);o=[f/Math.sqrt(r.count()/d),f/Math.sqrt(r.count()/d)]}else te(o)||(o=[o,o]),o[0]/=t.getScale()/16,o[1]/=t.getScale()/16;var v=[0,0,1],p=[n,a,i],g=Sd(r,p);r.each(p,function(m,_,y,x){var S=r.get(g.dimension,x),T=g.isStacked?S-y:0,b=t.dataToPoint([m,_,T]),w=t.dataToPoint([m,_,S]),A=Math.max(w[2]-b[2],s),E=[o[0],A,o[1]];r.setItemLayout(x,[b,v,E])}),r.setLayout("orient",[1,0,0])}function Sd(e,t){var r=dN(e,t[2]);return{dimension:r?e.getCalculationInfo("stackResultDimension"):t[2],isStacked:r}}function mN(e){e.registerLayout(function(t,r){t.eachSeriesByType("bar3D",function(n){var a=n.coordinateSystem,i=a&&a.type;i==="globe"?vN(n,a):i==="cartesian3D"?fN(n,a):i==="geo3D"?pN(n,a):(i==="mapbox3D"||i==="maptalks3D")&&gN(n,a)})})}var Td={};Td.getFormattedLabel=function(e,t,r,n,a){r=r||"normal";var i=e.getData(n),o=i.getItemModel(t),s=e.getDataParams(t,n);a!=null&&s.value instanceof Array&&(s.value=s.value[a]);var l=o.get(r==="normal"?["label","formatter"]:["emphasis","label","formatter"]);l==null&&(l=o.get(["label","formatter"]));var u;return typeof l=="function"?(s.status=r,u=l(s)):typeof l=="string"&&(u=O3(l,s)),u};Td.normalizeToArray=function(e){return e instanceof Array?e:e==null?[]:[e]};const mi=Td;function yN(e,t){var r=[];return R(e.dimensions,function(n){var a=e.getDimensionInfo(n),i=a.otherDims,o=i[t];o!=null&&o!==!1&&(r[o]=a.name)}),r}function Uo(e,t,r){function n(h){var f=[],d=yN(a,"tooltip");d.length?R(d,function(p){v(a.get(p,t),p)}):R(h,v);function v(p,g){var m=a.getDimensionInfo(g);if(!(!m||m.otherDims.tooltip===!1)){var _=m.type,y="- "+(m.tooltipName||m.name)+": "+(_==="ordinal"?p+"":_==="time"?r?"":F3("yyyy/MM/dd hh:mm:ss",p):fv(p));y&&f.push(ra(y))}}return"<br/>"+f.join("<br/>")}var a=e.getData(),i=e.getRawValue(t),o=te(i)?n(i):ra(fv(i)),s=a.getName(t),l=Ct(a,t);Hr(l)&&l.colorStops&&(l=(l.colorStops[0]||{}).color),l=l||"transparent";var u=B3(l),c=e.name;return c==="\0-"&&(c=""),c=c?ra(c)+(r?": ":"<br/>"):"",r?u+c+o:c+u+(s?ra(s)+": "+o:o)}function tu(e,t,r){r=r||e.getSource();var n=t||Xm(e.get("coordinateSystem"))||["x","y","z"],a=Fo(r,{dimensionsDefine:r.dimensionsDefine||e.get("dimensions"),encodeDefine:r.encodeDefine||e.get("encode"),coordDimensions:n.map(function(s){var l=e.getReferringComponents(s+"Axis3D").models[0];return{type:l&&l.get("type")==="category"?"ordinal":"float",name:s}})});e.get("coordinateSystem")==="cartesian3D"&&a.forEach(function(s){if(n.indexOf(s.coordDim)>=0){var l=e.getReferringComponents(s.coordDim+"Axis3D").models[0];l&&l.get("type")==="category"&&(s.ordinalMeta=l.getOrdinalMeta())}});var i=gf.enableDataStack(e,a,{byIndex:!0,stackedCoordDimension:"z"}),o=new it(a,e);return o.setCalculationInfo(i),o.initData(r),o}var e2=$e.extend({type:"series.bar3D",dependencies:["globe"],visualStyleAccessPathvisu:"itemStyle",getInitialData:function(e,t){return tu(this)},getFormattedLabel:function(e,t,r,n){var a=mi.getFormattedLabel(this,e,t,r,n);return a==null&&(a=this.getData().get("z",e)),a},formatTooltip:function(e){return Uo(this,e)},defaultOption:{coordinateSystem:"cartesian3D",globeIndex:0,grid3DIndex:0,zlevel:-10,bevelSize:0,bevelSmoothness:2,onGridPlane:"xy",shading:"color",minHeight:0,itemStyle:{opacity:1},label:{show:!1,distance:2,textStyle:{fontSize:14,color:"#000",backgroundColor:"rgba(255,255,255,0.7)",padding:3,borderRadius:3}},emphasis:{label:{show:!0}},animationDurationUpdate:500}});fe(e2.prototype,pi);const _N=e2;var Qe=lt.vec3,xN=lt.mat3,bd=Me.extend(function(){return{attributes:{position:new Me.Attribute("position","float",3,"POSITION"),normal:new Me.Attribute("normal","float",3,"NORMAL"),color:new Me.Attribute("color","float",4,"COLOR"),prevPosition:new Me.Attribute("prevPosition","float",3),prevNormal:new Me.Attribute("prevNormal","float",3)},dynamic:!0,enableNormal:!1,bevelSize:1,bevelSegments:0,_dataIndices:null,_vertexOffset:0,_triangleOffset:0}},{resetOffset:function(){this._vertexOffset=0,this._triangleOffset=0},setBarCount:function(e){var t=this.enableNormal,r=this.getBarVertexCount()*e,n=this.getBarTriangleCount()*e;this.vertexCount!==r&&(this.attributes.position.init(r),t?this.attributes.normal.init(r):this.attributes.normal.value=null,this.attributes.color.init(r)),this.triangleCount!==n&&(this.indices=r>65535?new Uint32Array(n*3):new Uint16Array(n*3),this._dataIndices=new Uint32Array(r))},getBarVertexCount:function(){var e=this.bevelSize>0?this.bevelSegments:0;return e>0?this._getBevelBarVertexCount(e):this.enableNormal?24:8},getBarTriangleCount:function(){var e=this.bevelSize>0?this.bevelSegments:0;return e>0?this._getBevelBarTriangleCount(e):12},_getBevelBarVertexCount:function(e){return(e+1)*4*(e+1)*2},_getBevelBarTriangleCount:function(e){var t=e*4+3,r=e*2+1;return(t+1)*r*2+4},setColor:function(e,t){for(var r=this.getBarVertexCount(),n=r*e,a=r*(e+1),i=n;i<a;i++)this.attributes.color.set(i,t);this.dirtyAttribute("color")},getDataIndexOfVertex:function(e){return this._dataIndices?this._dataIndices[e]:null},addBar:function(){for(var e=Qe.create,t=Qe.scaleAndAdd,r=e(),n=e(),a=e(),i=e(),o=e(),s=e(),l=e(),u=[],c=[],h=0;h<8;h++)u[h]=e();for(var f=[[0,1,5,4],[2,3,7,6],[4,5,6,7],[3,2,1,0],[0,4,7,3],[1,2,6,5]],d=[0,1,2,0,2,3],v=[],h=0;h<f.length;h++)for(var p=f[h],g=0;g<2;g++){for(var m=[],_=0;_<3;_++)m.push(p[d[g*3+_]]);v.push(m)}return function(y,x,S,T,b,w){var A=this._vertexOffset;if(this.bevelSize>0&&this.bevelSegments>0)this._addBevelBar(y,x,S,T,this.bevelSize,this.bevelSegments,b);else{Qe.copy(a,x),Qe.normalize(a,a),Qe.cross(i,S,a),Qe.normalize(i,i),Qe.cross(n,a,i),Qe.normalize(i,i),Qe.negate(o,n),Qe.negate(s,a),Qe.negate(l,i),t(u[0],y,n,T[0]/2),t(u[0],u[0],i,T[2]/2),t(u[1],y,n,T[0]/2),t(u[1],u[1],l,T[2]/2),t(u[2],y,o,T[0]/2),t(u[2],u[2],l,T[2]/2),t(u[3],y,o,T[0]/2),t(u[3],u[3],i,T[2]/2),t(r,y,a,T[1]),t(u[4],r,n,T[0]/2),t(u[4],u[4],i,T[2]/2),t(u[5],r,n,T[0]/2),t(u[5],u[5],l,T[2]/2),t(u[6],r,o,T[0]/2),t(u[6],u[6],l,T[2]/2),t(u[7],r,o,T[0]/2),t(u[7],u[7],i,T[2]/2);var E=this.attributes;if(this.enableNormal){c[0]=n,c[1]=o,c[2]=a,c[3]=s,c[4]=i,c[5]=l;for(var C=this._vertexOffset,M=0;M<f.length;M++){for(var P=this._triangleOffset*3,L=0;L<6;L++)this.indices[P++]=C+d[L];C+=4,this._triangleOffset+=2}for(var M=0;M<f.length;M++)for(var I=c[M],L=0;L<4;L++){var N=f[M][L];E.position.set(this._vertexOffset,u[N]),E.normal.set(this._vertexOffset,I),E.color.set(this._vertexOffset++,b)}}else{for(var M=0;M<v.length;M++){for(var P=this._triangleOffset*3,L=0;L<3;L++)this.indices[P+L]=v[M][L]+this._vertexOffset;this._triangleOffset++}for(var M=0;M<u.length;M++)E.position.set(this._vertexOffset,u[M]),E.color.set(this._vertexOffset++,b)}}for(var F=this._vertexOffset,M=A;M<F;M++)this._dataIndices[M]=w}}(),_addBevelBar:function(){var e=Qe.create(),t=Qe.create(),r=Qe.create(),n=xN.create(),a=[],i=[1,-1,-1,1],o=[1,1,-1,-1],s=[2,0];return function(l,u,c,h,f,d,v){Qe.copy(t,u),Qe.normalize(t,t),Qe.cross(r,c,t),Qe.normalize(r,r),Qe.cross(e,t,r),Qe.normalize(r,r),n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=t[0],n[4]=t[1],n[5]=t[2],n[6]=r[0],n[7]=r[1],n[8]=r[2],f=Math.min(h[0],h[2])/2*f;for(var p=0;p<3;p++)a[p]=Math.max(h[p]-f*2,0);for(var g=(h[0]-a[0])/2,m=(h[1]-a[1])/2,_=(h[2]-a[2])/2,y=[],x=[],S=this._vertexOffset,T=[],p=0;p<2;p++){T[p]=T[p]=[];for(var b=0;b<=d;b++)for(var w=0;w<4;w++){(b===0&&p===0||p===1&&b===d)&&T[p].push(S);for(var A=0;A<=d;A++){var E=A/d*Math.PI/2+Math.PI/2*w,C=b/d*Math.PI/2+Math.PI/2*p;x[0]=g*Math.cos(E)*Math.sin(C),x[1]=m*Math.cos(C),x[2]=_*Math.sin(E)*Math.sin(C),y[0]=x[0]+i[w]*a[0]/2,y[1]=x[1]+m+s[p]*a[1]/2,y[2]=x[2]+o[w]*a[2]/2,Math.abs(g-m)<1e-6&&Math.abs(m-_)<1e-6||(x[0]/=g*g,x[1]/=m*m,x[2]/=_*_),Qe.normalize(x,x),Qe.transformMat3(y,y,n),Qe.transformMat3(x,x,n),Qe.add(y,y,l),this.attributes.position.set(S,y),this.enableNormal&&this.attributes.normal.set(S,x),this.attributes.color.set(S,v),S++}}}for(var M=d*4+3,P=d*2+1,L=M+1,w=0;w<P;w++)for(var p=0;p<=M;p++){var I=w*L+p+this._vertexOffset,N=w*L+(p+1)%L+this._vertexOffset,F=(w+1)*L+(p+1)%L+this._vertexOffset,B=(w+1)*L+p+this._vertexOffset;this.setTriangleIndices(this._triangleOffset++,[F,I,N]),this.setTriangleIndices(this._triangleOffset++,[F,B,I])}this.setTriangleIndices(this._triangleOffset++,[T[0][0],T[0][2],T[0][1]]),this.setTriangleIndices(this._triangleOffset++,[T[0][0],T[0][3],T[0][2]]),this.setTriangleIndices(this._triangleOffset++,[T[1][0],T[1][1],T[1][2]]),this.setTriangleIndices(this._triangleOffset++,[T[1][0],T[1][2],T[1][3]]),this._vertexOffset=S}}()});Te(bd.prototype,Go);Te(bd.prototype,md);const SN=bd;var TN=lt.vec3;const bN=He.extend({type:"bar3D",__ecgl__:!0,init:function(e,t){this.groupGL=new D.Node,this._api=t,this._labelsBuilder=new fn(256,256,t);var r=this;this._labelsBuilder.getLabelPosition=function(n,a,i){if(r._data){var o=r._data.getItemLayout(n),s=o[0],l=o[1],u=o[2][1];return TN.scaleAndAdd([],s,l,i+u)}else return[0,0]},this._labelsBuilder.getMesh().renderOrder=100},render:function(e,t,r){var n=this._prevBarMesh;this._prevBarMesh=this._barMesh,this._barMesh=n,this._barMesh||(this._barMesh=new D.Mesh({geometry:new SN,shadowDepthMaterial:new D.Material({shader:new D.Shader(D.Shader.source("ecgl.sm.depth.vertex"),D.Shader.source("ecgl.sm.depth.fragment"))}),culling:e.coordinateSystem.type==="cartesian3D",renderOrder:10,renderNormal:!0})),this.groupGL.remove(this._prevBarMesh),this.groupGL.add(this._barMesh),this.groupGL.add(this._labelsBuilder.getMesh());var a=e.coordinateSystem;if(this._doRender(e,r),a&&a.viewGL){a.viewGL.add(this.groupGL);var i=a.viewGL.isLinearSpace()?"define":"undefine";this._barMesh.material[i]("fragment","SRGB_DECODE")}this._data=e.getData(),this._labelsBuilder.updateData(this._data),this._labelsBuilder.updateLabels(),this._updateAnimation(e)},_updateAnimation:function(e){D.updateVertexAnimation([["prevPosition","position"],["prevNormal","normal"]],this._prevBarMesh,this._barMesh,e)},_doRender:function(e,t){var r=e.getData(),n=e.get("shading"),a=n!=="color",i=this,o=this._barMesh,s="ecgl."+n;(!o.material||o.material.shader.name!==s)&&(o.material=D.createMaterial(s,["VERTEX_COLOR"])),D.setMaterialFromModel(n,o.material,e,t),o.geometry.enableNormal=a,o.geometry.resetOffset();var l=e.get("bevelSize"),u=e.get("bevelSmoothness");o.geometry.bevelSegments=u,o.geometry.bevelSize=l;var c=[],h=new Float32Array(r.count()*4),f=0,g=0,d=!1;r.each(function(_){if(r.hasValue(_)){var y=Ct(r,_),x=At(r,_);x==null&&(x=1),D.parseColor(y,c),c[3]*=x,h[f++]=c[0],h[f++]=c[1],h[f++]=c[2],h[f++]=c[3],c[3]>0&&(g++,c[3]<.99&&(d=!0))}}),o.geometry.setBarCount(g);var v=r.getLayout("orient"),p=this._barIndexOfData=new Int32Array(r.count()),g=0;r.each(function(_){if(!r.hasValue(_)){p[_]=-1;return}var y=r.getItemLayout(_),x=y[0],S=y[1],T=y[2],b=_*4;c[0]=h[b++],c[1]=h[b++],c[2]=h[b++],c[3]=h[b++],c[3]>0&&(i._barMesh.geometry.addBar(x,S,v,T,c,_),p[_]=g++)}),o.geometry.dirty(),o.geometry.updateBoundingBox();var m=o.material;m.transparent=d,m.depthMask=!d,o.geometry.sortTriangles=d,this._initHandler(e,t)},_initHandler:function(e,t){var r=e.getData(),n=this._barMesh,a=e.coordinateSystem.type==="cartesian3D";n.seriesIndex=e.seriesIndex;var i=-1;n.off("mousemove"),n.off("mouseout"),n.on("mousemove",function(o){var s=n.geometry.getDataIndexOfVertex(o.triangle[0]);s!==i&&(this._downplay(i),this._highlight(s),this._labelsBuilder.updateLabels([s]),a&&t.dispatchAction({type:"grid3DShowAxisPointer",value:[r.get("x",s),r.get("y",s),r.get("z",s,!0)]})),i=s,n.dataIndex=s},this),n.on("mouseout",function(o){this._downplay(i),this._labelsBuilder.updateLabels(),i=-1,n.dataIndex=-1,a&&t.dispatchAction({type:"grid3DHideAxisPointer"})},this)},_highlight:function(e){var t=this._data;if(t){var r=this._barIndexOfData[e];if(!(r<0)){var n=t.getItemModel(e),a=n.getModel("emphasis.itemStyle"),i=a.get("color"),o=a.get("opacity");if(i==null){var s=Ct(t,e);i=Fl(s,-.4)}o==null&&(o=At(t,e));var l=D.parseColor(i);l[3]*=o,this._barMesh.geometry.setColor(r,l),this._api.getZr().refresh()}}},_downplay:function(e){var t=this._data;if(t){var r=this._barIndexOfData[e];if(!(r<0)){var n=Ct(t,e),a=At(t,e),i=D.parseColor(n);i[3]*=a,this._barMesh.geometry.setColor(r,i),this._api.getZr().refresh()}}},highlight:function(e,t,r,n){this._toggleStatus("highlight",e,t,r,n)},downplay:function(e,t,r,n){this._toggleStatus("downplay",e,t,r,n)},_toggleStatus:function(e,t,r,n,a){var i=t.getData(),o=Se.queryDataIndex(i,a),s=this;o!=null?R(mi.normalizeToArray(o),function(l){e==="highlight"?this._highlight(l):this._downplay(l)},this):i.each(function(l){e==="highlight"?s._highlight(l):s._downplay(l)})},remove:function(){this.groupGL.removeAll()},dispose:function(){this._labelsBuilder.dispose(),this.groupGL.removeAll()}});function wN(e){e.registerChartView(bN),e.registerSeriesModel(_N),mN(e),e.registerProcessor(function(t,r){t.eachSeriesByType("bar3d",function(n){var a=n.getData();a.filterSelf(function(i){return a.hasValue(i)})})})}oe(wN);var AN=$e.extend({type:"series.line3D",dependencies:["grid3D"],visualStyleAccessPath:"lineStyle",visualDrawType:"stroke",getInitialData:function(e,t){return tu(this)},formatTooltip:function(e){return Uo(this,e)},defaultOption:{coordinateSystem:"cartesian3D",zlevel:-10,grid3DIndex:0,lineStyle:{width:2},animationDurationUpdate:500}});const EN=AN;var CN=lt.vec3;D.Shader.import(eu);const LN=He.extend({type:"line3D",__ecgl__:!0,init:function(e,t){this.groupGL=new D.Node,this._api=t},render:function(e,t,r){var n=this._prevLine3DMesh;this._prevLine3DMesh=this._line3DMesh,this._line3DMesh=n,this._line3DMesh||(this._line3DMesh=new D.Mesh({geometry:new Sa({useNativeLine:!1,sortTriangles:!0}),material:new D.Material({shader:D.createShader("ecgl.meshLines3D")}),renderOrder:10}),this._line3DMesh.geometry.pick=this._pick.bind(this)),this.groupGL.remove(this._prevLine3DMesh),this.groupGL.add(this._line3DMesh);var a=e.coordinateSystem;if(a&&a.viewGL){a.viewGL.add(this.groupGL);var i=a.viewGL.isLinearSpace()?"define":"undefine";this._line3DMesh.material[i]("fragment","SRGB_DECODE")}this._doRender(e,r),this._data=e.getData(),this._camera=a.viewGL.camera,this.updateCamera(),this._updateAnimation(e)},updateCamera:function(){this._updateNDCPosition()},_doRender:function(e,t){var r=e.getData(),n=this._line3DMesh;n.geometry.resetOffset();var a=r.getLayout("points"),i=[],o=new Float32Array(a.length/3*4),s=0,l=!1;r.each(function(h){var f=Ct(r,h),d=At(r,h);d==null&&(d=1),D.parseColor(f,i),i[3]*=d,o[s++]=i[0],o[s++]=i[1],o[s++]=i[2],o[s++]=i[3],i[3]<.99&&(l=!0)}),n.geometry.setVertexCount(n.geometry.getPolylineVertexCount(a)),n.geometry.setTriangleCount(n.geometry.getPolylineTriangleCount(a)),n.geometry.addPolyline(a,o,Se.firstNotNull(e.get("lineStyle.width"),1)),n.geometry.dirty(),n.geometry.updateBoundingBox();var u=n.material;u.transparent=l,u.depthMask=!l;var c=e.getModel("debug.wireframe");c.get("show")?(n.geometry.createAttribute("barycentric","float",3),n.geometry.generateBarycentric(),n.material.set("both","WIREFRAME_TRIANGLE"),n.material.set("wireframeLineColor",D.parseColor(c.get("lineStyle.color")||"rgba(0,0,0,0.5)")),n.material.set("wireframeLineWidth",Se.firstNotNull(c.get("lineStyle.width"),1))):n.material.set("both","WIREFRAME_TRIANGLE"),this._points=a,this._initHandler(e,t)},_updateAnimation:function(e){D.updateVertexAnimation([["prevPosition","position"],["prevPositionPrev","positionPrev"],["prevPositionNext","positionNext"]],this._prevLine3DMesh,this._line3DMesh,e)},_initHandler:function(e,t){var r=e.getData(),n=e.coordinateSystem,a=this._line3DMesh,i=-1;a.seriesIndex=e.seriesIndex,a.off("mousemove"),a.off("mouseout"),a.on("mousemove",function(o){var s=n.pointToData(o.point.array),l=r.indicesOfNearest("x",s[0])[0];l!==i&&(t.dispatchAction({type:"grid3DShowAxisPointer",value:[r.get("x",l),r.get("y",l),r.get("z",l)]}),a.dataIndex=l),i=l},this),a.on("mouseout",function(o){i=-1,a.dataIndex=-1,t.dispatchAction({type:"grid3DHideAxisPointer"})},this)},_updateNDCPosition:function(){var e=new ne,t=this._camera;ne.multiply(e,t.projectionMatrix,t.viewMatrix);var r=this._positionNDC,n=this._points,a=n.length/3;(!r||r.length/2!==a)&&(r=this._positionNDC=new Float32Array(a*2));for(var i=[],o=0;o<a;o++){var s=o*3,l=o*2;i[0]=n[s],i[1]=n[s+1],i[2]=n[s+2],i[3]=1,CN.transformMat4(i,i,e.array),r[l]=i[0]/i[3],r[l+1]=i[1]/i[3]}},_pick:function(e,t,r,n,a,i){var o=this._positionNDC,s=this._data.hostModel,l=s.get("lineStyle.width"),u=-1,c=r.viewport.width,h=r.viewport.height,f=c*.5,d=h*.5;e=(e+1)*f,t=(t+1)*d;for(var v=1;v<o.length/2;v++){var p=(o[(v-1)*2]+1)*f,g=(o[(v-1)*2+1]+1)*d,m=(o[v*2]+1)*f,_=(o[v*2+1]+1)*d;if(th(p,g,m,_,l,e,t)){var y=(p-e)*(p-e)+(g-t)*(g-t),x=(m-e)*(m-e)+(_-t)*(_-t);u=y<x?v-1:v}}if(u>=0){var S=u*3,T=new X(this._points[S],this._points[S+1],this._points[S+2]);i.push({dataIndex:u,point:T,pointWorld:T.clone(),target:this._line3DMesh,distance:this._camera.getWorldPosition().dist(T)})}},remove:function(){this.groupGL.removeAll()},dispose:function(){this.groupGL.removeAll()}});function DN(e){e.registerChartView(LN),e.registerSeriesModel(EN),e.registerLayout(function(t,r){t.eachSeriesByType("line3D",function(n){var a=n.getData(),i=n.coordinateSystem;if(i){if(i.type!=="cartesian3D")return;var o=new Float32Array(a.count()*3),s=[],l=[],u=i.dimensions,c=u.map(function(h){return n.coordDimToDataDim(h)[0]});i&&a.each(c,function(h,f,d,v){s[0]=h,s[1]=f,s[2]=d,i.dataToPoint(s,l),o[v*3]=l[0],o[v*3+1]=l[1],o[v*3+2]=l[2]}),a.setLayout("points",o)}})})}oe(DN);const MN=$e.extend({type:"series.scatter3D",dependencies:["globe","grid3D","geo3D"],visualStyleAccessPath:"itemStyle",hasSymbolVisual:!0,getInitialData:function(e,t){return tu(this)},getFormattedLabel:function(e,t,r,n){var a=mi.getFormattedLabel(this,e,t,r,n);if(a==null){var i=this.getData(),o=i.dimensions[i.dimensions.length-1];a=i.get(o,e)}return a},formatTooltip:function(e){return Uo(this,e)},defaultOption:{coordinateSystem:"cartesian3D",zlevel:-10,progressive:1e5,progressiveThreshold:1e5,grid3DIndex:0,globeIndex:0,symbol:"circle",symbolSize:10,blendMode:"source-over",label:{show:!1,position:"right",distance:5,textStyle:{fontSize:14,color:"#000",backgroundColor:"rgba(255,255,255,0.7)",padding:3,borderRadius:3}},itemStyle:{opacity:.8},emphasis:{label:{show:!0}},animationDurationUpdate:500}});function Fc(e,n,r){var n=n||document.createElement("canvas");n.width=e,n.height=e;var a=n.getContext("2d");return r&&r(a),n}function PN(e,t,r,n){te(t)||(t=[t,t]);var a=wd.getMarginByStyle(r,n),i=t[0]+a.left+a.right,o=t[1]+a.top+a.bottom,s=Pr(e,0,0,t[0],t[1]),l=Math.max(i,o);s.x=a.left,s.y=a.top,i>o?s.y+=(l-o)/2:s.x+=(l-i)/2;var u=s.getBoundingRect();return s.x-=u.x,s.y-=u.y,s.setStyle(r),s.update(),s.__size=l,s}function IN(e,t,r){var n=t.width,a=t.height,i=e.canvas.width,o=e.canvas.height,s=n/i,l=a/o;function u(m){return m<128?1:-1}function c(m,_){var y=1/0;m=Math.floor(m*s),_=Math.floor(_*l);for(var x=_*n+m,S=t.data[x*4],T=u(S),b=Math.max(_-r,0);b<Math.min(_+r,a);b++)for(var w=Math.max(m-r,0);w<Math.min(m+r,n);w++){var x=b*n+w,A=t.data[x*4],E=u(A),C=w-m,M=b-_;if(T!==E){var P=C*C+M*M;P<y&&(y=P)}}return T*Math.sqrt(y)}for(var h=e.createImageData(i,o),f=0;f<o;f++)for(var d=0;d<i;d++){var v=c(d,f),p=v/r*.5+.5,g=(f*i+d)*4;h.data[g++]=(1-p)*255,h.data[g++]=(1-p)*255,h.data[g++]=(1-p)*255,h.data[g++]=255}return h}var wd={getMarginByStyle:function(e){var t=e.minMargin||0,r=0;e.stroke&&e.stroke!=="none"&&(r=e.lineWidth==null?1:e.lineWidth);var n=e.shadowBlur||0,a=e.shadowOffsetX||0,i=e.shadowOffsetY||0,o={};return o.left=Math.max(r/2,-a+n,t),o.right=Math.max(r/2,a+n,t),o.top=Math.max(r/2,-i+n,t),o.bottom=Math.max(r/2,i+n,t),o},createSymbolSprite:function(e,t,r,n){var a=PN(e,t,r),i=wd.getMarginByStyle(r);return{image:Fc(a.__size,n,function(o){km(o,a)}),margin:i}},createSDFFromCanvas:function(e,t,r,n){return Fc(t,n,function(a){var i=e.getContext("2d"),o=i.getImageData(0,0,e.width,e.height);a.putImageData(IN(a,o,r),0,0)})},createSimpleSprite:function(e,t){return Fc(e,t,function(r){var n=e/2;r.beginPath(),r.arc(n,n,60,0,Math.PI*2,!1),r.closePath();var a=r.createRadialGradient(n,n,0,n,n,n);a.addColorStop(0,"rgba(255, 255, 255, 1)"),a.addColorStop(.5,"rgba(255, 255, 255, 0.5)"),a.addColorStop(1,"rgba(255, 255, 255, 0)"),r.fillStyle=a,r.fill()})}};const H1=wd;var W1=lt.vec3;const RN={needsSortVertices:function(){return this.sortVertices},needsSortVerticesProgressively:function(){return this.needsSortVertices()&&this.vertexCount>=2e4},doSortVertices:function(e,t){var r=this.indices,n=W1.create();if(!r){r=this.indices=this.vertexCount>65535?new Uint32Array(this.vertexCount):new Uint16Array(this.vertexCount);for(var a=0;a<r.length;a++)r[a]=a}if(t===0){var i=this.attributes.position,e=e.array,o=0;(!this._zList||this._zList.length!==this.vertexCount)&&(this._zList=new Float32Array(this.vertexCount));for(var s,a=0;a<this.vertexCount;a++){i.get(a,n);var l=W1.sqrDist(n,e);isNaN(l)&&(l=1e7,o++),a===0?(s=l,l=0):l=l-s,this._zList[a]=l}this._noneCount=o}if(this.vertexCount<2e4)t===0&&this._simpleSort(this._noneCount/this.vertexCount>.05);else for(var a=0;a<3;a++)this._progressiveQuickSort(t*3+a);this.dirtyIndices()},_simpleSort:function(e){var t=this._zList,r=this.indices;function n(a,i){return t[i]-t[a]}e?Array.prototype.sort.call(r,n):ii.sort(r,n,0,r.length-1)},_progressiveQuickSort:function(e){var t=this._zList,r=this.indices;this._quickSort=this._quickSort||new ii,this._quickSort.step(r,function(n,a){return t[a]-t[n]},e)}},NN=`@export ecgl.sdfSprite.vertex

uniform mat4 worldViewProjection : WORLDVIEWPROJECTION;
uniform float elapsedTime : 0;

attribute vec3 position : POSITION;

#ifdef VERTEX_SIZE
attribute float size;
#else
uniform float u_Size;
#endif

#ifdef VERTEX_COLOR
attribute vec4 a_FillColor: COLOR;
varying vec4 v_Color;
#endif

#ifdef VERTEX_ANIMATION
attribute vec3 prevPosition;
attribute float prevSize;
uniform float percent : 1.0;
#endif


#ifdef POSITIONTEXTURE_ENABLED
uniform sampler2D positionTexture;
#endif

varying float v_Size;

void main()
{

#ifdef POSITIONTEXTURE_ENABLED
 gl_Position = worldViewProjection * vec4(texture2D(positionTexture, position.xy).xy, -10.0, 1.0);
#else

 #ifdef VERTEX_ANIMATION
 vec3 pos = mix(prevPosition, position, percent);
 #else
 vec3 pos = position;
 #endif
 gl_Position = worldViewProjection * vec4(pos, 1.0);
#endif

#ifdef VERTEX_SIZE
#ifdef VERTEX_ANIMATION
 v_Size = mix(prevSize, size, percent);
#else
 v_Size = size;
#endif
#else
 v_Size = u_Size;
#endif

#ifdef VERTEX_COLOR
 v_Color = a_FillColor;
 #endif

 gl_PointSize = v_Size;
}

@end

@export ecgl.sdfSprite.fragment

uniform vec4 color: [1, 1, 1, 1];
uniform vec4 strokeColor: [1, 1, 1, 1];
uniform float smoothing: 0.07;

uniform float lineWidth: 0.0;

#ifdef VERTEX_COLOR
varying vec4 v_Color;
#endif

varying float v_Size;

uniform sampler2D sprite;

@import clay.util.srgb

void main()
{
 gl_FragColor = color;

 vec4 _strokeColor = strokeColor;

#ifdef VERTEX_COLOR
 gl_FragColor *= v_Color;
 #endif

#ifdef SPRITE_ENABLED
 float d = texture2D(sprite, gl_PointCoord).r;
 gl_FragColor.a *= smoothstep(0.5 - smoothing, 0.5 + smoothing, d);

 if (lineWidth > 0.0) {
 float sLineWidth = lineWidth / 2.0;

 float outlineMaxValue0 = 0.5 + sLineWidth;
 float outlineMaxValue1 = 0.5 + sLineWidth + smoothing;
 float outlineMinValue0 = 0.5 - sLineWidth - smoothing;
 float outlineMinValue1 = 0.5 - sLineWidth;

 if (d <= outlineMaxValue1 && d >= outlineMinValue0) {
 float a = _strokeColor.a;
 if (d <= outlineMinValue1) {
 a = a * smoothstep(outlineMinValue0, outlineMinValue1, d);
 }
 else {
 a = a * smoothstep(outlineMaxValue1, outlineMaxValue0, d);
 }
 gl_FragColor.rgb = mix(gl_FragColor.rgb * gl_FragColor.a, _strokeColor.rgb, a);
 gl_FragColor.a = gl_FragColor.a * (1.0 - a) + a;
 }
 }
#endif

#ifdef SRGB_DECODE
 gl_FragColor = sRGBToLinear(gl_FragColor);
#endif
}
@end`;var zc=lt.vec4;D.Shader.import(NN);var ON=D.Mesh.extend(function(){var e=new D.Geometry({dynamic:!0,attributes:{color:new D.Geometry.Attribute("color","float",4,"COLOR"),position:new D.Geometry.Attribute("position","float",3,"POSITION"),size:new D.Geometry.Attribute("size","float",1),prevPosition:new D.Geometry.Attribute("prevPosition","float",3),prevSize:new D.Geometry.Attribute("prevSize","float",1)}});Object.assign(e,RN);var t=new D.Material({shader:D.createShader("ecgl.sdfSprite"),transparent:!0,depthMask:!1});t.enableTexture("sprite"),t.define("both","VERTEX_COLOR"),t.define("both","VERTEX_SIZE");var r=new D.Texture2D({image:document.createElement("canvas"),flipY:!1});return t.set("sprite",r),e.pick=this._pick.bind(this),{geometry:e,material:t,mode:D.Mesh.POINTS,sizeScale:1}},{_pick:function(e,t,r,n,a,i){var o=this._positionNDC;if(o)for(var s=r.viewport,l=2/s.width,u=2/s.height,c=this.geometry.vertexCount-1;c>=0;c--){var h;this.geometry.indices?h=this.geometry.indices[c]:h=c;var f=o[h*2],d=o[h*2+1],v=this.geometry.attributes.size.get(h)/this.sizeScale,p=v/2;if(e>f-p*l&&e<f+p*l&&t>d-p*u&&t<d+p*u){var g=new D.Vector3,m=new D.Vector3;this.geometry.attributes.position.get(h,g.array),D.Vector3.transformMat4(m,g,this.worldTransform),i.push({vertexIndex:h,point:g,pointWorld:m,target:this,distance:m.distance(n.getWorldPosition())})}}},updateNDCPosition:function(e,t,r){var n=this._positionNDC,a=this.geometry;(!n||n.length/2!==a.vertexCount)&&(n=this._positionNDC=new Float32Array(a.vertexCount*2));for(var i=zc.create(),o=0;o<a.vertexCount;o++)a.attributes.position.get(o,i),i[3]=1,zc.transformMat4(i,i,e.array),zc.scale(i,i,1/i[3]),n[o*2]=i[0],n[o*2+1]=i[1]}});const BN=ON;var $1=20,X1=-10;function FN(e,t){return e&&t&&e[0]===t[0]&&e[1]===t[1]}function ya(e,t){this.rootNode=new D.Node,this.is2D=e,this._labelsBuilder=new fn(256,256,t),this._labelsBuilder.getMesh().renderOrder=100,this.rootNode.add(this._labelsBuilder.getMesh()),this._api=t,this._spriteImageCanvas=document.createElement("canvas"),this._startDataIndex=0,this._endDataIndex=0,this._sizeScale=1}ya.prototype={constructor:ya,highlightOnMouseover:!0,update:function(e,t,r,n,a){var i=this._prevMesh;this._prevMesh=this._mesh,this._mesh=i;var o=e.getData();if(n==null&&(n=0),a==null&&(a=o.count()),this._startDataIndex=n,this._endDataIndex=a-1,!this._mesh){var s=this._prevMesh&&this._prevMesh.material;this._mesh=new BN({renderOrder:10,frustumCulling:!1}),s&&(this._mesh.material=s)}var s=this._mesh.material,l=this._mesh.geometry,u=l.attributes;this.rootNode.remove(this._prevMesh),this.rootNode.add(this._mesh),this._setPositionTextureToMesh(this._mesh,this._positionTexture);var c=this._getSymbolInfo(e,n,a),h=r.getDevicePixelRatio(),f=e.getModel("itemStyle").getItemStyle(),d=e.get("large"),v=1;c.maxSize>2?(v=this._updateSymbolSprite(e,f,c,h),s.enableTexture("sprite")):s.disableTexture("sprite"),u.position.init(a-n);var p=[];if(d){s.undefine("VERTEX_SIZE"),s.undefine("VERTEX_COLOR");var g=yR(o),m=_R(o);D.parseColor(g,p),p[3]*=m,s.set({color:p,u_Size:c.maxSize*this._sizeScale})}else s.set({color:[1,1,1,1]}),s.define("VERTEX_SIZE"),s.define("VERTEX_COLOR"),u.size.init(a-n),u.color.init(a-n),this._originalOpacity=new Float32Array(a-n);for(var _=o.getLayout("points"),y=u.position.value,x=0;x<a-n;x++){var S=x*3,T=x*2;if(this.is2D?(y[S]=_[T],y[S+1]=_[T+1],y[S+2]=X1):(y[S]=_[S],y[S+1]=_[S+1],y[S+2]=_[S+2]),!d){var g=Ct(o,x),m=At(o,x);D.parseColor(g,p),p[3]*=m,u.color.set(x,p),p[3]<.99;var b=o.getItemVisual(x,"symbolSize");b=b instanceof Array?Math.max(b[0],b[1]):b,isNaN(b)&&(b=0),u.size.value[x]=b*v*this._sizeScale,this._originalOpacity[x]=p[3]}}this._mesh.sizeScale=v,l.updateBoundingBox(),l.dirty(),this._updateMaterial(e,f);var w=e.coordinateSystem;if(w&&w.viewGL){var A=w.viewGL.isLinearSpace()?"define":"undefine";s[A]("fragment","SRGB_DECODE")}d||this._updateLabelBuilder(e,n,a),this._updateHandler(e,t,r),this._updateAnimation(e),this._api=r},getPointsMesh:function(){return this._mesh},updateLabels:function(e){this._labelsBuilder.updateLabels(e)},hideLabels:function(){this.rootNode.remove(this._labelsBuilder.getMesh())},showLabels:function(){this.rootNode.add(this._labelsBuilder.getMesh())},dispose:function(){this._labelsBuilder.dispose()},_updateSymbolSprite:function(e,t,r,n){r.maxSize=Math.min(r.maxSize*2,200);var a=[];return r.aspect>1?(a[0]=r.maxSize,a[1]=r.maxSize/r.aspect):(a[1]=r.maxSize,a[0]=r.maxSize*r.aspect),a[0]=a[0]||1,a[1]=a[1]||1,(this._symbolType!==r.type||!FN(this._symbolSize,a)||this._lineWidth!==t.lineWidth)&&(H1.createSymbolSprite(r.type,a,{fill:"#fff",lineWidth:t.lineWidth,stroke:"transparent",shadowColor:"transparent",minMargin:Math.min(a[0]/2,10)},this._spriteImageCanvas),H1.createSDFFromCanvas(this._spriteImageCanvas,Math.min(this._spriteImageCanvas.width,32),$1,this._mesh.material.get("sprite").image),this._symbolType=r.type,this._symbolSize=a,this._lineWidth=t.lineWidth),this._spriteImageCanvas.width/r.maxSize*n},_updateMaterial:function(e,t){var r=e.get("blendMode")==="lighter"?D.additiveBlend:null,n=this._mesh.material;n.blend=r,n.set("lineWidth",t.lineWidth/$1);var a=D.parseColor(t.stroke);n.set("strokeColor",a),n.transparent=!0,n.depthMask=!1,n.depthTest=!this.is2D,n.sortVertices=!this.is2D},_updateLabelBuilder:function(e,o,r){var n=e.getData(),a=this._mesh.geometry,i=a.attributes.position.value,o=this._startDataIndex,s=this._mesh.sizeScale;this._labelsBuilder.updateData(n,o,r),this._labelsBuilder.getLabelPosition=function(l,u,c){var h=(l-o)*3;return[i[h],i[h+1],i[h+2]]},this._labelsBuilder.getLabelDistance=function(l,u,c){var h=a.attributes.size.get(l-o)/s;return h/2+c},this._labelsBuilder.updateLabels()},_updateAnimation:function(e){D.updateVertexAnimation([["prevPosition","position"],["prevSize","size"]],this._prevMesh,this._mesh,e)},_updateHandler:function(e,t,r){var n=e.getData(),a=this._mesh,i=this,o=-1,s=e.coordinateSystem&&e.coordinateSystem.type==="cartesian3D",l;s&&(l=e.coordinateSystem.model),a.seriesIndex=e.seriesIndex,a.off("mousemove"),a.off("mouseout"),a.on("mousemove",function(u){var c=u.vertexIndex+i._startDataIndex;c!==o&&(this.highlightOnMouseover&&(this.downplay(n,o),this.highlight(n,c),this._labelsBuilder.updateLabels([c])),s&&r.dispatchAction({type:"grid3DShowAxisPointer",value:[n.get(e.coordDimToDataDim("x")[0],c),n.get(e.coordDimToDataDim("y")[0],c),n.get(e.coordDimToDataDim("z")[0],c)],grid3DIndex:l.componentIndex})),a.dataIndex=c,o=c},this),a.on("mouseout",function(u){var c=u.vertexIndex+i._startDataIndex;this.highlightOnMouseover&&(this.downplay(n,c),this._labelsBuilder.updateLabels()),o=-1,a.dataIndex=-1,s&&r.dispatchAction({type:"grid3DHideAxisPointer",grid3DIndex:l.componentIndex})},this)},updateLayout:function(e,t,r){var n=e.getData();if(this._mesh){var a=this._mesh.geometry.attributes.position.value,i=n.getLayout("points");if(this.is2D)for(var o=0;o<i.length/2;o++){var s=o*3,l=o*2;a[s]=i[l],a[s+1]=i[l+1],a[s+2]=X1}else for(var o=0;o<i.length;o++)a[o]=i[o];this._mesh.geometry.dirty(),r.getZr().refresh()}},updateView:function(e){if(this._mesh){var t=new ne;ne.mul(t,e.viewMatrix,this._mesh.worldTransform),ne.mul(t,e.projectionMatrix,t),this._mesh.updateNDCPosition(t,this.is2D,this._api)}},highlight:function(e,t){if(!(t>this._endDataIndex||t<this._startDataIndex)){var r=e.getItemModel(t),n=r.getModel("emphasis.itemStyle"),a=n.get("color"),i=n.get("opacity");if(a==null){var o=Ct(e,t);a=Fl(o,-.4)}i==null&&(i=At(e,t));var s=D.parseColor(a);s[3]*=i,this._mesh.geometry.attributes.color.set(t-this._startDataIndex,s),this._mesh.geometry.dirtyAttribute("color"),this._api.getZr().refresh()}},downplay:function(e,t){if(!(t>this._endDataIndex||t<this._startDataIndex)){var r=Ct(e,t),n=At(e,t),a=D.parseColor(r);a[3]*=n,this._mesh.geometry.attributes.color.set(t-this._startDataIndex,a),this._mesh.geometry.dirtyAttribute("color"),this._api.getZr().refresh()}},fadeOutAll:function(e){if(this._originalOpacity){for(var t=this._mesh.geometry,r=0;r<t.vertexCount;r++){var n=this._originalOpacity[r]*e;t.attributes.color.value[r*4+3]=n}t.dirtyAttribute("color"),this._api.getZr().refresh()}},fadeInAll:function(){this.fadeOutAll(1)},setPositionTexture:function(e){this._mesh&&this._setPositionTextureToMesh(this._mesh,e),this._positionTexture=e},removePositionTexture:function(){this._positionTexture=null,this._mesh&&this._setPositionTextureToMesh(this._mesh,null)},setSizeScale:function(e){if(e!==this._sizeScale){if(this._mesh){var t=this._mesh.material.get("u_Size");this._mesh.material.set("u_Size",t/this._sizeScale*e);var r=this._mesh.geometry.attributes;if(r.size.value)for(var n=0;n<r.size.value.length;n++)r.size.value[n]=r.size.value[n]/this._sizeScale*e}this._sizeScale=e}},_setPositionTextureToMesh:function(e,t){t&&e.material.set("positionTexture",t),e.material[t?"enableTexture":"disableTexture"]("positionTexture")},_getSymbolInfo:function(e,t,r){if(e.get("large")){var n=Se.firstNotNull(e.get("symbolSize"),1),s,i;return n instanceof Array?(s=Math.max(n[0],n[1]),i=n[0]/n[1]):(s=n,i=1),{maxSize:n,type:e.get("symbol"),aspect:i}}for(var a=e.getData(),i,o=a.getItemVisual(0,"symbol")||"circle",s=0,l=t;l<r;l++){var n=a.getItemVisual(l,"symbolSize"),u=a.getItemVisual(l,"symbol"),c;if(n instanceof Array)c=n[0]/n[1],s=Math.max(Math.max(n[0],n[1]),s);else{if(isNaN(n))continue;c=1,s=Math.max(n,s)}o=u,i=c}return{maxSize:s,type:o,aspect:i}}};const zN=He.extend({type:"scatter3D",hasSymbolVisual:!0,__ecgl__:!0,init:function(e,t){this.groupGL=new D.Node,this._pointsBuilderList=[],this._currentStep=0},render:function(e,t,r){if(this.groupGL.removeAll(),!!e.getData().count()){var n=e.coordinateSystem;if(n&&n.viewGL){n.viewGL.add(this.groupGL),this._camera=n.viewGL.camera;var a=this._pointsBuilderList[0];a||(a=this._pointsBuilderList[0]=new ya(!1,r)),this._pointsBuilderList.length=1,this.groupGL.add(a.rootNode),a.update(e,t,r),a.updateView(n.viewGL.camera)}}},incrementalPrepareRender:function(e,t,r){var n=e.coordinateSystem;n&&n.viewGL&&(n.viewGL.add(this.groupGL),this._camera=n.viewGL.camera),this.groupGL.removeAll(),this._currentStep=0},incrementalRender:function(e,t,r,n){if(!(e.end<=e.start)){var a=this._pointsBuilderList[this._currentStep];a||(a=new ya(!1,n),this._pointsBuilderList[this._currentStep]=a),this.groupGL.add(a.rootNode),a.update(t,r,n,e.start,e.end),a.updateView(t.coordinateSystem.viewGL.camera),this._currentStep++}},updateCamera:function(){this._pointsBuilderList.forEach(function(e){e.updateView(this._camera)},this)},highlight:function(e,t,r,n){this._toggleStatus("highlight",e,t,r,n)},downplay:function(e,t,r,n){this._toggleStatus("downplay",e,t,r,n)},_toggleStatus:function(e,t,r,n,a){var i=t.getData(),o=Se.queryDataIndex(i,a),s=e==="highlight";o!=null?R(mi.normalizeToArray(o),function(l){for(var u=0;u<this._pointsBuilderList.length;u++){var c=this._pointsBuilderList[u];s?c.highlight(i,l):c.downplay(i,l)}},this):i.each(function(l){for(var u=0;u<this._pointsBuilderList.length;u++){var c=this._pointsBuilderList[u];s?c.highlight(i,l):c.downplay(i,l)}})},dispose:function(){this._pointsBuilderList.forEach(function(e){e.dispose()}),this.groupGL.removeAll()},remove:function(){this.groupGL.removeAll()}});function GN(e){e.registerChartView(zN),e.registerSeriesModel(MN),e.registerLayout({seriesType:"scatter3D",reset:function(t){var r=t.coordinateSystem;if(r){var n=r.dimensions;if(n.length<3)return;var a=n.map(function(s){return t.coordDimToDataDim(s)[0]}),i=[],o=[];return{progress:function(s,l){for(var u=new Float32Array((s.end-s.start)*3),c=s.start;c<s.end;c++){var h=(c-s.start)*3;i[0]=l.get(a[0],c),i[1]=l.get(a[1],c),i[2]=l.get(a[2],c),r.dataToPoint(i,o),u[h]=o[0],u[h+1]=o[1],u[h+2]=o[2]}l.setLayout("points",u)}}}}})}oe(GN);var mt=lt.vec3,j1=lt.vec2,Kr=mt.normalize,xs=mt.cross,Z1=mt.sub,Gc=mt.add,An=mt.create,mn=An(),vr=An(),yn=An(),Gi=An(),Y1=[],q1=[];function VN(e,t){j1.copy(Y1,e[0]),j1.copy(q1,e[1]);var r=[],n=r[0]=An(),a=r[1]=An(),i=r[2]=An(),o=r[3]=An();t.dataToPoint(Y1,n),t.dataToPoint(q1,o),Kr(mn,n),Z1(vr,o,n),Kr(vr,vr),xs(yn,vr,mn),Kr(yn,yn),xs(vr,mn,yn),Gc(a,mn,vr),Kr(a,a),Kr(mn,o),Z1(vr,n,o),Kr(vr,vr),xs(yn,vr,mn),Kr(yn,yn),xs(vr,mn,yn),Gc(i,mn,vr),Kr(i,i),Gc(Gi,n,o),Kr(Gi,Gi);var s=mt.dot(n,Gi),l=mt.dot(Gi,a),u=(Math.max(mt.len(n),mt.len(o))-s)/l*2;return mt.scaleAndAdd(a,n,a,u),mt.scaleAndAdd(i,o,i,u),r}function UN(e,t,r){var n=[],a=n[0]=mt.create(),i=n[1]=mt.create(),o=n[2]=mt.create(),s=n[3]=mt.create();t.dataToPoint(e[0],a),t.dataToPoint(e[1],s);var l=mt.dist(a,s);return mt.lerp(i,a,s,.3),mt.lerp(o,a,s,.3),mt.scaleAndAdd(i,i,r,Math.min(l*.1,10)),mt.scaleAndAdd(o,o,r,Math.min(l*.1,10)),n}function t2(e,t){for(var r=new Float32Array(e.length*3),n=0,a=[],i=0;i<e.length;i++)t.dataToPoint(e[i],a),r[n++]=a[0],r[n++]=a[1],r[n++]=a[2];return r}function r2(e){var t=[];return e.each(function(r){var n=e.getItemModel(r),a=n.option instanceof Array?n.option:n.getShallow("coords",!0);t.push(a)}),{coordsList:t}}function kN(e,t){var r=e.getData(),n=e.get("polyline");r.setLayout("lineType",n?"polyline":"cubicBezier");var a=r2(r);r.each(function(i){var o=a.coordsList[i],s=n?t2:VN;r.setItemLayout(i,s(o,t))})}function K1(e,t,r){var n=e.getData(),a=e.get("polyline"),i=r2(n);n.setLayout("lineType",a?"polyline":"cubicBezier"),n.each(function(o){var s=i.coordsList[o],l=a?t2(s,t):UN(s,t,r);n.setItemLayout(o,l)})}function HN(e,t){e.eachSeriesByType("lines3D",function(r){var n=r.coordinateSystem;n.type==="globe"?kN(r,n):n.type==="geo3D"?K1(r,n,[0,1,0]):(n.type==="mapbox3D"||n.type==="maptalks3D")&&K1(r,n,[0,0,1])})}const WN=$e.extend({type:"series.lines3D",dependencies:["globe"],visualStyleAccessPath:"lineStyle",visualDrawType:"stroke",getInitialData:function(e,t){var r=new it(["value"],this);return r.hasItemOption=!1,r.initData(e.data,[],function(n,a,i,o){if(n instanceof Array)return NaN;r.hasItemOption=!0;var s=n.value;if(s!=null)return s instanceof Array?s[o]:s}),r},defaultOption:{coordinateSystem:"globe",globeIndex:0,geo3DIndex:0,zlevel:-10,polyline:!1,effect:{show:!1,period:4,trailWidth:4,trailLength:.2,spotIntensity:6},silent:!0,blendMode:"source-over",lineStyle:{width:1,opacity:.5}}}),$N=`@export ecgl.trail2.vertex
attribute vec3 position: POSITION;
attribute vec3 positionPrev;
attribute vec3 positionNext;
attribute float offset;
attribute float dist;
attribute float distAll;
attribute float start;

attribute vec4 a_Color : COLOR;

uniform mat4 worldViewProjection : WORLDVIEWPROJECTION;
uniform vec4 viewport : VIEWPORT;
uniform float near : NEAR;

uniform float speed : 0;
uniform float trailLength: 0.3;
uniform float time;
uniform float period: 1000;

uniform float spotSize: 1;

varying vec4 v_Color;
varying float v_Percent;
varying float v_SpotPercent;

@import ecgl.common.wireframe.vertexHeader

@import ecgl.lines3D.clipNear

void main()
{
 @import ecgl.lines3D.expandLine

 gl_Position = currProj;

 v_Color = a_Color;

 @import ecgl.common.wireframe.vertexMain

#ifdef CONSTANT_SPEED
 float t = mod((speed * time + start) / distAll, 1. + trailLength) - trailLength;
#else
 float t = mod((time + start) / period, 1. + trailLength) - trailLength;
#endif

 float trailLen = distAll * trailLength;

 v_Percent = (dist - t * distAll) / trailLen;

 v_SpotPercent = spotSize / distAll;

 }
@end


@export ecgl.trail2.fragment

uniform vec4 color : [1.0, 1.0, 1.0, 1.0];
uniform float spotIntensity: 5;

varying vec4 v_Color;
varying float v_Percent;
varying float v_SpotPercent;

@import ecgl.common.wireframe.fragmentHeader

@import clay.util.srgb

void main()
{
 if (v_Percent > 1.0 || v_Percent < 0.0) {
 discard;
 }

 float fade = v_Percent;

#ifdef SRGB_DECODE
 gl_FragColor = sRGBToLinear(color * v_Color);
#else
 gl_FragColor = color * v_Color;
#endif

 @import ecgl.common.wireframe.fragmentMain

 if (v_Percent > (1.0 - v_SpotPercent)) {
 gl_FragColor.rgb *= spotIntensity;
 }

 gl_FragColor.a *= fade;
}

@end`;var J1=lt.vec3;function XN(e){return e>0?1:-1}D.Shader.import($N);const jN=D.Mesh.extend(function(){var e=new D.Material({shader:new D.Shader(D.Shader.source("ecgl.trail2.vertex"),D.Shader.source("ecgl.trail2.fragment")),transparent:!0,depthMask:!1}),t=new Sa({dynamic:!0});return t.createAttribute("dist","float",1),t.createAttribute("distAll","float",1),t.createAttribute("start","float",1),{geometry:t,material:e,culling:!1,$ignorePicking:!0}},{updateData:function(e,t,r){var n=e.hostModel,a=this.geometry,i=n.getModel("effect"),o=i.get("trailWidth")*t.getDevicePixelRatio(),s=i.get("trailLength"),l=n.get("effect.constantSpeed"),u=n.get("effect.period")*1e3,c=l!=null;c?this.material.set("speed",l/1e3):this.material.set("period",u),this.material[c?"define":"undefine"]("vertex","CONSTANT_SPEED");var h=n.get("polyline");a.trailLength=s,this.material.set("trailLength",s),a.resetOffset(),["position","positionPrev","positionNext"].forEach(function(b){a.attributes[b].value=r.attributes[b].value});var f=["dist","distAll","start","offset","color"];f.forEach(function(b){a.attributes[b].init(a.vertexCount)}),a.indices=r.indices;var d=[],v=i.get("trailColor"),p=i.get("trailOpacity"),g=v!=null,m=p!=null;this.updateWorldTransform();var _=this.worldTransform.x.len(),y=this.worldTransform.y.len(),x=this.worldTransform.z.len(),S=0,T=0;e.each(function(b){var w=e.getItemLayout(b),A=m?p:At(e,b),E=Ct(e,b);A==null&&(A=1),d=D.parseColor(g?v:E,d),d[3]*=A;for(var C=h?r.getPolylineVertexCount(w):r.getCubicCurveVertexCount(w[0],w[1],w[2],w[3]),M=0,P=[],L=[],I=S;I<S+C;I++)a.attributes.position.get(I,P),P[0]*=_,P[1]*=y,P[2]*=x,I>S&&(M+=J1.dist(P,L)),a.attributes.dist.set(I,M),J1.copy(L,P);T=Math.max(T,M);for(var N=Math.random()*(c?M:u),I=S;I<S+C;I++)a.attributes.distAll.set(I,M),a.attributes.start.set(I,N),a.attributes.offset.set(I,XN(r.attributes.offset.get(I))*o/2),a.attributes.color.set(I,d);S+=C}),this.material.set("spotSize",T*.1*s),this.material.set("spotIntensity",i.get("spotIntensity")),a.dirty()},setAnimationTime:function(e){this.material.set("time",e)}});D.Shader.import(eu);function ZN(e){return e.radius!=null?e.radius:e.size!=null?Math.max(e.size[0],e.size[1],e.size[2]):100}const YN=He.extend({type:"lines3D",__ecgl__:!0,init:function(e,t){this.groupGL=new D.Node,this._meshLinesMaterial=new D.Material({shader:D.createShader("ecgl.meshLines3D"),transparent:!0,depthMask:!1}),this._linesMesh=new D.Mesh({geometry:new Sa,material:this._meshLinesMaterial,$ignorePicking:!0}),this._trailMesh=new jN},render:function(e,t,r){this.groupGL.add(this._linesMesh);var n=e.coordinateSystem,a=e.getData();if(n&&n.viewGL){var i=n.viewGL;i.add(this.groupGL),this._updateLines(e,t,r);var o=n.viewGL.isLinearSpace()?"define":"undefine";this._linesMesh.material[o]("fragment","SRGB_DECODE"),this._trailMesh.material[o]("fragment","SRGB_DECODE")}var s=this._trailMesh;if(s.stopAnimation(),e.get("effect.show")){this.groupGL.add(s),s.updateData(a,r,this._linesMesh.geometry),s.__time=s.__time||0;var l=3600*1e3;this._curveEffectsAnimator=s.animate("",{loop:!0}).when(l,{__time:l}).during(function(){s.setAnimationTime(s.__time)}).start()}else this.groupGL.remove(s),this._curveEffectsAnimator=null;this._linesMesh.material.blend=this._trailMesh.material.blend=e.get("blendMode")==="lighter"?D.additiveBlend:null},pauseEffect:function(){this._curveEffectsAnimator&&this._curveEffectsAnimator.pause()},resumeEffect:function(){this._curveEffectsAnimator&&this._curveEffectsAnimator.resume()},toggleEffect:function(){var e=this._curveEffectsAnimator;e&&(e.isPaused()?e.resume():e.pause())},_updateLines:function(e,t,r){var n=e.getData(),a=e.coordinateSystem,i=this._linesMesh.geometry,o=e.get("polyline");i.expandLine=!0;var s=ZN(a);i.segmentScale=s/20;var l="lineStyle.width".split("."),u=r.getDevicePixelRatio();n.each(function(d){var v=n.getItemModel(d),p=v.get(l);p==null&&(p=1),n.setItemVisual(d,"lineWidth",p)}),i.useNativeLine=!1;var c=0,h=0;n.each(function(d){var v=n.getItemLayout(d);o?(c+=i.getPolylineVertexCount(v),h+=i.getPolylineTriangleCount(v)):(c+=i.getCubicCurveVertexCount(v[0],v[1],v[2],v[3]),h+=i.getCubicCurveTriangleCount(v[0],v[1],v[2],v[3]))}),i.setVertexCount(c),i.setTriangleCount(h),i.resetOffset();var f=[];n.each(function(d){var v=n.getItemLayout(d),p=Ct(n,d),g=At(n,d),m=n.getItemVisual(d,"lineWidth")*u;g==null&&(g=1),f=D.parseColor(p,f),f[3]*=g,o?i.addPolyline(v,f,m):i.addCubicCurve(v[0],v[1],v[2],v[3],f,m)}),i.dirty()},remove:function(){this.groupGL.removeAll()},dispose:function(){this.groupGL.removeAll()}});function qN(e){e.registerChartView(YN),e.registerSeriesModel(WN),e.registerLayout(HN),e.registerAction({type:"lines3DPauseEffect",event:"lines3deffectpaused",update:"series.lines3D:pauseEffect"},function(){}),e.registerAction({type:"lines3DResumeEffect",event:"lines3deffectresumed",update:"series.lines3D:resumeEffect"},function(){}),e.registerAction({type:"lines3DToggleEffect",event:"lines3deffectchanged",update:"series.lines3D:toggleEffect"},function(){})}oe(qN);function Q1(e,t){for(var r=[],n=0;n<t.length;n++)r.push(e.dataToPoint(t[n]));return r}var n2=$e.extend({type:"series.polygons3D",getRegionModel:function(e){return this.getData().getItemModel(e)},getRegionPolygonCoords:function(e){var t=this.coordinateSystem,r=this.getData().getItemModel(e),n=r.option instanceof Array?r.option:r.getShallow("coords");r.get("multiPolygon")||(n=[n]);for(var a=[],i=0;i<n.length;i++){for(var o=[],s=1;s<n[i].length;s++)o.push(Q1(t,n[i][s]));a.push({exterior:Q1(t,n[i][0]),interiors:o})}return a},getInitialData:function(e){var t=new it(["value"],this);return t.hasItemOption=!1,t.initData(e.data,[],function(r,n,a,i){if(r instanceof Array)return NaN;t.hasItemOption=!0;var o=r.value;if(o!=null)return o instanceof Array?o[i]:o}),t},defaultOption:{show:!0,data:null,multiPolygon:!1,progressiveThreshold:1e3,progressive:1e3,zlevel:-10,label:{show:!1,distance:2,textStyle:{fontSize:20,color:"#000",backgroundColor:"rgba(255,255,255,0.7)",padding:3,borderRadius:4}},itemStyle:{color:"#fff",borderWidth:0,borderColor:"#333"},emphasis:{itemStyle:{color:"#639fc0"},label:{show:!0}}}});fe(n2.prototype,pi);const KN=n2,JN=He.extend({type:"polygons3D",__ecgl__:!0,init:function(e,t){this.groupGL=new D.Node,this._geo3DBuilderList=[],this._currentStep=0},render:function(e,t,r){this.groupGL.removeAll();var n=e.coordinateSystem;n&&n.viewGL&&n.viewGL.add(this.groupGL);var a=this._geo3DBuilderList[0];a||(a=new oi(r),a.extrudeY=n.type!=="mapbox3D"&&n.type!=="maptalks3D",this._geo3DBuilderList[0]=a),this._updateShaderDefines(n,a),a.update(e,t,r),this._geo3DBuilderList.length=1,this.groupGL.add(a.rootNode)},incrementalPrepareRender:function(e,t,r){this.groupGL.removeAll();var n=e.coordinateSystem;n&&n.viewGL&&n.viewGL.add(this.groupGL),this._currentStep=0},incrementalRender:function(e,t,r,n){var a=this._geo3DBuilderList[this._currentStep],i=t.coordinateSystem;a||(a=new oi(n),a.extrudeY=i.type!=="mapbox3D"&&i.type!=="maptalks3D",this._geo3DBuilderList[this._currentStep]=a),a.update(t,r,n,e.start,e.end),this.groupGL.add(a.rootNode),this._updateShaderDefines(i,a),this._currentStep++},_updateShaderDefines:function(e,t){var r=e.viewGL.isLinearSpace()?"define":"undefine";t.rootNode.traverse(function(n){n.material&&(n.material[r]("fragment","SRGB_DECODE"),(e.type==="mapbox3D"||e.type==="maptalks3D")&&(n.material.define("fragment","NORMAL_UP_AXIS",2),n.material.define("fragment","NORMAL_FRONT_AXIS",1)))})},remove:function(){this.groupGL.removeAll()},dispose:function(){this.groupGL.removeAll(),this._geo3DBuilderList.forEach(function(e){e.dispose()})}});function QN(e){e.registerChartView(JN),e.registerSeriesModel(KN)}oe(QN);var a2=$e.extend({type:"series.surface",dependencies:["globe","grid3D","geo3D"],visualStyleAccessPath:"itemStyle",formatTooltip:function(e){return Uo(this,e)},getInitialData:function(e,t){var r=e.data;function n(F){return!(isNaN(F.min)||isNaN(F.max)||isNaN(F.step))}function a(F){var B=Hm;return Math.max(B(F.min),B(F.max),B(F.step))+1}if(!r)if(e.parametric){var x=e.parametricEquation||{},S=x.u||{},T=x.v||{};["u","v"].forEach(function(B){n(x[B])}),["x","y","z"].forEach(function(B){x[B]});var b=Math.floor((S.max+S.step-S.min)/S.step),w=Math.floor((T.max+T.step-T.min)/T.step);r=new Float32Array(b*w*5);for(var A=a(S),E=a(T),f=0,d=0;d<w;d++)for(var v=0;v<b;v++){var C=v*S.step+S.min,M=d*T.step+T.min,P=na(Math.min(C,S.max),A),L=na(Math.min(M,T.max),E),p=x.x(P,L),g=x.y(P,L),y=x.z(P,L);r[f++]=p,r[f++]=g,r[f++]=y,r[f++]=P,r[f++]=L}}else{var i=e.equation||{},o=i.x||{},s=i.y||{};if(["x","y"].forEach(function(F){n(i[F])}),typeof i.z!="function")return;var l=Math.floor((o.max+o.step-o.min)/o.step),u=Math.floor((s.max+s.step-s.min)/s.step);r=new Float32Array(l*u*3);for(var c=a(o),h=a(s),f=0,d=0;d<u;d++)for(var v=0;v<l;v++){var p=v*o.step+o.min,g=d*s.step+s.min,m=na(Math.min(p,o.max),c),_=na(Math.min(g,s.max),h),y=i.z(m,_);r[f++]=m,r[f++]=_,r[f++]=y}}var I=["x","y","z"];e.parametric&&I.push("u","v");var N=tu(this,I,r);return N},defaultOption:{coordinateSystem:"cartesian3D",zlevel:-10,grid3DIndex:0,shading:"lambert",parametric:!1,wireframe:{show:!0,lineStyle:{color:"rgba(0,0,0,0.5)",width:1}},equation:{x:{min:-1,max:1,step:.1},y:{min:-1,max:1,step:.1},z:null},parametricEquation:{u:{min:-1,max:1,step:.1},v:{min:-1,max:1,step:.1},x:null,y:null,z:null},dataShape:null,itemStyle:{},animationDurationUpdate:500}});fe(a2.prototype,pi);const e7=a2;var Zn=lt.vec3;function t7(e){return isNaN(e[0])||isNaN(e[1])||isNaN(e[2])}const r7=He.extend({type:"surface",__ecgl__:!0,init:function(e,t){this.groupGL=new D.Node},render:function(e,t,r){var n=this._prevSurfaceMesh;this._prevSurfaceMesh=this._surfaceMesh,this._surfaceMesh=n,this._surfaceMesh||(this._surfaceMesh=this._createSurfaceMesh()),this.groupGL.remove(this._prevSurfaceMesh),this.groupGL.add(this._surfaceMesh);var a=e.coordinateSystem,i=e.get("shading"),o=e.getData(),s="ecgl."+i;if((!this._surfaceMesh.material||this._surfaceMesh.material.shader.name!==s)&&(this._surfaceMesh.material=D.createMaterial(s,["VERTEX_COLOR","DOUBLE_SIDED"])),D.setMaterialFromModel(i,this._surfaceMesh.material,e,r),a&&a.viewGL){a.viewGL.add(this.groupGL);var l=a.viewGL.isLinearSpace()?"define":"undefine";this._surfaceMesh.material[l]("fragment","SRGB_DECODE")}var u=e.get("parametric"),c=e.get("dataShape");c||(c=this._getDataShape(o,u));var h=e.getModel("wireframe"),f=h.get("lineStyle.width"),d=h.get("show")&&f>0;this._updateSurfaceMesh(this._surfaceMesh,e,c,d);var v=this._surfaceMesh.material;d?(v.define("WIREFRAME_QUAD"),v.set("wireframeLineWidth",f),v.set("wireframeLineColor",D.parseColor(h.get("lineStyle.color")))):v.undefine("WIREFRAME_QUAD"),this._initHandler(e,r),this._updateAnimation(e)},_updateAnimation:function(e){D.updateVertexAnimation([["prevPosition","position"],["prevNormal","normal"]],this._prevSurfaceMesh,this._surfaceMesh,e)},_createSurfaceMesh:function(){var e=new D.Mesh({geometry:new D.Geometry({dynamic:!0,sortTriangles:!0}),shadowDepthMaterial:new D.Material({shader:new D.Shader(D.Shader.source("ecgl.sm.depth.vertex"),D.Shader.source("ecgl.sm.depth.fragment"))}),culling:!1,renderOrder:10,renderNormal:!0});return e.geometry.createAttribute("barycentric","float",4),e.geometry.createAttribute("prevPosition","float",3),e.geometry.createAttribute("prevNormal","float",3),Object.assign(e.geometry,md),e},_initHandler:function(e,t){var r=e.getData(),n=this._surfaceMesh,a=e.coordinateSystem;function i(s,l){for(var u=1/0,c=-1,h=[],f=0;f<s.length;f++){n.geometry.attributes.position.get(s[f],h);var d=Zn.dist(l.array,h);d<u&&(u=d,c=s[f])}return c}n.seriesIndex=e.seriesIndex;var o=-1;n.off("mousemove"),n.off("mouseout"),n.on("mousemove",function(s){var l=i(s.triangle,s.point);if(l>=0){var u=[];n.geometry.attributes.position.get(l,u);for(var c=a.pointToData(u),h=1/0,f=-1,d=[],v=0;v<r.count();v++){d[0]=r.get("x",v),d[1]=r.get("y",v),d[2]=r.get("z",v);var p=Zn.squaredDistance(d,c);p<h&&(f=v,h=p)}f!==o&&t.dispatchAction({type:"grid3DShowAxisPointer",value:c}),o=f,n.dataIndex=f}else n.dataIndex=-1},this),n.on("mouseout",function(s){o=-1,n.dataIndex=-1,t.dispatchAction({type:"grid3DHideAxisPointer"})},this)},_updateSurfaceMesh:function(e,t,r,n){var a=e.geometry,i=t.getData(),o=i.getLayout("points"),s=0;i.each(function(De){i.hasValue(De)||s++});var l=s||n,u=a.attributes.position,c=a.attributes.normal,h=a.attributes.texcoord0,f=a.attributes.barycentric,d=a.attributes.color,v=r[0],p=r[1],g=t.get("shading"),m=g!=="color";if(l){var _=(v-1)*(p-1)*4;u.init(_),n&&f.init(_)}else u.value=new Float32Array(o);d.init(a.vertexCount),h.init(a.vertexCount);var y=[0,3,1,1,3,2],x=[[1,1,0,0],[0,1,0,1],[1,0,0,1],[1,0,1,0]],S=a.indices=new(a.vertexCount>65535?Uint32Array:Uint16Array)((v-1)*(p-1)*6),T=function(De,Re,Be){Be[1]=De*p+Re,Be[0]=De*p+Re+1,Be[3]=(De+1)*p+Re+1,Be[2]=(De+1)*p+Re},b=!1;if(l){var w=[],A=[],E=0;m?c.init(a.vertexCount):c.value=null;for(var C=[[],[],[]],M=[],P=[],L=Zn.create(),I=function(De,Re,Be){var Dt=Re*3;return Be[0]=De[Dt],Be[1]=De[Dt+1],Be[2]=De[Dt+2],Be},N=new Float32Array(o.length),F=new Float32Array(o.length/3*4),B=0;B<i.count();B++)if(i.hasValue(B)){var de=D.parseColor(Ct(i,B)),k=At(i,B);k!=null&&(de[3]*=k),de[3]<.99&&(b=!0);for(var z=0;z<4;z++)F[B*4+z]=de[z]}for(var W=[1e7,1e7,1e7],B=0;B<v-1;B++)for(var J=0;J<p-1;J++){var re=B*(p-1)+J,Q=re*4;T(B,J,w);for(var q=!1,z=0;z<4;z++)I(o,w[z],A),t7(A)&&(q=!0);for(var z=0;z<4;z++)q?u.set(Q+z,W):(I(o,w[z],A),u.set(Q+z,A)),n&&f.set(Q+z,x[z]);for(var z=0;z<6;z++)S[E++]=y[z]+Q;if(m&&!q)for(var z=0;z<2;z++){for(var Ee=z*3,ae=0;ae<3;ae++){var j=w[y[Ee]+ae];I(o,j,C[ae])}Zn.sub(M,C[0],C[1]),Zn.sub(P,C[1],C[2]),Zn.cross(L,M,P);for(var ae=0;ae<3;ae++){var pe=w[y[Ee]+ae]*3;N[pe]=N[pe]+L[0],N[pe+1]=N[pe+1]+L[1],N[pe+2]=N[pe+2]+L[2]}}}if(m)for(var B=0;B<N.length/3;B++)I(N,B,L),Zn.normalize(L,L),N[B*3]=L[0],N[B*3+1]=L[1],N[B*3+2]=L[2];for(var de=[],ge=[],B=0;B<v-1;B++)for(var J=0;J<p-1;J++){var re=B*(p-1)+J,Q=re*4;T(B,J,w);for(var z=0;z<4;z++){for(var ae=0;ae<4;ae++)de[ae]=F[w[z]*4+ae];d.set(Q+z,de),m&&(I(N,w[z],L),c.set(Q+z,L));var j=w[z];ge[0]=j%p/(p-1),ge[1]=Math.floor(j/p)/(v-1),h.set(Q+z,ge)}re++}}else{for(var ge=[],B=0;B<i.count();B++){ge[0]=B%p/(p-1),ge[1]=Math.floor(B/p)/(v-1);var de=D.parseColor(Ct(i,B)),k=At(i,B);k!=null&&(de[3]*=k),de[3]<.99&&(b=!0),d.set(B,de),h.set(B,ge)}for(var w=[],nt=0,B=0;B<v-1;B++)for(var J=0;J<p-1;J++){T(B,J,w);for(var z=0;z<6;z++)S[nt++]=w[y[z]]}m?a.generateVertexNormals():c.value=null}e.material.get("normalMap")&&a.generateTangents(),a.updateBoundingBox(),a.dirty(),e.material.transparent=b,e.material.depthMask=!b},_getDataShape:function(e,t){for(var r=-1/0,n=0,a=0,i=!1,o=t?"u":"x",s=e.count(),l=0;l<s;l++){var u=e.get(o,l);u<r&&(a=0,n++),r=u,a++}if((!n||a===1)&&(i=!0),!i)return[n+1,a];for(var c=Math.floor(Math.sqrt(s));c>0;){if(Math.floor(s/c)===s/c)return[c,s/c];c--}return c=Math.floor(Math.sqrt(s)),[c,c]},dispose:function(){this.groupGL.removeAll()},remove:function(){this.groupGL.removeAll()}});function n7(e){e.registerChartView(r7),e.registerSeriesModel(e7),e.registerLayout(function(t,r){t.eachSeriesByType("surface",function(n){var a=n.coordinateSystem;!a||a.type;var i=n.getData(),o=new Float32Array(3*i.count()),s=[NaN,NaN,NaN];if(a&&a.type==="cartesian3D"){var l=a.dimensions,u=l.map(function(c){return n.coordDimToDataDim(c)[0]});i.each(u,function(c,h,f,d){var v;i.hasValue(d)?v=a.dataToPoint([c,h,f]):v=s,o[d*3]=v[0],o[d*3+1]=v[1],o[d*3+2]=v[2]})}i.setLayout("points",o)})})}oe(n7);function e0(e,t){for(var r=[],n=0;n<t.length;n++)r.push(e.dataToPoint(t[n]));return r}var yi=$e.extend({type:"series.map3D",layoutMode:"box",coordinateSystem:null,visualStyleAccessPath:"itemStyle",optionUpdated:function(e){var t=this.get("coordinateSystem");t==null||t==="geo3D"||(this.get("groundPlane.show")&&(this.option.groundPlane.show=!1),this._geo=null)},getInitialData:function(e){e.data=this.getFilledRegions(e.data,e.map);var t=Fo(e.data,{coordDimensions:["value"]}),r=new it(t,this);r.initData(e.data);var n={};return r.each(function(a){var i=r.getName(a),o=r.getItemModel(a);n[i]=o}),this._regionModelMap=n,r},formatTooltip:function(e){return Uo(this,e)},getRegionModel:function(e){var t=this.getData().getName(e);return this._regionModelMap[t]||new Ft(null,this)},getRegionPolygonCoords:function(e){var t=this.coordinateSystem,r=this.getData().getName(e);if(t.transform){var n=t.getRegion(r);return n?n.geometries:[]}else{this._geo||(this._geo=Hx.createGeo3D(this));for(var n=this._geo.getRegion(r),a=[],i=0;i<n.geometries.length;i++){var o=n.geometries[i],s=[],l=e0(t,o.exterior);if(s&&s.length)for(var u=0;u<o.interiors.length;u++)s.push(e0(t,s[u]));a.push({interiors:s,exterior:l})}return a}},getFormattedLabel:function(e,t){var r=mi.getFormattedLabel(this,e,t);return r==null&&(r=this.getData().getName(e)),r},defaultOption:{coordinateSystem:"geo3D",data:null}});fe(yi.prototype,Nx);fe(yi.prototype,ql);fe(yi.prototype,fi);fe(yi.prototype,di);fe(yi.prototype,pi);const a7=yi,i7=He.extend({type:"map3D",__ecgl__:!0,init:function(e,t){this._geo3DBuilder=new oi(t),this.groupGL=new D.Node},render:function(e,t,r){var n=e.coordinateSystem;if(!(!n||!n.viewGL)){if(this.groupGL.add(this._geo3DBuilder.rootNode),n.viewGL.add(this.groupGL),n.type==="geo3D"){this._sceneHelper||(this._sceneHelper=new Rn,this._sceneHelper.initLight(this.groupGL)),this._sceneHelper.setScene(n.viewGL.scene),this._sceneHelper.updateLight(e),n.viewGL.setPostEffect(e.getModel("postEffect"),r),n.viewGL.setTemporalSuperSampling(e.getModel("temporalSuperSampling"));var a=this._control;a||(a=this._control=new Jl({zr:r.getZr()}),this._control.init());var i=e.getModel("viewControl");a.setViewGL(n.viewGL),a.setFromViewControlModel(i,0),a.off("update"),a.on("update",function(){r.dispatchAction({type:"map3DChangeCamera",alpha:a.getAlpha(),beta:a.getBeta(),distance:a.getDistance(),from:this.uid,map3DId:e.id})}),this._geo3DBuilder.extrudeY=!0}else this._control&&(this._control.dispose(),this._control=null),this._sceneHelper&&(this._sceneHelper.dispose(),this._sceneHelper=null),e.getData().getLayout("geo3D"),this._geo3DBuilder.extrudeY=!1;this._geo3DBuilder.update(e,t,r,0,e.getData().count());var o=n.viewGL.isLinearSpace()?"define":"undefine";this._geo3DBuilder.rootNode.traverse(function(s){s.material&&s.material[o]("fragment","SRGB_DECODE")})}},afterRender:function(e,t,r,n){var a=n.renderer,i=e.coordinateSystem;i&&i.type==="geo3D"&&(this._sceneHelper.updateAmbientCubemap(a,e,r),this._sceneHelper.updateSkybox(a,e,r))},dispose:function(){this.groupGL.removeAll(),this._control.dispose(),this._geo3DBuilder.dispose()}});function o7(e){Wx(e),e.registerChartView(i7),e.registerSeriesModel(a7),e.registerAction({type:"map3DChangeCamera",event:"map3dcamerachanged",update:"series:updateCamera"},function(t,r){r.eachComponent({mainType:"series",subType:"map3D",query:t},function(n){n.setView(t)})})}oe(o7);const s7=$e.extend({type:"series.scatterGL",dependencies:["grid","polar","geo","singleAxis"],visualStyleAccessPath:"itemStyle",hasSymbolVisual:!0,getInitialData:function(){return H3(this)},defaultOption:{coordinateSystem:"cartesian2d",zlevel:10,progressive:1e5,progressiveThreshold:1e5,large:!1,symbol:"circle",symbolSize:10,zoomScale:0,blendMode:"source-over",itemStyle:{opacity:.8},postEffect:{enable:!1,colorCorrection:{exposure:0,brightness:0,contrast:1,saturation:1,enable:!0}}}});function dn(e){this.viewGL=e}dn.prototype.reset=function(e,t){this._updateCamera(t.getWidth(),t.getHeight(),t.getDevicePixelRatio()),this._viewTransform=Po(),this.updateTransform(e,t)};dn.prototype.updateTransform=function(e,t){var r=e.coordinateSystem;r.getRoamTransform&&(z3(this._viewTransform,r.getRoamTransform()),this._setCameraTransform(this._viewTransform),t.getZr().refresh())};dn.prototype.dataToPoint=function(e,t,r){r=e.dataToPoint(t,null,r);var n=this._viewTransform;n&&jm(r,r,n)};dn.prototype.removeTransformInPoint=function(e){return this._viewTransform&&jm(e,e,this._viewTransform),e};dn.prototype.getZoom=function(){if(this._viewTransform){var e=this._viewTransform;return 1/Math.max(Math.sqrt(e[0]*e[0]+e[1]*e[1]),Math.sqrt(e[2]*e[2]+e[3]*e[3]))}return 1};dn.prototype._setCameraTransform=function(e){var t=this.viewGL.camera;t.position.set(e[4],e[5],0),t.scale.set(Math.sqrt(e[0]*e[0]+e[1]*e[1]),Math.sqrt(e[2]*e[2]+e[3]*e[3]),1)};dn.prototype._updateCamera=function(e,t,r){this.viewGL.setViewport(0,0,e,t,r);var n=this.viewGL.camera;n.left=n.top=0,n.bottom=t,n.right=e,n.near=0,n.far=100};const l7=He.extend({type:"scatterGL",__ecgl__:!0,init:function(e,t){this.groupGL=new D.Node,this.viewGL=new Oe("orthographic"),this.viewGL.add(this.groupGL),this._pointsBuilderList=[],this._currentStep=0,this._sizeScale=1,this._glViewHelper=new dn(this.viewGL)},render:function(e,t,r){if(this.groupGL.removeAll(),this._glViewHelper.reset(e,r),!!e.getData().count()){var n=this._pointsBuilderList[0];n||(n=this._pointsBuilderList[0]=new ya(!0,r)),this._pointsBuilderList.length=1,this.groupGL.add(n.rootNode),this._removeTransformInPoints(e.getData().getLayout("points")),n.update(e,t,r),this.viewGL.setPostEffect(e.getModel("postEffect"),r)}},incrementalPrepareRender:function(e,t,r){this.groupGL.removeAll(),this._glViewHelper.reset(e,r),this._currentStep=0,this.viewGL.setPostEffect(e.getModel("postEffect"),r)},incrementalRender:function(e,t,r,n){if(!(e.end<=e.start)){var a=this._pointsBuilderList[this._currentStep];a||(a=new ya(!0,n),this._pointsBuilderList[this._currentStep]=a),this.groupGL.add(a.rootNode),this._removeTransformInPoints(t.getData().getLayout("points")),a.setSizeScale(this._sizeScale),a.update(t,r,n,e.start,e.end),n.getZr().refresh(),this._currentStep++}},updateTransform:function(e,t,r){if(e.coordinateSystem.getRoamTransform){this._glViewHelper.updateTransform(e,r);var n=this._glViewHelper.getZoom(),a=Math.max((e.get("zoomScale")||0)*(n-1)+1,0);this._sizeScale=a,this._pointsBuilderList.forEach(function(i){i.setSizeScale(a)})}},_removeTransformInPoints:function(e){if(e)for(var t=[],r=0;r<e.length;r+=2)t[0]=e[r],t[1]=e[r+1],this._glViewHelper.removeTransformInPoint(t),e[r]=t[0],e[r+1]=t[1]},dispose:function(){this.groupGL.removeAll(),this._pointsBuilderList.forEach(function(e){e.dispose()})},remove:function(){this.groupGL.removeAll()}});function u7(e){e.registerChartView(l7),e.registerSeriesModel(s7),e.registerLayout({seriesType:"scatterGL",reset:function(t){var r=t.coordinateSystem,n=t.getData(),a;if(r){var i=r.dimensions.map(function(s){return n.mapDimension(s)}).slice(0,2),o=[];i.length===1?a=function(s){for(var l=new Float32Array((s.end-s.start)*2),u=s.start;u<s.end;u++){var c=(u-s.start)*2,h=n.get(i[0],u),f=r.dataToPoint(h);l[c]=f[0],l[c+1]=f[1]}n.setLayout("points",l)}:i.length===2&&(a=function(s){for(var l=new Float32Array((s.end-s.start)*2),u=s.start;u<s.end;u++){var c=(u-s.start)*2,h=n.get(i[0],u),f=n.get(i[1],u);o[0]=h,o[1]=f,o=r.dataToPoint(o),l[c]=o[0],l[c+1]=o[1]}n.setLayout("points",l)})}return{progress:a}}})}oe(u7);function c7(e,t,r,n,a){for(var i=new My(n),o=0;o<e.length;o++)i.addNode(Se.firstNotNull(e[o].id,e[o].name,o),o);for(var s=[],l=[],u=0,o=0;o<t.length;o++){var c=t[o],h=c.source,f=c.target;i.addEdge(h,f,u)&&(l.push(c),s.push(Se.firstNotNull(c.id,h+" > "+f)),u++)}var d,v=Fo(e,{coordDimensions:["value"]});d=new it(v,r),d.initData(e);var p=new it(["value"],r);return p.initData(l,s),a&&a(d,p),Tf({mainData:d,struct:i,structAttr:"graph",datas:{node:d,edge:p},datasAttr:{node:"data",edge:"edgeData"}}),i.update(),i}var Ki=$e.extend({type:"series.graphGL",visualStyleAccessPath:"itemStyle",hasSymbolVisual:!0,init:function(e){Ki.superApply(this,"init",arguments),this.legendDataProvider=function(){return this._categoriesData},this._updateCategoriesData()},mergeOption:function(e){Ki.superApply(this,"mergeOption",arguments),this._updateCategoriesData()},getFormattedLabel:function(e,t,r,n){var a=mi.getFormattedLabel(this,e,t,r,n);if(a==null){var i=this.getData(),o=i.dimensions[i.dimensions.length-1];a=i.get(o,e)}return a},getInitialData:function(e,t){var r=e.edges||e.links||[],n=e.data||e.nodes||[],a=this;if(n&&r)return c7(n,r,this,!0,i).data;function i(o,s){o.wrapMethod("getItemModel",function(h){const f=a._categoriesModels,d=h.getShallow("category"),v=f[d];return v&&(v.parentModel=h.parentModel,h.parentModel=v),h});const l=t.getModel([]).getModel;function u(h,f){const d=l.call(this,h,f);return d.resolveParentPath=c,d}s.wrapMethod("getItemModel",function(h){return h.resolveParentPath=c,h.getModel=u,h});function c(h){if(h&&(h[0]==="label"||h[1]==="label")){const f=h.slice();return h[0]==="label"?f[0]="edgeLabel":h[1]==="label"&&(f[1]="edgeLabel"),f}return h}}},getGraph:function(){return this.getData().graph},getEdgeData:function(){return this.getGraph().edgeData},getCategoriesData:function(){return this._categoriesData},formatTooltip:function(e,t,r){if(r==="edge"){var n=this.getData(),a=this.getDataParams(e,r),i=n.graph.getEdgeByIndex(e),o=n.getName(i.node1.dataIndex),s=n.getName(i.node2.dataIndex),l=[];return o!=null&&l.push(o),s!=null&&l.push(s),l=ra(l.join(" > ")),a.value&&(l+=" : "+ra(a.value)),l}else return Ki.superApply(this,"formatTooltip",arguments)},_updateCategoriesData:function(){var e=(this.option.categories||[]).map(function(r){return r.value!=null?r:Object.assign({value:0},r)}),t=new it(["value"],this);t.initData(e),this._categoriesData=t,this._categoriesModels=t.mapArray(function(r){return t.getItemModel(r,!0)})},setView:function(e){e.zoom!=null&&(this.option.zoom=e.zoom),e.offset!=null&&(this.option.offset=e.offset)},setNodePosition:function(e){for(var t=0;t<e.length/2;t++){var r=e[t*2],n=e[t*2+1],a=this.getData().getRawDataItem(t);a.x=r,a.y=n}},isAnimationEnabled:function(){return Ki.superCall(this,"isAnimationEnabled")&&!(this.get("layout")==="force"&&this.get("force.layoutAnimation"))},defaultOption:{zlevel:10,z:2,legendHoverLink:!0,layout:"forceAtlas2",forceAtlas2:{initLayout:null,GPU:!0,steps:1,maxSteps:1e3,repulsionByDegree:!0,linLogMode:!1,strongGravityMode:!1,gravity:1,edgeWeightInfluence:1,edgeWeight:[1,4],nodeWeight:[1,4],preventOverlap:!1,gravityCenter:null},focusNodeAdjacency:!0,focusNodeAdjacencyOn:"mouseover",left:"center",top:"center",symbol:"circle",symbolSize:5,roam:!1,center:null,zoom:1,label:{show:!1,formatter:"{b}",position:"right",distance:5,textStyle:{fontSize:14}},itemStyle:{},lineStyle:{color:"#aaa",width:1,opacity:.5},emphasis:{label:{show:!0}},animation:!1}});const h7=Ki;var gt=lt.vec2,t0=[[0,0],[1,1]],i2=Me.extend(function(){return{segmentScale:4,dynamic:!0,useNativeLine:!0,attributes:{position:new Me.Attribute("position","float",2,"POSITION"),normal:new Me.Attribute("normal","float",2),offset:new Me.Attribute("offset","float",1),color:new Me.Attribute("color","float",4,"COLOR")}}},{resetOffset:function(){this._vertexOffset=0,this._faceOffset=0,this._itemVertexOffsets=[]},setVertexCount:function(e){var t=this.attributes;this.vertexCount!==e&&(t.position.init(e),t.color.init(e),this.useNativeLine||(t.offset.init(e),t.normal.init(e)),e>65535?this.indices instanceof Uint16Array&&(this.indices=new Uint32Array(this.indices)):this.indices instanceof Uint32Array&&(this.indices=new Uint16Array(this.indices)))},setTriangleCount:function(e){this.triangleCount!==e&&(e===0?this.indices=null:this.indices=this.vertexCount>65535?new Uint32Array(e*3):new Uint16Array(e*3))},_getCubicCurveApproxStep:function(e,t,r,n){var a=gt.dist(e,t)+gt.dist(r,t)+gt.dist(n,r),i=1/(a+1)*this.segmentScale;return i},getCubicCurveVertexCount:function(e,t,r,n){var a=this._getCubicCurveApproxStep(e,t,r,n),i=Math.ceil(1/a);return this.useNativeLine?i*2:i*2+2},getCubicCurveTriangleCount:function(e,t,r,n){var a=this._getCubicCurveApproxStep(e,t,r,n),i=Math.ceil(1/a);return this.useNativeLine?0:i*2},getLineVertexCount:function(){return this.getPolylineVertexCount(t0)},getLineTriangleCount:function(){return this.getPolylineTriangleCount(t0)},getPolylineVertexCount:function(e){var t;if(typeof e=="number")t=e;else{var r=typeof e[0]!="number";t=r?e.length:e.length/2}return this.useNativeLine?(t-1)*2:(t-1)*2+2},getPolylineTriangleCount:function(e){var t;if(typeof e=="number")t=e;else{var r=typeof e[0]!="number";t=r?e.length:e.length/2}return this.useNativeLine?0:(t-1)*2},addCubicCurve:function(e,t,r,n,a,i){i==null&&(i=1);for(var o=e[0],s=e[1],l=t[0],u=t[1],c=r[0],h=r[1],f=n[0],d=n[1],v=this._getCubicCurveApproxStep(e,t,r,n),p=v*v,g=p*v,m=3*v,_=3*p,y=6*p,x=6*g,S=o-l*2+c,T=s-u*2+h,b=(l-c)*3-o+f,w=(u-h)*3-s+d,A=o,E=s,C=(l-o)*m+S*_+b*g,M=(u-s)*m+T*_+w*g,P=S*y+b*x,L=T*y+w*x,I=b*x,N=w*x,F=0,B=0,k=Math.ceil(1/v),z=new Float32Array((k+1)*3),z=[],W=0,B=0;B<k+1;B++)z[W++]=A,z[W++]=E,A+=C,E+=M,C+=P,M+=L,P+=I,L+=N,F+=v,F>1&&(A=C>0?Math.min(A,f):Math.max(A,f),E=M>0?Math.min(E,d):Math.max(E,d));this.addPolyline(z,a,i)},addLine:function(e,t,r,n){this.addPolyline([e,t],r,n)},addPolyline:function(){var e=gt.create(),t=gt.create(),r=gt.create(),n=gt.create(),a=[],i=[],o=[];return function(s,l,u,c,h){if(s.length){var f=typeof s[0]!="number";if(h==null&&(h=f?s.length:s.length/2),!(h<2)){c==null&&(c=0),u==null&&(u=1),this._itemVertexOffsets.push(this._vertexOffset);for(var d=f?typeof l[0]!="number":l.length/4===h,v=this.attributes.position,p=this.attributes.color,g=this.attributes.offset,m=this.attributes.normal,_=this.indices,y=this._vertexOffset,x,S=0;S<h;S++){if(f)a=s[S+c],d?x=l[S+c]:x=l;else{var T=S*2+c;if(a=a||[],a[0]=s[T],a[1]=s[T+1],d){var b=S*4+c;x=x||[],x[0]=l[b],x[1]=l[b+1],x[2]=l[b+2],x[3]=l[b+3]}else x=l}if(this.useNativeLine)S>1&&(v.copy(y,y-1),p.copy(y,y-1),y++);else{var w;if(S<h-1){if(f)gt.copy(i,s[S+1]);else{var T=(S+1)*2+c;i=i||[],i[0]=s[T],i[1]=s[T+1]}if(S>0){gt.sub(e,a,o),gt.sub(t,i,a),gt.normalize(e,e),gt.normalize(t,t),gt.add(n,e,t),gt.normalize(n,n);var A=u/2*Math.min(1/gt.dot(e,n),2);r[0]=-n[1],r[1]=n[0],w=A}else gt.sub(e,i,a),gt.normalize(e,e),r[0]=-e[1],r[1]=e[0],w=u/2}else gt.sub(e,a,o),gt.normalize(e,e),r[0]=-e[1],r[1]=e[0],w=u/2;m.set(y,r),m.set(y+1,r),g.set(y,w),g.set(y+1,-w),gt.copy(o,a),v.set(y,a),v.set(y+1,a),p.set(y,x),p.set(y+1,x),y+=2}if(this.useNativeLine)p.set(y,x),v.set(y,a),y++;else if(S>0){var E=this._faceOffset*3,_=this.indices;_[E]=y-4,_[E+1]=y-3,_[E+2]=y-2,_[E+3]=y-3,_[E+4]=y-1,_[E+5]=y-2,this._faceOffset+=2}}this._vertexOffset=y}}}}(),setItemColor:function(e,t){for(var r=this._itemVertexOffsets[e],n=e<this._itemVertexOffsets.length-1?this._itemVertexOffsets[e+1]:this._vertexOffset,a=r;a<n;a++)this.attributes.color.set(a,t);this.dirty("color")}});Te(i2.prototype,Go);const o2=i2,f7=`@export ecgl.forceAtlas2.updateNodeRepulsion

#define NODE_COUNT 0

uniform sampler2D positionTex;

uniform vec2 textureSize;
uniform float gravity;
uniform float scaling;
uniform vec2 gravityCenter;

uniform bool strongGravityMode;
uniform bool preventOverlap;

varying vec2 v_Texcoord;

void main() {

 vec4 n0 = texture2D(positionTex, v_Texcoord);

 vec2 force = vec2(0.0);
 for (int i = 0; i < NODE_COUNT; i++) {
 vec2 uv = vec2(
 mod(float(i), textureSize.x) / (textureSize.x - 1.0),
 floor(float(i) / textureSize.x) / (textureSize.y - 1.0)
 );
 vec4 n1 = texture2D(positionTex, uv);

 vec2 dir = n0.xy - n1.xy;
 float d2 = dot(dir, dir);

 if (d2 > 0.0) {
 float factor = 0.0;
 if (preventOverlap) {
 float d = sqrt(d2);
 d = d - n0.w - n1.w;
 if (d > 0.0) {
 factor = scaling * n0.z * n1.z / (d * d);
 }
 else if (d < 0.0) {
 factor = scaling * 100.0 * n0.z * n1.z;
 }
 }
 else {
 factor = scaling * n0.z * n1.z / d2;
 }
 force += dir * factor;
 }
 }

 vec2 dir = gravityCenter - n0.xy;
 float d = 1.0;
 if (!strongGravityMode) {
 d = length(dir);
 }

 force += dir * n0.z * gravity / (d + 1.0);

 gl_FragColor = vec4(force, 0.0, 1.0);
}
@end

@export ecgl.forceAtlas2.updateEdgeAttraction.vertex

attribute vec2 node1;
attribute vec2 node2;
attribute float weight;

uniform sampler2D positionTex;
uniform float edgeWeightInfluence;
uniform bool preventOverlap;
uniform bool linLogMode;

uniform vec2 windowSize: WINDOW_SIZE;

varying vec2 v_Force;

void main() {

 vec4 n0 = texture2D(positionTex, node1);
 vec4 n1 = texture2D(positionTex, node2);

 vec2 dir = n1.xy - n0.xy;
 float d = length(dir);
 float w;
 if (edgeWeightInfluence == 0.0) {
 w = 1.0;
 }
 else if (edgeWeightInfluence == 1.0) {
 w = weight;
 }
 else {
 w = pow(weight, edgeWeightInfluence);
 }
 vec2 offset = vec2(1.0 / windowSize.x, 1.0 / windowSize.y);
 vec2 scale = vec2((windowSize.x - 1.0) / windowSize.x, (windowSize.y - 1.0) / windowSize.y);
 vec2 pos = node1 * scale * 2.0 - 1.0;
 gl_Position = vec4(pos + offset, 0.0, 1.0);
 gl_PointSize = 1.0;

 float factor;
 if (preventOverlap) {
 d = d - n1.w - n0.w;
 }
 if (d <= 0.0) {
 v_Force = vec2(0.0);
 return;
 }

 if (linLogMode) {
 factor = w * log(d) / d;
 }
 else {
 factor = w;
 }
 v_Force = dir * factor;
}
@end

@export ecgl.forceAtlas2.updateEdgeAttraction.fragment

varying vec2 v_Force;

void main() {
 gl_FragColor = vec4(v_Force, 0.0, 0.0);
}
@end

@export ecgl.forceAtlas2.calcWeightedSum.vertex

attribute vec2 node;

varying vec2 v_NodeUv;

void main() {

 v_NodeUv = node;
 gl_Position = vec4(0.0, 0.0, 0.0, 1.0);
 gl_PointSize = 1.0;
}
@end

@export ecgl.forceAtlas2.calcWeightedSum.fragment

varying vec2 v_NodeUv;

uniform sampler2D positionTex;
uniform sampler2D forceTex;
uniform sampler2D forcePrevTex;

void main() {
 vec2 force = texture2D(forceTex, v_NodeUv).rg;
 vec2 forcePrev = texture2D(forcePrevTex, v_NodeUv).rg;

 float mass = texture2D(positionTex, v_NodeUv).z;
 float swing = length(force - forcePrev) * mass;
 float traction = length(force + forcePrev) * 0.5 * mass;

 gl_FragColor = vec4(swing, traction, 0.0, 0.0);
}
@end

@export ecgl.forceAtlas2.calcGlobalSpeed

uniform sampler2D globalSpeedPrevTex;
uniform sampler2D weightedSumTex;
uniform float jitterTolerence;

void main() {
 vec2 weightedSum = texture2D(weightedSumTex, vec2(0.5)).xy;
 float prevGlobalSpeed = texture2D(globalSpeedPrevTex, vec2(0.5)).x;
 float globalSpeed = jitterTolerence * jitterTolerence
 * weightedSum.y / weightedSum.x;
 if (prevGlobalSpeed > 0.0) {
 globalSpeed = min(globalSpeed / prevGlobalSpeed, 1.5) * prevGlobalSpeed;
 }
 gl_FragColor = vec4(globalSpeed, 0.0, 0.0, 1.0);
}
@end

@export ecgl.forceAtlas2.updatePosition

uniform sampler2D forceTex;
uniform sampler2D forcePrevTex;
uniform sampler2D positionTex;
uniform sampler2D globalSpeedTex;

varying vec2 v_Texcoord;

void main() {
 vec2 force = texture2D(forceTex, v_Texcoord).xy;
 vec2 forcePrev = texture2D(forcePrevTex, v_Texcoord).xy;
 vec4 node = texture2D(positionTex, v_Texcoord);

 float globalSpeed = texture2D(globalSpeedTex, vec2(0.5)).r;
 float swing = length(force - forcePrev);
 float speed = 0.1 * globalSpeed / (0.1 + globalSpeed * sqrt(swing));

 float df = length(force);
 if (df > 0.0) {
 speed = min(df * speed, 10.0) / df;

 gl_FragColor = vec4(node.xy + speed * force, node.zw);
 }
 else {
 gl_FragColor = node;
 }
}
@end

@export ecgl.forceAtlas2.edges.vertex
uniform mat4 worldViewProjection : WORLDVIEWPROJECTION;

attribute vec2 node;
attribute vec4 a_Color : COLOR;
varying vec4 v_Color;

uniform sampler2D positionTex;

void main()
{
 gl_Position = worldViewProjection * vec4(
 texture2D(positionTex, node).xy, -10.0, 1.0
 );
 v_Color = a_Color;
}
@end

@export ecgl.forceAtlas2.edges.fragment
uniform vec4 color : [1.0, 1.0, 1.0, 1.0];
varying vec4 v_Color;
void main() {
 gl_FragColor = color * v_Color;
}
@end`;D.Shader.import(f7);var Vc={repulsionByDegree:!0,linLogMode:!1,strongGravityMode:!1,gravity:1,scaling:1,edgeWeightInfluence:1,jitterTolerence:.1,preventOverlap:!1,dissuadeHubs:!1,gravityCenter:null};function _t(e){var t={type:D.Texture.FLOAT,minFilter:D.Texture.NEAREST,magFilter:D.Texture.NEAREST};this._positionSourceTex=new D.Texture2D(t),this._positionSourceTex.flipY=!1,this._positionTex=new D.Texture2D(t),this._positionPrevTex=new D.Texture2D(t),this._forceTex=new D.Texture2D(t),this._forcePrevTex=new D.Texture2D(t),this._weightedSumTex=new D.Texture2D(t),this._weightedSumTex.width=this._weightedSumTex.height=1,this._globalSpeedTex=new D.Texture2D(t),this._globalSpeedPrevTex=new D.Texture2D(t),this._globalSpeedTex.width=this._globalSpeedTex.height=1,this._globalSpeedPrevTex.width=this._globalSpeedPrevTex.height=1,this._nodeRepulsionPass=new dt({fragment:D.Shader.source("ecgl.forceAtlas2.updateNodeRepulsion")}),this._positionPass=new dt({fragment:D.Shader.source("ecgl.forceAtlas2.updatePosition")}),this._globalSpeedPass=new dt({fragment:D.Shader.source("ecgl.forceAtlas2.calcGlobalSpeed")}),this._copyPass=new dt({fragment:D.Shader.source("clay.compositor.output")});var r=function(n){n.blendEquation(n.FUNC_ADD),n.blendFunc(n.ONE,n.ONE)};this._edgeForceMesh=new D.Mesh({geometry:new D.Geometry({attributes:{node1:new D.Geometry.Attribute("node1","float",2),node2:new D.Geometry.Attribute("node2","float",2),weight:new D.Geometry.Attribute("weight","float",1)},dynamic:!0,mainAttribute:"node1"}),material:new D.Material({transparent:!0,shader:D.createShader("ecgl.forceAtlas2.updateEdgeAttraction"),blend:r,depthMask:!1,depthText:!1}),mode:D.Mesh.POINTS}),this._weightedSumMesh=new D.Mesh({geometry:new D.Geometry({attributes:{node:new D.Geometry.Attribute("node","float",2)},dynamic:!0,mainAttribute:"node"}),material:new D.Material({transparent:!0,shader:D.createShader("ecgl.forceAtlas2.calcWeightedSum"),blend:r,depthMask:!1,depthText:!1}),mode:D.Mesh.POINTS}),this._framebuffer=new Rt({depthBuffer:!1}),this._dummyCamera=new D.OrthographicCamera({left:-1,right:1,top:1,bottom:-1,near:0,far:100}),this._globalSpeed=0}_t.prototype.updateOption=function(e){for(var t in Vc)this[t]=Vc[t];var r=this._nodes.length;if(r>5e4?this.jitterTolerence=10:r>5e3?this.jitterTolerence=1:this.jitterTolerence=.1,r>100?this.scaling=2:this.scaling=10,e)for(var t in Vc)e[t]!=null&&(this[t]=e[t]);if(this.repulsionByDegree)for(var n=this._positionSourceTex.pixels,a=0;a<this._nodes.length;a++)n[a*4+2]=(this._nodes[a].degree||0)+1};_t.prototype._updateGravityCenter=function(e){var t=this._nodes,r=this._edges;if(this.gravityCenter)this._gravityCenter=this.gravityCenter;else{for(var n=[1/0,1/0],a=[-1/0,-1/0],i=0;i<t.length;i++)n[0]=Math.min(t[i].x,n[0]),n[1]=Math.min(t[i].y,n[1]),a[0]=Math.max(t[i].x,a[0]),a[1]=Math.max(t[i].y,a[1]);this._gravityCenter=[(n[0]+a[0])*.5,(n[1]+a[1])*.5]}for(var i=0;i<r.length;i++){var o=r[i].node1,s=r[i].node2;t[o].degree=(t[o].degree||0)+1,t[s].degree=(t[s].degree||0)+1}};_t.prototype.initData=function(e,t){this._nodes=e,this._edges=t,this._updateGravityCenter();var r=Math.ceil(Math.sqrt(e.length)),n=r,a=new Float32Array(r*n*4);this._resize(r,n);for(var i=0,o=0;o<e.length;o++){var s=e[o];a[i++]=s.x||0,a[i++]=s.y||0,a[i++]=s.mass||1,a[i++]=s.size||1}this._positionSourceTex.pixels=a;var l=this._edgeForceMesh.geometry,u=t.length;l.attributes.node1.init(u*2),l.attributes.node2.init(u*2),l.attributes.weight.init(u*2);for(var c=[],o=0;o<t.length;o++){var h=l.attributes,f=t[o].weight;f==null&&(f=1),h.node1.set(o,this.getNodeUV(t[o].node1,c)),h.node2.set(o,this.getNodeUV(t[o].node2,c)),h.weight.set(o,f),h.node1.set(o+u,this.getNodeUV(t[o].node2,c)),h.node2.set(o+u,this.getNodeUV(t[o].node1,c)),h.weight.set(o+u,f)}var d=this._weightedSumMesh.geometry;d.attributes.node.init(e.length);for(var o=0;o<e.length;o++)d.attributes.node.set(o,this.getNodeUV(o,c));l.dirty(),d.dirty(),this._nodeRepulsionPass.material.define("fragment","NODE_COUNT",e.length),this._nodeRepulsionPass.material.setUniform("textureSize",[r,n]),this._inited=!1,this._frame=0};_t.prototype.getNodes=function(){return this._nodes};_t.prototype.getEdges=function(){return this._edges};_t.prototype.step=function(e){this._inited||(this._initFromSource(e),this._inited=!0),this._frame++,this._framebuffer.attach(this._forceTex),this._framebuffer.bind(e);var t=this._nodeRepulsionPass;t.setUniform("strongGravityMode",this.strongGravityMode),t.setUniform("gravity",this.gravity),t.setUniform("gravityCenter",this._gravityCenter),t.setUniform("scaling",this.scaling),t.setUniform("preventOverlap",this.preventOverlap),t.setUniform("positionTex",this._positionPrevTex),t.render(e);var r=this._edgeForceMesh;r.material.set("linLogMode",this.linLogMode),r.material.set("edgeWeightInfluence",this.edgeWeightInfluence),r.material.set("preventOverlap",this.preventOverlap),r.material.set("positionTex",this._positionPrevTex),e.gl.enable(e.gl.BLEND),e.renderPass([r],this._dummyCamera),this._framebuffer.attach(this._weightedSumTex),e.gl.clearColor(0,0,0,0),e.gl.clear(e.gl.COLOR_BUFFER_BIT),e.gl.enable(e.gl.BLEND);var n=this._weightedSumMesh;n.material.set("positionTex",this._positionPrevTex),n.material.set("forceTex",this._forceTex),n.material.set("forcePrevTex",this._forcePrevTex),e.renderPass([n],this._dummyCamera),this._framebuffer.attach(this._globalSpeedTex);var a=this._globalSpeedPass;a.setUniform("globalSpeedPrevTex",this._globalSpeedPrevTex),a.setUniform("weightedSumTex",this._weightedSumTex),a.setUniform("jitterTolerence",this.jitterTolerence),e.gl.disable(e.gl.BLEND),a.render(e);var i=this._positionPass;this._framebuffer.attach(this._positionTex),i.setUniform("globalSpeedTex",this._globalSpeedTex),i.setUniform("positionTex",this._positionPrevTex),i.setUniform("forceTex",this._forceTex),i.setUniform("forcePrevTex",this._forcePrevTex),i.render(e),this._framebuffer.unbind(e),this._swapTexture()};_t.prototype.update=function(e,t,r){t==null&&(t=1),t=Math.max(t,1);for(var n=0;n<t;n++)this.step(e);r&&r()};_t.prototype.getNodePositionTexture=function(){return this._inited?this._positionPrevTex:this._positionSourceTex};_t.prototype.getNodeUV=function(e,t){t=t||[];var r=this._positionTex.width,n=this._positionTex.height;return t[0]=e%r/(r-1),t[1]=Math.floor(e/r)/(n-1)||0,t};_t.prototype.getNodePosition=function(e,t){var r=this._positionArr,n=this._positionTex.width,a=this._positionTex.height,i=n*a;(!r||r.length!==i*4)&&(r=this._positionArr=new Float32Array(i*4)),this._framebuffer.bind(e),this._framebuffer.attach(this._positionPrevTex),e.gl.readPixels(0,0,n,a,e.gl.RGBA,e.gl.FLOAT,r),this._framebuffer.unbind(e),t||(t=new Float32Array(this._nodes.length*2));for(var o=0;o<this._nodes.length;o++)t[o*2]=r[o*4],t[o*2+1]=r[o*4+1];return t};_t.prototype.getTextureData=function(e,t){var r=this["_"+t+"Tex"],n=r.width,a=r.height;this._framebuffer.bind(e),this._framebuffer.attach(r);var i=new Float32Array(n*a*4);return e.gl.readPixels(0,0,n,a,e.gl.RGBA,e.gl.FLOAT,i),this._framebuffer.unbind(e),i};_t.prototype.getTextureSize=function(){return{width:this._positionTex.width,height:this._positionTex.height}};_t.prototype.isFinished=function(e){return this._frame>e};_t.prototype._swapTexture=function(){var e=this._positionPrevTex;this._positionPrevTex=this._positionTex,this._positionTex=e;var e=this._forcePrevTex;this._forcePrevTex=this._forceTex,this._forceTex=e;var e=this._globalSpeedPrevTex;this._globalSpeedPrevTex=this._globalSpeedTex,this._globalSpeedTex=e};_t.prototype._initFromSource=function(e){this._framebuffer.attach(this._positionPrevTex),this._framebuffer.bind(e),this._copyPass.setUniform("texture",this._positionSourceTex),this._copyPass.render(e),e.gl.clearColor(0,0,0,0),this._framebuffer.attach(this._forcePrevTex),e.gl.clear(e.gl.COLOR_BUFFER_BIT),this._framebuffer.attach(this._globalSpeedPrevTex),e.gl.clear(e.gl.COLOR_BUFFER_BIT),this._framebuffer.unbind(e)};_t.prototype._resize=function(e,t){["_positionSourceTex","_positionTex","_positionPrevTex","_forceTex","_forcePrevTex"].forEach(function(r){this[r].width=e,this[r].height=t,this[r].dirty()},this)};_t.prototype.dispose=function(e){this._framebuffer.dispose(e),this._copyPass.dispose(e),this._nodeRepulsionPass.dispose(e),this._positionPass.dispose(e),this._globalSpeedPass.dispose(e),this._edgeForceMesh.geometry.dispose(e),this._weightedSumMesh.geometry.dispose(e),this._positionSourceTex.dispose(e),this._positionTex.dispose(e),this._positionPrevTex.dispose(e),this._forceTex.dispose(e),this._forcePrevTex.dispose(e),this._weightedSumTex.dispose(e),this._globalSpeedTex.dispose(e),this._globalSpeedPrevTex.dispose(e)};function d7(){var e={create:function(){return new Float32Array(2)},dist:function(l,u){var c=u[0]-l[0],h=u[1]-l[1];return Math.sqrt(c*c+h*h)},len:function(l){var u=l[0],c=l[1];return Math.sqrt(u*u+c*c)},scaleAndAdd:function(l,u,c,h){return l[0]=u[0]+c[0]*h,l[1]=u[1]+c[1]*h,l},scale:function(l,u,c){return l[0]=u[0]*c,l[1]=u[1]*c,l},add:function(l,u,c){return l[0]=u[0]+c[0],l[1]=u[1]+c[1],l},sub:function(l,u,c){return l[0]=u[0]-c[0],l[1]=u[1]-c[1],l},normalize:function(l,u){var c=u[0],h=u[1],f=c*c+h*h;return f>0&&(f=1/Math.sqrt(f),l[0]=u[0]*f,l[1]=u[1]*f),l},negate:function(l,u){return l[0]=-u[0],l[1]=-u[1],l},copy:function(l,u){return l[0]=u[0],l[1]=u[1],l},set:function(l,u,c){return l[0]=u,l[1]=c,l}};function t(){this.subRegions=[],this.nSubRegions=0,this.node=null,this.mass=0,this.centerOfMass=null,this.bbox=new Float32Array(4),this.size=0}var r=t.prototype;r.beforeUpdate=function(){for(var l=0;l<this.nSubRegions;l++)this.subRegions[l].beforeUpdate();this.mass=0,this.centerOfMass&&(this.centerOfMass[0]=0,this.centerOfMass[1]=0),this.nSubRegions=0,this.node=null},r.afterUpdate=function(){this.subRegions.length=this.nSubRegions;for(var l=0;l<this.nSubRegions;l++)this.subRegions[l].afterUpdate()},r.addNode=function(l){if(this.nSubRegions===0)if(this.node==null){this.node=l;return}else this._addNodeToSubRegion(this.node),this.node=null;this._addNodeToSubRegion(l),this._updateCenterOfMass(l)},r.findSubRegion=function(l,u){for(var c=0;c<this.nSubRegions;c++){var h=this.subRegions[c];if(h.contain(l,u))return h}},r.contain=function(l,u){return this.bbox[0]<=l&&this.bbox[2]>=l&&this.bbox[1]<=u&&this.bbox[3]>=u},r.setBBox=function(l,u,c,h){this.bbox[0]=l,this.bbox[1]=u,this.bbox[2]=c,this.bbox[3]=h,this.size=(c-l+h-u)/2},r._newSubRegion=function(){var l=this.subRegions[this.nSubRegions];return l||(l=new t,this.subRegions[this.nSubRegions]=l),this.nSubRegions++,l},r._addNodeToSubRegion=function(l){var u=this.findSubRegion(l.position[0],l.position[1]),c=this.bbox;if(!u){var h=(c[0]+c[2])/2,f=(c[1]+c[3])/2,d=(c[2]-c[0])/2,v=(c[3]-c[1])/2,p=l.position[0]>=h?1:0,g=l.position[1]>=f?1:0,u=this._newSubRegion();u.setBBox(p*d+c[0],g*v+c[1],(p+1)*d+c[0],(g+1)*v+c[1])}u.addNode(l)},r._updateCenterOfMass=function(l){this.centerOfMass==null&&(this.centerOfMass=new Float32Array(2));var u=this.centerOfMass[0]*this.mass,c=this.centerOfMass[1]*this.mass;u+=l.position[0]*l.mass,c+=l.position[1]*l.mass,this.mass+=l.mass,this.centerOfMass[0]=u/this.mass,this.centerOfMass[1]=c/this.mass};function n(){this.position=new Float32Array(2),this.force=e.create(),this.forcePrev=e.create(),this.mass=1,this.inDegree=0,this.outDegree=0}function a(l,u){this.source=l,this.target=u,this.weight=1}function i(){this.autoSettings=!0,this.barnesHutOptimize=!0,this.barnesHutTheta=1.5,this.repulsionByDegree=!0,this.linLogMode=!1,this.strongGravityMode=!1,this.gravity=1,this.scaling=1,this.edgeWeightInfluence=1,this.jitterTolerence=.1,this.preventOverlap=!1,this.dissuadeHubs=!1,this.rootRegion=new t,this.rootRegion.centerOfMass=e.create(),this.nodes=[],this.edges=[],this.bbox=new Float32Array(4),this.gravityCenter=null,this._massArr=null,this._swingingArr=null,this._sizeArr=null,this._globalSpeed=0}var o=i.prototype;o.initNodes=function(l,u,c){var h=u.length;this.nodes.length=0;for(var f=typeof c<"u",d=0;d<h;d++){var v=new n;v.position[0]=l[d*2],v.position[1]=l[d*2+1],v.mass=u[d],f&&(v.size=c[d]),this.nodes.push(v)}this._massArr=u,this._swingingArr=new Float32Array(h),f&&(this._sizeArr=c)},o.initEdges=function(l,u){var c=l.length/2;this.edges.length=0;for(var h=0;h<c;h++){var f=l[h*2],d=l[h*2+1],v=this.nodes[f],p=this.nodes[d];if(!v||!p){console.error("Node not exists, try initNodes before initEdges");return}v.outDegree++,p.inDegree++;var g=new a(v,p);u&&(g.weight=u[h]),this.edges.push(g)}},o.updateSettings=function(){if(this.repulsionByDegree)for(var l=0;l<this.nodes.length;l++){var u=this.nodes[l];u.mass=u.inDegree+u.outDegree+1}else for(var l=0;l<this.nodes.length;l++){var u=this.nodes[l];u.mass=this._massArr[l]}},o.update=function(){var l=this.nodes.length;if(this.updateSettings(),this.updateBBox(),this.barnesHutOptimize){this.rootRegion.setBBox(this.bbox[0],this.bbox[1],this.bbox[2],this.bbox[3]),this.rootRegion.beforeUpdate();for(var u=0;u<l;u++)this.rootRegion.addNode(this.nodes[u]);this.rootRegion.afterUpdate()}for(var u=0;u<l;u++){var c=this.nodes[u];e.copy(c.forcePrev,c.force),e.set(c.force,0,0)}for(var u=0;u<l;u++){var h=this.nodes[u];if(this.barnesHutOptimize)this.applyRegionToNodeRepulsion(this.rootRegion,h);else for(var f=u+1;f<l;f++){var d=this.nodes[f];this.applyNodeToNodeRepulsion(h,d,!1)}this.gravity>0&&(this.strongGravityMode?this.applyNodeStrongGravity(h):this.applyNodeGravity(h))}for(var u=0;u<this.edges.length;u++)this.applyEdgeAttraction(this.edges[u]);for(var v=0,p=0,g=e.create(),u=0;u<l;u++){var c=this.nodes[u],m=e.dist(c.force,c.forcePrev);v+=m*c.mass,e.add(g,c.force,c.forcePrev);var _=e.len(g)*.5;p+=_*c.mass,this._swingingArr[u]=m}var y=this.jitterTolerence*this.jitterTolerence*p/v;this._globalSpeed>0&&(y=Math.min(y/this._globalSpeed,1.5)*this._globalSpeed),this._globalSpeed=y;for(var u=0;u<l;u++){var c=this.nodes[u],m=this._swingingArr[u],x=.1*y/(1+y*Math.sqrt(m)),S=e.len(c.force);S>0&&(x=Math.min(S*x,10)/S,e.scaleAndAdd(c.position,c.position,c.force,x))}},o.applyRegionToNodeRepulsion=function(){var l=e.create();return function(c,h){if(c.node)this.applyNodeToNodeRepulsion(c.node,h,!0);else{e.sub(l,h.position,c.centerOfMass);var f=l[0]*l[0]+l[1]*l[1];if(f>this.barnesHutTheta*c.size*c.size){var d=this.scaling*h.mass*c.mass/f;e.scaleAndAdd(h.force,h.force,l,d)}else for(var v=0;v<c.nSubRegions;v++)this.applyRegionToNodeRepulsion(c.subRegions[v],h)}}}(),o.applyNodeToNodeRepulsion=function(){var l=e.create();return function(c,h,f){if(c!=h){e.sub(l,c.position,h.position);var d=l[0]*l[0]+l[1]*l[1];if(d!==0){var v;if(this.preventOverlap){var p=Math.sqrt(d);if(p=p-c.size-h.size,p>0)v=this.scaling*c.mass*h.mass/(p*p);else if(p<0)v=this.scaling*100*c.mass*h.mass;else return}else v=this.scaling*c.mass*h.mass/d;e.scaleAndAdd(c.force,c.force,l,v),e.scaleAndAdd(h.force,h.force,l,-v)}}}}(),o.applyEdgeAttraction=function(){var l=e.create();return function(c){var h=c.source,f=c.target;e.sub(l,h.position,f.position);var d=e.len(l),v;this.edgeWeightInfluence===0?v=1:this.edgeWeightInfluence===1?v=c.weight:v=Math.pow(c.weight,this.edgeWeightInfluence);var p;this.preventOverlap&&(d=d-h.size-f.size,d<=0)||(this.linLogMode?p=-v*Math.log(d+1)/(d+1):p=-v,e.scaleAndAdd(h.force,h.force,l,p),e.scaleAndAdd(f.force,f.force,l,-p))}}(),o.applyNodeGravity=function(){var l=e.create();return function(u){e.sub(l,this.gravityCenter,u.position);var c=e.len(l);e.scaleAndAdd(u.force,u.force,l,this.gravity*u.mass/(c+1))}}(),o.applyNodeStrongGravity=function(){var l=e.create();return function(u){e.sub(l,this.gravityCenter,u.position),e.scaleAndAdd(u.force,u.force,l,this.gravity*u.mass)}}(),o.updateBBox=function(){for(var l=1/0,u=1/0,c=-1/0,h=-1/0,f=0;f<this.nodes.length;f++){var d=this.nodes[f].position;l=Math.min(l,d[0]),u=Math.min(u,d[1]),c=Math.max(c,d[0]),h=Math.max(h,d[1])}this.bbox[0]=l,this.bbox[1]=u,this.bbox[2]=c,this.bbox[3]=h},o.getGlobalSpeed=function(){return this._globalSpeed};var s=null;self.onmessage=function(l){switch(l.data.cmd){case"init":s=new i,s.initNodes(l.data.nodesPosition,l.data.nodesMass,l.data.nodesSize),s.initEdges(l.data.edges,l.data.edgesWeight);break;case"updateConfig":if(s)for(var u in l.data.config)s[u]=l.data.config[u];break;case"update":var c=l.data.steps;if(s){for(var h=0;h<c;h++)s.update();for(var f=s.nodes.length,d=new Float32Array(f*2),h=0;h<f;h++){var v=s.nodes[h];d[h*2]=v.position[0],d[h*2+1]=v.position[1]}self.postMessage({buffer:d.buffer,globalSpeed:s.getGlobalSpeed()},[d.buffer])}else{var p=new Float32Array;self.postMessage({buffer:p.buffer,globalSpeed:s.getGlobalSpeed()},[p.buffer])}break}}}var Ji=d7.toString();Ji=Ji.slice(Ji.indexOf("{")+1,Ji.lastIndexOf("}"));var no={barnesHutOptimize:!0,barnesHutTheta:1.5,repulsionByDegree:!0,linLogMode:!1,strongGravityMode:!1,gravity:1,scaling:1,edgeWeightInfluence:1,jitterTolerence:.1,preventOverlap:!1,dissuadeHubs:!1,gravityCenter:null},fr=function(e){for(var t in no)this[t]=no[t];if(e)for(var t in e)this[t]=e[t];this._nodes=[],this._edges=[],this._disposed=!1,this._positionTex=new _e({type:ie.FLOAT,flipY:!1,minFilter:ie.NEAREST,magFilter:ie.NEAREST})};fr.prototype.initData=function(e,t){var r=new Blob([Ji]),n=window.URL.createObjectURL(r);this._worker=new Worker(n),this._worker.onmessage=this._$onupdate.bind(this),this._nodes=e,this._edges=t,this._frame=0;for(var a=e.length,i=t.length,o=new Float32Array(a*2),s=new Float32Array(a),l=new Float32Array(a),u=new Float32Array(i*2),c=new Float32Array(i),h=0;h<e.length;h++){var f=e[h];o[h*2]=f.x,o[h*2+1]=f.y,s[h]=f.mass==null?1:f.mass,l[h]=f.size==null?1:f.size}for(var h=0;h<t.length;h++){var d=t[h],v=d.node1,p=d.node2;u[h*2]=v,u[h*2+1]=p,c[h]=d.weight==null?1:d.weight}var g=Math.ceil(Math.sqrt(e.length)),m=g,_=new Float32Array(g*m*4),y=this._positionTex;y.width=g,y.height=m,y.pixels=_,this._worker.postMessage({cmd:"init",nodesPosition:o,nodesMass:s,nodesSize:l,edges:u,edgesWeight:c}),this._globalSpeed=1/0};fr.prototype.updateOption=function(e){var t={};for(var r in no)t[r]=no[r];var n=this._nodes,a=this._edges,i=n.length;if(i>5e4?t.jitterTolerence=10:i>5e3?t.jitterTolerence=1:t.jitterTolerence=.1,i>100?t.scaling=2:t.scaling=10,i>1e3?t.barnesHutOptimize=!0:t.barnesHutOptimize=!1,e)for(var r in no)e[r]!=null&&(t[r]=e[r]);if(!t.gravityCenter){for(var o=[1/0,1/0],s=[-1/0,-1/0],l=0;l<n.length;l++)o[0]=Math.min(n[l].x,o[0]),o[1]=Math.min(n[l].y,o[1]),s[0]=Math.max(n[l].x,s[0]),s[1]=Math.max(n[l].y,s[1]);t.gravityCenter=[(o[0]+s[0])*.5,(o[1]+s[1])*.5]}for(var l=0;l<a.length;l++){var u=a[l].node1,c=a[l].node2;n[u].degree=(n[u].degree||0)+1,n[c].degree=(n[c].degree||0)+1}this._worker&&this._worker.postMessage({cmd:"updateConfig",config:t})};fr.prototype.update=function(e,t,r){t==null&&(t=1),t=Math.max(t,1),this._frame+=t,this._onupdate=r,this._worker&&this._worker.postMessage({cmd:"update",steps:Math.round(t)})};fr.prototype._$onupdate=function(e){if(!this._disposed){var t=new Float32Array(e.data.buffer);this._globalSpeed=e.data.globalSpeed,this._positionArr=t,this._updateTexture(t),this._onupdate&&this._onupdate()}};fr.prototype.getNodePositionTexture=function(){return this._positionTex};fr.prototype.getNodeUV=function(e,t){t=t||[];var r=this._positionTex.width,n=this._positionTex.height;return t[0]=e%r/(r-1),t[1]=Math.floor(e/r)/(n-1),t};fr.prototype.getNodes=function(){return this._nodes};fr.prototype.getEdges=function(){return this._edges};fr.prototype.isFinished=function(e){return this._frame>e};fr.prototype.getNodePosition=function(e,t){if(t||(t=new Float32Array(this._nodes.length*2)),this._positionArr)for(var r=0;r<this._positionArr.length;r++)t[r]=this._positionArr[r];return t};fr.prototype._updateTexture=function(e){for(var t=this._positionTex.pixels,r=0,n=0;n<e.length;)t[r++]=e[n++],t[r++]=e[n++],t[r++]=1,t[r++]=1;this._positionTex.dirty()};fr.prototype.dispose=function(e){this._disposed=!0,this._worker=null};const r0=fr;var v7=qt.extend(function(){return{zr:null,viewGL:null,minZoom:.2,maxZoom:5,_needsUpdate:!1,_dx:0,_dy:0,_zoom:1}},function(){this._mouseDownHandler=this._mouseDownHandler.bind(this),this._mouseWheelHandler=this._mouseWheelHandler.bind(this),this._mouseMoveHandler=this._mouseMoveHandler.bind(this),this._mouseUpHandler=this._mouseUpHandler.bind(this),this._update=this._update.bind(this)},{init:function(){var e=this.zr;e.on("mousedown",this._mouseDownHandler),e.on("mousewheel",this._mouseWheelHandler),e.on("globalout",this._mouseUpHandler),e.animation.on("frame",this._update)},setTarget:function(e){this._target=e},setZoom:function(e){this._zoom=Math.max(Math.min(e,this.maxZoom),this.minZoom),this._needsUpdate=!0},setOffset:function(e){this._dx=e[0],this._dy=e[1],this._needsUpdate=!0},getZoom:function(){return this._zoom},getOffset:function(){return[this._dx,this._dy]},_update:function(){if(this._target&&this._needsUpdate){var e=this._target,t=this._zoom;e.position.x=this._dx,e.position.y=this._dy,e.scale.set(t,t,t),this.zr.refresh(),this._needsUpdate=!1,this.trigger("update")}},_mouseDownHandler:function(e){if(!e.target){var t=e.offsetX,r=e.offsetY;if(!(this.viewGL&&!this.viewGL.containPoint(t,r))){this.zr.on("mousemove",this._mouseMoveHandler),this.zr.on("mouseup",this._mouseUpHandler);var n=this._convertPos(t,r);this._x=n.x,this._y=n.y}}},_convertPos:function(e,t){var r=this.viewGL.camera,n=this.viewGL.viewport;return{x:(e-n.x)/n.width*(r.right-r.left)+r.left,y:(t-n.y)/n.height*(r.bottom-r.top)+r.top}},_mouseMoveHandler:function(e){var t=this._convertPos(e.offsetX,e.offsetY);this._dx+=t.x-this._x,this._dy+=t.y-this._y,this._x=t.x,this._y=t.y,this._needsUpdate=!0},_mouseUpHandler:function(e){this.zr.off("mousemove",this._mouseMoveHandler),this.zr.off("mouseup",this._mouseUpHandler)},_mouseWheelHandler:function(e){e=e.event;var t=e.wheelDelta||-e.detail;if(t!==0){var r=e.offsetX,n=e.offsetY;if(!(this.viewGL&&!this.viewGL.containPoint(r,n))){var a=t>0?1.1:.9,i=Math.max(Math.min(this._zoom*a,this.maxZoom),this.minZoom);a=i/this._zoom;var o=this._convertPos(r,n),s=(o.x-this._dx)*(a-1),l=(o.y-this._dy)*(a-1);this._dx-=s,this._dy-=l,this._zoom=i,this._needsUpdate=!0}}},dispose:function(){var e=this.zr;e.off("mousedown",this._mouseDownHandler),e.off("mousemove",this._mouseMoveHandler),e.off("mouseup",this._mouseUpHandler),e.off("mousewheel",this._mouseWheelHandler),e.off("globalout",this._mouseUpHandler),e.animation.off("frame",this._update)}});const p7=v7,g7=`@export ecgl.lines2D.vertex

uniform mat4 worldViewProjection : WORLDVIEWPROJECTION;

attribute vec2 position: POSITION;
attribute vec4 a_Color : COLOR;
varying vec4 v_Color;

#ifdef POSITIONTEXTURE_ENABLED
uniform sampler2D positionTexture;
#endif

void main()
{
 gl_Position = worldViewProjection * vec4(position, -10.0, 1.0);

 v_Color = a_Color;
}

@end

@export ecgl.lines2D.fragment

uniform vec4 color : [1.0, 1.0, 1.0, 1.0];

varying vec4 v_Color;

void main()
{
 gl_FragColor = color * v_Color;
}
@end


@export ecgl.meshLines2D.vertex

attribute vec2 position: POSITION;
attribute vec2 normal;
attribute float offset;
attribute vec4 a_Color : COLOR;

uniform mat4 worldViewProjection : WORLDVIEWPROJECTION;
uniform vec4 viewport : VIEWPORT;

varying vec4 v_Color;
varying float v_Miter;

void main()
{
 vec4 p2 = worldViewProjection * vec4(position + normal, -10.0, 1.0);
 gl_Position = worldViewProjection * vec4(position, -10.0, 1.0);

 p2.xy /= p2.w;
 gl_Position.xy /= gl_Position.w;

 vec2 N = normalize(p2.xy - gl_Position.xy);
 gl_Position.xy += N * offset / viewport.zw * 2.0;

 gl_Position.xy *= gl_Position.w;

 v_Color = a_Color;
}
@end


@export ecgl.meshLines2D.fragment

uniform vec4 color : [1.0, 1.0, 1.0, 1.0];

varying vec4 v_Color;
varying float v_Miter;

void main()
{
 gl_FragColor = color * v_Color;
}

@end`;var Ss=lt.vec2;D.Shader.import(g7);var m7=1;const y7=He.extend({type:"graphGL",__ecgl__:!0,init:function(e,t){this.groupGL=new D.Node,this.viewGL=new Oe("orthographic"),this.viewGL.camera.left=this.viewGL.camera.right=0,this.viewGL.add(this.groupGL),this._pointsBuilder=new ya(!0,t),this._forceEdgesMesh=new D.Mesh({material:new D.Material({shader:D.createShader("ecgl.forceAtlas2.edges"),transparent:!0,depthMask:!1,depthTest:!1}),$ignorePicking:!0,geometry:new D.Geometry({attributes:{node:new D.Geometry.Attribute("node","float",2),color:new D.Geometry.Attribute("color","float",4,"COLOR")},dynamic:!0,mainAttribute:"node"}),renderOrder:-1,mode:D.Mesh.LINES}),this._edgesMesh=new D.Mesh({material:new D.Material({shader:D.createShader("ecgl.meshLines2D"),transparent:!0,depthMask:!1,depthTest:!1}),$ignorePicking:!0,geometry:new o2({useNativeLine:!1,dynamic:!0}),renderOrder:-1,culling:!1}),this._layoutId=0,this._control=new p7({zr:t.getZr(),viewGL:this.viewGL}),this._control.setTarget(this.groupGL),this._control.init(),this._clickHandler=this._clickHandler.bind(this)},render:function(e,t,r){this.groupGL.add(this._pointsBuilder.rootNode),this._model=e,this._api=r,this._initLayout(e,t,r),this._pointsBuilder.update(e,t,r),this._forceLayoutInstance instanceof _t||this.groupGL.remove(this._forceEdgesMesh),this._updateCamera(e,r),this._control.off("update"),this._control.on("update",function(){r.dispatchAction({type:"graphGLRoam",seriesId:e.id,zoom:this._control.getZoom(),offset:this._control.getOffset()}),this._pointsBuilder.updateView(this.viewGL.camera)},this),this._control.setZoom(Se.firstNotNull(e.get("zoom"),1)),this._control.setOffset(e.get("offset")||[0,0]);var n=this._pointsBuilder.getPointsMesh();if(n.off("mousemove",this._mousemoveHandler),n.off("mouseout",this._mouseOutHandler,this),r.getZr().off("click",this._clickHandler),this._pointsBuilder.highlightOnMouseover=!0,e.get("focusNodeAdjacency")){var a=e.get("focusNodeAdjacencyOn");a==="click"?r.getZr().on("click",this._clickHandler):a==="mouseover"&&(n.on("mousemove",this._mousemoveHandler,this),n.on("mouseout",this._mouseOutHandler,this),this._pointsBuilder.highlightOnMouseover=!1)}this._lastMouseOverDataIndex=-1},_clickHandler:function(e){if(!this._layouting){var t=this._pointsBuilder.getPointsMesh().dataIndex;t>=0?this._api.dispatchAction({type:"graphGLFocusNodeAdjacency",seriesId:this._model.id,dataIndex:t}):this._api.dispatchAction({type:"graphGLUnfocusNodeAdjacency",seriesId:this._model.id})}},_mousemoveHandler:function(e){if(!this._layouting){var t=this._pointsBuilder.getPointsMesh().dataIndex;t>=0?t!==this._lastMouseOverDataIndex&&this._api.dispatchAction({type:"graphGLFocusNodeAdjacency",seriesId:this._model.id,dataIndex:t}):this._mouseOutHandler(e),this._lastMouseOverDataIndex=t}},_mouseOutHandler:function(e){this._layouting||(this._api.dispatchAction({type:"graphGLUnfocusNodeAdjacency",seriesId:this._model.id}),this._lastMouseOverDataIndex=-1)},_updateForceEdgesGeometry:function(e,t){var r=this._forceEdgesMesh.geometry,n=t.getEdgeData(),a=0,i=this._forceLayoutInstance,o=n.count()*2;r.attributes.node.init(o),r.attributes.color.init(o),n.each(function(s){var l=e[s];r.attributes.node.set(a,i.getNodeUV(l.node1)),r.attributes.node.set(a+1,i.getNodeUV(l.node2));var u=Ct(n,l.dataIndex),c=D.parseColor(u);c[3]*=Se.firstNotNull(At(n,l.dataIndex),1),r.attributes.color.set(a,c),r.attributes.color.set(a+1,c),a+=2}),r.dirty()},_updateMeshLinesGeometry:function(){var t=this._model.getEdgeData(),e=this._edgesMesh.geometry,t=this._model.getEdgeData(),r=this._model.getData().getLayout("points");e.resetOffset(),e.setVertexCount(t.count()*e.getLineVertexCount()),e.setTriangleCount(t.count()*e.getLineTriangleCount());var n=[],a=[],i=["lineStyle","width"];this._originalEdgeColors=new Float32Array(t.count()*4),this._edgeIndicesMap=new Float32Array(t.count()),t.each(function(o){var s=t.graph.getEdgeByIndex(o),l=s.node1.dataIndex*2,u=s.node2.dataIndex*2;n[0]=r[l],n[1]=r[l+1],a[0]=r[u],a[1]=r[u+1];var c=Ct(t,s.dataIndex),h=D.parseColor(c);h[3]*=Se.firstNotNull(At(t,s.dataIndex),1);var f=t.getItemModel(s.dataIndex),d=Se.firstNotNull(f.get(i),1)*this._api.getDevicePixelRatio();e.addLine(n,a,h,d);for(var v=0;v<4;v++)this._originalEdgeColors[s.dataIndex*4+v]=h[v];this._edgeIndicesMap[s.dataIndex]=o},this),e.dirty()},_updateForceNodesGeometry:function(e){for(var t=this._pointsBuilder.getPointsMesh(),r=[],n=0;n<e.count();n++)this._forceLayoutInstance.getNodeUV(n,r),t.geometry.attributes.position.set(n,r);t.geometry.dirty("position")},_initLayout:function(e,t,r){var n=e.get("layout"),a=e.getGraph(),i=e.getBoxLayoutParams(),o=sr(i,{width:r.getWidth(),height:r.getHeight()});n==="force"&&(n="forceAtlas2"),this.stopLayout(e,t,r,{beforeLayout:!0});var s=e.getData(),l=e.getData();if(n==="forceAtlas2"){var u=e.getModel("forceAtlas2"),c=this._forceLayoutInstance,h=[],f=[],d=s.getDataExtent("value"),v=l.getDataExtent("value"),p=Se.firstNotNull(u.get("edgeWeight"),1),g=Se.firstNotNull(u.get("nodeWeight"),1);typeof p=="number"&&(p=[p,p]),typeof g=="number"&&(g=[g,g]);var m=0,_={},y=new Float32Array(s.count()*2);if(a.eachNode(function(S){var T=S.dataIndex,b=s.get("value",T),w,A;if(s.hasItemOption){var E=s.getItemModel(T);w=E.get("x"),A=E.get("y")}w==null&&(w=o.x+Math.random()*o.width,A=o.y+Math.random()*o.height),y[m*2]=w,y[m*2+1]=A,_[S.id]=m++;var C=Ye(b,d,g);isNaN(C)&&(isNaN(g[0])?C=1:C=g[0]),h.push({x:w,y:A,mass:C,size:s.getItemVisual(T,"symbolSize")})}),s.setLayout("points",y),a.eachEdge(function(S){var T=S.dataIndex,b=s.get("value",T),w=Ye(b,v,p);isNaN(w)&&(isNaN(p[0])?w=1:w=p[0]),f.push({node1:_[S.node1.id],node2:_[S.node2.id],weight:w,dataIndex:T})}),!c){var x=u.get("GPU");this._forceLayoutInstance&&(x&&!(this._forceLayoutInstance instanceof _t)||!x&&!(this._forceLayoutInstance instanceof r0))&&(this._forceLayoutInstanceToDispose=this._forceLayoutInstance),c=this._forceLayoutInstance=x?new _t:new r0}c.initData(h,f),c.updateOption(u.option),this._updateForceEdgesGeometry(c.getEdges(),e),this._updatePositionTexture(),r.dispatchAction({type:"graphGLStartLayout",from:this.uid})}else{var y=new Float32Array(s.count()*2),m=0;a.eachNode(function(b){var w=b.dataIndex,A,E;if(s.hasItemOption){var C=s.getItemModel(w);A=C.get("x"),E=C.get("y")}y[m++]=A,y[m++]=E}),s.setLayout("points",y),this._updateAfterLayout(e,t,r)}},_updatePositionTexture:function(){var e=this._forceLayoutInstance.getNodePositionTexture();this._pointsBuilder.setPositionTexture(e),this._forceEdgesMesh.material.set("positionTex",e)},startLayout:function(e,t,i,n){if(!(n&&n.from!=null&&n.from!==this.uid)){var a=this.viewGL,i=this._api,o=this._forceLayoutInstance,s=this._model.getData(),l=this._model.getModel("forceAtlas2");if(o&&(this.groupGL.remove(this._edgesMesh),this.groupGL.add(this._forceEdgesMesh),!!this._forceLayoutInstance)){this._updateForceNodesGeometry(e.getData()),this._pointsBuilder.hideLabels();var u=this,c=this._layoutId=m7++,h=l.getShallow("maxSteps"),f=l.getShallow("steps"),d=0,v=Math.max(f*2,20),p=function(g){if(g===u._layoutId){if(o.isFinished(h)){i.dispatchAction({type:"graphGLStopLayout",from:u.uid}),i.dispatchAction({type:"graphGLFinishLayout",points:s.getLayout("points"),from:u.uid});return}o.update(a.layer.renderer,f,function(){u._updatePositionTexture(),d+=f,d>=v&&(u._syncNodePosition(e),d=0),i.getZr().refresh(),nh(function(){p(g)})})}};nh(function(){u._forceLayoutInstanceToDispose&&(u._forceLayoutInstanceToDispose.dispose(a.layer.renderer),u._forceLayoutInstanceToDispose=null),p(c)}),this._layouting=!0}}},stopLayout:function(e,t,r,n){n&&n.from!=null&&n.from!==this.uid||(this._layoutId=0,this.groupGL.remove(this._forceEdgesMesh),this.groupGL.add(this._edgesMesh),this._forceLayoutInstance&&this.viewGL.layer&&(n&&n.beforeLayout||(this._syncNodePosition(e),this._updateAfterLayout(e,t,r)),this._api.getZr().refresh(),this._layouting=!1))},_syncNodePosition:function(e){var t=this._forceLayoutInstance.getNodePosition(this.viewGL.layer.renderer);e.getData().setLayout("points",t),e.setNodePosition(t)},_updateAfterLayout:function(e,t,r){this._updateMeshLinesGeometry(),this._pointsBuilder.removePositionTexture(),this._pointsBuilder.updateLayout(e,t,r),this._pointsBuilder.updateView(this.viewGL.camera),this._pointsBuilder.updateLabels(),this._pointsBuilder.showLabels()},focusNodeAdjacency:function(e,t,r,n){var a=this._model.getData();this._downplayAll();var i=n.dataIndex,o=a.graph,s=[],l=o.getNodeByIndex(i);s.push(l),l.edges.forEach(function(c){c.dataIndex<0||(c.node1!==l&&s.push(c.node1),c.node2!==l&&s.push(c.node2))},this),this._pointsBuilder.fadeOutAll(.05),this._fadeOutEdgesAll(.05),s.forEach(function(c){this._pointsBuilder.highlight(a,c.dataIndex)},this),this._pointsBuilder.updateLabels(s.map(function(c){return c.dataIndex}));var u=[];l.edges.forEach(function(c){c.dataIndex>=0&&(this._highlightEdge(c.dataIndex),u.push(c))},this),this._focusNodes=s,this._focusEdges=u},unfocusNodeAdjacency:function(e,t,r,n){this._downplayAll(),this._pointsBuilder.fadeInAll(),this._fadeInEdgesAll(),this._pointsBuilder.updateLabels()},_highlightEdge:function(e){var t=this._model.getEdgeData().getItemModel(e),r=D.parseColor(t.get("emphasis.lineStyle.color")||t.get("lineStyle.color")),n=Se.firstNotNull(t.get("emphasis.lineStyle.opacity"),t.get("lineStyle.opacity"),1);r[3]*=n,this._edgesMesh.geometry.setItemColor(this._edgeIndicesMap[e],r)},_downplayAll:function(){this._focusNodes&&this._focusNodes.forEach(function(e){this._pointsBuilder.downplay(this._model.getData(),e.dataIndex)},this),this._focusEdges&&this._focusEdges.forEach(function(e){this._downplayEdge(e.dataIndex)},this)},_downplayEdge:function(e){var t=this._getColor(e,[]);this._edgesMesh.geometry.setItemColor(this._edgeIndicesMap[e],t)},_setEdgeFade:function(){var e=[];return function(t,r){this._getColor(t,e),e[3]*=r,this._edgesMesh.geometry.setItemColor(this._edgeIndicesMap[t],e)}}(),_getColor:function(e,t){for(var r=0;r<4;r++)t[r]=this._originalEdgeColors[e*4+r];return t},_fadeOutEdgesAll:function(e){var t=this._model.getData().graph;t.eachEdge(function(r){this._setEdgeFade(r.dataIndex,e)},this)},_fadeInEdgesAll:function(){this._fadeOutEdgesAll(1)},_updateCamera:function(e,t){this.viewGL.setViewport(0,0,t.getWidth(),t.getHeight(),t.getDevicePixelRatio());for(var r=this.viewGL.camera,n=e.getData(),a=n.getLayout("points"),i=Ss.create(1/0,1/0),o=Ss.create(-1/0,-1/0),s=[],l=0;l<a.length;)s[0]=a[l++],s[1]=a[l++],Ss.min(i,i,s),Ss.max(o,o,s);var u=(o[1]+i[1])/2,c=(o[0]+i[0])/2;if(!(c>r.left&&c<r.right&&u<r.bottom&&u>r.top)){var h=Math.max(o[0]-i[0],10),f=h/t.getWidth()*t.getHeight();h*=1.4,f*=1.4,i[0]-=h*.2,r.left=i[0],r.top=u-f/2,r.bottom=u+f/2,r.right=h+i[0],r.near=0,r.far=100}},dispose:function(){var e=this.viewGL.layer.renderer;this._forceLayoutInstance&&this._forceLayoutInstance.dispose(e),this.groupGL.removeAll(),this._layoutId=-1,this._pointsBuilder.dispose()},remove:function(){this.groupGL.removeAll(),this._control.dispose()}});function Ts(e){return e instanceof Array||(e=[e,e]),e}function _7(e){e.registerChartView(y7),e.registerSeriesModel(h7),e.registerVisual(function(r){const n={};r.eachSeriesByType("graphGL",function(a){var i=a.getCategoriesData(),o=a.getData(),s={};i.each(function(l){var u=i.getName(l);s["ec-"+u]=l;var c=i.getItemModel(l),h=c.getModel("itemStyle").getItemStyle();h.fill||(h.fill=a.getColorFromPalette(u,n)),i.setItemVisual(l,"style",h);var f=["symbol","symbolSize","symbolKeepAspect"];for(let v=0;v<f.length;v++){var d=c.getShallow(f[v],!0);d!=null&&i.setItemVisual(l,f[v],d)}}),i.count()&&o.each(function(l){var u=o.getItemModel(l);let c=u.getShallow("category");if(c!=null){typeof c=="string"&&(c=s["ec-"+c]);var h=i.getItemVisual(c,"style"),f=o.ensureUniqueItemVisual(l,"style");le(f,h);var d=["symbol","symbolSize","symbolKeepAspect"];for(let v=0;v<d.length;v++)o.setItemVisual(l,d[v],i.getItemVisual(c,d[v]))}})})}),e.registerVisual(function(r){r.eachSeriesByType("graphGL",function(n){var a=n.getGraph(),i=n.getEdgeData(),o=Ts(n.get("edgeSymbol")),s=Ts(n.get("edgeSymbolSize"));i.setVisual("drawType","stroke"),i.setVisual("fromSymbol",o&&o[0]),i.setVisual("toSymbol",o&&o[1]),i.setVisual("fromSymbolSize",s&&s[0]),i.setVisual("toSymbolSize",s&&s[1]),i.setVisual("style",n.getModel("lineStyle").getLineStyle()),i.each(function(l){var u=i.getItemModel(l),c=a.getEdgeByIndex(l),h=Ts(u.getShallow("symbol",!0)),f=Ts(u.getShallow("symbolSize",!0)),d=u.getModel("lineStyle").getLineStyle(),v=i.ensureUniqueItemVisual(l,"style");switch(le(v,d),v.stroke){case"source":{var p=c.node1.getVisual("style");v.stroke=p&&p.fill;break}case"target":{var p=c.node2.getVisual("style");v.stroke=p&&p.fill;break}}h[0]&&c.setVisual("fromSymbol",h[0]),h[1]&&c.setVisual("toSymbol",h[1]),f[0]&&c.setVisual("fromSymbolSize",f[0]),f[1]&&c.setVisual("toSymbolSize",f[1])})})}),e.registerAction({type:"graphGLRoam",event:"graphglroam",update:"series.graphGL:roam"},function(r,n){n.eachComponent({mainType:"series",query:r},function(a){a.setView(r)})});function t(){}e.registerAction({type:"graphGLStartLayout",event:"graphgllayoutstarted",update:"series.graphGL:startLayout"},t),e.registerAction({type:"graphGLStopLayout",event:"graphgllayoutstopped",update:"series.graphGL:stopLayout"},t),e.registerAction({type:"graphGLFocusNodeAdjacency",event:"graphGLFocusNodeAdjacency",update:"series.graphGL:focusNodeAdjacency"},t),e.registerAction({type:"graphGLUnfocusNodeAdjacency",event:"graphGLUnfocusNodeAdjacency",update:"series.graphGL:unfocusNodeAdjacency"},t)}oe(_7);const x7=$e.extend({type:"series.flowGL",dependencies:["geo","grid","bmap"],visualStyleAccessPath:"itemStyle",getInitialData:function(e,t){var r=this.get("coordinateSystem"),n=r==="geo"?["lng","lat"]:Xm(r)||["x","y"];n.push("vx","vy");var a=Fo(this.getSource(),{coordDimensions:n,encodeDefine:this.get("encode"),dimensionsDefine:this.get("dimensions")}),i=new it(a,this);return i.initData(this.getSource()),i},defaultOption:{coordinateSystem:"cartesian2d",zlevel:10,supersampling:1,particleType:"point",particleDensity:128,particleSize:1,particleSpeed:1,particleTrail:2,colorTexture:null,gridWidth:"auto",gridHeight:"auto",itemStyle:{color:"#fff",opacity:.8}}});var S7=Me.extend(function(){return{dynamic:!0,attributes:{position:new Me.Attribute("position","float",3,"POSITION")}}},{resetOffset:function(){this._vertexOffset=0,this._faceOffset=0},setLineCount:function(e){var t=this.attributes,r=4*e,n=2*e;this.vertexCount!==r&&t.position.init(r),this.triangleCount!==n&&(n===0?this.indices=null:this.indices=this.vertexCount>65535?new Uint32Array(n*3):new Uint16Array(n*3))},addLine:function(e){var t=this._vertexOffset;this.attributes.position.set(t,[e[0],e[1],1]),this.attributes.position.set(t+1,[e[0],e[1],-1]),this.attributes.position.set(t+2,[e[0],e[1],2]),this.attributes.position.set(t+3,[e[0],e[1],-2]),this.setTriangleIndices(this._faceOffset++,[t,t+1,t+2]),this.setTriangleIndices(this._faceOffset++,[t+1,t+2,t+3]),this._vertexOffset+=4}});const T7=S7,b7=`@export ecgl.vfParticle.particle.fragment

uniform sampler2D particleTexture;
uniform sampler2D spawnTexture;
uniform sampler2D velocityTexture;

uniform float deltaTime;
uniform float elapsedTime;

uniform float speedScaling : 1.0;

uniform vec2 textureSize;
uniform vec4 region : [0, 0, 1, 1];
uniform float firstFrameTime;

varying vec2 v_Texcoord;


void main()
{
 vec4 p = texture2D(particleTexture, v_Texcoord);
 bool spawn = false;
 if (p.w <= 0.0) {
 p = texture2D(spawnTexture, fract(v_Texcoord + elapsedTime / 10.0));
 p.w -= firstFrameTime;
 spawn = true;
 }
 vec2 v = texture2D(velocityTexture, fract(p.xy * region.zw + region.xy)).xy;
 v = (v - 0.5) * 2.0;
 p.z = length(v);
 p.xy += v * deltaTime / 10.0 * speedScaling;
 p.w -= deltaTime;

 if (spawn || p.xy != fract(p.xy)) {
 p.z = 0.0;
 }
 p.xy = fract(p.xy);

 gl_FragColor = p;
}
@end

@export ecgl.vfParticle.renderPoints.vertex

#define PI 3.1415926

attribute vec2 texcoord : TEXCOORD_0;

uniform sampler2D particleTexture;
uniform mat4 worldViewProjection : WORLDVIEWPROJECTION;

uniform float size : 1.0;

varying float v_Mag;
varying vec2 v_Uv;

void main()
{
 vec4 p = texture2D(particleTexture, texcoord);

 if (p.w > 0.0 && p.z > 1e-5) {
 gl_Position = worldViewProjection * vec4(p.xy * 2.0 - 1.0, 0.0, 1.0);
 }
 else {
 gl_Position = vec4(100000.0, 100000.0, 100000.0, 1.0);
 }

 v_Mag = p.z;
 v_Uv = p.xy;

 gl_PointSize = size;
}

@end

@export ecgl.vfParticle.renderPoints.fragment

uniform vec4 color : [1.0, 1.0, 1.0, 1.0];
uniform sampler2D gradientTexture;
uniform sampler2D colorTexture;
uniform sampler2D spriteTexture;

varying float v_Mag;
varying vec2 v_Uv;

void main()
{
 gl_FragColor = color;
#ifdef SPRITETEXTURE_ENABLED
 gl_FragColor *= texture2D(spriteTexture, gl_PointCoord);
 if (color.a == 0.0) {
 discard;
 }
#endif
#ifdef GRADIENTTEXTURE_ENABLED
 gl_FragColor *= texture2D(gradientTexture, vec2(v_Mag, 0.5));
#endif
#ifdef COLORTEXTURE_ENABLED
 gl_FragColor *= texture2D(colorTexture, v_Uv);
#endif
}

@end

@export ecgl.vfParticle.renderLines.vertex

#define PI 3.1415926

attribute vec3 position : POSITION;

uniform sampler2D particleTexture;
uniform sampler2D prevParticleTexture;

uniform float size : 1.0;
uniform vec4 vp: VIEWPORT;
uniform mat4 worldViewProjection : WORLDVIEWPROJECTION;

varying float v_Mag;
varying vec2 v_Uv;

@import clay.util.rand

void main()
{
 vec4 p = texture2D(particleTexture, position.xy);
 vec4 p2 = texture2D(prevParticleTexture, position.xy);

 p.xy = p.xy * 2.0 - 1.0;
 p2.xy = p2.xy * 2.0 - 1.0;

 if (p.w > 0.0 && p.z > 1e-5) {
 vec2 dir = normalize(p.xy - p2.xy);
 vec2 norm = vec2(dir.y / vp.z, -dir.x / vp.w) * sign(position.z) * size;
 if (abs(position.z) == 2.0) {
 gl_Position = vec4(p.xy + norm, 0.0, 1.0);
 v_Uv = p.xy;
 v_Mag = p.z;
 }
 else {
 gl_Position = vec4(p2.xy + norm, 0.0, 1.0);
 v_Mag = p2.z;
 v_Uv = p2.xy;
 }
 gl_Position = worldViewProjection * gl_Position;
 }
 else {
 gl_Position = vec4(100000.0, 100000.0, 100000.0, 1.0);
 }
}

@end

@export ecgl.vfParticle.renderLines.fragment

uniform vec4 color : [1.0, 1.0, 1.0, 1.0];
uniform sampler2D gradientTexture;
uniform sampler2D colorTexture;

varying float v_Mag;
varying vec2 v_Uv;

void main()
{
 gl_FragColor = color;
 #ifdef GRADIENTTEXTURE_ENABLED
 gl_FragColor *= texture2D(gradientTexture, vec2(v_Mag, 0.5));
#endif
#ifdef COLORTEXTURE_ENABLED
 gl_FragColor *= texture2D(colorTexture, v_Uv);
#endif
}

@end
`;H.import(b7);function w7(e){var t=document.createElement("canvas");t.width=t.height=e;var r=t.getContext("2d");return r.fillStyle="#fff",r.arc(e/2,e/2,e/2,0,Math.PI*2),r.fill(),t}var Hh=function(){this.motionBlurFactor=.99,this.vectorFieldTexture=new _e({type:ie.FLOAT,flipY:!1}),this.particleLife=[5,20],this._particleType="point",this._particleSize=1,this.particleColor=[1,1,1,1],this.particleSpeedScaling=1,this._thisFrameTexture=null,this._particlePass=null,this._spawnTexture=null,this._particleTexture0=null,this._particleTexture1=null,this._particlePointsMesh=null,this._surfaceFrameBuffer=null,this._elapsedTime=0,this._scene=null,this._camera=null,this._lastFrameTexture=null,this._supersampling=1,this._downsampleTextures=[],this._width=512,this._height=512,this.init()};Hh.prototype={constructor:Hh,init:function(){var e={type:ie.FLOAT,minFilter:ie.NEAREST,magFilter:ie.NEAREST,useMipmap:!1};this._spawnTexture=new _e(e),this._particleTexture0=new _e(e),this._particleTexture1=new _e(e),this._frameBuffer=new Rt({depthBuffer:!1}),this._particlePass=new dt({fragment:H.source("ecgl.vfParticle.particle.fragment")}),this._particlePass.setUniform("velocityTexture",this.vectorFieldTexture),this._particlePass.setUniform("spawnTexture",this._spawnTexture),this._downsamplePass=new dt({fragment:H.source("clay.compositor.downsample")});var t=new oa({renderOrder:10,material:new Sr({shader:new H(H.source("ecgl.vfParticle.renderPoints.vertex"),H.source("ecgl.vfParticle.renderPoints.fragment"))}),mode:oa.POINTS,geometry:new Me({dynamic:!0,mainAttribute:"texcoord0"})}),r=new oa({renderOrder:10,material:new Sr({shader:new H(H.source("ecgl.vfParticle.renderLines.vertex"),H.source("ecgl.vfParticle.renderLines.fragment"))}),geometry:new T7,culling:!1}),n=new oa({material:new Sr({shader:new H(H.source("ecgl.color.vertex"),H.source("ecgl.color.fragment"))}),geometry:new Yl});n.material.enableTexture("diffuseMap"),this._particlePointsMesh=t,this._particleLinesMesh=r,this._lastFrameFullQuadMesh=n,this._camera=new ni,this._thisFrameTexture=new _e,this._lastFrameTexture=new _e},setParticleDensity:function(e,t){for(var r=e*t,n=new Float32Array(r*4),a=0,i=this.particleLife,o=0;o<e;o++)for(var s=0;s<t;s++,a++){n[a*4]=Math.random(),n[a*4+1]=Math.random(),n[a*4+2]=Math.random();var l=(i[1]-i[0])*Math.random()+i[0];n[a*4+3]=l}this._particleType==="line"?this._setLineGeometry(e,t):this._setPointsGeometry(e,t),this._spawnTexture.width=e,this._spawnTexture.height=t,this._spawnTexture.pixels=n,this._particleTexture0.width=this._particleTexture1.width=e,this._particleTexture0.height=this._particleTexture1.height=t,this._particlePass.setUniform("textureSize",[e,t])},_setPointsGeometry:function(e,t){var r=e*t,n=this._particlePointsMesh.geometry,a=n.attributes;a.texcoord0.init(r);for(var i=0,o=0;o<e;o++)for(var s=0;s<t;s++,i++)a.texcoord0.value[i*2]=o/e,a.texcoord0.value[i*2+1]=s/t;n.dirty()},_setLineGeometry:function(e,t){var r=e*t,n=this._getParticleMesh().geometry;n.setLineCount(r),n.resetOffset();for(var a=0;a<e;a++)for(var i=0;i<t;i++)n.addLine([a/e,i/t]);n.dirty()},_getParticleMesh:function(){return this._particleType==="line"?this._particleLinesMesh:this._particlePointsMesh},update:function(e,t,r,n){var a=this._getParticleMesh(),i=this._frameBuffer,o=this._particlePass;n&&this._updateDownsampleTextures(e,t),a.material.set("size",this._particleSize*this._supersampling),a.material.set("color",this.particleColor),o.setUniform("speedScaling",this.particleSpeedScaling),i.attach(this._particleTexture1),o.setUniform("firstFrameTime",n?(this.particleLife[1]+this.particleLife[0])/2:0),o.setUniform("particleTexture",this._particleTexture0),o.setUniform("deltaTime",r),o.setUniform("elapsedTime",this._elapsedTime),o.render(e,i),a.material.set("particleTexture",this._particleTexture1),a.material.set("prevParticleTexture",this._particleTexture0),i.attach(this._thisFrameTexture),i.bind(e),e.gl.clear(e.gl.DEPTH_BUFFER_BIT|e.gl.COLOR_BUFFER_BIT);var s=this._lastFrameFullQuadMesh;s.material.set("diffuseMap",this._lastFrameTexture),s.material.set("color",[1,1,1,this.motionBlurFactor]),this._camera.update(!0),e.renderPass([s,a],this._camera),i.unbind(e),this._downsample(e),this._swapTexture(),this._elapsedTime+=r},_downsample:function(e){var t=this._downsampleTextures;if(t.length!==0)for(var r=0,n=this._thisFrameTexture,a=t[r];a;)this._frameBuffer.attach(a),this._downsamplePass.setUniform("texture",n),this._downsamplePass.setUniform("textureSize",[n.width,n.height]),this._downsamplePass.render(e,this._frameBuffer),n=a,a=t[++r]},getSurfaceTexture:function(){var e=this._downsampleTextures;return e.length>0?e[e.length-1]:this._lastFrameTexture},setRegion:function(e){this._particlePass.setUniform("region",e)},resize:function(e,t){this._lastFrameTexture.width=e*this._supersampling,this._lastFrameTexture.height=t*this._supersampling,this._thisFrameTexture.width=e*this._supersampling,this._thisFrameTexture.height=t*this._supersampling,this._width=e,this._height=t},setParticleSize:function(e){var t=this._getParticleMesh();if(e<=2){t.material.disableTexture("spriteTexture"),t.material.transparent=!1;return}this._spriteTexture||(this._spriteTexture=new _e),(!this._spriteTexture.image||this._spriteTexture.image.width!==e)&&(this._spriteTexture.image=w7(e),this._spriteTexture.dirty()),t.material.transparent=!0,t.material.enableTexture("spriteTexture"),t.material.set("spriteTexture",this._spriteTexture),this._particleSize=e},setGradientTexture:function(e){var t=this._getParticleMesh().material;t[e?"enableTexture":"disableTexture"]("gradientTexture"),t.setUniform("gradientTexture",e)},setColorTextureImage:function(e,t){var r=this._getParticleMesh().material;r.setTextureImage("colorTexture",e,t,{flipY:!0})},setParticleType:function(e){this._particleType=e},clearFrame:function(e){var t=this._frameBuffer;t.attach(this._lastFrameTexture),t.bind(e),e.gl.clear(e.gl.DEPTH_BUFFER_BIT|e.gl.COLOR_BUFFER_BIT),t.unbind(e)},setSupersampling:function(e){this._supersampling=e,this.resize(this._width,this._height)},_updateDownsampleTextures:function(e,t){for(var r=this._downsampleTextures,n=Math.max(Math.floor(Math.log(this._supersampling/t.getDevicePixelRatio())/Math.log(2)),0),a=2,i=this._width*this._supersampling,o=this._height*this._supersampling,s=0;s<n;s++)r[s]=r[s]||new _e,r[s].width=i/a,r[s].height=o/a,a*=2;for(;s<r.length;s++)r[s].dispose(e);r.length=n},_swapTexture:function(){var e=this._particleTexture0;this._particleTexture0=this._particleTexture1,this._particleTexture1=e;var e=this._thisFrameTexture;this._thisFrameTexture=this._lastFrameTexture,this._lastFrameTexture=e},dispose:function(e){e.disposeFrameBuffer(this._frameBuffer),e.disposeTexture(this.vectorFieldTexture),e.disposeTexture(this._spawnTexture),e.disposeTexture(this._particleTexture0),e.disposeTexture(this._particleTexture1),e.disposeTexture(this._thisFrameTexture),e.disposeTexture(this._lastFrameTexture),e.disposeGeometry(this._particleLinesMesh.geometry),e.disposeGeometry(this._particlePointsMesh.geometry),e.disposeGeometry(this._lastFrameFullQuadMesh.geometry),this._spriteTexture&&e.disposeTexture(this._spriteTexture),this._particlePass.dispose(e),this._downsamplePass.dispose(e),this._downsampleTextures.forEach(function(t){t.dispose(e)})}};const A7=Hh,E7=He.extend({type:"flowGL",__ecgl__:!0,init:function(e,t){this.viewGL=new Oe("orthographic"),this.groupGL=new D.Node,this.viewGL.add(this.groupGL),this._particleSurface=new A7;var r=new D.Mesh({geometry:new D.PlaneGeometry,material:new D.Material({shader:new D.Shader({vertex:D.Shader.source("ecgl.color.vertex"),fragment:D.Shader.source("ecgl.color.fragment")}),transparent:!0})});r.material.enableTexture("diffuseMap"),this.groupGL.add(r),this._planeMesh=r},render:function(e,t,r){var n=this._particleSurface;n.setParticleType(e.get("particleType")),n.setSupersampling(e.get("supersampling")),this._updateData(e,r),this._updateCamera(r.getWidth(),r.getHeight(),r.getDevicePixelRatio());var a=Se.firstNotNull(e.get("particleDensity"),128);n.setParticleDensity(a,a);var i=this._planeMesh,o=+new Date,s=this,l=!0;i.__percent=0,i.stopAnimation(),i.animate("",{loop:!0}).when(1e5,{__percent:1}).during(function(){var h=+new Date,f=Math.min(h-o,20);o=o+f,s._renderer&&(n.update(s._renderer,r,f/1e3,l),i.material.set("diffuseMap",n.getSurfaceTexture())),l=!1}).start();var u=e.getModel("itemStyle"),c=D.parseColor(u.get("color"));c[3]*=Se.firstNotNull(u.get("opacity"),1),i.material.set("color",c),n.setColorTextureImage(e.get("colorTexture"),r),n.setParticleSize(e.get("particleSize")),n.particleSpeedScaling=e.get("particleSpeed"),n.motionBlurFactor=1-Math.pow(.1,e.get("particleTrail"))},updateTransform:function(e,t,r){this._updateData(e,r)},afterRender:function(e,t,r,n){var a=n.renderer;this._renderer=a},_updateData:function(e,t){var r=e.coordinateSystem,n=r.dimensions.map(function(_){return e.coordDimToDataDim(_)[0]}),a=e.getData(),i=a.getDataExtent(n[0]),o=a.getDataExtent(n[1]),s=e.get("gridWidth"),l=e.get("gridHeight");if(s==null||s==="auto"){var u=(i[1]-i[0])/(o[1]-o[0]);s=Math.round(Math.sqrt(u*a.count()))}(l==null||l==="auto")&&(l=Math.ceil(a.count()/s));var c=this._particleSurface.vectorFieldTexture,h=c.pixels;if(!h||h.length!==l*s*4)h=c.pixels=new Float32Array(s*l*4);else for(var f=0;f<h.length;f++)h[f]=0;var d=0,v=1/0,p=new Float32Array(a.count()*2),g=0,m=[[1/0,1/0],[-1/0,-1/0]];a.each([n[0],n[1],"vx","vy"],function(_,y,x,S){var T=r.dataToPoint([_,y]);p[g++]=T[0],p[g++]=T[1],m[0][0]=Math.min(T[0],m[0][0]),m[0][1]=Math.min(T[1],m[0][1]),m[1][0]=Math.max(T[0],m[1][0]),m[1][1]=Math.max(T[1],m[1][1]);var b=Math.sqrt(x*x+S*S);d=Math.max(d,b),v=Math.min(v,b)}),a.each(["vx","vy"],function(_,y,x){var S=Math.round((p[x*2]-m[0][0])/(m[1][0]-m[0][0])*(s-1)),T=l-1-Math.round((p[x*2+1]-m[0][1])/(m[1][1]-m[0][1])*(l-1)),b=(T*s+S)*4;h[b]=_/d*.5+.5,h[b+1]=y/d*.5+.5,h[b+3]=1}),c.width=s,c.height=l,e.get("coordinateSystem")==="bmap"&&this._fillEmptyPixels(c),c.dirty(),this._updatePlanePosition(m[0],m[1],e,t),this._updateGradientTexture(a.getVisual("visualMeta"),[v,d])},_fillEmptyPixels:function(e){var t=e.pixels,r=e.width,n=e.height;function a(p,g,m){p=Math.max(Math.min(p,r-1),0),g=Math.max(Math.min(g,n-1),0);var _=(g*(r-1)+p)*4;return t[_+3]===0?!1:(m[0]=t[_],m[1]=t[_+1],!0)}function i(p,g,m){m[0]=p[0]+g[0],m[1]=p[1]+g[1]}for(var o=[],s=[],l=[],u=[],c=[],h=0,f=0;f<n;f++)for(var d=0;d<r;d++){var v=(f*(r-1)+d)*4;t[v+3]===0&&(h=o[0]=o[1]=0,a(d-1,f,s)&&(h++,i(s,o,o)),a(d+1,f,l)&&(h++,i(l,o,o)),a(d,f-1,u)&&(h++,i(u,o,o)),a(d,f+1,c)&&(h++,i(c,o,o)),o[0]/=h,o[1]/=h,t[v]=o[0],t[v+1]=o[1]),t[v+3]=1}},_updateGradientTexture:function(e,t){if(!e||!e.length){this._particleSurface.setGradientTexture(null);return}this._gradientTexture=this._gradientTexture||new D.Texture2D({image:document.createElement("canvas")});var r=this._gradientTexture,n=r.image;n.width=200,n.height=1;var a=n.getContext("2d"),i=a.createLinearGradient(0,.5,n.width,.5);e[0].stops.forEach(function(o){var s;t[1]===t[0]?s=0:(s=o.value/t[1],s=Math.min(Math.max(s,0),1)),i.addColorStop(s,o.color)}),a.fillStyle=i,a.fillRect(0,0,n.width,n.height),r.dirty(),this._particleSurface.setGradientTexture(this._gradientTexture)},_updatePlanePosition:function(e,t,r,n){var a=this._limitInViewportAndFullFill(e,t,r,n);e=a.leftTop,t=a.rightBottom,this._particleSurface.setRegion(a.region),this._planeMesh.position.set((e[0]+t[0])/2,n.getHeight()-(e[1]+t[1])/2,0);var i=t[0]-e[0],o=t[1]-e[1];this._planeMesh.scale.set(i/2,o/2,1),this._particleSurface.resize(Math.max(Math.min(i,2048),1),Math.max(Math.min(o,2048),1)),this._renderer&&this._particleSurface.clearFrame(this._renderer)},_limitInViewportAndFullFill:function(e,t,r,n){var a=[Math.max(e[0],0),Math.max(e[1],0)],i=[Math.min(t[0],n.getWidth()),Math.min(t[1],n.getHeight())];if(r.get("coordinateSystem")==="bmap"){var o=r.getData().getDataExtent(r.coordDimToDataDim("lng")[0]),s=Math.floor(o[1]-o[0])>=359;s&&(a[0]>0&&(a[0]=0),i[0]<n.getWidth()&&(i[0]=n.getWidth()))}var l=t[0]-e[0],u=t[1]-e[1],c=i[0]-a[0],h=i[1]-a[1],f=[(a[0]-e[0])/l,1-h/u-(a[1]-e[1])/u,c/l,h/u];return{leftTop:a,rightBottom:i,region:f}},_updateCamera:function(e,t,r){this.viewGL.setViewport(0,0,e,t,r);var n=this.viewGL.camera;n.left=n.bottom=0,n.top=t,n.right=e,n.near=0,n.far=100,n.position.z=10},remove:function(){this._planeMesh.stopAnimation(),this.groupGL.removeAll()},dispose:function(){this._renderer&&this._particleSurface.dispose(this._renderer),this.groupGL.removeAll()}});function C7(e){e.registerChartView(E7),e.registerSeriesModel(x7)}oe(C7);var Wh=$e.extend({type:"series.linesGL",dependencies:["grid","geo"],visualStyleAccessPath:"lineStyle",visualDrawType:"stroke",streamEnabled:!0,init:function(e){var t=this._processFlatCoordsArray(e.data);this._flatCoords=t.flatCoords,this._flatCoordsOffset=t.flatCoordsOffset,t.flatCoords&&(e.data=new Float32Array(t.count)),Wh.superApply(this,"init",arguments)},mergeOption:function(e){var t=this._processFlatCoordsArray(e.data);this._flatCoords=t.flatCoords,this._flatCoordsOffset=t.flatCoordsOffset,t.flatCoords&&(e.data=new Float32Array(t.count)),Wh.superApply(this,"mergeOption",arguments)},appendData:function(e){var t=this._processFlatCoordsArray(e.data);t.flatCoords&&(this._flatCoords?(this._flatCoords=so(this._flatCoords,t.flatCoords),this._flatCoordsOffset=so(this._flatCoordsOffset,t.flatCoordsOffset)):(this._flatCoords=t.flatCoords,this._flatCoordsOffset=t.flatCoordsOffset),e.data=new Float32Array(t.count)),this.getRawData().appendData(e.data)},_getCoordsFromItemModel:function(e){var t=this.getData().getItemModel(e),r=t.option instanceof Array?t.option:t.getShallow("coords");return r},getLineCoordsCount:function(e){return this._flatCoordsOffset?this._flatCoordsOffset[e*2+1]:this._getCoordsFromItemModel(e).length},getLineCoords:function(e,t){if(this._flatCoordsOffset){for(var r=this._flatCoordsOffset[e*2],n=this._flatCoordsOffset[e*2+1],a=0;a<n;a++)t[a]=t[a]||[],t[a][0]=this._flatCoords[r+a*2],t[a][1]=this._flatCoords[r+a*2+1];return n}else{for(var i=this._getCoordsFromItemModel(e),a=0;a<i.length;a++)t[a]=t[a]||[],t[a][0]=i[a][0],t[a][1]=i[a][1];return i.length}},_processFlatCoordsArray:function(e){var t=0;if(this._flatCoords&&(t=this._flatCoords.length),typeof e[0]=="number"){for(var r=e.length,n=new Uint32Array(r),a=new Float64Array(r),i=0,o=0,s=0,l=0;l<r;){s++;var u=e[l++];n[o++]=i+t,n[o++]=u;for(var c=0;c<u;c++){var h=e[l++],f=e[l++];a[i++]=h,a[i++]=f}}return{flatCoordsOffset:new Uint32Array(n.buffer,0,o),flatCoords:a,count:s}}return{flatCoordsOffset:null,flatCoords:null,count:e.length}},getInitialData:function(e,t){var r=new it(["value"],this);return r.hasItemOption=!1,r.initData(e.data,[],function(n,a,i,o){if(n instanceof Array)return NaN;r.hasItemOption=!0;var s=n.value;if(s!=null)return s instanceof Array?s[o]:s}),r},defaultOption:{coordinateSystem:"geo",zlevel:10,progressive:1e4,progressiveThreshold:5e4,blendMode:"source-over",lineStyle:{opacity:.8},postEffect:{enable:!1,colorCorrection:{exposure:0,brightness:0,contrast:1,saturation:1,enable:!0}}}});const L7=Wh,D7=He.extend({type:"linesGL",__ecgl__:!0,init:function(e,t){this.groupGL=new D.Node,this.viewGL=new Oe("orthographic"),this.viewGL.add(this.groupGL),this._glViewHelper=new dn(this.viewGL),this._nativeLinesShader=D.createShader("ecgl.lines3D"),this._meshLinesShader=D.createShader("ecgl.meshLines3D"),this._linesMeshes=[],this._currentStep=0},render:function(e,t,r){this.groupGL.removeAll(),this._glViewHelper.reset(e,r);var n=this._linesMeshes[0];n||(n=this._linesMeshes[0]=this._createLinesMesh(e)),this._linesMeshes.length=1,this.groupGL.add(n),this._updateLinesMesh(e,n,0,e.getData().count()),this.viewGL.setPostEffect(e.getModel("postEffect"),r)},incrementalPrepareRender:function(e,t,r){this.groupGL.removeAll(),this._glViewHelper.reset(e,r),this._currentStep=0,this.viewGL.setPostEffect(e.getModel("postEffect"),r)},incrementalRender:function(e,t,r,n){var a=this._linesMeshes[this._currentStep];a||(a=this._createLinesMesh(t),this._linesMeshes[this._currentStep]=a),this._updateLinesMesh(t,a,e.start,e.end),this.groupGL.add(a),n.getZr().refresh(),this._currentStep++},updateTransform:function(e,t,r){e.coordinateSystem.getRoamTransform&&this._glViewHelper.updateTransform(e,r)},_createLinesMesh:function(e){var t=new D.Mesh({$ignorePicking:!0,material:new D.Material({shader:D.createShader("ecgl.lines3D"),transparent:!0,depthMask:!1,depthTest:!1}),geometry:new o2({segmentScale:10,useNativeLine:!0,dynamic:!1}),mode:D.Mesh.LINES,culling:!1});return t},_updateLinesMesh:function(e,t,r,n){var a=e.getData();t.material.blend=e.get("blendMode")==="lighter"?D.additiveBlend:null;var i=e.get("lineStyle.curveness")||0,o=e.get("polyline"),s=t.geometry,l=e.coordinateSystem,u=Se.firstNotNull(e.get("lineStyle.width"),1);u>1?(t.material.shader!==this._meshLinesShader&&t.material.attachShader(this._meshLinesShader),t.mode=D.Mesh.TRIANGLES):(t.material.shader!==this._nativeLinesShader&&t.material.attachShader(this._nativeLinesShader),t.mode=D.Mesh.LINES),r=r||0,n=n||a.count(),s.resetOffset();var c=0,h=0,f=[],d=[],v=[],p=[],g=[],m=.3,_=.7;function y(){d[0]=f[0]*_+p[0]*m-(f[1]-p[1])*i,d[1]=f[1]*_+p[1]*m-(p[0]-f[0])*i,v[0]=f[0]*m+p[0]*_-(f[1]-p[1])*i,v[1]=f[1]*m+p[1]*_-(p[0]-f[0])*i}if(o||i!==0)for(var x=r;x<n;x++)if(o){var S=e.getLineCoordsCount(x);c+=s.getPolylineVertexCount(S),h+=s.getPolylineTriangleCount(S)}else e.getLineCoords(x,g),this._glViewHelper.dataToPoint(l,g[0],f),this._glViewHelper.dataToPoint(l,g[1],p),y(),c+=s.getCubicCurveVertexCount(f,d,v,p),h+=s.getCubicCurveTriangleCount(f,d,v,p);else{var T=n-r;c+=T*s.getLineVertexCount(),h+=T*s.getLineVertexCount()}s.setVertexCount(c),s.setTriangleCount(h);for(var b=r,w=[],x=r;x<n;x++){D.parseColor(Ct(a,b),w);var A=Se.firstNotNull(At(a,b),1);w[3]*=A;for(var S=e.getLineCoords(x,g),E=0;E<S;E++)this._glViewHelper.dataToPoint(l,g[E],g[E]);o?s.addPolyline(g,w,u,0,S):i!==0?(f=g[0],p=g[1],y(),s.addCubicCurve(f,d,v,p,w,u)):s.addPolyline(g,w,u,0,2),b++}},dispose:function(){this.groupGL.removeAll()},remove:function(){this.groupGL.removeAll()}});function M7(e){e.registerChartView(D7),e.registerSeriesModel(L7)}oe(M7);function s2(e,t){return function(){return e.apply(t,arguments)}}const{toString:P7}=Object.prototype,{getPrototypeOf:Ad}=Object,ru=(e=>t=>{const r=P7.call(t);return e[r]||(e[r]=r.slice(8,-1).toLowerCase())})(Object.create(null)),jr=e=>(e=e.toLowerCase(),t=>ru(t)===e),nu=e=>t=>typeof t===e,{isArray:_i}=Array,Do=nu("undefined");function I7(e){return e!==null&&!Do(e)&&e.constructor!==null&&!Do(e.constructor)&&br(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const l2=jr("ArrayBuffer");function R7(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&l2(e.buffer),t}const N7=nu("string"),br=nu("function"),u2=nu("number"),au=e=>e!==null&&typeof e=="object",O7=e=>e===!0||e===!1,Rs=e=>{if(ru(e)!=="object")return!1;const t=Ad(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},B7=jr("Date"),F7=jr("File"),z7=jr("Blob"),G7=jr("FileList"),V7=e=>au(e)&&br(e.pipe),U7=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||br(e.append)&&((t=ru(e))==="formdata"||t==="object"&&br(e.toString)&&e.toString()==="[object FormData]"))},k7=jr("URLSearchParams"),H7=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function ko(e,t,{allOwnKeys:r=!1}={}){if(e===null||typeof e>"u")return;let n,a;if(typeof e!="object"&&(e=[e]),_i(e))for(n=0,a=e.length;n<a;n++)t.call(null,e[n],n,e);else{const i=r?Object.getOwnPropertyNames(e):Object.keys(e),o=i.length;let s;for(n=0;n<o;n++)s=i[n],t.call(null,e[s],s,e)}}function c2(e,t){t=t.toLowerCase();const r=Object.keys(e);let n=r.length,a;for(;n-- >0;)if(a=r[n],t===a.toLowerCase())return a;return null}const h2=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,f2=e=>!Do(e)&&e!==h2;function $h(){const{caseless:e}=f2(this)&&this||{},t={},r=(n,a)=>{const i=e&&c2(t,a)||a;Rs(t[i])&&Rs(n)?t[i]=$h(t[i],n):Rs(n)?t[i]=$h({},n):_i(n)?t[i]=n.slice():t[i]=n};for(let n=0,a=arguments.length;n<a;n++)arguments[n]&&ko(arguments[n],r);return t}const W7=(e,t,r,{allOwnKeys:n}={})=>(ko(t,(a,i)=>{r&&br(a)?e[i]=s2(a,r):e[i]=a},{allOwnKeys:n}),e),$7=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),X7=(e,t,r,n)=>{e.prototype=Object.create(t.prototype,n),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),r&&Object.assign(e.prototype,r)},j7=(e,t,r,n)=>{let a,i,o;const s={};if(t=t||{},e==null)return t;do{for(a=Object.getOwnPropertyNames(e),i=a.length;i-- >0;)o=a[i],(!n||n(o,e,t))&&!s[o]&&(t[o]=e[o],s[o]=!0);e=r!==!1&&Ad(e)}while(e&&(!r||r(e,t))&&e!==Object.prototype);return t},Z7=(e,t,r)=>{e=String(e),(r===void 0||r>e.length)&&(r=e.length),r-=t.length;const n=e.indexOf(t,r);return n!==-1&&n===r},Y7=e=>{if(!e)return null;if(_i(e))return e;let t=e.length;if(!u2(t))return null;const r=new Array(t);for(;t-- >0;)r[t]=e[t];return r},q7=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&Ad(Uint8Array)),K7=(e,t)=>{const n=(e&&e[Symbol.iterator]).call(e);let a;for(;(a=n.next())&&!a.done;){const i=a.value;t.call(e,i[0],i[1])}},J7=(e,t)=>{let r;const n=[];for(;(r=e.exec(t))!==null;)n.push(r);return n},Q7=jr("HTMLFormElement"),eO=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(r,n,a){return n.toUpperCase()+a}),n0=(({hasOwnProperty:e})=>(t,r)=>e.call(t,r))(Object.prototype),tO=jr("RegExp"),d2=(e,t)=>{const r=Object.getOwnPropertyDescriptors(e),n={};ko(r,(a,i)=>{let o;(o=t(a,i,e))!==!1&&(n[i]=o||a)}),Object.defineProperties(e,n)},rO=e=>{d2(e,(t,r)=>{if(br(e)&&["arguments","caller","callee"].indexOf(r)!==-1)return!1;const n=e[r];if(br(n)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")})}})},nO=(e,t)=>{const r={},n=a=>{a.forEach(i=>{r[i]=!0})};return _i(e)?n(e):n(String(e).split(t)),r},aO=()=>{},iO=(e,t)=>(e=+e,Number.isFinite(e)?e:t),Uc="abcdefghijklmnopqrstuvwxyz",a0="0123456789",v2={DIGIT:a0,ALPHA:Uc,ALPHA_DIGIT:Uc+Uc.toUpperCase()+a0},oO=(e=16,t=v2.ALPHA_DIGIT)=>{let r="";const{length:n}=t;for(;e--;)r+=t[Math.random()*n|0];return r};function sO(e){return!!(e&&br(e.append)&&e[Symbol.toStringTag]==="FormData"&&e[Symbol.iterator])}const lO=e=>{const t=new Array(10),r=(n,a)=>{if(au(n)){if(t.indexOf(n)>=0)return;if(!("toJSON"in n)){t[a]=n;const i=_i(n)?[]:{};return ko(n,(o,s)=>{const l=r(o,a+1);!Do(l)&&(i[s]=l)}),t[a]=void 0,i}}return n};return r(e,0)},uO=jr("AsyncFunction"),cO=e=>e&&(au(e)||br(e))&&br(e.then)&&br(e.catch),V={isArray:_i,isArrayBuffer:l2,isBuffer:I7,isFormData:U7,isArrayBufferView:R7,isString:N7,isNumber:u2,isBoolean:O7,isObject:au,isPlainObject:Rs,isUndefined:Do,isDate:B7,isFile:F7,isBlob:z7,isRegExp:tO,isFunction:br,isStream:V7,isURLSearchParams:k7,isTypedArray:q7,isFileList:G7,forEach:ko,merge:$h,extend:W7,trim:H7,stripBOM:$7,inherits:X7,toFlatObject:j7,kindOf:ru,kindOfTest:jr,endsWith:Z7,toArray:Y7,forEachEntry:K7,matchAll:J7,isHTMLForm:Q7,hasOwnProperty:n0,hasOwnProp:n0,reduceDescriptors:d2,freezeMethods:rO,toObjectSet:nO,toCamelCase:eO,noop:aO,toFiniteNumber:iO,findKey:c2,global:h2,isContextDefined:f2,ALPHABET:v2,generateString:oO,isSpecCompliantForm:sO,toJSONObject:lO,isAsyncFn:uO,isThenable:cO};function Ie(e,t,r,n,a){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),r&&(this.config=r),n&&(this.request=n),a&&(this.response=a)}V.inherits(Ie,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:V.toJSONObject(this.config),code:this.code,status:this.response&&this.response.status?this.response.status:null}}});const p2=Ie.prototype,g2={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{g2[e]={value:e}});Object.defineProperties(Ie,g2);Object.defineProperty(p2,"isAxiosError",{value:!0});Ie.from=(e,t,r,n,a,i)=>{const o=Object.create(p2);return V.toFlatObject(e,o,function(l){return l!==Error.prototype},s=>s!=="isAxiosError"),Ie.call(o,e.message,t,r,n,a),o.cause=e,o.name=e.name,i&&Object.assign(o,i),o};const hO=null;function Xh(e){return V.isPlainObject(e)||V.isArray(e)}function m2(e){return V.endsWith(e,"[]")?e.slice(0,-2):e}function i0(e,t,r){return e?e.concat(t).map(function(a,i){return a=m2(a),!r&&i?"["+a+"]":a}).join(r?".":""):t}function fO(e){return V.isArray(e)&&!e.some(Xh)}const dO=V.toFlatObject(V,{},null,function(t){return/^is[A-Z]/.test(t)});function iu(e,t,r){if(!V.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,r=V.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,function(p,g){return!V.isUndefined(g[p])});const n=r.metaTokens,a=r.visitor||c,i=r.dots,o=r.indexes,l=(r.Blob||typeof Blob<"u"&&Blob)&&V.isSpecCompliantForm(t);if(!V.isFunction(a))throw new TypeError("visitor must be a function");function u(v){if(v===null)return"";if(V.isDate(v))return v.toISOString();if(!l&&V.isBlob(v))throw new Ie("Blob is not supported. Use a Buffer instead.");return V.isArrayBuffer(v)||V.isTypedArray(v)?l&&typeof Blob=="function"?new Blob([v]):Buffer.from(v):v}function c(v,p,g){let m=v;if(v&&!g&&typeof v=="object"){if(V.endsWith(p,"{}"))p=n?p:p.slice(0,-2),v=JSON.stringify(v);else if(V.isArray(v)&&fO(v)||(V.isFileList(v)||V.endsWith(p,"[]"))&&(m=V.toArray(v)))return p=m2(p),m.forEach(function(y,x){!(V.isUndefined(y)||y===null)&&t.append(o===!0?i0([p],x,i):o===null?p:p+"[]",u(y))}),!1}return Xh(v)?!0:(t.append(i0(g,p,i),u(v)),!1)}const h=[],f=Object.assign(dO,{defaultVisitor:c,convertValue:u,isVisitable:Xh});function d(v,p){if(!V.isUndefined(v)){if(h.indexOf(v)!==-1)throw Error("Circular reference detected in "+p.join("."));h.push(v),V.forEach(v,function(m,_){(!(V.isUndefined(m)||m===null)&&a.call(t,m,V.isString(_)?_.trim():_,p,f))===!0&&d(m,p?p.concat(_):[_])}),h.pop()}}if(!V.isObject(e))throw new TypeError("data must be an object");return d(e),t}function o0(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(n){return t[n]})}function Ed(e,t){this._pairs=[],e&&iu(e,this,t)}const y2=Ed.prototype;y2.append=function(t,r){this._pairs.push([t,r])};y2.toString=function(t){const r=t?function(n){return t.call(this,n,o0)}:o0;return this._pairs.map(function(a){return r(a[0])+"="+r(a[1])},"").join("&")};function vO(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function _2(e,t,r){if(!t)return e;const n=r&&r.encode||vO,a=r&&r.serialize;let i;if(a?i=a(t,r):i=V.isURLSearchParams(t)?t.toString():new Ed(t,r).toString(n),i){const o=e.indexOf("#");o!==-1&&(e=e.slice(0,o)),e+=(e.indexOf("?")===-1?"?":"&")+i}return e}class pO{constructor(){this.handlers=[]}use(t,r,n){return this.handlers.push({fulfilled:t,rejected:r,synchronous:n?n.synchronous:!1,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){V.forEach(this.handlers,function(n){n!==null&&t(n)})}}const s0=pO,x2={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},gO=typeof URLSearchParams<"u"?URLSearchParams:Ed,mO=typeof FormData<"u"?FormData:null,yO=typeof Blob<"u"?Blob:null,_O={isBrowser:!0,classes:{URLSearchParams:gO,FormData:mO,Blob:yO},protocols:["http","https","file","blob","url","data"]},S2=typeof window<"u"&&typeof document<"u",xO=(e=>S2&&["ReactNative","NativeScript","NS"].indexOf(e)<0)(typeof navigator<"u"&&navigator.product),SO=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",TO=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:S2,hasStandardBrowserEnv:xO,hasStandardBrowserWebWorkerEnv:SO},Symbol.toStringTag,{value:"Module"})),Ur={...TO,..._O};function bO(e,t){return iu(e,new Ur.classes.URLSearchParams,Object.assign({visitor:function(r,n,a,i){return Ur.isNode&&V.isBuffer(r)?(this.append(n,r.toString("base64")),!1):i.defaultVisitor.apply(this,arguments)}},t))}function wO(e){return V.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function AO(e){const t={},r=Object.keys(e);let n;const a=r.length;let i;for(n=0;n<a;n++)i=r[n],t[i]=e[i];return t}function T2(e){function t(r,n,a,i){let o=r[i++];const s=Number.isFinite(+o),l=i>=r.length;return o=!o&&V.isArray(a)?a.length:o,l?(V.hasOwnProp(a,o)?a[o]=[a[o],n]:a[o]=n,!s):((!a[o]||!V.isObject(a[o]))&&(a[o]=[]),t(r,n,a[o],i)&&V.isArray(a[o])&&(a[o]=AO(a[o])),!s)}if(V.isFormData(e)&&V.isFunction(e.entries)){const r={};return V.forEachEntry(e,(n,a)=>{t(wO(n),a,r,0)}),r}return null}function EO(e,t,r){if(V.isString(e))try{return(t||JSON.parse)(e),V.trim(e)}catch(n){if(n.name!=="SyntaxError")throw n}return(r||JSON.stringify)(e)}const Cd={transitional:x2,adapter:["xhr","http"],transformRequest:[function(t,r){const n=r.getContentType()||"",a=n.indexOf("application/json")>-1,i=V.isObject(t);if(i&&V.isHTMLForm(t)&&(t=new FormData(t)),V.isFormData(t))return a&&a?JSON.stringify(T2(t)):t;if(V.isArrayBuffer(t)||V.isBuffer(t)||V.isStream(t)||V.isFile(t)||V.isBlob(t))return t;if(V.isArrayBufferView(t))return t.buffer;if(V.isURLSearchParams(t))return r.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let s;if(i){if(n.indexOf("application/x-www-form-urlencoded")>-1)return bO(t,this.formSerializer).toString();if((s=V.isFileList(t))||n.indexOf("multipart/form-data")>-1){const l=this.env&&this.env.FormData;return iu(s?{"files[]":t}:t,l&&new l,this.formSerializer)}}return i||a?(r.setContentType("application/json",!1),EO(t)):t}],transformResponse:[function(t){const r=this.transitional||Cd.transitional,n=r&&r.forcedJSONParsing,a=this.responseType==="json";if(t&&V.isString(t)&&(n&&!this.responseType||a)){const o=!(r&&r.silentJSONParsing)&&a;try{return JSON.parse(t)}catch(s){if(o)throw s.name==="SyntaxError"?Ie.from(s,Ie.ERR_BAD_RESPONSE,this,null,this.response):s}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Ur.classes.FormData,Blob:Ur.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};V.forEach(["delete","get","head","post","put","patch"],e=>{Cd.headers[e]={}});const Ld=Cd,CO=V.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),LO=e=>{const t={};let r,n,a;return e&&e.split(`
`).forEach(function(o){a=o.indexOf(":"),r=o.substring(0,a).trim().toLowerCase(),n=o.substring(a+1).trim(),!(!r||t[r]&&CO[r])&&(r==="set-cookie"?t[r]?t[r].push(n):t[r]=[n]:t[r]=t[r]?t[r]+", "+n:n)}),t},l0=Symbol("internals");function Vi(e){return e&&String(e).trim().toLowerCase()}function Ns(e){return e===!1||e==null?e:V.isArray(e)?e.map(Ns):String(e)}function DO(e){const t=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let n;for(;n=r.exec(e);)t[n[1]]=n[2];return t}const MO=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function kc(e,t,r,n,a){if(V.isFunction(n))return n.call(this,t,r);if(a&&(t=r),!!V.isString(t)){if(V.isString(n))return t.indexOf(n)!==-1;if(V.isRegExp(n))return n.test(t)}}function PO(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,r,n)=>r.toUpperCase()+n)}function IO(e,t){const r=V.toCamelCase(" "+t);["get","set","has"].forEach(n=>{Object.defineProperty(e,n+r,{value:function(a,i,o){return this[n].call(this,t,a,i,o)},configurable:!0})})}class ou{constructor(t){t&&this.set(t)}set(t,r,n){const a=this;function i(s,l,u){const c=Vi(l);if(!c)throw new Error("header name must be a non-empty string");const h=V.findKey(a,c);(!h||a[h]===void 0||u===!0||u===void 0&&a[h]!==!1)&&(a[h||l]=Ns(s))}const o=(s,l)=>V.forEach(s,(u,c)=>i(u,c,l));return V.isPlainObject(t)||t instanceof this.constructor?o(t,r):V.isString(t)&&(t=t.trim())&&!MO(t)?o(LO(t),r):t!=null&&i(r,t,n),this}get(t,r){if(t=Vi(t),t){const n=V.findKey(this,t);if(n){const a=this[n];if(!r)return a;if(r===!0)return DO(a);if(V.isFunction(r))return r.call(this,a,n);if(V.isRegExp(r))return r.exec(a);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,r){if(t=Vi(t),t){const n=V.findKey(this,t);return!!(n&&this[n]!==void 0&&(!r||kc(this,this[n],n,r)))}return!1}delete(t,r){const n=this;let a=!1;function i(o){if(o=Vi(o),o){const s=V.findKey(n,o);s&&(!r||kc(n,n[s],s,r))&&(delete n[s],a=!0)}}return V.isArray(t)?t.forEach(i):i(t),a}clear(t){const r=Object.keys(this);let n=r.length,a=!1;for(;n--;){const i=r[n];(!t||kc(this,this[i],i,t,!0))&&(delete this[i],a=!0)}return a}normalize(t){const r=this,n={};return V.forEach(this,(a,i)=>{const o=V.findKey(n,i);if(o){r[o]=Ns(a),delete r[i];return}const s=t?PO(i):String(i).trim();s!==i&&delete r[i],r[s]=Ns(a),n[s]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const r=Object.create(null);return V.forEach(this,(n,a)=>{n!=null&&n!==!1&&(r[a]=t&&V.isArray(n)?n.join(", "):n)}),r}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,r])=>t+": "+r).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...r){const n=new this(t);return r.forEach(a=>n.set(a)),n}static accessor(t){const n=(this[l0]=this[l0]={accessors:{}}).accessors,a=this.prototype;function i(o){const s=Vi(o);n[s]||(IO(a,o),n[s]=!0)}return V.isArray(t)?t.forEach(i):i(t),this}}ou.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);V.reduceDescriptors(ou.prototype,({value:e},t)=>{let r=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(n){this[r]=n}}});V.freezeMethods(ou);const an=ou;function Hc(e,t){const r=this||Ld,n=t||r,a=an.from(n.headers);let i=n.data;return V.forEach(e,function(s){i=s.call(r,i,a.normalize(),t?t.status:void 0)}),a.normalize(),i}function b2(e){return!!(e&&e.__CANCEL__)}function Ho(e,t,r){Ie.call(this,e??"canceled",Ie.ERR_CANCELED,t,r),this.name="CanceledError"}V.inherits(Ho,Ie,{__CANCEL__:!0});function RO(e,t,r){const n=r.config.validateStatus;!r.status||!n||n(r.status)?e(r):t(new Ie("Request failed with status code "+r.status,[Ie.ERR_BAD_REQUEST,Ie.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r))}const NO=Ur.hasStandardBrowserEnv?{write(e,t,r,n,a,i){const o=[e+"="+encodeURIComponent(t)];V.isNumber(r)&&o.push("expires="+new Date(r).toGMTString()),V.isString(n)&&o.push("path="+n),V.isString(a)&&o.push("domain="+a),i===!0&&o.push("secure"),document.cookie=o.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function OO(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function BO(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}function w2(e,t){return e&&!OO(t)?BO(e,t):t}const FO=Ur.hasStandardBrowserEnv?function(){const t=/(msie|trident)/i.test(navigator.userAgent),r=document.createElement("a");let n;function a(i){let o=i;return t&&(r.setAttribute("href",o),o=r.href),r.setAttribute("href",o),{href:r.href,protocol:r.protocol?r.protocol.replace(/:$/,""):"",host:r.host,search:r.search?r.search.replace(/^\?/,""):"",hash:r.hash?r.hash.replace(/^#/,""):"",hostname:r.hostname,port:r.port,pathname:r.pathname.charAt(0)==="/"?r.pathname:"/"+r.pathname}}return n=a(window.location.href),function(o){const s=V.isString(o)?a(o):o;return s.protocol===n.protocol&&s.host===n.host}}():function(){return function(){return!0}}();function zO(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function GO(e,t){e=e||10;const r=new Array(e),n=new Array(e);let a=0,i=0,o;return t=t!==void 0?t:1e3,function(l){const u=Date.now(),c=n[i];o||(o=u),r[a]=l,n[a]=u;let h=i,f=0;for(;h!==a;)f+=r[h++],h=h%e;if(a=(a+1)%e,a===i&&(i=(i+1)%e),u-o<t)return;const d=c&&u-c;return d?Math.round(f*1e3/d):void 0}}function u0(e,t){let r=0;const n=GO(50,250);return a=>{const i=a.loaded,o=a.lengthComputable?a.total:void 0,s=i-r,l=n(s),u=i<=o;r=i;const c={loaded:i,total:o,progress:o?i/o:void 0,bytes:s,rate:l||void 0,estimated:l&&o&&u?(o-i)/l:void 0,event:a};c[t?"download":"upload"]=!0,e(c)}}const VO=typeof XMLHttpRequest<"u",UO=VO&&function(e){return new Promise(function(r,n){let a=e.data;const i=an.from(e.headers).normalize();let{responseType:o,withXSRFToken:s}=e,l;function u(){e.cancelToken&&e.cancelToken.unsubscribe(l),e.signal&&e.signal.removeEventListener("abort",l)}let c;if(V.isFormData(a)){if(Ur.hasStandardBrowserEnv||Ur.hasStandardBrowserWebWorkerEnv)i.setContentType(!1);else if((c=i.getContentType())!==!1){const[p,...g]=c?c.split(";").map(m=>m.trim()).filter(Boolean):[];i.setContentType([p||"multipart/form-data",...g].join("; "))}}let h=new XMLHttpRequest;if(e.auth){const p=e.auth.username||"",g=e.auth.password?unescape(encodeURIComponent(e.auth.password)):"";i.set("Authorization","Basic "+btoa(p+":"+g))}const f=w2(e.baseURL,e.url);h.open(e.method.toUpperCase(),_2(f,e.params,e.paramsSerializer),!0),h.timeout=e.timeout;function d(){if(!h)return;const p=an.from("getAllResponseHeaders"in h&&h.getAllResponseHeaders()),m={data:!o||o==="text"||o==="json"?h.responseText:h.response,status:h.status,statusText:h.statusText,headers:p,config:e,request:h};RO(function(y){r(y),u()},function(y){n(y),u()},m),h=null}if("onloadend"in h?h.onloadend=d:h.onreadystatechange=function(){!h||h.readyState!==4||h.status===0&&!(h.responseURL&&h.responseURL.indexOf("file:")===0)||setTimeout(d)},h.onabort=function(){h&&(n(new Ie("Request aborted",Ie.ECONNABORTED,e,h)),h=null)},h.onerror=function(){n(new Ie("Network Error",Ie.ERR_NETWORK,e,h)),h=null},h.ontimeout=function(){let g=e.timeout?"timeout of "+e.timeout+"ms exceeded":"timeout exceeded";const m=e.transitional||x2;e.timeoutErrorMessage&&(g=e.timeoutErrorMessage),n(new Ie(g,m.clarifyTimeoutError?Ie.ETIMEDOUT:Ie.ECONNABORTED,e,h)),h=null},Ur.hasStandardBrowserEnv&&(s&&V.isFunction(s)&&(s=s(e)),s||s!==!1&&FO(f))){const p=e.xsrfHeaderName&&e.xsrfCookieName&&NO.read(e.xsrfCookieName);p&&i.set(e.xsrfHeaderName,p)}a===void 0&&i.setContentType(null),"setRequestHeader"in h&&V.forEach(i.toJSON(),function(g,m){h.setRequestHeader(m,g)}),V.isUndefined(e.withCredentials)||(h.withCredentials=!!e.withCredentials),o&&o!=="json"&&(h.responseType=e.responseType),typeof e.onDownloadProgress=="function"&&h.addEventListener("progress",u0(e.onDownloadProgress,!0)),typeof e.onUploadProgress=="function"&&h.upload&&h.upload.addEventListener("progress",u0(e.onUploadProgress)),(e.cancelToken||e.signal)&&(l=p=>{h&&(n(!p||p.type?new Ho(null,e,h):p),h.abort(),h=null)},e.cancelToken&&e.cancelToken.subscribe(l),e.signal&&(e.signal.aborted?l():e.signal.addEventListener("abort",l)));const v=zO(f);if(v&&Ur.protocols.indexOf(v)===-1){n(new Ie("Unsupported protocol "+v+":",Ie.ERR_BAD_REQUEST,e));return}h.send(a||null)})},jh={http:hO,xhr:UO};V.forEach(jh,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const c0=e=>`- ${e}`,kO=e=>V.isFunction(e)||e===null||e===!1,A2={getAdapter:e=>{e=V.isArray(e)?e:[e];const{length:t}=e;let r,n;const a={};for(let i=0;i<t;i++){r=e[i];let o;if(n=r,!kO(r)&&(n=jh[(o=String(r)).toLowerCase()],n===void 0))throw new Ie(`Unknown adapter '${o}'`);if(n)break;a[o||"#"+i]=n}if(!n){const i=Object.entries(a).map(([s,l])=>`adapter ${s} `+(l===!1?"is not supported by the environment":"is not available in the build"));let o=t?i.length>1?`since :
`+i.map(c0).join(`
`):" "+c0(i[0]):"as no adapter specified";throw new Ie("There is no suitable adapter to dispatch the request "+o,"ERR_NOT_SUPPORT")}return n},adapters:jh};function Wc(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new Ho(null,e)}function h0(e){return Wc(e),e.headers=an.from(e.headers),e.data=Hc.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),A2.getAdapter(e.adapter||Ld.adapter)(e).then(function(n){return Wc(e),n.data=Hc.call(e,e.transformResponse,n),n.headers=an.from(n.headers),n},function(n){return b2(n)||(Wc(e),n&&n.response&&(n.response.data=Hc.call(e,e.transformResponse,n.response),n.response.headers=an.from(n.response.headers))),Promise.reject(n)})}const f0=e=>e instanceof an?e.toJSON():e;function li(e,t){t=t||{};const r={};function n(u,c,h){return V.isPlainObject(u)&&V.isPlainObject(c)?V.merge.call({caseless:h},u,c):V.isPlainObject(c)?V.merge({},c):V.isArray(c)?c.slice():c}function a(u,c,h){if(V.isUndefined(c)){if(!V.isUndefined(u))return n(void 0,u,h)}else return n(u,c,h)}function i(u,c){if(!V.isUndefined(c))return n(void 0,c)}function o(u,c){if(V.isUndefined(c)){if(!V.isUndefined(u))return n(void 0,u)}else return n(void 0,c)}function s(u,c,h){if(h in t)return n(u,c);if(h in e)return n(void 0,u)}const l={url:i,method:i,data:i,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:s,headers:(u,c)=>a(f0(u),f0(c),!0)};return V.forEach(Object.keys(Object.assign({},e,t)),function(c){const h=l[c]||a,f=h(e[c],t[c],c);V.isUndefined(f)&&h!==s||(r[c]=f)}),r}const E2="1.6.2",Dd={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{Dd[e]=function(n){return typeof n===e||"a"+(t<1?"n ":" ")+e}});const d0={};Dd.transitional=function(t,r,n){function a(i,o){return"[Axios v"+E2+"] Transitional option '"+i+"'"+o+(n?". "+n:"")}return(i,o,s)=>{if(t===!1)throw new Ie(a(o," has been removed"+(r?" in "+r:"")),Ie.ERR_DEPRECATED);return r&&!d0[o]&&(d0[o]=!0,console.warn(a(o," has been deprecated since v"+r+" and will be removed in the near future"))),t?t(i,o,s):!0}};function HO(e,t,r){if(typeof e!="object")throw new Ie("options must be an object",Ie.ERR_BAD_OPTION_VALUE);const n=Object.keys(e);let a=n.length;for(;a-- >0;){const i=n[a],o=t[i];if(o){const s=e[i],l=s===void 0||o(s,i,e);if(l!==!0)throw new Ie("option "+i+" must be "+l,Ie.ERR_BAD_OPTION_VALUE);continue}if(r!==!0)throw new Ie("Unknown option "+i,Ie.ERR_BAD_OPTION)}}const Zh={assertOptions:HO,validators:Dd},_n=Zh.validators;class yl{constructor(t){this.defaults=t,this.interceptors={request:new s0,response:new s0}}request(t,r){typeof t=="string"?(r=r||{},r.url=t):r=t||{},r=li(this.defaults,r);const{transitional:n,paramsSerializer:a,headers:i}=r;n!==void 0&&Zh.assertOptions(n,{silentJSONParsing:_n.transitional(_n.boolean),forcedJSONParsing:_n.transitional(_n.boolean),clarifyTimeoutError:_n.transitional(_n.boolean)},!1),a!=null&&(V.isFunction(a)?r.paramsSerializer={serialize:a}:Zh.assertOptions(a,{encode:_n.function,serialize:_n.function},!0)),r.method=(r.method||this.defaults.method||"get").toLowerCase();let o=i&&V.merge(i.common,i[r.method]);i&&V.forEach(["delete","get","head","post","put","patch","common"],v=>{delete i[v]}),r.headers=an.concat(o,i);const s=[];let l=!0;this.interceptors.request.forEach(function(p){typeof p.runWhen=="function"&&p.runWhen(r)===!1||(l=l&&p.synchronous,s.unshift(p.fulfilled,p.rejected))});const u=[];this.interceptors.response.forEach(function(p){u.push(p.fulfilled,p.rejected)});let c,h=0,f;if(!l){const v=[h0.bind(this),void 0];for(v.unshift.apply(v,s),v.push.apply(v,u),f=v.length,c=Promise.resolve(r);h<f;)c=c.then(v[h++],v[h++]);return c}f=s.length;let d=r;for(h=0;h<f;){const v=s[h++],p=s[h++];try{d=v(d)}catch(g){p.call(this,g);break}}try{c=h0.call(this,d)}catch(v){return Promise.reject(v)}for(h=0,f=u.length;h<f;)c=c.then(u[h++],u[h++]);return c}getUri(t){t=li(this.defaults,t);const r=w2(t.baseURL,t.url);return _2(r,t.params,t.paramsSerializer)}}V.forEach(["delete","get","head","options"],function(t){yl.prototype[t]=function(r,n){return this.request(li(n||{},{method:t,url:r,data:(n||{}).data}))}});V.forEach(["post","put","patch"],function(t){function r(n){return function(i,o,s){return this.request(li(s||{},{method:t,headers:n?{"Content-Type":"multipart/form-data"}:{},url:i,data:o}))}}yl.prototype[t]=r(),yl.prototype[t+"Form"]=r(!0)});const Os=yl;class Md{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let r;this.promise=new Promise(function(i){r=i});const n=this;this.promise.then(a=>{if(!n._listeners)return;let i=n._listeners.length;for(;i-- >0;)n._listeners[i](a);n._listeners=null}),this.promise.then=a=>{let i;const o=new Promise(s=>{n.subscribe(s),i=s}).then(a);return o.cancel=function(){n.unsubscribe(i)},o},t(function(i,o,s){n.reason||(n.reason=new Ho(i,o,s),r(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const r=this._listeners.indexOf(t);r!==-1&&this._listeners.splice(r,1)}static source(){let t;return{token:new Md(function(a){t=a}),cancel:t}}}const WO=Md;function $O(e){return function(r){return e.apply(null,r)}}function XO(e){return V.isObject(e)&&e.isAxiosError===!0}const Yh={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(Yh).forEach(([e,t])=>{Yh[t]=e});const jO=Yh;function C2(e){const t=new Os(e),r=s2(Os.prototype.request,t);return V.extend(r,Os.prototype,t,{allOwnKeys:!0}),V.extend(r,t,null,{allOwnKeys:!0}),r.create=function(a){return C2(li(e,a))},r}const Tt=C2(Ld);Tt.Axios=Os;Tt.CanceledError=Ho;Tt.CancelToken=WO;Tt.isCancel=b2;Tt.VERSION=E2;Tt.toFormData=iu;Tt.AxiosError=Ie;Tt.Cancel=Tt.CanceledError;Tt.all=function(t){return Promise.all(t)};Tt.spread=$O;Tt.isAxiosError=XO;Tt.mergeConfig=li;Tt.AxiosHeaders=an;Tt.formToJSON=e=>T2(V.isHTMLForm(e)?new FormData(e):e);Tt.getAdapter=A2.getAdapter;Tt.HttpStatusCode=jO;Tt.default=Tt;const su=Tt;var L2=(e=>(e.GB_TOKEN_STORE="GB_TOKEN_STORE",e.YH_LANG_STORE="YH_LANG",e.YH_THEME_STORE="YH_THEME",e))(L2||{}),D2=(e=>(e.GB_TOKEN_KEY="auth-token",e.GB_SIGN_KEY="sign",e.GB_TIMESTAMP_KEY="timestamp",e))(D2||{});const ZO=e=>{const t=window.localStorage.getItem(e);try{return t&&JSON.parse(t)}catch{return t}},M2={baseUrl:"",code:401,noContentCode:204,ENC:!1};let YO=M2.baseUrl;su.CancelToken;su.interceptors.request.use(function(e){let t=ZO(L2.GB_TOKEN_STORE);return t&&(e.headers.common[D2.GB_TOKEN_KEY]=t),e.headers["Content-Type"]="application/json;charset=utf-8",e},function(e){return console.log(e),Promise.reject(e)});su.interceptors.response.use(e=>e.status!==200?Promise.reject(e):(e.data.code==M2.code,e.data),e=>{let t={success:!1,msg:"未知异常，请联系管理员！"};return JSON.stringify(e).indexOf("Network Error")!=-1&&(t.msg="网络错误或服务错误！"),Promise.reject(t)});let qO=e=>e;const KO=async(e,t)=>{try{return t=qO(t),await su.get(`${YO}${e}`,{params:t})}catch(r){return r}},JO={leftTop:"/bigscreen/countDeviceNum",leftCenter:"/bigscreen/countUserNum",centerMap:"/bigscreen/centerMap",centerBottom:"/bigscreen/installationPlan",leftBottom:"/bigscreen/leftBottom",rightTop:"/bigscreen/alarmNum",rightBottom:"/bigscreen/rightBottom",rightCenter:"/bigscreen/ranking"},QO={...JO},_X=(e,t)=>KO(QO[e],t||{});function eB(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var zn=eB,tB=typeof Yo=="object"&&Yo&&Yo.Object===Object&&Yo,P2=tB,rB=P2,nB=typeof self=="object"&&self&&self.Object===Object&&self,aB=rB||nB||Function("return this")(),Zr=aB,iB=Zr,oB=iB.Symbol,Pd=oB,v0=Pd,I2=Object.prototype,sB=I2.hasOwnProperty,lB=I2.toString,Ui=v0?v0.toStringTag:void 0;function uB(e){var t=sB.call(e,Ui),r=e[Ui];try{e[Ui]=void 0;var n=!0}catch{}var a=lB.call(e);return n&&(t?e[Ui]=r:delete e[Ui]),a}var cB=uB,hB=Object.prototype,fB=hB.toString;function dB(e){return fB.call(e)}var vB=dB,p0=Pd,pB=cB,gB=vB,mB="[object Null]",yB="[object Undefined]",g0=p0?p0.toStringTag:void 0;function _B(e){return e==null?e===void 0?yB:mB:g0&&g0 in Object(e)?pB(e):gB(e)}var Wo=_B;function xB(e){return e!=null&&typeof e=="object"}var Ta=xB;const SB="FeatureCollection",TB=[{type:"Feature",properties:{adcode:130200,name:"唐山市",center:[118.175393,39.635113],centroid:[118.343325,39.71703],childrenNum:14,level:"city",parent:{adcode:13e4},subFeatureIndex:1,acroutes:[1e5,13e4]},geometry:{type:"MultiPolygon",coordinates:[[[[119.319039,39.429554],[119.280403,39.422852],[119.257401,39.429752],[119.212295,39.463453],[119.185769,39.458986],[119.064545,39.473763],[119.048399,39.459052],[119.004894,39.467459],[119.015658,39.482103],[119.008098,39.509347],[118.961453,39.51591],[118.966067,39.529494],[118.983302,39.538942],[118.945243,39.544781],[118.938452,39.557572],[118.895139,39.547011],[118.882261,39.566557],[118.861309,39.574754],[118.844586,39.615004],[118.850097,39.622737],[118.824596,39.648681],[118.822225,39.668984],[118.804157,39.679985],[118.787242,39.71592],[118.774428,39.764198],[118.800185,39.775706],[118.797942,39.790415],[118.825429,39.799436],[118.816843,39.825836],[118.838179,39.847981],[118.835232,39.859018],[118.853556,39.88409],[118.859643,39.93362],[118.875149,39.941121],[118.884247,39.961794],[118.88508,40.005403],[118.865602,40.023777],[118.866307,40.061942],[118.900521,40.086549],[118.918269,40.092211],[118.92474,40.149653],[118.906736,40.169679],[118.888924,40.168768],[118.867652,40.180599],[118.849135,40.178974],[118.794482,40.204838],[118.775581,40.194182],[118.743609,40.191777],[118.746108,40.208087],[118.708562,40.216078],[118.665634,40.242577],[118.628472,40.249915],[118.571384,40.269845],[118.568949,40.287564],[118.533325,40.298854],[118.532364,40.319419],[118.539989,40.361048],[118.558377,40.36928],[118.550881,40.385482],[118.571512,40.414636],[118.548062,40.422667],[118.523458,40.40628],[118.503211,40.403365],[118.45599,40.414053],[118.430746,40.411851],[118.402683,40.416838],[118.387305,40.436719],[118.360011,40.428819],[118.356295,40.435295],[118.306575,40.419558],[118.277935,40.425711],[118.262942,40.452063],[118.239684,40.464686],[118.173818,40.423056],[118.156967,40.423768],[118.153123,40.409519],[118.165232,40.400449],[118.133837,40.375113],[118.121856,40.354695],[118.079312,40.353528],[118.061564,40.319095],[118.031643,40.302358],[118.000888,40.29256],[117.909457,40.285876],[117.897989,40.270429],[117.867554,40.26965],[117.844104,40.261406],[117.807775,40.261926],[117.75152,40.229718],[117.714551,40.241668],[117.694112,40.238161],[117.677069,40.22095],[117.64625,40.205163],[117.619532,40.206398],[117.609409,40.194897],[117.575451,40.192817],[117.576412,40.178584],[117.601208,40.171239],[117.630232,40.147833],[117.635999,40.132094],[117.650159,40.128191],[117.65317,40.110757],[117.644841,40.096181],[117.668099,40.100931],[117.67489,40.082123],[117.708272,40.093643],[117.721983,40.07991],[117.751648,40.081993],[117.758184,40.065978],[117.776188,40.059272],[117.758312,40.04436],[117.747932,40.047421],[117.744152,40.018434],[117.782467,40.023516],[117.797075,40.010225],[117.782019,39.968315],[117.756326,39.96512],[117.72775,39.972422],[117.70667,39.986046],[117.674698,39.974834],[117.634589,39.968901],[117.589226,39.996866],[117.537777,39.997452],[117.547323,39.976855],[117.532907,39.952469],[117.514967,39.946665],[117.525539,39.92964],[117.507406,39.909023],[117.518811,39.891271],[117.521374,39.870641],[117.548092,39.839882],[117.537264,39.835178],[117.561419,39.800024],[117.546106,39.776164],[117.559305,39.756088],[117.59589,39.746147],[117.596082,39.735222],[117.577629,39.726913],[117.602425,39.705384],[117.644777,39.701849],[117.643944,39.688692],[117.657014,39.668657],[117.668355,39.667085],[117.662012,39.636365],[117.641957,39.628438],[117.641189,39.612645],[117.619084,39.603207],[117.621967,39.59167],[117.636191,39.603731],[117.660795,39.57541],[117.68495,39.588916],[117.708913,39.572918],[117.688794,39.569246],[117.689563,39.559539],[117.710194,39.550422],[117.71596,39.530084],[117.744857,39.548585],[117.737745,39.574033],[117.753122,39.576],[117.747868,39.589375],[117.76773,39.599012],[117.801945,39.601765],[117.826548,39.590818],[117.851408,39.589244],[117.868259,39.596849],[117.892607,39.591539],[117.933997,39.574164],[117.905293,39.53015],[117.912277,39.516172],[117.898565,39.509675],[117.898181,39.472516],[117.878062,39.467196],[117.87031,39.45498],[117.871847,39.411547],[117.859353,39.403265],[117.852369,39.38078],[117.805277,39.373284],[117.803354,39.362037],[117.837056,39.350789],[117.862877,39.362169],[117.842054,39.336512],[117.84955,39.327366],[117.888314,39.332038],[117.891774,39.32322],[117.972248,39.314401],[117.97763,39.300643],[118.016842,39.284117],[118.024787,39.292414],[118.036512,39.265151],[118.064768,39.256061],[118.064768,39.231222],[118.037089,39.230497],[118.026196,39.20176],[118.050864,39.200112],[118.07047,39.214021],[118.07771,39.202024],[118.125316,39.182771],[118.16299,39.136596],[118.182596,39.094155],[118.225011,39.034839],[118.267107,39.021555],[118.290813,39.022216],[118.309907,39.011773],[118.373594,39.012037],[118.371031,38.984137],[118.378015,38.97177],[118.406463,38.960525],[118.491038,38.909041],[118.525252,38.90487],[118.539732,38.909835],[118.604445,38.971505],[118.570487,38.999212],[118.532877,39.091051],[118.551394,39.088278],[118.560107,39.09904],[118.588619,39.107623],[118.578752,39.130921],[118.59272,39.142601],[118.637314,39.157379],[118.692992,39.148077],[118.719646,39.136992],[118.760716,39.133495],[118.814409,39.138642],[118.857913,39.162854],[118.876366,39.14999],[118.897253,39.151508],[118.920447,39.171758],[118.951074,39.178485],[118.896549,39.139698],[118.890013,39.118844],[118.926278,39.123464],[118.977984,39.163381],[119.023988,39.186925],[119.038276,39.21178],[119.096068,39.241963],[119.121505,39.281549],[119.185577,39.342039],[119.239269,39.352368],[119.272779,39.363616],[119.317052,39.410759],[119.319039,39.429554]]],[[[117.784581,39.377032],[117.782147,39.394785],[117.737296,39.410562],[117.69975,39.407604],[117.702313,39.388934],[117.673224,39.386698],[117.669124,39.412008],[117.643495,39.405829],[117.61415,39.407078],[117.6014,39.4195],[117.590636,39.405435],[117.571158,39.404646],[117.557895,39.38558],[117.535342,39.374007],[117.520862,39.357236],[117.536239,39.338026],[117.595249,39.349144],[117.637536,39.335986],[117.650799,39.315191],[117.669316,39.324141],[117.670982,39.357828],[117.706221,39.351513],[117.744601,39.354604],[117.784581,39.377032]]],[[[118.630522,39.054726],[118.640005,39.042306],[118.653652,39.056973],[118.638852,39.076061],[118.620847,39.068268],[118.630522,39.054726]]],[[[118.869446,39.142733],[118.842664,39.117788],[118.820239,39.108745],[118.820495,39.093693],[118.857465,39.098842],[118.871753,39.115082],[118.869446,39.142733]]],[[[118.83914,39.153817],[118.815177,39.132373],[118.825749,39.122672],[118.841511,39.135475],[118.83914,39.153817]]]]}},{type:"Feature",properties:{adcode:130300,name:"秦皇岛市",center:[119.586579,39.942531],centroid:[119.193332,40.088346],childrenNum:7,level:"city",parent:{adcode:13e4},subFeatureIndex:2,acroutes:[1e5,13e4]},geometry:{type:"MultiPolygon",coordinates:[[[[119.319039,39.429554],[119.304238,39.459972],[119.270024,39.498582],[119.31276,39.605894],[119.334928,39.656148],[119.358122,39.721744],[119.3735,39.739671],[119.395925,39.74425],[119.396886,39.761124],[119.464738,39.809239],[119.506641,39.816493],[119.53778,39.810154],[119.537652,39.831259],[119.520352,39.838183],[119.541048,39.888138],[119.559564,39.901518],[119.587948,39.909936],[119.612936,39.898907],[119.637027,39.923182],[119.666436,39.92018],[119.674317,39.933424],[119.683543,39.921942],[119.726279,39.941056],[119.787212,39.950382],[119.816877,39.978224],[119.836739,39.985786],[119.835522,39.964468],[119.862432,39.951556],[119.872363,39.960621],[119.841032,40.011789],[119.854231,40.03231],[119.835009,40.050286],[119.817069,40.052826],[119.795285,40.040387],[119.770873,40.048788],[119.76043,40.065653],[119.771578,40.082253],[119.736723,40.104836],[119.76248,40.144776],[119.755496,40.153165],[119.745949,40.207957],[119.716797,40.196066],[119.676239,40.224522],[119.671562,40.23959],[119.625174,40.224132],[119.633503,40.249395],[119.651892,40.272377],[119.642153,40.291327],[119.621458,40.30359],[119.598136,40.334206],[119.599801,40.356575],[119.586667,40.375437],[119.600442,40.406863],[119.593458,40.435683],[119.604927,40.454976],[119.553542,40.501762],[119.555464,40.516833],[119.568855,40.520778],[119.571033,40.540887],[119.534256,40.554203],[119.520288,40.547416],[119.503886,40.553945],[119.491007,40.536167],[119.477809,40.533322],[119.441864,40.539852],[119.361839,40.537331],[119.338068,40.531253],[119.302188,40.530283],[119.25612,40.543279],[119.220624,40.569133],[119.232862,40.589421],[119.230812,40.603891],[119.178209,40.609316],[119.162575,40.600015],[119.158474,40.614418],[119.105487,40.603632],[119.086394,40.588775],[119.063392,40.606151],[119.013095,40.577081],[118.998359,40.578955],[118.983366,40.56364],[118.952676,40.558469],[118.966003,40.536102],[118.919038,40.53093],[118.886938,40.542438],[118.864,40.527244],[118.821328,40.531964],[118.794867,40.510753],[118.792112,40.492382],[118.772954,40.479765],[118.723491,40.473746],[118.702795,40.491411],[118.657176,40.450574],[118.624179,40.437626],[118.618349,40.425193],[118.643785,40.380946],[118.640197,40.354566],[118.608225,40.328305],[118.596949,40.308456],[118.580098,40.305861],[118.568949,40.287564],[118.571384,40.269845],[118.628472,40.249915],[118.665634,40.242577],[118.708562,40.216078],[118.746108,40.208087],[118.743609,40.191777],[118.775581,40.194182],[118.794482,40.204838],[118.849135,40.178974],[118.867652,40.180599],[118.888924,40.168768],[118.906736,40.169679],[118.92474,40.149653],[118.918269,40.092211],[118.900521,40.086549],[118.866307,40.061942],[118.865602,40.023777],[118.88508,40.005403],[118.884247,39.961794],[118.875149,39.941121],[118.859643,39.93362],[118.853556,39.88409],[118.835232,39.859018],[118.838179,39.847981],[118.816843,39.825836],[118.825429,39.799436],[118.797942,39.790415],[118.800185,39.775706],[118.774428,39.764198],[118.787242,39.71592],[118.804157,39.679985],[118.822225,39.668984],[118.824596,39.648681],[118.850097,39.622737],[118.844586,39.615004],[118.861309,39.574754],[118.882261,39.566557],[118.895139,39.547011],[118.938452,39.557572],[118.945243,39.544781],[118.983302,39.538942],[118.966067,39.529494],[118.961453,39.51591],[119.008098,39.509347],[119.015658,39.482103],[119.004894,39.467459],[119.048399,39.459052],[119.064545,39.473763],[119.185769,39.458986],[119.212295,39.463453],[119.257401,39.429752],[119.280403,39.422852],[119.319039,39.429554]]]]}},{type:"Feature",properties:{adcode:130700,name:"张家口市",center:[114.884091,40.811901],centroid:[115.038685,40.874645],childrenNum:16,level:"city",parent:{adcode:13e4},subFeatureIndex:6,acroutes:[1e5,13e4]},geometry:{type:"MultiPolygon",coordinates:[[[[116.365069,40.943216],[116.341747,40.964804],[116.333546,40.984458],[116.29837,40.986641],[116.264733,41.038252],[116.296128,41.062118],[116.277419,41.083154],[116.268769,41.102645],[116.245447,41.114183],[116.233273,41.130845],[116.245895,41.16358],[116.22347,41.174275],[116.221356,41.185928],[116.235195,41.211853],[116.213603,41.233288],[116.198995,41.259578],[116.191627,41.288158],[116.209503,41.307715],[116.203352,41.326117],[116.17484,41.356328],[116.141586,41.373439],[116.08751,41.376951],[116.07713,41.384866],[116.036124,41.397694],[116.03023,41.416645],[116.004473,41.432911],[116.000052,41.454402],[115.97673,41.470913],[115.982112,41.485127],[115.97391,41.529659],[115.958789,41.550353],[115.924767,41.568623],[115.929252,41.596113],[115.909967,41.642921],[115.972885,41.680101],[116.014404,41.715355],[116.056307,41.733705],[116.081039,41.776352],[116.083986,41.781745],[116.03401,41.782633],[116.016646,41.77705],[115.994926,41.828608],[115.978588,41.840841],[115.946936,41.885634],[115.916374,41.945141],[115.853071,41.927738],[115.828852,41.936978],[115.815461,41.928687],[115.810976,41.912356],[115.795855,41.911153],[115.756707,41.886774],[115.727874,41.888421],[115.724415,41.868025],[115.68815,41.867708],[115.659382,41.848319],[115.653871,41.829052],[115.630806,41.824995],[115.598641,41.808003],[115.574102,41.805403],[115.548345,41.783902],[115.519769,41.767787],[115.488758,41.760934],[115.430068,41.728753],[115.366317,41.712561],[115.347031,41.712307],[115.319032,41.691473],[115.336844,41.675145],[115.355489,41.672158],[115.360935,41.661355],[115.345494,41.635673],[115.377594,41.602475],[115.365099,41.595795],[115.311535,41.592677],[115.290328,41.622955],[115.273477,41.622764],[115.26425,41.611889],[115.266429,41.592868],[115.257587,41.581097],[115.204215,41.571423],[115.205753,41.591723],[115.195053,41.602093],[115.167246,41.605973],[115.142386,41.616087],[115.113489,41.615769],[115.099137,41.623973],[115.087796,41.613415],[115.055953,41.602284],[115.025006,41.61526],[114.977849,41.611571],[114.938317,41.613225],[114.89808,41.607182],[114.877449,41.590896],[114.860726,41.600948],[114.895581,41.636436],[114.902885,41.689313],[114.895068,41.736561],[114.896157,41.76766],[114.8663,41.804578],[114.922363,41.825121],[114.939214,41.846165],[114.92153,41.875943],[114.925438,41.899566],[114.916148,41.936978],[114.933255,41.943559],[114.915507,41.958934],[114.916853,41.981008],[114.901796,42.015528],[114.89148,42.012115],[114.889622,42.030316],[114.860854,42.05483],[114.861302,42.101997],[114.823051,42.140867],[114.828369,42.147679],[114.793963,42.149193],[114.78935,42.130963],[114.754879,42.115756],[114.710221,42.115377],[114.704647,42.121435],[114.675494,42.120426],[114.647751,42.109634],[114.624813,42.112222],[114.585537,42.131215],[114.560293,42.132414],[114.510957,42.110897],[114.500706,42.085963],[114.5025,42.067398],[114.479883,42.064304],[114.466107,42.037962],[114.46835,42.025577],[114.485969,42.015338],[114.484752,41.999155],[114.501411,41.99277],[114.510701,41.973292],[114.487443,41.96722],[114.476295,41.953936],[114.421705,41.942167],[114.374036,41.956783],[114.348087,41.947609],[114.343217,41.926915],[114.326751,41.9297],[114.330403,41.916977],[114.287026,41.868658],[114.243457,41.832792],[114.202964,41.793416],[114.200401,41.778509],[114.215266,41.756492],[114.206744,41.738402],[114.232501,41.717705],[114.237563,41.698651],[114.219302,41.700239],[114.215394,41.685057],[114.259347,41.6234],[114.227632,41.620221],[114.237242,41.59624],[114.221673,41.582242],[114.231604,41.547043],[114.231027,41.513671],[114.101218,41.537746],[114.083982,41.528958],[114.032148,41.529595],[113.977559,41.506664],[113.952827,41.483533],[113.930659,41.485573],[113.92124,41.457271],[113.884911,41.438141],[113.8712,41.413327],[113.918229,41.40382],[113.943985,41.390802],[113.93399,41.376823],[113.937514,41.356647],[113.923354,41.33934],[113.926622,41.326309],[113.89952,41.316214],[113.922585,41.291162],[113.936297,41.294805],[113.951226,41.282916],[113.952956,41.254269],[113.971536,41.239814],[113.976854,41.266676],[113.985824,41.270385],[114.007032,41.250752],[114.016259,41.232073],[114.000625,41.224011],[113.996781,41.192458],[113.973651,41.174275],[113.920407,41.172034],[113.877927,41.115593],[113.863383,41.106042],[113.820327,41.101619],[113.823402,41.093093],[113.868445,41.068853],[113.90567,41.034081],[113.922585,41.024391],[113.972946,40.982981],[113.97647,40.961206],[113.991142,40.940195],[114.000753,40.947521],[114.011773,40.935311],[114.057457,40.925092],[114.041375,40.917378],[114.052203,40.893395],[114.052844,40.870304],[114.073539,40.857308],[114.069694,40.846948],[114.044771,40.831115],[114.081163,40.790486],[114.104421,40.797571],[114.104165,40.768068],[114.134727,40.737263],[114.147285,40.73346],[114.18323,40.671675],[114.200081,40.662189],[114.216163,40.63437],[114.209307,40.629721],[114.236153,40.606991],[114.258258,40.610672],[114.282926,40.590778],[114.273379,40.553815],[114.293433,40.551424],[114.296381,40.535973],[114.285617,40.525822],[114.282605,40.495164],[114.267228,40.474199],[114.275429,40.458019],[114.299648,40.440086],[114.28709,40.423444],[114.314449,40.369604],[114.344435,40.36954],[114.382237,40.362085],[114.390374,40.351259],[114.446565,40.372845],[114.470784,40.349703],[114.499296,40.354047],[114.530627,40.3451],[114.526463,40.32357],[114.510957,40.303006],[114.469951,40.268093],[114.406392,40.246149],[114.362567,40.250109],[114.335144,40.245434],[114.293113,40.230108],[114.255247,40.236213],[114.240126,40.221924],[114.235833,40.198341],[114.180026,40.191517],[114.145107,40.177349],[114.123963,40.178129],[114.123387,40.188723],[114.097758,40.193597],[114.068029,40.179754],[114.089108,40.121491],[114.101218,40.10874],[114.091159,40.075288],[114.043809,40.056863],[114.019462,40.102819],[113.989476,40.112383],[113.973843,40.097157],[113.981019,40.073205],[113.975573,40.051068],[113.954878,40.030812],[113.922457,40.026578],[113.914641,40.005924],[113.932004,40.009443],[113.960452,40.000906],[114.021256,39.991782],[114.029457,39.985395],[114.02824,39.959316],[114.047397,39.916135],[114.067772,39.922334],[114.089941,39.910197],[114.102884,39.912873],[114.174132,39.897602],[114.211998,39.918745],[114.229426,39.899495],[114.19944,39.87939],[114.224877,39.851704],[114.276967,39.874494],[114.286065,39.858235],[114.328929,39.865548],[114.349432,39.862806],[114.395436,39.867246],[114.406712,39.83348],[114.390695,39.818584],[114.408827,39.782375],[114.408122,39.651956],[114.431636,39.614021],[114.474757,39.613759],[114.495836,39.608188],[114.515378,39.564983],[114.557025,39.581442],[114.568942,39.573967],[114.563432,39.558162],[114.58432,39.585835],[114.604887,39.567869],[114.633527,39.555866],[114.654991,39.599209],[114.680748,39.588064],[114.712079,39.594358],[114.716756,39.618674],[114.760645,39.617036],[114.783775,39.609499],[114.821642,39.61022],[114.838429,39.589179],[114.891032,39.634728],[114.936331,39.66368],[114.961895,39.666103],[114.987396,39.67802],[115.011487,39.674746],[115.03199,39.702373],[115.050058,39.709245],[115.095293,39.704795],[115.138734,39.688627],[115.168847,39.672651],[115.179163,39.679592],[115.177625,39.700475],[115.215043,39.708067],[115.250859,39.73882],[115.283216,39.745165],[115.312945,39.783551],[115.342867,39.79205],[115.330052,39.80656],[115.345237,39.821851],[115.343251,39.837857],[115.365676,39.867507],[115.364523,39.885331],[115.399891,39.891336],[115.40162,39.903802],[115.426801,39.950056],[115.428531,39.984352],[115.450123,39.99289],[115.442178,40.010876],[115.454544,40.029705],[115.478571,40.036153],[115.528034,40.07633],[115.555457,40.082644],[115.553727,40.091691],[115.575576,40.100997],[115.590697,40.096376],[115.59909,40.119995],[115.641762,40.115897],[115.644581,40.12663],[115.715893,40.133395],[115.734858,40.129492],[115.754849,40.145427],[115.754336,40.163243],[115.773045,40.176179],[115.806555,40.15323],[115.847817,40.147052],[115.844421,40.168053],[115.855506,40.188853],[115.870306,40.186058],[115.886324,40.206657],[115.883121,40.216143],[115.898498,40.234524],[115.911953,40.23446],[115.930085,40.254524],[115.960007,40.256667],[115.968913,40.264263],[115.93976,40.304434],[115.943156,40.311375],[115.922653,40.325905],[115.918296,40.353917],[115.864476,40.359363],[115.861849,40.373428],[115.846856,40.375113],[115.796431,40.426812],[115.770418,40.444165],[115.769841,40.468051],[115.782207,40.492058],[115.736012,40.503832],[115.755041,40.540046],[115.792203,40.561313],[115.819818,40.559374],[115.827378,40.587031],[115.846151,40.593039],[115.885427,40.595235],[115.907788,40.617324],[115.971988,40.602341],[115.981407,40.579665],[116.005113,40.584124],[116.0285,40.607314],[116.030037,40.597367],[116.062714,40.610285],[116.099363,40.630561],[116.121724,40.62914],[116.112562,40.648507],[116.136909,40.667674],[116.162025,40.662383],[116.171316,40.695996],[116.191947,40.724241],[116.218857,40.742807],[116.235003,40.783143],[116.247946,40.791839],[116.269602,40.777152],[116.273446,40.762913],[116.290938,40.763815],[116.307917,40.752152],[116.317015,40.772256],[116.379806,40.77232],[116.414276,40.777925],[116.416519,40.769357],[116.453937,40.765877],[116.465854,40.774511],[116.456564,40.798665],[116.43683,40.820751],[116.40646,40.833368],[116.399988,40.84978],[116.334443,40.904648],[116.334571,40.921749],[116.365069,40.943216]]]]}},{type:"Feature",properties:{adcode:130800,name:"承德市",center:[117.939152,40.976204],centroid:[117.551533,41.356206],childrenNum:11,level:"city",parent:{adcode:13e4},subFeatureIndex:7,acroutes:[1e5,13e4]},geometry:{type:"MultiPolygon",coordinates:[[[[119.158474,40.614418],[119.146557,40.63579],[119.173211,40.654316],[119.185833,40.67574],[119.176222,40.690191],[119.153349,40.688707],[119.115098,40.666513],[119.095107,40.663351],[119.081588,40.671869],[119.05423,40.664964],[119.048719,40.681482],[119.027063,40.692448],[119.010725,40.687868],[118.987723,40.697931],[118.960813,40.720566],[118.949344,40.747834],[118.91167,40.756083],[118.895459,40.754021],[118.910965,40.776766],[118.878544,40.783207],[118.861501,40.802658],[118.849135,40.800919],[118.846252,40.822103],[118.855094,40.840577],[118.873034,40.848042],[118.891743,40.903362],[118.903468,40.961784],[118.917052,40.968594],[118.946461,40.958122],[119.000601,40.967052],[119.005086,40.984265],[119.0204,40.997878],[119.013544,41.007637],[118.951971,41.018421],[118.936209,41.037482],[118.93685,41.052624],[118.964657,41.079307],[119.008354,41.068596],[119.037507,41.067378],[119.050834,41.080333],[119.073771,41.084244],[119.080627,41.095978],[119.081204,41.131422],[119.126374,41.138662],[119.158603,41.169664],[119.184295,41.182727],[119.188909,41.198156],[119.166483,41.21294],[119.169623,41.222923],[119.209796,41.225803],[119.20954,41.244483],[119.231004,41.256444],[119.248367,41.27665],[119.239461,41.314489],[119.212103,41.308099],[119.200698,41.28234],[119.154951,41.297682],[119.093121,41.293655],[119.035136,41.298768],[119.006752,41.307076],[118.974716,41.306565],[118.949536,41.318003],[118.934671,41.304584],[118.890718,41.300749],[118.868421,41.312636],[118.844907,41.34247],[118.846124,41.373823],[118.770007,41.353071],[118.763343,41.328928],[118.741879,41.324073],[118.695171,41.337999],[118.676974,41.350453],[118.629946,41.34643],[118.57997,41.354029],[118.539796,41.3509],[118.528135,41.355051],[118.500841,41.345791],[118.47329,41.345663],[118.412422,41.33193],[118.399607,41.311102],[118.380193,41.312124],[118.349119,41.342789],[118.348286,41.373886],[118.361741,41.386717],[118.343993,41.404139],[118.34867,41.428318],[118.327078,41.450831],[118.272168,41.471296],[118.269605,41.478881],[118.295426,41.485127],[118.315801,41.512525],[118.302923,41.552709],[118.313302,41.561494],[118.301577,41.569641],[118.279152,41.56544],[118.270823,41.573524],[118.230522,41.582178],[118.215337,41.595668],[118.20989,41.61774],[118.215208,41.633002],[118.206879,41.65074],[118.169013,41.67076],[118.153699,41.691156],[118.155173,41.712624],[118.130698,41.742275],[118.140372,41.783965],[118.165873,41.813265],[118.219117,41.815358],[118.236032,41.807559],[118.246988,41.774005],[118.270823,41.762203],[118.292287,41.772863],[118.319838,41.83146],[118.331755,41.840651],[118.340213,41.872459],[118.324515,41.880187],[118.286649,41.91109],[118.270182,41.917357],[118.268901,41.930143],[118.306511,41.940269],[118.306255,41.975127],[118.314007,41.987774],[118.294722,42.005224],[118.256278,42.010724],[118.237634,42.022859],[118.283061,42.03158],[118.297284,42.048765],[118.272232,42.083311],[118.252498,42.091014],[118.226613,42.090256],[118.212581,42.081101],[118.220206,42.058619],[118.204188,42.034866],[118.189067,42.030569],[118.141846,42.031327],[118.116538,42.037204],[118.115256,42.045859],[118.136913,42.052871],[118.155173,42.081164],[118.136528,42.094486],[118.097765,42.10509],[118.088859,42.117144],[118.104172,42.148878],[118.10635,42.171958],[118.089051,42.183874],[118.033629,42.199127],[118.020366,42.213432],[117.977438,42.229875],[117.971095,42.248014],[118.023249,42.267155],[118.047468,42.280563],[118.059962,42.29831],[118.016265,42.333286],[118.009153,42.358248],[118.021263,42.371636],[118.019405,42.395201],[117.99762,42.416684],[117.954564,42.445003],[117.940148,42.462766],[117.87409,42.510194],[117.849614,42.546619],[117.829624,42.56498],[117.797588,42.585277],[117.792334,42.598367],[117.801496,42.612706],[117.779904,42.618591],[117.707247,42.588033],[117.66733,42.582459],[117.6442,42.589787],[117.610883,42.592355],[117.600311,42.603001],[117.539955,42.605443],[117.524898,42.590727],[117.473512,42.602437],[117.455957,42.589411],[117.435197,42.585403],[117.44436,42.577447],[117.433147,42.555769],[117.39637,42.536339],[117.387015,42.517405],[117.408415,42.519976],[117.416296,42.512326],[117.412836,42.472493],[117.390732,42.462076],[117.330056,42.461887],[117.321406,42.468791],[117.275466,42.481905],[117.252208,42.473685],[117.222287,42.475442],[117.175963,42.465527],[117.135726,42.469167],[117.094912,42.483661],[117.079535,42.460632],[117.046922,42.454105],[117.016744,42.45649],[117.006685,42.432948],[116.965102,42.421583],[116.914421,42.402677],[116.911858,42.391431],[116.886806,42.366608],[116.897442,42.297618],[116.918522,42.229875],[116.917433,42.207698],[116.903401,42.19087],[116.858166,42.197236],[116.789225,42.200261],[116.825169,42.155563],[116.850221,42.15632],[116.865022,42.124085],[116.877324,42.121057],[116.890651,42.092655],[116.881681,42.05224],[116.87963,42.018372],[116.868161,42.002885],[116.831961,42.005351],[116.821133,41.988723],[116.796209,41.978099],[116.766479,41.990304],[116.744631,41.982146],[116.72746,41.951089],[116.669154,41.947735],[116.634812,41.929953],[116.597073,41.935586],[116.566383,41.928751],[116.533706,41.938876],[116.514164,41.970067],[116.496416,41.97968],[116.482641,41.975886],[116.453873,41.945964],[116.432088,41.939383],[116.393133,41.94299],[116.41402,41.98221],[116.409087,41.994034],[116.373719,42.009965],[116.327267,42.005667],[116.306507,41.991379],[116.29837,41.968106],[116.28421,41.959376],[116.233401,41.941408],[116.230518,41.926282],[116.211361,41.906848],[116.212578,41.885128],[116.193164,41.861816],[116.171124,41.868912],[116.134731,41.863844],[116.106667,41.849587],[116.105706,41.834757],[116.129221,41.806607],[116.098658,41.776479],[116.081039,41.776352],[116.056307,41.733705],[116.014404,41.715355],[115.972885,41.680101],[115.909967,41.642921],[115.929252,41.596113],[115.924767,41.568623],[115.958789,41.550353],[115.97391,41.529659],[115.982112,41.485127],[115.97673,41.470913],[116.000052,41.454402],[116.004473,41.432911],[116.03023,41.416645],[116.036124,41.397694],[116.07713,41.384866],[116.08751,41.376951],[116.141586,41.373439],[116.17484,41.356328],[116.203352,41.326117],[116.209503,41.307715],[116.191627,41.288158],[116.198995,41.259578],[116.213603,41.233288],[116.235195,41.211853],[116.221356,41.185928],[116.22347,41.174275],[116.245895,41.16358],[116.233273,41.130845],[116.245447,41.114183],[116.268769,41.102645],[116.277419,41.083154],[116.296128,41.062118],[116.264733,41.038252],[116.29837,40.986641],[116.333546,40.984458],[116.341747,40.964804],[116.365069,40.943216],[116.37641,40.939681],[116.398515,40.905999],[116.41402,40.899762],[116.458678,40.900597],[116.474184,40.896032],[116.473607,40.919757],[116.447466,40.953818],[116.455539,40.980476],[116.516791,40.975274],[116.536333,40.988889],[116.569715,40.991265],[116.597778,40.97476],[116.614309,40.982916],[116.622958,41.02086],[116.614116,41.03607],[116.630839,41.060771],[116.64769,41.059296],[116.665182,41.046658],[116.688632,41.044669],[116.698884,41.021246],[116.683058,41.000511],[116.67774,40.971227],[116.689465,40.950669],[116.722334,40.927406],[116.713236,40.911978],[116.730471,40.897768],[116.759496,40.889858],[116.79512,40.863614],[116.805051,40.840706],[116.813636,40.848428],[116.847723,40.839354],[116.87617,40.821202],[116.880207,40.804332],[116.896353,40.79712],[116.894623,40.781597],[116.923391,40.773738],[116.926531,40.744869],[116.979967,40.702833],[117.031032,40.692126],[117.058327,40.701543],[117.0771,40.700059],[117.110673,40.70825],[117.117785,40.700059],[117.20236,40.695609],[117.241636,40.676643],[117.261371,40.681159],[117.290395,40.660189],[117.32115,40.658317],[117.342678,40.673611],[117.359208,40.673869],[117.409248,40.687288],[117.442245,40.676643],[117.492862,40.675417],[117.514583,40.660511],[117.501256,40.636759],[117.477997,40.635338],[117.46198,40.65309],[117.448909,40.628366],[117.430264,40.626041],[117.412708,40.605118],[117.430008,40.576112],[117.402072,40.573139],[117.387464,40.560861],[117.365936,40.575982],[117.342742,40.581604],[117.311859,40.57805],[117.269444,40.560473],[117.247403,40.54024],[117.264126,40.517285],[117.247147,40.511788],[117.219019,40.514375],[117.208575,40.501115],[117.237215,40.468763],[117.236511,40.45653],[117.263357,40.442352],[117.234076,40.417162],[117.240675,40.394424],[117.228502,40.386389],[117.226195,40.369021],[117.242277,40.369993],[117.260217,40.335762],[117.275018,40.33239],[117.274377,40.308521],[117.293342,40.296713],[117.296354,40.278088],[117.331465,40.28977],[117.339859,40.246213],[117.350943,40.229978],[117.386375,40.22712],[117.415335,40.236862],[117.419115,40.249785],[117.450062,40.252512],[117.484084,40.235304],[117.514326,40.227705],[117.54617,40.232901],[117.571671,40.219261],[117.56238,40.206073],[117.575451,40.192817],[117.609409,40.194897],[117.619532,40.206398],[117.64625,40.205163],[117.677069,40.22095],[117.694112,40.238161],[117.714551,40.241668],[117.75152,40.229718],[117.807775,40.261926],[117.844104,40.261406],[117.867554,40.26965],[117.897989,40.270429],[117.909457,40.285876],[118.000888,40.29256],[118.031643,40.302358],[118.061564,40.319095],[118.079312,40.353528],[118.121856,40.354695],[118.133837,40.375113],[118.165232,40.400449],[118.153123,40.409519],[118.156967,40.423768],[118.173818,40.423056],[118.239684,40.464686],[118.262942,40.452063],[118.277935,40.425711],[118.306575,40.419558],[118.356295,40.435295],[118.360011,40.428819],[118.387305,40.436719],[118.402683,40.416838],[118.430746,40.411851],[118.45599,40.414053],[118.503211,40.403365],[118.523458,40.40628],[118.548062,40.422667],[118.571512,40.414636],[118.550881,40.385482],[118.558377,40.36928],[118.539989,40.361048],[118.532364,40.319419],[118.533325,40.298854],[118.568949,40.287564],[118.580098,40.305861],[118.596949,40.308456],[118.608225,40.328305],[118.640197,40.354566],[118.643785,40.380946],[118.618349,40.425193],[118.624179,40.437626],[118.657176,40.450574],[118.702795,40.491411],[118.723491,40.473746],[118.772954,40.479765],[118.792112,40.492382],[118.794867,40.510753],[118.821328,40.531964],[118.864,40.527244],[118.886938,40.542438],[118.919038,40.53093],[118.966003,40.536102],[118.952676,40.558469],[118.983366,40.56364],[118.998359,40.578955],[119.013095,40.577081],[119.063392,40.606151],[119.086394,40.588775],[119.105487,40.603632],[119.158474,40.614418]]]]}},{type:"Feature",properties:{adcode:131e3,name:"廊坊市",center:[116.704441,39.523927],centroid:[116.540212,39.111215],childrenNum:10,level:"city",parent:{adcode:13e4},subFeatureIndex:9,acroutes:[1e5,13e4]},geometry:{type:"MultiPolygon",coordinates:[[[[116.244678,39.517354],[116.222766,39.501995],[116.220843,39.511644],[116.182144,39.49635],[116.179901,39.486568],[116.151325,39.471005],[116.132104,39.429423],[116.133001,39.4055],[116.116791,39.376243],[116.13582,39.351842],[116.198226,39.351315],[116.208734,39.330195],[116.201109,39.251911],[116.186116,39.222457],[116.206555,39.207429],[116.207837,39.168526],[116.221804,39.147813],[116.262426,39.138114],[116.263131,39.127292],[116.28184,39.107623],[116.305354,39.098116],[116.317592,39.077911],[116.318617,39.037416],[116.307148,39.032196],[116.293757,39.007344],[116.299588,38.993658],[116.3215,38.998088],[116.33534,38.984004],[116.316182,38.962708],[116.298755,38.975076],[116.291386,38.948683],[116.253007,38.932074],[116.243653,38.949345],[116.228083,38.942199],[116.230262,38.92453],[116.209503,38.921618],[116.20002,38.915727],[116.202198,38.887258],[116.212194,38.870238],[116.23212,38.871894],[116.248907,38.85964],[116.247497,38.848907],[116.278764,38.836451],[116.271973,38.816634],[116.338287,38.80689],[116.390313,38.789784],[116.42299,38.770419],[116.435804,38.733199],[116.406331,38.703596],[116.370836,38.692508],[116.366863,38.67305],[116.381984,38.619165],[116.41921,38.599288],[116.425425,38.587187],[116.454834,38.580337],[116.455475,38.557656],[116.432152,38.552533],[116.431127,38.539558],[116.452655,38.534501],[116.449772,38.518262],[116.465726,38.494096],[116.519482,38.48817],[116.559399,38.496759],[116.569715,38.470988],[116.589897,38.483908],[116.610593,38.479646],[116.627315,38.501087],[116.621228,38.514335],[116.647114,38.50648],[116.668257,38.530042],[116.672678,38.546545],[116.652431,38.551202],[116.643333,38.564773],[116.671653,38.566503],[116.662234,38.581268],[116.680303,38.592706],[116.680559,38.605936],[116.702792,38.619098],[116.71503,38.609327],[116.733739,38.614047],[116.738224,38.631327],[116.763212,38.633853],[116.77404,38.652258],[116.758855,38.732071],[116.766351,38.741959],[116.746297,38.754233],[116.751294,38.780168],[116.737327,38.784479],[116.73848,38.807022],[116.75123,38.831282],[116.74604,38.851491],[116.723103,38.852551],[116.722334,38.897058],[116.708046,38.897058],[116.70811,38.931876],[116.716183,38.93889],[116.728613,38.975341],[116.754626,39.003245],[116.756612,39.0503],[116.773015,39.046865],[116.787303,39.061927],[116.80268,39.050895],[116.860473,39.050564],[116.869891,39.069919],[116.881488,39.071702],[116.91109,39.111055],[116.924096,39.119372],[116.909232,39.150782],[116.870084,39.153685],[116.863164,39.201365],[116.855796,39.215669],[116.875594,39.21646],[116.874569,39.230036],[116.892637,39.223973],[116.878733,39.255336],[116.867969,39.302552],[116.884243,39.305383],[116.889626,39.338157],[116.875786,39.33921],[116.870724,39.357499],[116.849196,39.339473],[116.829206,39.338881],[116.818121,39.373547],[116.837599,39.374073],[116.834139,39.402674],[116.875914,39.434548],[116.855475,39.443352],[116.832473,39.435468],[116.815751,39.451761],[116.807421,39.445586],[116.785124,39.465883],[116.820748,39.482431],[116.813957,39.510266],[116.826194,39.513088],[116.819595,39.52851],[116.806204,39.528838],[116.787687,39.554555],[116.81165,39.576983],[116.797875,39.594358],[116.812355,39.615922],[116.789994,39.610548],[116.790699,39.596062],[116.748667,39.619919],[116.700742,39.621033],[116.7026,39.610417],[116.727075,39.593047],[116.705099,39.587999],[116.662363,39.605239],[116.646537,39.599143],[116.620524,39.601699],[116.607773,39.619723],[116.565934,39.619788],[116.566575,39.604387],[116.541779,39.593505],[116.524416,39.596521],[116.519354,39.566491],[116.508462,39.551078],[116.470916,39.55462],[116.478861,39.539204],[116.464573,39.527657],[116.437534,39.526541],[116.443813,39.509872],[116.424656,39.509741],[116.424079,39.522735],[116.402679,39.526869],[116.402807,39.5144],[116.418761,39.506393],[116.412354,39.482103],[116.444134,39.482169],[116.454706,39.453338],[116.434395,39.442761],[116.408958,39.45025],[116.350461,39.453009],[116.320027,39.46851],[116.306443,39.488997],[116.279277,39.491295],[116.257941,39.500551],[116.244678,39.517354]]],[[[117.209793,40.082253],[117.204347,40.06982],[117.160073,40.076199],[117.13925,40.064025],[117.119515,40.072424],[117.085621,40.075158],[117.085173,40.068583],[117.052048,40.059402],[117.028533,40.033939],[117.000662,40.0299],[116.972086,40.037],[116.960489,40.051133],[116.928133,40.05491],[116.867841,40.041885],[116.857782,40.051914],[116.822734,40.046444],[116.819979,40.028337],[116.781536,40.034851],[116.770452,40.011658],[116.775385,39.99276],[116.757317,39.961468],[116.780575,39.94973],[116.784676,39.891401],[116.804154,39.877954],[116.827284,39.87704],[116.866047,39.843866],[116.885653,39.844585],[116.907566,39.834133],[116.902824,39.848242],[116.92589,39.835374],[116.928453,39.813095],[116.952608,39.789827],[116.949725,39.778583],[116.924288,39.781263],[116.920893,39.769167],[116.901799,39.763609],[116.916664,39.731362],[116.88277,39.718472],[116.893854,39.695893],[116.912563,39.689216],[116.91692,39.706365],[116.950878,39.706824],[116.944599,39.695173],[116.963629,39.643441],[116.974585,39.636824],[117.004378,39.644489],[117.015783,39.654052],[117.057045,39.644554],[117.127076,39.61697],[117.152641,39.623523],[117.157959,39.636627],[117.177693,39.645602],[117.159624,39.666823],[117.170132,39.673371],[117.169235,39.717622],[117.153153,39.722726],[117.161867,39.747389],[117.205884,39.763871],[117.18064,39.78244],[117.178718,39.795318],[117.15751,39.796756],[117.156357,39.817473],[117.195056,39.82551],[117.192173,39.833088],[117.252208,39.834591],[117.259961,39.843409],[117.247467,39.861043],[117.227797,39.852749],[117.166865,39.868944],[117.149117,39.896297],[117.158856,39.909218],[117.137456,39.921616],[117.156869,39.938055],[117.151039,39.944839],[117.175963,39.959121],[117.178654,39.977311],[117.198132,39.99276],[117.187752,40.026187],[117.1841,40.062593],[117.222863,40.065523],[117.209793,40.082253]]]]}}],xX={type:SB,features:TB};function bB(){this.__data__=[],this.size=0}var wB=bB;function AB(e,t){return e===t||e!==e&&t!==t}var lu=AB,EB=lu;function CB(e,t){for(var r=e.length;r--;)if(EB(e[r][0],t))return r;return-1}var uu=CB,LB=uu,DB=Array.prototype,MB=DB.splice;function PB(e){var t=this.__data__,r=LB(t,e);if(r<0)return!1;var n=t.length-1;return r==n?t.pop():MB.call(t,r,1),--this.size,!0}var IB=PB,RB=uu;function NB(e){var t=this.__data__,r=RB(t,e);return r<0?void 0:t[r][1]}var OB=NB,BB=uu;function FB(e){return BB(this.__data__,e)>-1}var zB=FB,GB=uu;function VB(e,t){var r=this.__data__,n=GB(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this}var UB=VB,kB=wB,HB=IB,WB=OB,$B=zB,XB=UB;function xi(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}xi.prototype.clear=kB;xi.prototype.delete=HB;xi.prototype.get=WB;xi.prototype.has=$B;xi.prototype.set=XB;var cu=xi,jB=cu;function ZB(){this.__data__=new jB,this.size=0}var YB=ZB;function qB(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r}var KB=qB;function JB(e){return this.__data__.get(e)}var QB=JB;function eF(e){return this.__data__.has(e)}var tF=eF,rF=Wo,nF=zn,aF="[object AsyncFunction]",iF="[object Function]",oF="[object GeneratorFunction]",sF="[object Proxy]";function lF(e){if(!nF(e))return!1;var t=rF(e);return t==iF||t==oF||t==aF||t==sF}var Id=lF,uF=Zr,cF=uF["__core-js_shared__"],hF=cF,$c=hF,m0=function(){var e=/[^.]+$/.exec($c&&$c.keys&&$c.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function fF(e){return!!m0&&m0 in e}var dF=fF,vF=Function.prototype,pF=vF.toString;function gF(e){if(e!=null){try{return pF.call(e)}catch{}try{return e+""}catch{}}return""}var R2=gF,mF=Id,yF=dF,_F=zn,xF=R2,SF=/[\\^$.*+?()[\]{}|]/g,TF=/^\[object .+?Constructor\]$/,bF=Function.prototype,wF=Object.prototype,AF=bF.toString,EF=wF.hasOwnProperty,CF=RegExp("^"+AF.call(EF).replace(SF,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function LF(e){if(!_F(e)||yF(e))return!1;var t=mF(e)?CF:TF;return t.test(xF(e))}var DF=LF;function MF(e,t){return e==null?void 0:e[t]}var PF=MF,IF=DF,RF=PF;function NF(e,t){var r=RF(e,t);return IF(r)?r:void 0}var ba=NF,OF=ba,BF=Zr,FF=OF(BF,"Map"),Rd=FF,zF=ba,GF=zF(Object,"create"),hu=GF,y0=hu;function VF(){this.__data__=y0?y0(null):{},this.size=0}var UF=VF;function kF(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var HF=kF,WF=hu,$F="__lodash_hash_undefined__",XF=Object.prototype,jF=XF.hasOwnProperty;function ZF(e){var t=this.__data__;if(WF){var r=t[e];return r===$F?void 0:r}return jF.call(t,e)?t[e]:void 0}var YF=ZF,qF=hu,KF=Object.prototype,JF=KF.hasOwnProperty;function QF(e){var t=this.__data__;return qF?t[e]!==void 0:JF.call(t,e)}var ez=QF,tz=hu,rz="__lodash_hash_undefined__";function nz(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=tz&&t===void 0?rz:t,this}var az=nz,iz=UF,oz=HF,sz=YF,lz=ez,uz=az;function Si(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}Si.prototype.clear=iz;Si.prototype.delete=oz;Si.prototype.get=sz;Si.prototype.has=lz;Si.prototype.set=uz;var cz=Si,_0=cz,hz=cu,fz=Rd;function dz(){this.size=0,this.__data__={hash:new _0,map:new(fz||hz),string:new _0}}var vz=dz;function pz(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}var gz=pz,mz=gz;function yz(e,t){var r=e.__data__;return mz(t)?r[typeof t=="string"?"string":"hash"]:r.map}var fu=yz,_z=fu;function xz(e){var t=_z(this,e).delete(e);return this.size-=t?1:0,t}var Sz=xz,Tz=fu;function bz(e){return Tz(this,e).get(e)}var wz=bz,Az=fu;function Ez(e){return Az(this,e).has(e)}var Cz=Ez,Lz=fu;function Dz(e,t){var r=Lz(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this}var Mz=Dz,Pz=vz,Iz=Sz,Rz=wz,Nz=Cz,Oz=Mz;function Ti(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}Ti.prototype.clear=Pz;Ti.prototype.delete=Iz;Ti.prototype.get=Rz;Ti.prototype.has=Nz;Ti.prototype.set=Oz;var Bz=Ti,Fz=cu,zz=Rd,Gz=Bz,Vz=200;function Uz(e,t){var r=this.__data__;if(r instanceof Fz){var n=r.__data__;if(!zz||n.length<Vz-1)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new Gz(n)}return r.set(e,t),this.size=r.size,this}var kz=Uz,Hz=cu,Wz=YB,$z=KB,Xz=QB,jz=tF,Zz=kz;function bi(e){var t=this.__data__=new Hz(e);this.size=t.size}bi.prototype.clear=Wz;bi.prototype.delete=$z;bi.prototype.get=Xz;bi.prototype.has=jz;bi.prototype.set=Zz;var N2=bi;function Yz(e,t){for(var r=-1,n=e==null?0:e.length;++r<n&&t(e[r],r,e)!==!1;);return e}var qz=Yz,Kz=ba,Jz=function(){try{var e=Kz(Object,"defineProperty");return e({},"",{}),e}catch{}}(),O2=Jz,x0=O2;function Qz(e,t,r){t=="__proto__"&&x0?x0(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}var Nd=Qz,eG=Nd,tG=lu,rG=Object.prototype,nG=rG.hasOwnProperty;function aG(e,t,r){var n=e[t];(!(nG.call(e,t)&&tG(n,r))||r===void 0&&!(t in e))&&eG(e,t,r)}var B2=aG,iG=B2,oG=Nd;function sG(e,t,r,n){var a=!r;r||(r={});for(var i=-1,o=t.length;++i<o;){var s=t[i],l=n?n(r[s],e[s],s,r,e):void 0;l===void 0&&(l=e[s]),a?oG(r,s,l):iG(r,s,l)}return r}var $o=sG;function lG(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}var uG=lG,cG=Wo,hG=Ta,fG="[object Arguments]";function dG(e){return hG(e)&&cG(e)==fG}var vG=dG,S0=vG,pG=Ta,F2=Object.prototype,gG=F2.hasOwnProperty,mG=F2.propertyIsEnumerable,yG=S0(function(){return arguments}())?S0:function(e){return pG(e)&&gG.call(e,"callee")&&!mG.call(e,"callee")},z2=yG,_G=Array.isArray,du=_G,_l={exports:{}};function xG(){return!1}var SG=xG;_l.exports;(function(e,t){var r=Zr,n=SG,a=t&&!t.nodeType&&t,i=a&&!0&&e&&!e.nodeType&&e,o=i&&i.exports===a,s=o?r.Buffer:void 0,l=s?s.isBuffer:void 0,u=l||n;e.exports=u})(_l,_l.exports);var Od=_l.exports,TG=9007199254740991,bG=/^(?:0|[1-9]\d*)$/;function wG(e,t){var r=typeof e;return t=t??TG,!!t&&(r=="number"||r!="symbol"&&bG.test(e))&&e>-1&&e%1==0&&e<t}var G2=wG,AG=9007199254740991;function EG(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=AG}var V2=EG,CG=Wo,LG=V2,DG=Ta,MG="[object Arguments]",PG="[object Array]",IG="[object Boolean]",RG="[object Date]",NG="[object Error]",OG="[object Function]",BG="[object Map]",FG="[object Number]",zG="[object Object]",GG="[object RegExp]",VG="[object Set]",UG="[object String]",kG="[object WeakMap]",HG="[object ArrayBuffer]",WG="[object DataView]",$G="[object Float32Array]",XG="[object Float64Array]",jG="[object Int8Array]",ZG="[object Int16Array]",YG="[object Int32Array]",qG="[object Uint8Array]",KG="[object Uint8ClampedArray]",JG="[object Uint16Array]",QG="[object Uint32Array]",qe={};qe[$G]=qe[XG]=qe[jG]=qe[ZG]=qe[YG]=qe[qG]=qe[KG]=qe[JG]=qe[QG]=!0;qe[MG]=qe[PG]=qe[HG]=qe[IG]=qe[WG]=qe[RG]=qe[NG]=qe[OG]=qe[BG]=qe[FG]=qe[zG]=qe[GG]=qe[VG]=qe[UG]=qe[kG]=!1;function eV(e){return DG(e)&&LG(e.length)&&!!qe[CG(e)]}var tV=eV;function rV(e){return function(t){return e(t)}}var Bd=rV,xl={exports:{}};xl.exports;(function(e,t){var r=P2,n=t&&!t.nodeType&&t,a=n&&!0&&e&&!e.nodeType&&e,i=a&&a.exports===n,o=i&&r.process,s=function(){try{var l=a&&a.require&&a.require("util").types;return l||o&&o.binding&&o.binding("util")}catch{}}();e.exports=s})(xl,xl.exports);var Fd=xl.exports,nV=tV,aV=Bd,T0=Fd,b0=T0&&T0.isTypedArray,iV=b0?aV(b0):nV,U2=iV,oV=uG,sV=z2,lV=du,uV=Od,cV=G2,hV=U2,fV=Object.prototype,dV=fV.hasOwnProperty;function vV(e,t){var r=lV(e),n=!r&&sV(e),a=!r&&!n&&uV(e),i=!r&&!n&&!a&&hV(e),o=r||n||a||i,s=o?oV(e.length,String):[],l=s.length;for(var u in e)(t||dV.call(e,u))&&!(o&&(u=="length"||a&&(u=="offset"||u=="parent")||i&&(u=="buffer"||u=="byteLength"||u=="byteOffset")||cV(u,l)))&&s.push(u);return s}var k2=vV,pV=Object.prototype;function gV(e){var t=e&&e.constructor,r=typeof t=="function"&&t.prototype||pV;return e===r}var zd=gV;function mV(e,t){return function(r){return e(t(r))}}var H2=mV,yV=H2,_V=yV(Object.keys,Object),xV=_V,SV=zd,TV=xV,bV=Object.prototype,wV=bV.hasOwnProperty;function AV(e){if(!SV(e))return TV(e);var t=[];for(var r in Object(e))wV.call(e,r)&&r!="constructor"&&t.push(r);return t}var EV=AV,CV=Id,LV=V2;function DV(e){return e!=null&&LV(e.length)&&!CV(e)}var vu=DV,MV=k2,PV=EV,IV=vu;function RV(e){return IV(e)?MV(e):PV(e)}var Gd=RV,NV=$o,OV=Gd;function BV(e,t){return e&&NV(t,OV(t),e)}var FV=BV;function zV(e){var t=[];if(e!=null)for(var r in Object(e))t.push(r);return t}var GV=zV,VV=zn,UV=zd,kV=GV,HV=Object.prototype,WV=HV.hasOwnProperty;function $V(e){if(!VV(e))return kV(e);var t=UV(e),r=[];for(var n in e)n=="constructor"&&(t||!WV.call(e,n))||r.push(n);return r}var XV=$V,jV=k2,ZV=XV,YV=vu;function qV(e){return YV(e)?jV(e,!0):ZV(e)}var Xo=qV,KV=$o,JV=Xo;function QV(e,t){return e&&KV(t,JV(t),e)}var eU=QV,Sl={exports:{}};Sl.exports;(function(e,t){var r=Zr,n=t&&!t.nodeType&&t,a=n&&!0&&e&&!e.nodeType&&e,i=a&&a.exports===n,o=i?r.Buffer:void 0,s=o?o.allocUnsafe:void 0;function l(u,c){if(c)return u.slice();var h=u.length,f=s?s(h):new u.constructor(h);return u.copy(f),f}e.exports=l})(Sl,Sl.exports);var W2=Sl.exports;function tU(e,t){var r=-1,n=e.length;for(t||(t=Array(n));++r<n;)t[r]=e[r];return t}var $2=tU;function rU(e,t){for(var r=-1,n=e==null?0:e.length,a=0,i=[];++r<n;){var o=e[r];t(o,r,e)&&(i[a++]=o)}return i}var nU=rU;function aU(){return[]}var X2=aU,iU=nU,oU=X2,sU=Object.prototype,lU=sU.propertyIsEnumerable,w0=Object.getOwnPropertySymbols,uU=w0?function(e){return e==null?[]:(e=Object(e),iU(w0(e),function(t){return lU.call(e,t)}))}:oU,Vd=uU,cU=$o,hU=Vd;function fU(e,t){return cU(e,hU(e),t)}var dU=fU;function vU(e,t){for(var r=-1,n=t.length,a=e.length;++r<n;)e[a+r]=t[r];return e}var j2=vU,pU=H2,gU=pU(Object.getPrototypeOf,Object),Ud=gU,mU=j2,yU=Ud,_U=Vd,xU=X2,SU=Object.getOwnPropertySymbols,TU=SU?function(e){for(var t=[];e;)mU(t,_U(e)),e=yU(e);return t}:xU,Z2=TU,bU=$o,wU=Z2;function AU(e,t){return bU(e,wU(e),t)}var EU=AU,CU=j2,LU=du;function DU(e,t,r){var n=t(e);return LU(e)?n:CU(n,r(e))}var Y2=DU,MU=Y2,PU=Vd,IU=Gd;function RU(e){return MU(e,IU,PU)}var NU=RU,OU=Y2,BU=Z2,FU=Xo;function zU(e){return OU(e,FU,BU)}var GU=zU,VU=ba,UU=Zr,kU=VU(UU,"DataView"),HU=kU,WU=ba,$U=Zr,XU=WU($U,"Promise"),jU=XU,ZU=ba,YU=Zr,qU=ZU(YU,"Set"),KU=qU,JU=ba,QU=Zr,ek=JU(QU,"WeakMap"),tk=ek,qh=HU,Kh=Rd,Jh=jU,Qh=KU,ef=tk,q2=Wo,wi=R2,A0="[object Map]",rk="[object Object]",E0="[object Promise]",C0="[object Set]",L0="[object WeakMap]",D0="[object DataView]",nk=wi(qh),ak=wi(Kh),ik=wi(Jh),ok=wi(Qh),sk=wi(ef),Qn=q2;(qh&&Qn(new qh(new ArrayBuffer(1)))!=D0||Kh&&Qn(new Kh)!=A0||Jh&&Qn(Jh.resolve())!=E0||Qh&&Qn(new Qh)!=C0||ef&&Qn(new ef)!=L0)&&(Qn=function(e){var t=q2(e),r=t==rk?e.constructor:void 0,n=r?wi(r):"";if(n)switch(n){case nk:return D0;case ak:return A0;case ik:return E0;case ok:return C0;case sk:return L0}return t});var kd=Qn,lk=Object.prototype,uk=lk.hasOwnProperty;function ck(e){var t=e.length,r=new e.constructor(t);return t&&typeof e[0]=="string"&&uk.call(e,"index")&&(r.index=e.index,r.input=e.input),r}var hk=ck,fk=Zr,dk=fk.Uint8Array,vk=dk,M0=vk;function pk(e){var t=new e.constructor(e.byteLength);return new M0(t).set(new M0(e)),t}var Hd=pk,gk=Hd;function mk(e,t){var r=t?gk(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.byteLength)}var yk=mk,_k=/\w*$/;function xk(e){var t=new e.constructor(e.source,_k.exec(e));return t.lastIndex=e.lastIndex,t}var Sk=xk,P0=Pd,I0=P0?P0.prototype:void 0,R0=I0?I0.valueOf:void 0;function Tk(e){return R0?Object(R0.call(e)):{}}var bk=Tk,wk=Hd;function Ak(e,t){var r=t?wk(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)}var K2=Ak,Ek=Hd,Ck=yk,Lk=Sk,Dk=bk,Mk=K2,Pk="[object Boolean]",Ik="[object Date]",Rk="[object Map]",Nk="[object Number]",Ok="[object RegExp]",Bk="[object Set]",Fk="[object String]",zk="[object Symbol]",Gk="[object ArrayBuffer]",Vk="[object DataView]",Uk="[object Float32Array]",kk="[object Float64Array]",Hk="[object Int8Array]",Wk="[object Int16Array]",$k="[object Int32Array]",Xk="[object Uint8Array]",jk="[object Uint8ClampedArray]",Zk="[object Uint16Array]",Yk="[object Uint32Array]";function qk(e,t,r){var n=e.constructor;switch(t){case Gk:return Ek(e);case Pk:case Ik:return new n(+e);case Vk:return Ck(e,r);case Uk:case kk:case Hk:case Wk:case $k:case Xk:case jk:case Zk:case Yk:return Mk(e,r);case Rk:return new n;case Nk:case Fk:return new n(e);case Ok:return Lk(e);case Bk:return new n;case zk:return Dk(e)}}var Kk=qk,Jk=zn,N0=Object.create,Qk=function(){function e(){}return function(t){if(!Jk(t))return{};if(N0)return N0(t);e.prototype=t;var r=new e;return e.prototype=void 0,r}}(),eH=Qk,tH=eH,rH=Ud,nH=zd;function aH(e){return typeof e.constructor=="function"&&!nH(e)?tH(rH(e)):{}}var J2=aH,iH=kd,oH=Ta,sH="[object Map]";function lH(e){return oH(e)&&iH(e)==sH}var uH=lH,cH=uH,hH=Bd,O0=Fd,B0=O0&&O0.isMap,fH=B0?hH(B0):cH,dH=fH,vH=kd,pH=Ta,gH="[object Set]";function mH(e){return pH(e)&&vH(e)==gH}var yH=mH,_H=yH,xH=Bd,F0=Fd,z0=F0&&F0.isSet,SH=z0?xH(z0):_H,TH=SH,bH=N2,wH=qz,AH=B2,EH=FV,CH=eU,LH=W2,DH=$2,MH=dU,PH=EU,IH=NU,RH=GU,NH=kd,OH=hk,BH=Kk,FH=J2,zH=du,GH=Od,VH=dH,UH=zn,kH=TH,HH=Gd,WH=Xo,$H=1,XH=2,jH=4,Q2="[object Arguments]",ZH="[object Array]",YH="[object Boolean]",qH="[object Date]",KH="[object Error]",eS="[object Function]",JH="[object GeneratorFunction]",QH="[object Map]",eW="[object Number]",tS="[object Object]",tW="[object RegExp]",rW="[object Set]",nW="[object String]",aW="[object Symbol]",iW="[object WeakMap]",oW="[object ArrayBuffer]",sW="[object DataView]",lW="[object Float32Array]",uW="[object Float64Array]",cW="[object Int8Array]",hW="[object Int16Array]",fW="[object Int32Array]",dW="[object Uint8Array]",vW="[object Uint8ClampedArray]",pW="[object Uint16Array]",gW="[object Uint32Array]",Ze={};Ze[Q2]=Ze[ZH]=Ze[oW]=Ze[sW]=Ze[YH]=Ze[qH]=Ze[lW]=Ze[uW]=Ze[cW]=Ze[hW]=Ze[fW]=Ze[QH]=Ze[eW]=Ze[tS]=Ze[tW]=Ze[rW]=Ze[nW]=Ze[aW]=Ze[dW]=Ze[vW]=Ze[pW]=Ze[gW]=!0;Ze[KH]=Ze[eS]=Ze[iW]=!1;function Bs(e,t,r,n,a,i){var o,s=t&$H,l=t&XH,u=t&jH;if(r&&(o=a?r(e,n,a,i):r(e)),o!==void 0)return o;if(!UH(e))return e;var c=zH(e);if(c){if(o=OH(e),!s)return DH(e,o)}else{var h=NH(e),f=h==eS||h==JH;if(GH(e))return LH(e,s);if(h==tS||h==Q2||f&&!a){if(o=l||f?{}:FH(e),!s)return l?PH(e,CH(o,e)):MH(e,EH(o,e))}else{if(!Ze[h])return a?e:{};o=BH(e,h,s)}}i||(i=new bH);var d=i.get(e);if(d)return d;i.set(e,o),kH(e)?e.forEach(function(g){o.add(Bs(g,t,r,g,e,i))}):VH(e)&&e.forEach(function(g,m){o.set(m,Bs(g,t,r,m,e,i))});var v=u?l?RH:IH:l?WH:HH,p=c?void 0:v(e);return wH(p||e,function(g,m){p&&(m=g,g=e[m]),AH(o,m,Bs(g,t,r,m,e,i))}),o}var mW=Bs,yW=mW,_W=1,xW=4;function SW(e){return yW(e,_W|xW)}var TW=SW;const bW=Zm(TW);var wW=Nd,AW=lu;function EW(e,t,r){(r!==void 0&&!AW(e[t],r)||r===void 0&&!(t in e))&&wW(e,t,r)}var rS=EW;function CW(e){return function(t,r,n){for(var a=-1,i=Object(t),o=n(t),s=o.length;s--;){var l=o[e?s:++a];if(r(i[l],l,i)===!1)break}return t}}var LW=CW,DW=LW,MW=DW(),PW=MW,IW=vu,RW=Ta;function NW(e){return RW(e)&&IW(e)}var OW=NW,BW=Wo,FW=Ud,zW=Ta,GW="[object Object]",VW=Function.prototype,UW=Object.prototype,nS=VW.toString,kW=UW.hasOwnProperty,HW=nS.call(Object);function WW(e){if(!zW(e)||BW(e)!=GW)return!1;var t=FW(e);if(t===null)return!0;var r=kW.call(t,"constructor")&&t.constructor;return typeof r=="function"&&r instanceof r&&nS.call(r)==HW}var $W=WW;function XW(e,t){if(!(t==="constructor"&&typeof e[t]=="function")&&t!="__proto__")return e[t]}var aS=XW,jW=$o,ZW=Xo;function YW(e){return jW(e,ZW(e))}var qW=YW,G0=rS,KW=W2,JW=K2,QW=$2,e$=J2,V0=z2,U0=du,t$=OW,r$=Od,n$=Id,a$=zn,i$=$W,o$=U2,k0=aS,s$=qW;function l$(e,t,r,n,a,i,o){var s=k0(e,r),l=k0(t,r),u=o.get(l);if(u){G0(e,r,u);return}var c=i?i(s,l,r+"",e,t,o):void 0,h=c===void 0;if(h){var f=U0(l),d=!f&&r$(l),v=!f&&!d&&o$(l);c=l,f||d||v?U0(s)?c=s:t$(s)?c=QW(s):d?(h=!1,c=KW(l,!0)):v?(h=!1,c=JW(l,!0)):c=[]:i$(l)||V0(l)?(c=s,V0(s)?c=s$(s):(!a$(s)||n$(s))&&(c=e$(l))):h=!1}h&&(o.set(l,c),a(c,l,n,i,o),o.delete(l)),G0(e,r,c)}var u$=l$,c$=N2,h$=rS,f$=PW,d$=u$,v$=zn,p$=Xo,g$=aS;function iS(e,t,r,n,a){e!==t&&f$(t,function(i,o){if(a||(a=new c$),v$(i))d$(e,t,o,r,iS,n,a);else{var s=n?n(g$(e,o),i,o+"",e,t,a):void 0;s===void 0&&(s=i),h$(e,o,s)}},p$)}var m$=iS;function y$(e){return e}var oS=y$;function _$(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}var x$=_$,S$=x$,H0=Math.max;function T$(e,t,r){return t=H0(t===void 0?e.length-1:t,0),function(){for(var n=arguments,a=-1,i=H0(n.length-t,0),o=Array(i);++a<i;)o[a]=n[t+a];a=-1;for(var s=Array(t+1);++a<t;)s[a]=n[a];return s[t]=r(o),S$(e,this,s)}}var b$=T$;function w$(e){return function(){return e}}var A$=w$,E$=A$,W0=O2,C$=oS,L$=W0?function(e,t){return W0(e,"toString",{configurable:!0,enumerable:!1,value:E$(t),writable:!0})}:C$,D$=L$,M$=800,P$=16,I$=Date.now;function R$(e){var t=0,r=0;return function(){var n=I$(),a=P$-(n-r);if(r=n,a>0){if(++t>=M$)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}var N$=R$,O$=D$,B$=N$,F$=B$(O$),z$=F$,G$=oS,V$=b$,U$=z$;function k$(e,t){return U$(V$(e,t,G$),e+"")}var H$=k$,W$=lu,$$=vu,X$=G2,j$=zn;function Z$(e,t,r){if(!j$(r))return!1;var n=typeof t;return(n=="number"?$$(r)&&X$(t,r.length):n=="string"&&t in r)?W$(r[t],e):!1}var Y$=Z$,q$=H$,K$=Y$;function J$(e){return q$(function(t,r){var n=-1,a=r.length,i=a>1?r[a-1]:void 0,o=a>2?r[2]:void 0;for(i=e.length>3&&typeof i=="function"?(a--,i):void 0,o&&K$(r[0],r[1],o)&&(i=a<3?void 0:i,a=1),t=Object(t);++n<a;){var s=r[n];s&&e(t,s,n,i)}return t})}var Q$=J$,eX=m$,tX=Q$,rX=tX(function(e,t,r){eX(e,t,r)}),nX=rX;const aX=Zm(nX),iX=e=>(U3("data-v-22bb47a0"),e=e(),k3(),e),oX={class:"dv-capsule-chart"},sX={class:"label-column"},lX=iX(()=>aa("div",null," ",-1)),uX={class:"capsule-container"},cX={key:0,class:"capsule-item-value"},hX={class:"unit-label"},fX={key:0,class:"unit-text"},dX=Gl({__name:"capsule-chart",props:{config:{default:()=>{}},data:{default:()=>[]}},setup(e){const t=ka(null),r=ka([]),n=ka([]),a=ka([]),i=G3({colors:["#37a2da","#32c5e9","#67e0e3","#9fe6b8","#ffdb5c","#ff9f7f","#fb7293"],unit:"",showValue:!1}),o=e,s=()=>{l(),u()},l=()=>{t.value=aX(bW(i),o.config||{})},u=()=>{if(!o.data.length)return;const c=o.data.map(v=>v.value),h=Math.max(...c);n.value=c,r.value=c.map(v=>h?v/h:0);const f=h/5,d=Array.from(new Set(new Array(6).fill(0).map((v,p)=>Math.ceil(p*f))));a.value=d};return dv(()=>o.data,c=>{s()}),dv(()=>o.config,c=>{s()}),df(()=>{s()}),(c,h)=>(tr(),pr("div",oX,[t.value?(tr(),pr(qo,{key:0},[aa("div",sX,[(tr(!0),pr(qo,null,yu(c.data,f=>(tr(),pr("div",{key:f.name},Hi(f.name),1))),128)),lX]),aa("div",uX,[(tr(!0),pr(qo,null,yu(r.value,(f,d)=>(tr(),pr("div",{class:"capsule-item",key:d},[aa("div",{class:"capsule-item-column",style:V3(`width: ${f*100}%; background-color: ${t.value.colors[d%t.value.colors.length]};`)},[t.value.showValue?(tr(),pr("div",cX,Hi(n.value[d]),1)):Xa("",!0)],4)]))),128)),aa("div",hX,[(tr(!0),pr(qo,null,yu(a.value,(f,d)=>(tr(),pr("div",{key:f+d},Hi(f),1))),128))])]),t.value.unit?(tr(),pr("div",fX,Hi(t.value.unit),1)):Xa("",!0)],64)):Xa("",!0)]))}}),SX=Ym(dX,[["__scopeId","data-v-22bb47a0"]]),TX=""+new URL("m1-QI8OFCpq.png",import.meta.url).href,bX=""+new URL("m4-RJfs5YP9.png",import.meta.url).href,wX=""+new URL("m5-FRxWbfgh.png",import.meta.url).href,AX=""+new URL("m6-EDbVTiBA.png",import.meta.url).href;export{SX as C,Zr as _,Wo as a,zn as b,_X as c,mX as d,gX as e,yX as f,TX as g,bX as h,Ta as i,xX as j,wX as k,AX as l};
